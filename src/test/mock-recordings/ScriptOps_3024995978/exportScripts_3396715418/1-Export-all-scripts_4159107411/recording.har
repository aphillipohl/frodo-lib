{
  "log": {
    "_recordingName": "ScriptOps/exportScripts()/1: Export all scripts",
    "creator": {
      "comment": "persister:fs",
      "name": "Polly.JS",
      "version": "6.0.5"
    },
    "entries": [
      {
        "_id": "d5f3c78a168efd303e4ac23237ac992b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 531,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "true"
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=true"
        },
        "response": {
          "bodySize": 732828,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 732828,
            "text": "{\"result\":[{\"_id\":\"01e1a3c0-038b-4c16-956a-6c9d89328cff\",\"name\":\"Authentication Tree Decision Node Script\",\"description\":\"Default global script for a scripted decision node\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5511f576-6cbd-4f4d-8d80-40f294da98a5\",\"name\":\"Read custom IDM attributes\",\"description\":\"Read custom IDM attributes and put in shared state.\",\"script\":\"LyogUmVhZCBjdXN0b20gSURNIGF0dHJpYnV0ZXMKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmVhZCBjdXN0b20gSURNIGF0dHJpYnV0ZXMgYW5kIHB1dCBpbiBzaGFyZWQgc3RhdGUKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGVycm9yCiAqLwooZnVuY3Rpb24gKCkgewogIHRyeSB7CiAgCW91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgYXR0cmlidXRlID0gJ2ZyLWlkbS1jdXN0b20tYXR0cnMnOwogICAgdmFyIHVzZXJuYW1lID0gbm9kZVN0YXRlLmdldCgnX2lkJykuYXNTdHJpbmcoKTsKICAgIHZhciBjdXN0b21BdHRycyA9IEpTT04ucGFyc2UoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS5pdGVyYXRvcigpLm5leHQoKSk7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdjdXN0b21fZGVwYXJ0bWVudCcsIGN1c3RvbUF0dHJzWydjdXN0b21fZGVwYXJ0bWVudCddKTsKICAgIG5vZGVTdGF0ZS5wdXRTaGFyZWQoJ2N1c3RvbScsIGN1c3RvbUF0dHJzKTsKICB9IGNhdGNoIChlcnJvcikgewogIAlvdXRjb21lID0gJ2Vycm9yJzsKICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdmFsaWRhdGluZyBPVFAgZnJvbSBVUkw6ICcgKyBlcnJvcik7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdlcnJvcicsIGVycm9yLm1lc3NhZ2UpOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"2dc3997b-a3f9-42c6-b00a-f89faf59b538\",\"name\":\"Populate UserName as User+Company\",\"description\":\"This script creates username as prior userName+CompanyName\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJmclVuaW5kZXhlZFN0cmluZzEiKQpjb21wYW55ID0gb2JqZWN0QXR0cmlidXRlcy5nZXQoImZySW5kZXhlZFN0cmluZzQiKQp2YXIgcmVzdWx0ID0gdXNlck5hbWUuY29uY2F0KGNvbXBhbnkpLnRvTG93ZXJDYXNlKCk7Cgpsb2dnZXIuZXJyb3IoInJlc3VsdCA9ICIgKyByZXN1bHQpOwoKLy9vYmplY3RBdHRyaWJ1dGVzLnB1dCgidXNlck5hbWUiLCByZXN1bHQpCm9iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIscmVzdWx0KQpzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIixyZXN1bHQpCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3RBdHRyaWJ1dGVzKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e1db8a0a-0329-4962-a5bf-ecffaca376ae\",\"name\":\"Alpha endUserUIClient OIDC Claims Script\",\"description\":\"Used by endUserUIClient\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d6f3befb-c73a-437e-b02a-66d9b4c93f8b\",\"name\":\"Impersonate: Extract Actors And Become Impersonator\",\"description\":\"Extract impersonatee and impersonator from headers and become impersonator.\",\"script\":\"LyogSW1wZXJzb25hdGU6IEV4dHJhY3QgQWN0b3JzIEFuZCBCZWNvbWUgSW1wZXJzb25hdG9yCiAqCiAqIEV4dHJhY3QgaW1wZXJzb25hdGVlIGFuZCBpbXBlcnNvbmF0b3IgZnJvbSBoZWFkZXJzIGFuZCBiZWNvbWUgaW1wZXJzb25hdGVlLgogKgogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwoKKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogRXh0cmFjdCBBY3RvcnM6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gImZhbHNlIjsKCiAgICAvKgogICAgICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwogICAgdmFyIElNUEVSU09OQVRFRV9IRUFERVJfTkFNRSA9ICJYLUltcGVyc29uYXRlZSI7CiAgICB2YXIgSU1QRVJTT05BVE9SX0hFQURFUl9OQU1FID0gIlgtSW1wZXJzb25hdG9yIjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwoKICAgIHZhciBpbXBlcnNvbmF0ZWUgPSBnZXRIZWFkZXIoSU1QRVJTT05BVEVFX0hFQURFUl9OQU1FKTsKICAgIHZhciBpbXBlcnNvbmF0b3IgPSBnZXRIZWFkZXIoSU1QRVJTT05BVE9SX0hFQURFUl9OQU1FKTsKICAgIGlmIChpbXBlcnNvbmF0ZWUgJiYgaW1wZXJzb25hdG9yKSB7CiAgICAgICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoImltcGVyc29uYXRlZSIsIGltcGVyc29uYXRlZSk7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJpbXBlcnNvbmF0b3IiLCBpbXBlcnNvbmF0b3IpOwogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBpbXBlcnNvbmF0b3IpOwogICAgICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBpbXBlcnNvbmF0b3IpOwogICAgfQoKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogRXh0cmFjdCBBY3RvcnM6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKSAmJiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApKSB7CiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qCiAgICAgKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgICAgICB9CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5561a45f-bf00-4ec5-bab4-f069bac9a38b\",\"name\":\"CopyOTPToObjectAttributes\",\"description\":\"Copy an OTP generated by the \\\"HOTP Generator\\\" node to the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyogQ29weU9UUFRvT2JqZWN0QXR0cmlidXRlcwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDb3B5IGFuIE9UUCBnZW5lcmF0ZWQgYnkgdGhlICJIT1RQIEdlbmVyYXRvciIgbm9kZSB0byB0aGUgSURNIHByb2ZpbGUgCiAqIHNoYXJlZCBzdGF0ZSBzbyBpdCBjYW4gYmUgcGF0Y2hlZCB0byB0aGUgdXNlciBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwppZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKCXNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dCgiZGVzY3JpcHRpb24iLCBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKQp9CmVsc2UgewoJc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwge2Rlc2NyaXB0aW9uOiBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpfSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b6fce769-cf21-4963-a8dc-7c5370a4d15b\",\"name\":\"shared State Printer\",\"description\":\"null\",\"script\":\"dmFyIGZyID0gSmF2YUltcG9ydGVyKAogIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKTsKb3V0Y29tZSA9ICJ0cnVlIjsKd2l0aCAoZnIpIHsKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgdmFyIGNhbGxiYWNrID0gbmV3IFRleHRPdXRwdXRDYWxsYmFjayhUZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sICJzaGFyZWRTdGF0ZTogIi5jb25jYXQoc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkpOwogICAgYWN0aW9uID0gQWN0aW9uLnNlbmQoY2FsbGJhY2spLmJ1aWxkKCk7CiAgfSBlbHNlIHsKICAgIGFjdGlvbiA9IEFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d3405f9c-d338-4dc2-b00d-7aacf77b731d\",\"name\":\"Return OTP\",\"description\":\"Return the generated OTP using a TextOutputCallback\",\"script\":\"LyogUmV0dXJuIE9UUAogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBSZXR1cm4gdGhlIGdlbmVyYXRlZCBPVFAgdXNpbmcgYSBUZXh0T3V0cHV0Q2FsbGJhY2suCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBub2RlU3RhdGUuZ2V0KCJvbmVUaW1lUGFzc3dvcmQiKS5hc1N0cmluZygpCiAgICAgICAgKQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3b81d8e6-55f3-4937-bbbb-d62233cc6a0f\",\"name\":\"Launcher\",\"description\":\"Display launch panel with journeys.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPHA+QXV0aGVudGljYXRpb24vUmVnaXN0cmF0aW9uL01GQTwvcD4gXAogICAgICAgICAgICAgICAgICAgPHVsIHN0eWxlPVwidGV4dC1hbGlnbjpsZWZ0O1wiPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1JvdXRlclwiPklEUCBEaXNjb3Zlcnk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9BQS1SZWdpc3RyYXRpb25cIj5SZWdpc3RyYXRpb248L2E+ICg8YSBocmVmPVwiIy9zZXJ2aWNlL1JlZ2lzdHJhdGlvblwiPmNsYXNzaWM8L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvQUEtTG9naW5cIj5BdXRoZW50aWNhdGlvbjwvYT4gKDxhIGhyZWY9XCIjL3NlcnZpY2UvTG9naW5cIj5jbGFzc2ljPC9hPik8L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1Bhc3N3b3JkQnJlYWNoRGV0ZWN0aW9uXCI+UGFzc3dvcmQgQnJlYWNoIERldGVjdGlvbjwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1dlYkF1dGhOXCI+RmlkbzwvYT4gKDxhIGhyZWY9XCIjL3NlcnZpY2UvV2ViQXV0aE5SZWdpc3RyYXRpb25cIj5SZWdpc3RyYXRpb248L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvUHVzaFwiPlB1c2g8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9SZXNldFBhc3N3b3JkXCI+Rm9yZ290IFBhc3N3b3JkPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvRm9yZ290dGVuVXNlcm5hbWVcIj5Gb3Jnb3QgVXNlcm5hbWU8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cImh0dHBzOi8vaWRjLnNjaGV1YmVyLmlvL2xvZ2luP2F1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1BenVyZVwiPkF6dXJlIChTUC1pbml0KTwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiaHR0cHM6Ly9pZGMuc2NoZXViZXIuaW8vbG9naW4/YXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUFERlNPSURDXCI+QURGUyAoT0lEQyk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgPC91bD4gXAogICAgICAgICAgICAgICAgICAgPHA+QXBwbGljYXRpb25zPC9wPiBcCiAgICAgICAgICAgICAgICAgICA8dWwgc3R5bGU9XCJ0ZXh0LWFsaWduOmxlZnQ7XCI+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaWcvc3R1ZGlvL1wiPklkZW50aXR5IEdhdGV3YXkgRGV2ZWxvcGVyIFN0dWRpbzwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2dyYWZhbmFcIj5HcmFmYW5hPC9hPiAoPGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9wcm9tZXRoZXVzXCI+UHJvbWV0aGV1czwvYT4pPC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9leHBhbnNlXCI+VGhlIEV4cGFuc2UgRmFuIFBhZ2U8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+SWRlbnRpdHkgR2F0ZXdheSBcCiAgICAJCQkJCTx1bD4gXAogICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5TYW1wbGUgQXBwIDxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaWctc2FtcGxlLWFwcC9sb2dpblwiPlJlcGxheTwvYT4gKDxhIGhyZWY9XCJodHRwczovL2lkYy5zY2hldWJlci5pby9sb2dpbj9hdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9UmVzZXRSZXBsYXlDcmVkZW50aWFscyZGb3JjZUF1dGg9dHJ1ZVwiPnJlc2V0PC9hPil8PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9pZy1tYW51YWwtYXBwL2xvZ2luXCI+TWFudWFsPC9hPiAoPGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9pZy1tYW51YWwtYXBwL2xvZ291dFwiPmxvZ291dDwvYT4pPGJyPkNyZWRlbnRpYWxzOiA8Y29kZT5kZW1vPC9jb2RlPi88Y29kZT5DaDRuZzMxdDwvY29kZT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPkF1dGhaOiA8YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2Zvcmdlcm9jay9hcHAxL1wiPmFwcDE8L2E+IChwdWIpfDxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vZm9yZ2Vyb2NrL2FwcDIvXCI+YXBwMjwvYT4gKHNzbyl8PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9mb3JnZXJvY2svYXBwMy9cIj5hcHAzPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2Zvcmdlcm9jay9wYXkvXCI+cGF5PC9hPiAodHgpPGJyPlBvbGljeSBTZXQ6IDxjb2RlPmFwcHM8L2NvZGU+PC9saT4gXAoJCQkJCQk8L3VsPiBcCiAgCQkJCQkgPC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+V2ViIEFnZW50IFwKICAgIAkJCQkJPHVsPiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPkF1dGhaOiA8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMS9cIj5hcHAxPC9hPiAocHViKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMi9cIj5hcHAyPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMy9cIj5hcHAzPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vcGF5L1wiPnBheTwvYT4gKHR4KTxicj5Qb2xpY3kgU2V0OiA8Y29kZT5hcHBzPC9jb2RlPjwvbGk+IFwKCQkJCQkJPC91bD4gXAogIAkJCQkJIDwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IFwKICAgICAgICAgICAgICAgICAgIDxwPkR5bmFtaWMgQnJhbmRpbmcgKFRoZW1lcyk8L3A+IFwKICAgICAgICAgICAgICAgICAgIDx1bCBzdHlsZT1cInRleHQtYWxpZ246bGVmdDtcIj4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9UaGVtZUJ5TGFuZ3VhZ2VcIj5DaGFuZ2UgdGhlbWUgYmFzZWQgb24gdXNlcnMgbGFuZ3VhZ2U8L2E+ICg8YSBocmVmPVwiIy9zZXJ2aWNlL1RoZW1lQnlMYW5ndWFnZU11bHRpXCI+bXVsdGk8L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvVGhlbWVCeVByb2ZpbGVEYXRhXCI+Q2hhbmdlIHRoZW1lIHRvIGV4cG9zZSBhIG5ldyBmZWF0dXJlIChlYXJseSBhZG9wdGVycyk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9Sb3V0ZXJcIj5DaGFuZ2UgYnJhbmQgYmFzZWQgb24gdXNlcnMgbWVtYmVyc2hpcCBvZiBhbiBvcmdhbml6YXRpb248L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9UaGVtZUJ5UHJlZmVyZW5jZVwiPkNoYW5nZSBMb29rIGFuZCBmZWVsIGJhc2VkIG9uIHVzZXIgYWNjZXNzaWJpbGl0eSBwcm9wZXJ0aWVzPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvVGhlbWVkTUZBTG9naW5cIj5DaGFuZ2UgbG9vayBhbmQgZmVlbCBiYXNlZCBzdGVwIHVwIEF1dGhlbnRpY2F0aW9uPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IFwKICAgICAgICAgICAgICAgICAgIDxwPlNlbGVjdCBUaGVtZTwvcD4gXAogICAgICAgICAgICAgICAgICAgPHVsIHN0eWxlPVwidGV4dC1hbGlnbjpsZWZ0O1wiPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiP3RoZW1lSWQ9RXhwYW5zZSMvc2VydmljZS9MYXVuY2hlclwiPkV4cGFuc2U8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1GT1JHIy9zZXJ2aWNlL0xhdW5jaGVyXCI+Rk9SRzwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiP3JlYWxtPS9hbHBoYSZ0aGVtZUlkPUhpZ2hsYW5kZXIjL3NlcnZpY2UvTGF1bmNoZXJcIj5IaWdobGFuZGVyPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9Um9icm95Iy9zZXJ2aWNlL0xhdW5jaGVyXCI+Um9icm95PC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9WmFyZG96Iy9zZXJ2aWNlL0xhdW5jaGVyXCI+WmFyZG96PC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9d29vbG1hcmsjL3NlcnZpY2UvTGF1bmNoZXJcIj53b29sbWFyazwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT5PdGhlcjogPGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1BUyMvc2VydmljZS9MYXVuY2hlclwiPkFTPC9hPiwgPGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1GWCMvc2VydmljZS9MYXVuY2hlclwiPkZYPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IjsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAgICAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICAgICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICAgICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5zdHlsZSA9IFwidGV4dC1hbGlnbjogbGVmdDsgaW5saW5lLXNpemU6IDQzMHB4OyBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkO1wiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAgICAgIiAgfVxuIikuY29uY2F0KAogICAgICAifSkiKQogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIGFuY2hvcgogICAgICAgICAgICApLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCkKICAgIH0KICAgIGVsc2UgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e232cff3-2460-47cd-80b2-36c86c0d0f06\",\"name\":\"Alpha endUserUIClient OAuth2 Access Token Modification Script\",\"description\":\"Used by endUserUIClient\",\"script\":\"KGZ1bmN0aW9uICgpIHsKICBpZiAoc2NvcGVzLmNvbnRhaW5zKCdmcjphdXRvYWNjZXNzOionKSkgewogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICBjb20uc3VuLmlkZW50aXR5LmlkbS5JZFR5cGUKICAgICk7CiAgICB2YXIgZ3JvdXBzID0gW107CiAgICBpZGVudGl0eS5nZXRNZW1iZXJzaGlwcyhmci5JZFR5cGUuR1JPVVApLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkgewogICAgICBncm91cHMucHVzaChncm91cC5nZXRBdHRyaWJ1dGUoJ2NuJykudG9BcnJheSgpWzBdKTsKICAgIH0pOwogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ2dyb3VwcycsIGdyb3Vwcyk7CiAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b7259916-71ed-4675-8c5a-de86a80e4aed\",\"name\":\"FrodoTestScript2\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"051624d8-ce33-4e49-a4e5-e3ba7e7a9b22\",\"name\":\"Display Username (frUnindexedString1)\",\"description\":\"Display Username (frUnindexedString1)\",\"script\":\"LyoKICogQmVnaW4gY29uZmlndXJhdGlvbgogKgogKiBNb2RpZnkgdGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgdG8gYWRhcHQgdG8geW91ciBuZWVkcwogKi8KCi8vIFNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheS4gWW91IG1heSB1c2UgSFRNTCBmb3IgZm9ybWF0dGluZy4gQXZvaWQgbGluZSBicmVha3MhIFVzZSA8YnI+IGluc3RlYWQuCnZhciBtZXNzYWdlID0gIjxoNT4iLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoImZyVW5pbmRleGVkU3RyaW5nMSIpKS5jb25jYXQoIjwvaDU+IikKCi8vIENob29zZSB0aGUgaG9yaXpvbnRhbCBhbGlnbm1lbnQgb2YgeW91ciBtZXNzYWdlLiBVc2UgbGVmdCwgY2VudGVyLCByaWdodC4KdmFyIGhhbGlnbiA9ICJsZWZ0IjsKLyoKICogRW5kIGNvbmZpZ3VyYXRpb24KICovCgp2YXIgYW5jaG9yID0gImFuY2hvci0iLmNvbmNhdChnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4JykpOwp2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICIgIH1cbiIpLmNvbmNhdCgKICAifSkiKQp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgKSwKICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"424da748-82cc-4b54-be6f-82bd64d82a74\",\"name\":\"Yahoo Profile Normalization\",\"description\":\"Normalizes raw profile data from Yahoo\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImxvY2FsZSIsIHJhd1Byb2ZpbGUubG9jYWxlKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"3fff65f0-b3fe-40c5-8e82-b6d2e39a14e5\",\"name\":\"Twilio IVR: Send Registration Information Via SMS\",\"description\":\"Send registration information via SMS\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IHN0YXJ0Iik7CgppZiAoZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKSkgewogICAgdmFyIEJhc2U2ND17X2tleVN0cjoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iLGVuY29kZTpmdW5jdGlvbihpbnB1dCl7dmFyIG91dHB1dD0iIjt2YXIgY2hyMSxjaHIyLGNocjMsZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PUJhc2U2NC5fdXRmOF9lbmNvZGUoaW5wdXQpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtjaHIxPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIyPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIzPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtlbmMxPWNocjE+PjI7ZW5jMj0oY2hyMSYzKTw8NHxjaHIyPj40O2VuYzM9KGNocjImMTUpPDwyfGNocjM+PjY7ZW5jND1jaHIzJjYzO2lmKGlzTmFOKGNocjIpKXtlbmMzPWVuYzQ9NjR9ZWxzZSBpZihpc05hTihjaHIzKSl7ZW5jND02NH1vdXRwdXQ9b3V0cHV0K3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMSkrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMyKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzMpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jNCl9cmV0dXJuIG91dHB1dH0sZGVjb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMzt2YXIgZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PWlucHV0LnJlcGxhY2UoL1teQS1aYS16MC05XCtcL1w9XS9nLCIiKTt3aGlsZShpPGlucHV0Lmxlbmd0aCl7ZW5jMT10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMj10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMz10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jND10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7Y2hyMT1lbmMxPDwyfGVuYzI+PjQ7Y2hyMj0oZW5jMiYxNSk8PDR8ZW5jMz4+MjtjaHIzPShlbmMzJjMpPDw2fGVuYzQ7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjEpO2lmKGVuYzMhPTY0KXtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMil9aWYoZW5jNCE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKX19b3V0cHV0PUJhc2U2NC5fdXRmOF9kZWNvZGUob3V0cHV0KTtyZXR1cm4gb3V0cHV0fSxfdXRmOF9lbmNvZGU6ZnVuY3Rpb24oc3RyaW5nKXtzdHJpbmc9c3RyaW5nLnJlcGxhY2UoL1xyXG4vZywiXG4iKTt2YXIgdXRmdGV4dD0iIjtmb3IodmFyIG49MDtuPHN0cmluZy5sZW5ndGg7bisrKXt2YXIgYz1zdHJpbmcuY2hhckNvZGVBdChuKTtpZihjPDEyOCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjKX1lbHNlIGlmKGM+MTI3JiZjPDIwNDgpe3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NnwxOTIpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfWVsc2V7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj4xMnwyMjQpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NiY2M3wxMjgpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfX1yZXR1cm4gdXRmdGV4dH0sX3V0ZjhfZGVjb2RlOmZ1bmN0aW9uKHV0ZnRleHQpe3ZhciBzdHJpbmc9IiI7dmFyIGk9MDt2YXIgYz1jMT1jMj0wO3doaWxlKGk8dXRmdGV4dC5sZW5ndGgpe2M9dXRmdGV4dC5jaGFyQ29kZUF0KGkpO2lmKGM8MTI4KXtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyk7aSsrfWVsc2UgaWYoYz4xOTEmJmM8MjI0KXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMzEpPDw2fGMyJjYzKTtpKz0yfWVsc2V7YzI9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMSk7YzM9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMik7c3RyaW5nKz1TdHJpbmcuZnJvbUNoYXJDb2RlKChjJjE1KTw8MTJ8KGMyJjYzKTw8NnxjMyY2Myk7aSs9M319cmV0dXJuIHN0cmluZ319OwoKICAgIC8vIFR3aWxpbyBTTVMgTWVzc2FnZSBBUEkgQ29uZmlndXJhdGlvbgogICAgdmFyIFRXSUxJT19BUElfU0lEID0gIkFDNTQ5Zjc0ZTUxNWY3MzExMDk3M2RiNDMxZmMxYjE0NzQiOwogICAgdmFyIFRXSUxJT19BUElfVE9LRU4gPSAiOTM4OGZmMDdmMjVkZGQ3MzBjMzI3MDdjM2Q3OWY5NDIiOwogICAgdmFyIFRXSUxJT19BUElfRlJPTSA9ICIrMTkxNjMxODM0MzgiOwogIAogICAgdmFyIFRXSUxJT19BUElfVVJJID0gImh0dHBzOi8vYXBpLnR3aWxpby5jb20vMjAxMC0wNC0wMS9BY2NvdW50cy8iLmNvbmNhdChUV0lMSU9fQVBJX1NJRCkuY29uY2F0KCIvTWVzc2FnZXMuanNvbiIpOwkKICAgIHZhciBUV0lMSU9fQVBJX1RPID0gZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKTsKICAgIHZhciBUV0lMSU9fQVBJX0JPRFkgPSAiUmVnaXN0ZXIgeW91ciBhY2NvdW50IHdpdGggRm9yZ2VSb2NrIElkZW50aXR5IENsb3VkOiAiLmNvbmNhdCgiaHR0cHM6Ly9pZGMuc2NoZXViZXIuaW8vbG9naW4vP3JlYWxtPS9hbHBoYSMvc2VydmljZS9SZWdpc3RyYXRpb24iKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IFRvOiAiLmNvbmNhdChUV0lMSU9fQVBJX1RPKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBNZXNzYWdlOiAiLmNvbmNhdChUV0lMSU9fQVBJX0JPRFkpKTsKCiAgICB2YXIgQVVUSFogPSAiQmFzaWMgIi5jb25jYXQoQmFzZTY0LmVuY29kZShUV0lMSU9fQVBJX1NJRC5jb25jYXQoJzonKS5jb25jYXQoVFdJTElPX0FQSV9UT0tFTikpKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJCb2R5IiwgVFdJTElPX0FQSV9CT0RZKTsKICAgIHBhcmFtcy5hZGQoIlRvIiwgVFdJTElPX0FQSV9UTyk7CiAgICByZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhwYXJhbXMudG9TdHJpbmcoKSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgIGlmIChyZXN1bHRbImVycm9yX2NvZGUiXSkgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IGVycm9yX2NvZGUgPSAiLmNvbmNhdChyZXN1bHRbImVycm9yX2NvZGUiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogZXJyb3JfbWVzc2FnZSA9ICIuY29uY2F0KHJlc3VsdFsiZXJyb3JfbWVzc2FnZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBvdXRjb21lID0gZmFpbGVkIik7CiAgICB9IGVsc2UgaWYgKHJlc3VsdFsiY29kZSJdKSB7CiAgICAgICAgb3V0Y29tZSA9ICJmYWlsZWQiOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBtZXNzYWdlID0gIi5jb25jYXQocmVzdWx0WyJtZXNzYWdlIl0pKTsKICAgIH0gZWxzZSB7CiAgICAgICAgb3V0Y29tZSA9ICJzZW50IjsKICAgICAgICBsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogb3V0Y29tZSA9IHNlbnQiKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJmYWlsZWQiOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IE5vIHBob25lIG51bWJlciBmb3VuZCBpbiBzaGFyZWRTdGF0ZS5vYmplY3RBdHRyaWJ1dGVzLnRlbGVwaG9uZU51bWJlciEnIik7CiAgCWxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogb3V0Y29tZSA9IGZhaWxlZCIpOwp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICByZXR1cm4gc3RvcmFnZS5uYW1lOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"be6f1f2c-30ee-41fb-9e1e-8da72267fad3\",\"name\":\"Twilio IVR: Greet Verified Caller\",\"description\":\"Greet verified caller\",\"script\":\"LyogVHdpbGlvIElWUjogR3JlZXQgVmVyaWZpZWQgQ2FsbGVyCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEZvciBJRCBDbG91ZCB1c2UgIl9pZCIsIGZvciBjbGFzc2ljIGRlcGxveW1lbnRzIHVzZSAidXNlcm5hbWUiCnZhciB1c2VyaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCgovLyBDb25maWd1cmUgaG93IHlvdSB3b3VsZCBsaWtlIHRvIGFkZHJlc3MgdGhlIHZlcmlmaWVkIGNhbGxlci4gVGhlIGRlZmF1bHQgaXMgdGhlIGZ1bGwgbmFtZS4KdmFyIG5hbWUgPSBbaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKSwgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJzbiIpLml0ZXJhdG9yKCkubmV4dCgpXS5qb2luKCIgIik7CgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9IFsiSGVsbG8iLCBuYW1lLCAiISBIb3cgY2FuIEkgaGVscCB5b3UgdG9kYXk/Il0uam9pbigiICIpOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIG91dHB1dCA9IG5ldyBUZXh0T3V0cHV0Q2FsbGJhY2soVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLCBtZXNzYWdlKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChvdXRwdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"4f1273be-9c52-4879-bbe9-9a47068aeed9\",\"name\":\"Twilio IVR: Unverified Caller Message\",\"description\":\"Unverified caller message\",\"script\":\"LyogVHdpbGlvIElWUjogVW52ZXJpZmllZCBDYWxsZXIgTWVzc2FnZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogCiAqIERlcGVuZGluZyBvbiB0aGUgYW1vdW50IG9mIGRhdGEgY29sbGVjdGVkIHRocm91Z2ggY2FsbGJhY2tzIGFuZCBob3cgbWFueSBvZiB0aGUgY2FsbFBhcmFtcwogKiB5b3UgYWN0aXZhdGUgYmVsb3csIHlvdSB3aWxsIG5lZWQgdG8gY2hhbmdlIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiBmcm9tIEpXVCB0byBDVFMgb3IKICogTWVtb3J5LgogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9ICJUaGF0IGRvZXNuJ3QgbWF0Y2ggb3VyIHJlY29yZHMuIExldCB1cyB0cnkgdGhpcyBhbm90aGVyIHdheS4iOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIG91dHB1dCA9IG5ldyBUZXh0T3V0cHV0Q2FsbGJhY2soVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLCBtZXNzYWdlKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChvdXRwdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8e03eb43-ed5d-4c12-9e15-2051cc9be578\",\"name\":\"CopySAMLDataToObjectAttributes\",\"description\":\"Copy SAML Data To ObjectAttributes\",\"script\":\"LyogQ29weVNBTUxEYXRhVG9PYmplY3RBdHRyaWJ1dGVzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIENvcHkgU0FNTCBEYXRhIFRvIE9iamVjdEF0dHJpYnV0ZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CmlmIChzaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAJc2hhcmVkU3RhdGUucmVtb3ZlKCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICB9CiAgICB2YXIgdXNlck5hbWU9bnVsbCxnaXZlbk5hbWU9bnVsbCxzbj1udWxsLG1haWw9bnVsbCx0ZWxlcGhvbmVOdW1iZXI9bnVsbCxyb2xlcz1udWxsOwoKICAgIHRyeSB7IHVzZXJOYW1lPXNoYXJlZFN0YXRlLmdldCgidXNlckluZm8iKS5nZXQoInVzZXJOYW1lcyIpLmdldCgidWlkIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyBnaXZlbk5hbWU9c2hhcmVkU3RhdGUuZ2V0KCJ1c2VySW5mbyIpLmdldCgiYXR0cmlidXRlcyIpLmdldCgiZ2l2ZW5OYW1lIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyBzbj1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJzbiIpLmdldCgwKS50b1N0cmluZygpOyB9IGNhdGNoIChlKSB7fQogICAgdHJ5IHsgbWFpbD1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJtYWlsIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyB0ZWxlcGhvbmVOdW1iZXI9c2hhcmVkU3RhdGUuZ2V0KCJ1c2VySW5mbyIpLmdldCgiYXR0cmlidXRlcyIpLmdldCgidGVsZXBob25lTnVtYmVyIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICAvL3RyeSB7IHJvbGVzPXNoYXJlZFN0YXRlLmdldCgidXNlckluZm8iKS5nZXQoImF0dHJpYnV0ZXMiKS5nZXQoInJvbGVzIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyByb2xlcz1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJyb2xlcyIpLnRvQXJyYXkoKS5qb2luKCJ8Iik7IH0gY2F0Y2ggKGUpIHt9CgogICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgeyJ1c2VyTmFtZSI6dXNlck5hbWUsImdpdmVuTmFtZSI6Z2l2ZW5OYW1lLCJzbiI6c24sIm1haWwiOm1haWwsInRlbGVwaG9uZU51bWJlciI6dGVsZXBob25lTnVtYmVyLCJyb2xlcyI6cm9sZXN9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"58d29080-4563-480b-89bb-1e7719776a21\",\"name\":\"Google Profile Normalization\",\"description\":\"Normalizes raw profile data from Google\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImxvY2FsZSIsIHJhd1Byb2ZpbGUubG9jYWxlKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a2c639ac-7ccd-4906-bb31-f6e69632c93b\",\"name\":\"Hash State Variables\",\"description\":\"Hash State Variables\",\"script\":\"LyogSGFzaCBTdGF0ZSBWYXJpYWJsZXMKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBTZWUgY29weXJpZ2h0IG5vdGljZXMsIGNvbmRpdGlvbnMsIGFuZCBkaXNjbGFpbWVycyBhdCB0aGUgYm90dG9tIG9mIHRoaXMgc2NyaXB0LgogKiAKICogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJIYXNoIFN0YXRlIFZhcmlhYmxlczogc3RhcnQiKTsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgCiAgICAvKiBCZWdpbiBDb25maWd1cmF0aW9uICovCiAgCQogIAkvLyBoYXNoaW5nIGFsZ29yaXRobSAoTUQyLCBNRDUsIFNIQS0xLCBTSEEtMjI0LCBTSEEtMjU2LCBTSEEtMzg0LCBTSEEtNTEyLzIyNCwgU0hBLTUxMi8yNTYsIFNIQTMtMjI0LCBTSEEzLTI1NiwgU0hBMy0zODQsIFNIQTMtNTEyKQogIAl2YXIgYWxnb3JpdGhtID0gIlNIQS0yMjQiOwogIAogIAkvLyBzYWx0CiAgCXZhciBzYWx0ID0gInN1cGVyc2VjcmV0IjsKICAKICAJLy8gTGlzdCBvZiBhdHRyaWJ1dGVzIChJRE0gbmFtZXNwYWNlKSB5b3Ugd291bGQgbGlrZSB0byBoYXNoLgogIAl2YXIga2V5cyA9IFsKICAgICAgICAJInVzZXJOYW1lIiwKICAgICAgICAJInRlbGVwaG9uZU51bWJlciIKICAgICAgCV0KCiAgICAvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwogIAkKICAgIC8vIEhhc2ggdmFsdWVzIGluIHNoYXJlZCBzdGF0ZQogICAgdmFyIHZhbHVlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHZhbHVlcykgewogICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAJdmFyIHZhbHVlID0gdmFsdWVzLmdldChrZXkpOwogICAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJIYXNoIFN0YXRlIFZhcmlhYmxlczogaGFzaCAiK2tleSsiIGluIHNoYXJlZCBzdGF0ZSIpOwogICAgICAgICAgICAgIAkvL3ZhciBoYXNoID0gZ2VuZXJhdGVIYXNoQjY0KHZhbHVlLCBhbGdvcml0aG0pOwogICAgICAgICAgICAgIAl2YXIgaGFzaCA9IGdlbmVyYXRlU2FsdGVkSGFzaEI2NDIodmFsdWUsIGFsZ29yaXRobSwgc2FsdCk7CiAgICAgICAgICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoa2V5LCBoYXNoKTsKICAgICAgICAgICAgICAJLy8gQWxzbyBoYXNoIHVzZXJuYW1lIGlmIHVzZXJOYW1lIGlzIGluIGtleXMKICAgICAgICAgICAgICAJaWYgKGtleSA9PT0gInVzZXJOYW1lIiAmJiBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIikgJiYgdmFsdWUgPT09IHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKS50b1N0cmluZygpKSB7CiAgICAgICAgICAgICAgICAJbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBoYXNoIHVzZXJuYW1lIGluIHNoYXJlZCBzdGF0ZSIpOwogICAgICAgICAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ1c2VybmFtZSIsIGhhc2gpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0KICAJCiAgCS8vIEhhc2ggdmFsdWVzIGluIHRyYW5zaWVudCBzdGF0ZQogICAgdmFsdWVzID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAodmFsdWVzKSB7CiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIAl2YXIgdmFsdWUgPSB2YWx1ZXMuZ2V0KGtleSk7CiAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBoYXNoICIra2V5KyIgaW4gdHJhbnNpZW50IHN0YXRlIik7CiAgICAgICAgICAgICAgCS8vdmFyIGhhc2ggPSBnZW5lcmF0ZUhhc2hCNjQodmFsdWUsIGFsZ29yaXRobSk7CiAgICAgICAgICAgICAgCXZhciBoYXNoID0gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0Mih2YWx1ZSwgYWxnb3JpdGhtLCBzYWx0KTsKICAgICAgICAgICAgICAgIHNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZShrZXksIGhhc2gpOwogICAgICAgICAgICAgIAkvLyBBbHNvIGhhc2ggdXNlcm5hbWUgaWYgdXNlck5hbWUgaXMgaW4ga2V5cwogICAgICAgICAgICAgIAlpZiAoa2V5ID09PSAidXNlck5hbWUiICYmIHRyYW5zaWVudFN0YXRlLmdldCgidXNlcm5hbWUiKSAmJiB2YWx1ZSA9PT0gdHJhbnNpZW50U3RhdGUuZ2V0KCJ1c2VybmFtZSIpLnRvU3RyaW5nKCkpIHsKICAgICAgICAgICAgICAgIAlsb2dnZXIubWVzc2FnZSgiSGFzaCBTdGF0ZSBWYXJpYWJsZXM6IGhhc2ggdXNlcm5hbWUgaW4gdHJhbnNpZW50IHN0YXRlIik7CiAgICAgICAgICAgICAgICAgIAl0cmFuc2llbnRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgaGFzaCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBlbmQiKTsKCiAgICAvKgogICAgICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgIAl2YXIgb2JqZWN0ID0gewogICAgICAgICAgICAgIAluYW1lOiB2YWx1ZQogICAgICAgICAgICB9OwogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3QpOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICogU3RvcmUgYXR0cmlidXRlcyBpbiB0cmFuc2llbnQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgICAgICB2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0cmFuc2llbnRTdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgICAJdmFyIG9iamVjdCA9IHsKICAgICAgICAgICAgICAJbmFtZTogdmFsdWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJhbnNpZW50U3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0KTsKICAgICAgICB9CiAgICB9CiAgCQogICAgLyoKICAgICAqIEhhc2ggYSBzdHJpbmcgdXNpbmcgYW55IG9mIHRoZXNlIGFsZ29yaXRobXM6CiAgICAgKiAtIE1EMgogICAgICogLSBNRDUKICAgICAqIC0gU0hBLTEKICAgICAqIC0gU0hBLTIyNAogICAgICogLSBTSEEtMjU2CiAgICAgKiAtIFNIQS0zODQKICAgICAqIC0gU0hBLTUxMi8yMjQKICAgICAqIC0gU0hBLTUxMi8yNTYKICAgICAqIC0gU0hBMy0yMjQKICAgICAqIC0gU0hBMy0yNTYKICAgICAqIC0gU0hBMy0zODQKICAgICAqIC0gU0hBMy01MTIKICAgICAqLwogIAlmdW5jdGlvbiBnZW5lcmF0ZUhhc2hIZXgodmFsdWUsIGFsZykgewogICAgICAJdmFyIG1kID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKGFsZyk7CiAgICAgIAlyZXR1cm4gdG9IZXhTdHJpbmcobWQuZGlnZXN0KG5ldyBqYXZhLmxhbmcuU3RyaW5nKHZhbHVlKS5nZXRCeXRlcygpKSk7CiAgICB9CiAgCiAgCWZ1bmN0aW9uIGdlbmVyYXRlSGFzaEI2NCh2YWx1ZSwgYWxnKSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCXJldHVybiBvcmcuZm9yZ2Vyb2NrLnV0aWwuZW5jb2RlLkJhc2U2NC5lbmNvZGUobWQuZGlnZXN0KG5ldyBqYXZhLmxhbmcuU3RyaW5nKHZhbHVlKS5nZXRCeXRlcygpKSk7CiAgICB9CiAgCiAgICAvKgogICAgICogU2FsdCBhbmQgaGFzaCBhIHN0cmluZyB1c2luZyBhbnkgb2YgdGhlc2UgYWxnb3JpdGhtczoKICAgICAqIC0gTUQyCiAgICAgKiAtIE1ENQogICAgICogLSBTSEEtMQogICAgICogLSBTSEEtMjI0CiAgICAgKiAtIFNIQS0yNTYKICAgICAqIC0gU0hBLTM4NAogICAgICogLSBTSEEtNTEyLzIyNAogICAgICogLSBTSEEtNTEyLzI1NgogICAgICogLSBTSEEzLTIyNAogICAgICogLSBTSEEzLTI1NgogICAgICogLSBTSEEzLTM4NAogICAgICogLSBTSEEzLTUxMgogICAgICovCiAgCWZ1bmN0aW9uIGdlbmVyYXRlU2FsdGVkSGFzaEhleCh2YWx1ZSwgYWxnLCBzYWx0KSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCW1kLnVwZGF0ZShuZXcgamF2YS5sYW5nLlN0cmluZyhzYWx0KS5nZXRCeXRlcygpKTsKICAgICAgCXJldHVybiB0b0hleFN0cmluZyhtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAJZnVuY3Rpb24gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0KHZhbHVlLCBhbGcsIHNhbHQpIHsKICAgICAgCXZhciBtZCA9IGphdmEuc2VjdXJpdHkuTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZShhbGcpOwogICAgICAJbWQudXBkYXRlKG5ldyBqYXZhLmxhbmcuU3RyaW5nKHNhbHQpLmdldEJ5dGVzKCkpOwogICAgICAJcmV0dXJuIG9yZy5mb3JnZXJvY2sudXRpbC5lbmNvZGUuQmFzZTY0LmVuY29kZShtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAJZnVuY3Rpb24gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0Mih2YWx1ZSwgYWxnLCBzYWx0KSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCW1kLnVwZGF0ZShuZXcgamF2YS5sYW5nLlN0cmluZyhzYWx0KS5nZXRCeXRlcygpKTsKICAgICAgCXJldHVybiBvcmcuZm9yZ2Vyb2NrLnV0aWwuZW5jb2RlLkJhc2U2NC5lbmNvZGUoY29uY2F0Qnl0ZUFycmF5cyhtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpLG5ldyBqYXZhLmxhbmcuU3RyaW5nKHNhbHQpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAgIGZ1bmN0aW9uIHRvSGV4U3RyaW5nKGJ5dGVBcnJheSkgewogICAgICAgIHZhciBzID0gJyc7CiAgICAgICAgYnl0ZUFycmF5LmZvckVhY2goZnVuY3Rpb24oYnl0ZSkgewogICAgICAgICAgCXMgKz0gKCcwJyArIChieXRlICYgMHhGRikudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CiAgCiAgICBmdW5jdGlvbiBjb25jYXRCeXRlQXJyYXlzKGJ5dGVBcnJheTEsIGJ5dGVBcnJheTIpIHsKICAgICAgCXZhciBsZW5ndGggPSBieXRlQXJyYXkxLmxlbmd0aCArIGJ5dGVBcnJheTIubGVuZ3RoOwogICAgICAJdmFyIGJ5dGVzID0gW107CiAgICAgICAgYnl0ZUFycmF5MS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGUpIHsKICAgICAgICAgIAlieXRlcy5wdXNoKGJ5dGUpOwogICAgICAgIH0pOwogICAgICAgIGJ5dGVBcnJheTIuZm9yRWFjaChmdW5jdGlvbihieXRlKSB7CiAgICAgICAgICAJYnl0ZXMucHVzaChieXRlKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gYnl0ZXM7CiAgICB9Cn0oKSk7Ci8qCiAqIEJhc2U2NCBlbmNvZGUgLyBkZWNvZGUKICogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvLwogKiAKICogRXhhbXBsZToKICogQmFzZTY0LmVuY29kZSgnc29tZSBzdHJpbmcnKQogKiBCYXNlNjQuZGVjb2RlKCdzb21lIGVuY29kZWQgc3RyaW5nJykKICov\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a873fcd8-8f17-4675-9dd6-54ab1c11e2df\",\"name\":\"Record MFA\",\"description\":\"Record that MFA has been performed for this journey and no longer needs to be performed. This allows journeys and inner journeys to check that flag before performing MFA multiple times.\",\"script\":\"LyogTUZBIFN0YXR1cwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBSZWNvcmQgdGhhdCBNRkEgaGFzIGJlZW4gcGVyZm9ybWVkIGZvciB0aGlzIGpvdXJuZXkgYW5kIG5vIGxvbmdlciBuZWVkcyAKICogdG8gYmUgcGVyZm9ybWVkLiBUaGlzIGFsbG93cyBqb3VybmV5cyBhbmQgaW5uZXIgam91cm5leXMgdG8gY2hlY2sgdGhhdCAKICogZmxhZyBiZWZvcmUgcGVyZm9ybWluZyBNRkEgbXVsdGlwbGUgdGltZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnNoYXJlZFN0YXRlLnB1dCgibWZhUGVyZm9ybWVkIiwgInRydWUiKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8a1f6286-4cc2-4e4a-947b-c458de68e93e\",\"name\":\"Create Unique Username\",\"description\":\"Combine company and username.\",\"script\":\"LyogQ3JlYXRlIFVuaXF1ZSBVc2VybmFtZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDb21iaW5lIGNvbXBhbnkgYW5kIHVzZXJuYW1lLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBub2RlU3RhdGUuZ2V0KCJjb21wYW55IikuYXNTdHJpbmcoKSArICIuIiArIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiZnJVbmluZGV4ZWRTdHJpbmcxIikpOwoKICAgIC8qCiAgICAgKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUpIHsKICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoKICAgICAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICAgICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgICAgICAgaWYgKHN0b3JhZ2UucHV0KSB7CiAgICAgICAgICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgICAgIH0KICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"f8809ec4-e894-420d-a6e5-83295717d97d\",\"name\":\"Populate Company as Smokin\",\"description\":\"Places 'customer' in the 'entityType' attribute\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJ1c2VyTmFtZSIpCnZhciByZXN1bHQgPSAiU21va2luLUl0IjsKCmxvZ2dlci5lcnJvcigicmVzdWx0ID0gIiArIHJlc3VsdCk7CgovL29iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIsIHJlc3VsdCkKb2JqZWN0QXR0cmlidXRlcy5wdXQoImZySW5kZXhlZFN0cmluZzQiLHJlc3VsdCkKc2hhcmVkU3RhdGUucHV0KCJmckluZGV4ZWRTdHJpbmc0IixyZXN1bHQpCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3RBdHRyaWJ1dGVzKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"df10fa07-d2a2-4003-99f1-a1114f57b46a\",\"name\":\"Write HTML Meta Tags\",\"description\":\"Write HTML Meta Tags\",\"script\":\"LyogV3JpdGUgSFRNTCBNZXRhIFRhZ3MKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd3JpdGVzIG1ldGEgdGFncyB0byB0aGUgaGVhZGVyLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICkKCiAgZnVuY3Rpb24gY3JlYXRlU2NyaXB0KCkgewogICAgcmV0dXJuIFN0cmluZygiXG5cCiAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcblwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVxuXAogICAgKS5mb3JFYWNoKFxuXAogICAgICBmdW5jdGlvbiAoZSkge1xuXAogICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOyBcblwKICAgICAgICBtZXRhLm5hbWUgPSBcImF1dGhvclwiOyBcblwKICAgICAgICBtZXRhLmNvbnRlbnQgPSBcIkpvaG4gRG9lXCI7IFxuXAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobWV0YSk7IFxuXAogICAgICB9XG5cCiAgICApIik7CiAgfQoKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soY3JlYXRlU2NyaXB0KCkpCiAgICAgICkuYnVpbGQoKQogIH0gZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"10643e95-873a-4ec0-b713-a7f56760d179\",\"name\":\"FrodoTestScript4\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"aa2dabff-f5c4-4dc5-b4ac-5909e88a3a8f\",\"name\":\"Twilio IVR: Verify Known Caller\",\"description\":\"Verify known caller by first name\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IEtub3duIENhbGxlcgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IEtub3duIENhbGxlcjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gRm9yIElEIENsb3VkIHVzZSAiX2lkIiwgZm9yIGNsYXNzaWMgZGVwbG95bWVudHMgdXNlICJ1c2VybmFtZSIKdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKCi8vIFJldHJpZXZlIHRoZSBrbm93biBjYWxsZXIncyBmaXJzdCBuYW1lCnZhciBmaXJzdE5hbWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgImdpdmVuTmFtZSIpLml0ZXJhdG9yKCkubmV4dCgpLnJlcGxhY2VBbGwoIlteYS16QS1aIF0iLCAiIikudG9Mb3dlckNhc2UoKTsKCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIkkgc2VlIHdlIGhhdmUgYSBwcm9maWxlIGFzc29jaWF0ZWQgd2l0aCB5b3VyIHBob25lIG51bWJlciEiOwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiVG8gdmVyaWZ5IEkgaGF2ZSB0aGUgcmlnaHQgYWNjb3VudCwgcGxlYXNlIHNheSB5b3VyIGZpcnN0IG5hbWUuIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0SW5wdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJdmFyIGlucHV0ID0gbmV3IFRleHRJbnB1dENhbGxiYWNrKHByb21wdCk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0LCBpbnB1dCkuYnVpbGQoKTsKICAJfSAKICAJZWxzZSB7CiAgICAgIAl2YXIgYW5zd2VyID0gY2FsbGJhY2tzLmdldCgxKS5nZXRUZXh0KCkucmVwbGFjZUFsbCgiW15hLXpBLVogXSIsICIiKS50b0xvd2VyQ2FzZSgpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBWZXJpZnkgS25vd24gQ2FsbGVyOiBjYWxsYmFja3MgcmVjZWl2ZWQ6IGFuc3dlcj0iLmNvbmNhdChhbnN3ZXIpLmNvbmNhdCgiIFtmaXJzdE5hbWU9IikuY29uY2F0KGZpcnN0TmFtZSkuY29uY2F0KCJdIikpOwogICAgCWlmIChhbnN3ZXIgPT0gZmlyc3ROYW1lKSB7CiAgICAgIAkJb3V0Y29tZSA9ICJ0cnVlIjsKICAgIAl9CiAgICAgIAllbHNlIGlmIChhbnN3ZXIubGVuZ3RoID09IDApIHsKICAgICAgICAgIAlvdXRjb21lID0gIm5vIGlucHV0IjsKICAgICAgICB9CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFZlcmlmeSBLbm93biBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"6325cf19-a49b-471e-8d26-7e4df76df0e2\",\"name\":\"Okta Profile Normalization\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci53YXJuaW5nKCJPa3RhIHJhd1Byb2ZpbGU6ICIrcmF3UHJvZmlsZSkKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZS5kYXRhLnVybCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5wcmVmZXJyZWRfdXNlcm5hbWUpKSk=\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"23143919-6b78-40c3-b25e-beca19b229e0\",\"name\":\"GitHub Profile Normalization - imported (1)\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci53YXJuaW5nKCJHaXRIdWIgcmF3UHJvZmlsZTogIityYXdQcm9maWxlKQoKcmV0dXJuIGpzb24ob2JqZWN0KAogICAgICAgIGZpZWxkKCJpZCIsIHJhd1Byb2ZpbGUuaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIHJhd1Byb2ZpbGUuZmlyc3RfbmFtZSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmxhc3RfbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5waWN0dXJlLmRhdGEudXJsKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLmVtYWlsKSkp\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"cf3515f0-8278-4ee3-a530-1bad7424c416\",\"name\":\"Alpha OIDC Claims Script\",\"description\":\"Default alpha realm script for OIDC claims\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3814d347-a2f2-4be9-a810-ab41a1e374bd\",\"name\":\"Remove Button - imported (1)\",\"description\":\"Hide buttons on the journey page.\",\"script\":\"LyogUmVtb3ZlIEJ1dHRvbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBIaWRlIGJ1dHRvbnMgb24gdGhlIGpvdXJuZXkgcGFnZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2J1dHRvbicpKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnfSkiCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICB2YXIgbWVzc2FnZSA9ICIgIgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIG1lc3NhZ2UKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"703dab1a-1921-4981-98dd-b8e5349d8548\",\"name\":\"Device Id (Match) - Server Side\",\"description\":\"Default global script for server side Device Id (Match) Authentication Module\",\"script\":\"LyoKICogRE8gTk9UIEFMVEVSIE9SIFJFTU9WRSBDT1BZUklHSFQgTk9USUNFUyBPUiBUSElTIEhFQURFUi4KICoKICogQ29weXJpZ2h0IChjKSAyMDA5IFN1biBNaWNyb3N5c3RlbXMgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIHRlcm1zCiAqIG9mIHRoZSBDb21tb24gRGV2ZWxvcG1lbnQgYW5kIERpc3RyaWJ1dGlvbiBMaWNlbnNlCiAqICh0aGUgTGljZW5zZSkuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluCiAqIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICoKICogWW91IGNhbiBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqIGh0dHBzOi8vb3BlbnNzby5kZXYuamF2YS5uZXQvcHVibGljL0NEREx2MS4wLmh0bWwgb3IKICogb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQKICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nCiAqIHBlcm1pc3Npb24gYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBXaGVuIGRpc3RyaWJ1dGluZyBDb3ZlcmVkIENvZGUsIGluY2x1ZGUgdGhpcyBDRERMCiAqIEhlYWRlciBOb3RpY2UgaW4gZWFjaCBmaWxlIGFuZCBpbmNsdWRlIHRoZSBMaWNlbnNlIGZpbGUKICogYXQgb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQuCiAqIElmIGFwcGxpY2FibGUsIGFkZCB0aGUgZm9sbG93aW5nIGJlbG93IHRoZSBDRERMIEhlYWRlciwKICogd2l0aCB0aGUgZmllbGRzIGVuY2xvc2VkIGJ5IGJyYWNrZXRzIFtdIHJlcGxhY2VkIGJ5CiAqIHlvdXIgb3duIGlkZW50aWZ5aW5nIGluZm9ybWF0aW9uOgogKiAiUG9ydGlvbnMgQ29weXJpZ2h0ZWQgW3llYXJdIFtuYW1lIG9mIGNvcHlyaWdodCBvd25lcl0iCiAqCiAqLwovKgogKiBQb3J0aW9ucyBDb3B5cmlnaHRlZCAyMDEzIFN5bnRlZ3JpdHkuCiAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMtMjAxOCBGb3JnZVJvY2sgQVMuCiAqLwoKdmFyIFNjYWxhckNvbXBhcmF0b3IgPSB7fSwgU2NyZWVuQ29tcGFyYXRvciA9IHt9LCBNdWx0aVZhbHVlQ29tcGFyYXRvciA9IHt9LCBVc2VyQWdlbnRDb21wYXJhdG9yID0ge30sIEdlb2xvY2F0aW9uQ29tcGFyYXRvciA9IHt9OwoKdmFyIGNvbmZpZyA9IHsKICAgIHByb2ZpbGVFeHBpcmF0aW9uOiAzMCwgICAgICAgICAgICAgIC8vaW4gZGF5cwogICAgbWF4UHJvZmlsZXNBbGxvd2VkOiA1LAogICAgbWF4UGVuYWx0eVBvaW50czogMCwKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBzY3JlZW46IHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIGNvbXBhcmF0b3I6IFNjcmVlbkNvbXBhcmF0b3IsCiAgICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDUwCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHBsdWdpbnM6IHsKICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2luczogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogTXVsdGlWYWx1ZUNvbXBhcmF0b3IsCiAgICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4UGVyY2VudGFnZURpZmZlcmVuY2U6IDEwLAogICAgICAgICAgICAgICAgICAgIG1heERpZmZlcmVuY2VzOiA1LAogICAgICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDEwMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmb250czogewogICAgICAgICAgICBpbnN0YWxsZWRGb250czogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogTXVsdGlWYWx1ZUNvbXBhcmF0b3IsCiAgICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4UGVyY2VudGFnZURpZmZlcmVuY2U6IDEwLAogICAgICAgICAgICAgICAgICAgIG1heERpZmZlcmVuY2VzOiA1LAogICAgICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDEwMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0aW1lem9uZTogewogICAgICAgICAgICB0aW1lem9uZTogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogU2NhbGFyQ29tcGFyYXRvciwKICAgICAgICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgICAgICAgICBwZW5hbHR5UG9pbnRzOiAxMDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdXNlckFnZW50OiB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBjb21wYXJhdG9yOiBVc2VyQWdlbnRDb21wYXJhdG9yLAogICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICBpZ25vcmVWZXJzaW9uOiB0cnVlLAogICAgICAgICAgICAgICAgcGVuYWx0eVBvaW50czogMTAwCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGdlb2xvY2F0aW9uOiB7CiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgICAgY29tcGFyYXRvcjogR2VvbG9jYXRpb25Db21wYXJhdG9yLAogICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICBhbGxvd2VkUmFuZ2U6IDEwMCwJCQkvL2luIG1pbGVzCiAgICAgICAgICAgICAgICBwZW5hbHR5UG9pbnRzOiAxMDAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTsKCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLy8KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICBDb21wYXJhdG9yIGZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLwovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vCgp2YXIgYWxsLCBhbnksIGNhbGN1bGF0ZURpc3RhbmNlLCBjYWxjdWxhdGVJbnRlcnNlY3Rpb24sIGNhbGN1bGF0ZVBlcmNlbnRhZ2UsIG51bGxPclVuZGVmaW5lZCwgc3BsaXRBbmRUcmltLAogICAgdW5kZWZpbmVkTG9jYXRpb247CgovLyBDb21wYXJpc29uUmVzdWx0CgovKioKICogQ29uc3RydWN0cyBhbiBpbnN0YW5jZSBvZiBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gcGVuYWx0eSBwb2ludHMuCiAqCiAqIEBwYXJhbSBwZW5hbHR5UG9pbnRzIChOdW1iZXIpIFRoZSBwZW5hbHR5IHBvaW50cyBmb3IgdGhlIGNvbXBhcmlzb24gKGRlZmF1bHRzIHRvIDApLgogKiBAcGFyYW0gYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSAoYm9vbGVhbikgV2hldGhlciB0aGUgY3VycmVudCB2YWx1ZSBjb250YWlucyBtb3JlIGluZm9ybWF0aW9uCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGFuIHRoZSBzdG9yZWQgdmFsdWUgKGRlZmF1bHRzIHRvIGZhbHNlKS4KICovCmZ1bmN0aW9uIENvbXBhcmlzb25SZXN1bHQoKSB7CgogICAgdmFyIHBlbmFsdHlQb2ludHMgPSAwLAogICAgICAgIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPSBmYWxzZTsKCiAgICBpZiAoYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBwZW5hbHR5UG9pbnRzID0gYXJndW1lbnRzWzBdOwogICAgICAgIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPSBhcmd1bWVudHNbMV07CiAgICB9CgogICAgaWYgKGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkICYmIGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKHR5cGVvZihhcmd1bWVudHNbMF0pID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSA9IGFyZ3VtZW50c1swXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwZW5hbHR5UG9pbnRzID0gYXJndW1lbnRzWzBdOwogICAgICAgIH0KICAgIH0KCiAgICB0aGlzLnBlbmFsdHlQb2ludHMgPSBwZW5hbHR5UG9pbnRzOwogICAgdGhpcy5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZTsKCn0KCkNvbXBhcmlzb25SZXN1bHQuWkVST19QRU5BTFRZX1BPSU5UUyA9IG5ldyBDb21wYXJpc29uUmVzdWx0KDApOwoKLyoqCiAqIFN0YXRpYyBtZXRob2QgZm9yIGZ1bmN0aW9uYWwgcHJvZ3JhbW1pbmcuCiAqCiAqIEByZXR1cm4gYm9vbGVhbiB0cnVlIGlmIGNvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKCkuCiAqLwpDb21wYXJpc29uUmVzdWx0LmlzU3VjY2Vzc2Z1bCA9ICBmdW5jdGlvbihjb21wYXJpc29uUmVzdWx0KSB7CiAgICByZXR1cm4gY29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKTsKfTsKCgovKioKICogU3RhdGljIG1ldGhvZCBmb3IgZnVuY3Rpb25hbCBwcm9ncmFtbWluZy4KICoKICogQHJldHVybiBib29sZWFuIHRydWUgaWYgY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlLgogKi8KQ29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gIGZ1bmN0aW9uKGNvbXBhcmlzb25SZXN1bHQpIHsKICAgIHJldHVybiBjb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWU7Cn07CgovKioKICogQ29tcGFyaXNvbiBmdW5jdGlvbiB0aGF0IGNhbiBiZSBwcm92aWRlZCBhcyBhbiBhcmd1bWVudCB0byBhcnJheS5zb3J0CiAqLwpDb21wYXJpc29uUmVzdWx0LmNvbXBhcmUgPSBmdW5jdGlvbihmaXJzdCwgc2Vjb25kKSB7CiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGZpcnN0KSAmJiBudWxsT3JVbmRlZmluZWQoc2Vjb25kKSkgewogICAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmIChudWxsT3JVbmRlZmluZWQoZmlyc3QpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmIChudWxsT3JVbmRlZmluZWQoc2Vjb25kKSkgewogICAgICAgIHJldHVybiAxOwogICAgfSBlbHNlIHsKICAgICAgICBpZiAoZmlyc3QucGVuYWx0eVBvaW50cyAhPT0gc2Vjb25kLnBlbmFsdHlQb2ludHMpIHsKICAgICAgICAgICAgcmV0dXJuIGZpcnN0LnBlbmFsdHlQb2ludHMgLSBzZWNvbmQucGVuYWx0eVBvaW50czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gKGZpcnN0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPyAxIDogMCkgLSAoc2Vjb25kLmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPyAxIDogMCk7CiAgICAgICAgfQogICAgfQp9OwoKLyoqCiAqIEFtYWxnYW1hdGVzIHRoZSBnaXZlbiBDb21wYXJpc29uUmVzdWx0IGludG8gdGhpcyBDb21wYXJpc29uUmVzdWx0LgogKgogKiBAcGFyYW0gY29tcGFyaXNvblJlc3VsdCBUaGUgQ29tcGFyaXNvblJlc3VsdCB0byBpbmNsdWRlLgogKi8KQ29tcGFyaXNvblJlc3VsdC5wcm90b3R5cGUuYWRkQ29tcGFyaXNvblJlc3VsdCA9IGZ1bmN0aW9uKGNvbXBhcmlzb25SZXN1bHQpIHsKICAgIHRoaXMucGVuYWx0eVBvaW50cyArPSBjb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHM7CiAgICBpZiAoY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlKSB7CiAgICAgICAgdGhpcy5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlOwogICAgfQp9OwoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiBubyBwZW5hbHR5IHBvaW50cyBoYXZlIGJlZW4gYXNzaWduZWQgZm9yIHRoZSBjb21wYXJpc29uLgogKgogKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBpZiB0aGUgY29tcGFyaXNvbiB3YXMgc3VjY2Vzc2Z1bC4KICovCkNvbXBhcmlzb25SZXN1bHQucHJvdG90eXBlLmlzU3VjY2Vzc2Z1bCA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG51bGxPclVuZGVmaW5lZCh0aGlzLnBlbmFsdHlQb2ludHMpIHx8IHRoaXMucGVuYWx0eVBvaW50cyA9PT0gMDsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gc2ltcGxlIG9iamVjdHMgKFN0cmluZ3xOdW1iZXIpIGFuZCBpZiB0aGV5IGFyZSBlcXVhbCB0aGVuIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggemVybwogKiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZCwgb3RoZXJ3aXNlIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggdGhlIGdpdmVuIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZC4KICoKICogQHBhcmFtIGN1cnJlbnRWYWx1ZSAoU3RyaW5nfE51bWJlcikgVGhlIGN1cnJlbnQgdmFsdWUuCiAqIEBwYXJhbSBzdG9yZWRWYWx1ZSAoU3RyaW5nfE51bWJlcikgVGhlIHN0b3JlZCB2YWx1ZS4KICogQHBhcmFtIGNvbmZpZzogewogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KICogICAgICAgIH0KICogQHJldHVybiBDb21wYXJpc29uUmVzdWx0LgogKi8KU2NhbGFyQ29tcGFyYXRvci5jb21wYXJlID0gZnVuY3Rpb24gKGN1cnJlbnRWYWx1ZSwgc3RvcmVkVmFsdWUsIGNvbmZpZykgewogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlN0cmluZ0NvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU3RyaW5nQ29tcGFyYXRvci5jb21wYXJlOnN0b3JlZFZhbHVlOiAiICsgSlNPTi5zdHJpbmdpZnkoc3RvcmVkVmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU3RyaW5nQ29tcGFyYXRvci5jb21wYXJlOmNvbmZpZzogIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykpOwogICAgfQogICAgaWYgKGNvbmZpZy5wZW5hbHR5UG9pbnRzID09PSAwKSB7CiAgICAgICAgcmV0dXJuIENvbXBhcmlzb25SZXN1bHQuWkVST19QRU5BTFRZX1BPSU5UUzsKICAgIH0KCiAgICBpZiAoIW51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkpIHsKICAgICAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkgfHwgY3VycmVudFZhbHVlICE9PSBzdG9yZWRWYWx1ZSkgewogICAgICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQoY29uZmlnLnBlbmFsdHlQb2ludHMpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoIW51bGxPclVuZGVmaW5lZChjdXJyZW50VmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KHRydWUpOwogICAgfQoKICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7Cn07CgovKioKICogQ29tcGFyZXMgdHdvIHNjcmVlbnMgYW5kIGlmIHRoZXkgYXJlIGVxdWFsIHRoZW4gcmV0dXJucyBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB6ZXJvIHBlbmFsdHkgcG9pbnRzIGFzc2lnbmVkLAogKiBvdGhlcndpc2UgcmV0dXJucyBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHBlbmFsdHkgcG9pbnRzIGFzc2lnbmVkLgogKgogKiBAcGFyYW0gY3VycmVudFZhbHVlOiB7CiAqICAgICAgICAgICAgInNjcmVlbldpZHRoIjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiB3aWR0aC4KICogICAgICAgICAgICAic2NyZWVuSGVpZ2h0IjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiBoZWlnaHQuCiAqICAgICAgICAgICAgInNjcmVlbkNvbG91ckRlcHRoIjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiBjb2xvdXIgZGVwdGguCiAqICAgICAgICB9CiAqIEBwYXJhbSBzdG9yZWRWYWx1ZTogewogKiAgICAgICAgICAgICJzY3JlZW5XaWR0aCI6IChOdW1iZXIpIFRoZSBzdG9yZWQgY2xpZW50IHNjcmVlbiB3aWR0aC4KICogICAgICAgICAgICAic2NyZWVuSGVpZ2h0IjogKE51bWJlcikgVGhlIHN0b3JlZCBjbGllbnQgc2NyZWVuIGhlaWdodC4KICogICAgICAgICAgICAic2NyZWVuQ29sb3VyRGVwdGgiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGNsaWVudCBzY3JlZW4gY29sb3VyIGRlcHRoLgogKiAgICAgICAgfQogKiBAcGFyYW0gY29uZmlnOiB7CiAqICAgICAgICAgICAgInBlbmFsdHlQb2ludHMiOiAoTnVtYmVyKSBUaGUgbnVtYmVyIG9mIHBlbmFsdHkgcG9pbnRzLgogKiAgICAgICAgfQogKiBAcmV0dXJuIENvbXBhcmlzb25SZXN1bHQKICovClNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZSA9IGZ1bmN0aW9uIChjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBjb25maWcpIHsKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJTY3JlZW5Db21wYXJhdG9yLmNvbXBhcmU6Y3VycmVudFZhbHVlOiAiICsgSlNPTi5zdHJpbmdpZnkoY3VycmVudFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZTpzdG9yZWRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KHN0b3JlZFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZTpjb25maWc6ICIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpKTsKICAgIH0KCiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkpIHsKICAgICAgICBjdXJyZW50VmFsdWUgPSB7c2NyZWVuV2lkdGg6IG51bGwsIHNjcmVlbkhlaWdodDogbnVsbCwgc2NyZWVuQ29sb3VyRGVwdGg6IG51bGx9OwogICAgfQogICAgaWYgKG51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkpIHsKICAgICAgICBzdG9yZWRWYWx1ZSA9IHtzY3JlZW5XaWR0aDogbnVsbCwgc2NyZWVuSGVpZ2h0OiBudWxsLCBzY3JlZW5Db2xvdXJEZXB0aDogbnVsbH07CiAgICB9CgogICAgdmFyIGNvbXBhcmlzb25SZXN1bHRzID0gWwogICAgICAgIFNjYWxhckNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUuc2NyZWVuV2lkdGgsIHN0b3JlZFZhbHVlLnNjcmVlbldpZHRoLCBjb25maWcpLAogICAgICAgIFNjYWxhckNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUuc2NyZWVuSGVpZ2h0LCBzdG9yZWRWYWx1ZS5zY3JlZW5IZWlnaHQsIGNvbmZpZyksCiAgICAgICAgU2NhbGFyQ29tcGFyYXRvci5jb21wYXJlKGN1cnJlbnRWYWx1ZS5zY3JlZW5Db2xvdXJEZXB0aCwgc3RvcmVkVmFsdWUuc2NyZWVuQ29sb3VyRGVwdGgsIGNvbmZpZyldOwoKICAgIGlmIChhbGwoY29tcGFyaXNvblJlc3VsdHMsIENvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKSkgewogICAgICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdChhbnkoY29tcGFyaXNvblJlc3VsdHMsIENvbXBhcmlzb25SZXN1bHQuYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSkpOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQoY29uZmlnLnBlbmFsdHlQb2ludHMpOwogICAgfQp9OwoKLyoqCiAqIFNwbGl0cyBib3RoIHZhbHVlcyB1c2luZyBkZWxpbWl0ZXIsIHRyaW1zIGV2ZXJ5IHZhbHVlIGFuZCBjb21wYXJlcyBjb2xsZWN0aW9ucyBvZiB2YWx1ZXMuCiAqIFJldHVybnMgemVyby1yZXN1bHQgZm9yIHNhbWUgbXVsdGktdmFsdWUgYXR0cmlidXRlcy4KICoKICogSWYgY29sbGVjdGlvbnMgYXJlIG5vdCBzYW1lIGNoZWNrcyBpZiBudW1iZXIgb2YgZGlmZmVyZW5jZXMgaXMgbGVzcyBvciBlcXVhbCBtYXhEaWZmZXJlbmNlcyBvcgogKiBwZXJjZW50YWdlIG9mIGRpZmZlcmVuY2UgaXMgbGVzcyBvciBlcXVhbCBtYXhQZXJjZW50YWdlRGlmZmVyZW5jZS4KICoKICogSWYgeWVzIHRoZW4gcmV0dXJucyB6ZXJvLXJlc3VsdCB3aXRoIGFkZGl0aW9uYWwgaW5mbywgZWxzZSByZXR1cm5zIHBlbmFsdHlQb2ludHMtcmVzdWx0LgogKgogKiBAcGFyYW0gY3VycmVudFZhbHVlOiAoU3RyaW5nKSBUaGUgY3VycmVudCB2YWx1ZS4KICogQHBhcmFtIHN0b3JlZFZhbHVlOiAoU3RyaW5nKSBUaGUgc3RvcmVkIHZhbHVlLgogKiBAcGFyYW0gY29uZmlnOiB7CiAqICAgICAgICAgICAgIm1heFBlcmNlbnRhZ2VEaWZmZXJlbmNlIjogKE51bWJlcikgVGhlIG1heCBkaWZmZXJlbmNlIHBlcmNlbnRhZ2UgaW4gdGhlIHZhbHVlcywKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUgdGhlIHBlbmFsdHkgaXMgYXNzaWduZWQuCiAqICAgICAgICAgICAgIm1heERpZmZlcmVuY2VzIjogKE51bWJlcikgVGhlIG1heCBudW1iZXIgb2YgZGlmZmVyZW5jZXMgaW4gdGhlIHZhbHVlcywKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUgdGhlIHBlbmFsdHkgcG9pbnRzIGFyZSBhc3NpZ25lZC4KICogICAgICAgICAgICAicGVuYWx0eVBvaW50cyI6IChOdW1iZXIpIFRoZSBudW1iZXIgb2YgcGVuYWx0eSBwb2ludHMuCiAgKiAgICAgICAgfQogKiBAcmV0dXJuIENvbXBhcmlzb25SZXN1bHQKICovCk11bHRpVmFsdWVDb21wYXJhdG9yLmNvbXBhcmUgPSBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKSB7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiTXVsdGlWYWx1ZUNvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiTXVsdGlWYWx1ZUNvbXBhcmF0b3IuY29tcGFyZTpzdG9yZWRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KHN0b3JlZFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIk11bHRpVmFsdWVDb21wYXJhdG9yLmNvbXBhcmU6Y29uZmlnOiAiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7CiAgICB9CgogICAgdmFyIGRlbGltaXRlciA9ICI7IiwKICAgICAgICBjdXJyZW50VmFsdWVzID0gc3BsaXRBbmRUcmltKGN1cnJlbnRWYWx1ZSwgZGVsaW1pdGVyKSwKICAgICAgICBzdG9yZWRWYWx1ZXMgPSBzcGxpdEFuZFRyaW0oc3RvcmVkVmFsdWUsIGRlbGltaXRlciksCiAgICAgICAgbWF4TnVtYmVyT2ZFbGVtZW50cyA9IE1hdGgubWF4KGN1cnJlbnRWYWx1ZXMubGVuZ3RoLCBzdG9yZWRWYWx1ZXMubGVuZ3RoKSwKICAgICAgICBudW1iZXJPZlRoZVNhbWVFbGVtZW50cyA9IGNhbGN1bGF0ZUludGVyc2VjdGlvbihjdXJyZW50VmFsdWVzLCBzdG9yZWRWYWx1ZXMpLmxlbmd0aCwKICAgICAgICBudW1iZXJPZkRpZmZlcmVuY2VzID0gbWF4TnVtYmVyT2ZFbGVtZW50cyAtIG51bWJlck9mVGhlU2FtZUVsZW1lbnRzLAogICAgICAgIHBlcmNlbnRhZ2VPZkRpZmZlcmVuY2VzID0gY2FsY3VsYXRlUGVyY2VudGFnZShudW1iZXJPZkRpZmZlcmVuY2VzLCBtYXhOdW1iZXJPZkVsZW1lbnRzKTsKCiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKHN0b3JlZFZhbHVlKSAmJiAhbnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkpIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9CgogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UobnVtYmVyT2ZUaGVTYW1lRWxlbWVudHMgKyAiIG9mICIgKyBtYXhOdW1iZXJPZkVsZW1lbnRzICsgIiBhcmUgc2FtZSIpOwogICAgfQoKICAgIGlmIChtYXhOdW1iZXJPZkVsZW1lbnRzID09PSAwKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBubyBhdHRyaWJ1dGVzIGZvdW5kIGluIGJvdGggcHJvZmlsZXMiKTsKICAgICAgICByZXR1cm4gQ29tcGFyaXNvblJlc3VsdC5aRVJPX1BFTkFMVFlfUE9JTlRTOwogICAgfQoKICAgIGlmIChudW1iZXJPZlRoZVNhbWVFbGVtZW50cyA9PT0gbWF4TnVtYmVyT2ZFbGVtZW50cykgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJJZ25vcmVkIGJlY2F1c2UgYWxsIGF0dHJpYnV0ZXMgYXJlIHNhbWUiKTsKICAgICAgICByZXR1cm4gQ29tcGFyaXNvblJlc3VsdC5aRVJPX1BFTkFMVFlfUE9JTlRTOwogICAgfQoKICAgIGlmIChudW1iZXJPZkRpZmZlcmVuY2VzID4gY29uZmlnLm1heERpZmZlcmVuY2VzKSB7CiAgICAgICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJXb3VsZCBiZSBpZ25vcmVkIGlmIG5vdCBtb3JlIHRoYW4gIiArIGNvbmZpZy5tYXhEaWZmZXJlbmNlcyArICIgZGlmZmVyZW5jZXMiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KCiAgICBpZiAocGVyY2VudGFnZU9mRGlmZmVyZW5jZXMgPiBjb25maWcubWF4UGVyY2VudGFnZURpZmZlcmVuY2UpIHsKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UocGVyY2VudGFnZU9mRGlmZmVyZW5jZXMgKyAiIHBlcmNlbnRzIGFyZSBkaWZmZXJlbnQiKTsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIldvdWxkIGJlIGlnbm9yZWQgaWYgbm90IG1vcmUgdGhhbiAiICsgY29uZmlnLm1heFBlcmNlbnRhZ2VEaWZmZXJlbmNlICsgIiBwZXJjZW50Iik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdChjb25maWcucGVuYWx0eVBvaW50cyk7CiAgICB9CgogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBudW1iZXIgb2YgZGlmZmVyZW5jZXMoIiArIG51bWJlck9mRGlmZmVyZW5jZXMgKyAiKSBub3QgbW9yZSB0aGFuICIKICAgICAgICAgICAgKyBjb25maWcubWF4RGlmZmVyZW5jZXMpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKHBlcmNlbnRhZ2VPZkRpZmZlcmVuY2VzICsgIiBwZXJjZW50cyBhcmUgZGlmZmVyZW50Iik7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBub3QgbW9yZSB0aGFuICIgKyBjb25maWcubWF4UGVyY2VudGFnZURpZmZlcmVuY2UgKyAiIHBlcmNlbnQiKTsKICAgIH0KICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdCh0cnVlKTsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gVXNlciBBZ2VudCBTdHJpbmdzIGFuZCBpZiB0aGV5IGFyZSBlcXVhbCB0aGVuIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggemVybyBwZW5hbHR5CiAqIHBvaW50cyBhc3NpZ25lZCwgb3RoZXJ3aXNlIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggdGhlIGdpdmVuIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZC4KICoKICogQHBhcmFtIGN1cnJlbnRWYWx1ZSAoU3RyaW5nKSBUaGUgY3VycmVudCB2YWx1ZS4KICogQHBhcmFtIHN0b3JlZFZhbHVlIChTdHJpbmcpIFRoZSBzdG9yZWQgdmFsdWUuCiAqIEBwYXJhbSBjb25maWc6IHsKICogICAgICAgICAgICAiaWdub3JlVmVyc2lvbiI6IChib29sZWFuKSBJZiB0aGUgdmVyc2lvbiBudW1iZXJzIGluIHRoZSBVc2VyIEFnZW50IFN0cmluZ3Mgc2hvdWxkIGJlIGlnbm9yZQogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIHRoZSBjb21wYXJpc29uLgogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KICogICAgICAgIH0KICogQHJldHVybiBBIENvbXBhcmlzb25SZXN1bHQuCiAqLwpVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmUgPSBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKSB7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiVXNlckFnZW50Q29tcGFyYXRvci5jb21wYXJlOmN1cnJlbnRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmU6c3RvcmVkVmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShzdG9yZWRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmU6Y29uZmlnOiAiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7CiAgICB9CgogICAgaWYgKGNvbmZpZy5pZ25vcmVWZXJzaW9uKSB7CiAgICAgICAgLy8gcmVtb3ZlIHZlcnNpb24gbnVtYmVyCiAgICAgICAgY3VycmVudFZhbHVlID0gbnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkgPyBudWxsIDogY3VycmVudFZhbHVlLnJlcGxhY2UoL1tcZFwuXSsvZywgIiIpLnRyaW0oKTsKICAgICAgICBzdG9yZWRWYWx1ZSA9IG51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkgPyBudWxsIDogc3RvcmVkVmFsdWUucmVwbGFjZSgvW1xkXC5dKy9nLCAiIikudHJpbSgpOwogICAgfQoKICAgIHJldHVybiBTY2FsYXJDb21wYXJhdG9yLmNvbXBhcmUoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKTsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gbG9jYXRpb25zLCB0YWtpbmcgaW50byBhY2NvdW50IGEgZGVncmVlIG9mIGRpZmZlcmVuY2UuCiAqCiAqIEBwYXJhbSBjdXJyZW50VmFsdWU6IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgY3VycmVudCBsYXRpdHVkZS4KICogICAgICAgICAgICAibG9uZ2l0dWRlIjogKE51bWJlcikgVGhlIGN1cnJlbnQgbG9uZ2l0dWRlLgogKiAgICAgICAgfQogKiBAcGFyYW0gc3RvcmVkVmFsdWU6IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGxhdGl0dWRlLgogKiAgICAgICAgICAgICJsb25naXR1ZGUiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGxvbmdpdHVkZS4KICogICAgICAgIH0KICogQHBhcmFtIGNvbmZpZzogewogKiAgICAgICAgICAgICJhbGxvd2VkUmFuZ2UiOiAoTnVtYmVyKSBUaGUgbWF4IGRpZmZlcmVuY2UgYWxsb3dlZCBpbiB0aGUgdHdvIGxvY2F0aW9ucywgYmVmb3JlIHRoZSBwZW5hbHR5IGlzIGFzc2lnbmVkLgogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KKiAgICAgICAgIH0KICogQHJldHVybiBDb21wYXJpc29uUmVzdWx0CiAqLwpHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZSA9IGZ1bmN0aW9uIChjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBjb25maWcpIHsKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiR2VvbG9jYXRpb25Db21wYXJhdG9yLmNvbXBhcmU6c3RvcmVkVmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShzdG9yZWRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZTpjb25maWc6ICIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpKTsKICAgIH0KCiAgICAvLyBDaGVjayBmb3IgdW5kZWZpbmVkIHN0b3JlZCBvciBjdXJyZW50IGxvY2F0aW9ucwoKICAgIGlmICh1bmRlZmluZWRMb2NhdGlvbihjdXJyZW50VmFsdWUpICYmIHVuZGVmaW5lZExvY2F0aW9uKHN0b3JlZFZhbHVlKSkgewogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7CiAgICB9CiAgICBpZiAodW5kZWZpbmVkTG9jYXRpb24oY3VycmVudFZhbHVlKSAmJiAhdW5kZWZpbmVkTG9jYXRpb24oc3RvcmVkVmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KICAgIGlmICghdW5kZWZpbmVkTG9jYXRpb24oY3VycmVudFZhbHVlKSAmJiB1bmRlZmluZWRMb2NhdGlvbihzdG9yZWRWYWx1ZSkpIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9CgogICAgLy8gQm90aCBsb2NhdGlvbnMgZGVmaW5lZCwgdGhlcmVmb3JlIHBlcmZvcm0gY29tcGFyaXNvbgoKICAgIHZhciBkaXN0YW5jZSA9IGNhbGN1bGF0ZURpc3RhbmNlKGN1cnJlbnRWYWx1ZSwgc3RvcmVkVmFsdWUpOwoKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJEaXN0YW5jZSBiZXR3ZWVuICgiICsgY3VycmVudFZhbHVlLmxhdGl0dWRlICsgIiwiICsgY3VycmVudFZhbHVlLmxvbmdpdHVkZSArICIpIGFuZCAoIiArCiAgICAgICAgICAgIHN0b3JlZFZhbHVlLmxhdGl0dWRlICsgIiwiICsgc3RvcmVkVmFsdWUubG9uZ2l0dWRlICsgIikgaXMgIiArIGRpc3RhbmNlICsgIiBtaWxlcyIpOwogICAgfQoKICAgIGlmIChwYXJzZUZsb2F0KGRpc3RhbmNlLnRvUHJlY2lzaW9uKDUpKSA9PT0gMCkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJMb2NhdGlvbiBpcyB0aGUgc2FtZSIpOwogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7CiAgICB9CgogICAgaWYgKGRpc3RhbmNlIDw9IGNvbmZpZy5hbGxvd2VkUmFuZ2UpIHsKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlRvbGVyYXRlZCBiZWNhdXNlIGRpc3RhbmNlIG5vdCBtb3JlIHRoZW4gIiArIGNvbmZpZy5hbGxvd2VkUmFuZ2UpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9IGVsc2UgewogICAgICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgICAgICBsb2dnZXIubWVzc2FnZSgiV291bGQgYmUgaWdub3JlZCBpZiBkaXN0YW5jZSBub3QgbW9yZSB0aGVuICIgKyBjb25maWcuYWxsb3dlZFJhbmdlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KfTsKCgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vCi8vICAgICAgICAgICAgICAgICAgICBEZXZpY2UgUHJpbnQgTG9naWMgLSBETyBOT1QgTU9ESUZZICAgICAgICAgICAgICAgICAgICAgLy8KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vLwoKLy8gVXRpbGl0eSBmdW5jdGlvbnMKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgZXZhbHVhdGluZyBmdW5jdGlvbiBmIG9uIGVhY2ggZWxlbWVudCBvZiB0aGUgQXJyYXkgYSByZXR1cm5zIHRydWUuCiAqCiAqIEBwYXJhbSBhOiAoQXJyYXkpIFRoZSBhcnJheSBvZiBlbGVtZW50cyB0byBldmFsdWF0ZQogKiBAcGFyYW0gZjogKEZ1bmN0aW9uKSBBIHNpbmdsZSBhcmd1bWVudCBmdW5jdGlvbiBmb3IgbWFwcGluZyBlbGVtZW50cyBvZiB0aGUgYXJyYXkgdG8gYm9vbGVhbi4KICogQHJldHVybiBib29sZWFuLgogKi8KYWxsID0gZnVuY3Rpb24oYSwgZikgewogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChmKGFbaV0pID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHRydWU7Cn07CgovKioKICogUmV0dXJucyB0cnVlIGlmIGV2YWx1YXRpbmcgZnVuY3Rpb24gZiBvbiBhbnkgZWxlbWVudCBvZiB0aGUgQXJyYXkgYSByZXR1cm5zIHRydWUuCiAqCiAqIEBwYXJhbSBhOiAoQXJyYXkpIFRoZSBhcnJheSBvZiBlbGVtZW50cyB0byBldmFsdWF0ZQogKiBAcGFyYW0gZjogKEZ1bmN0aW9uKSBBIHNpbmdsZSBhcmd1bWVudCBmdW5jdGlvbiBmb3IgbWFwcGluZyBlbGVtZW50cyBvZiB0aGUgYXJyYXkgdG8gYm9vbGVhbi4KICogQHJldHVybiBib29sZWFuLgogKi8KYW55ID0gZnVuY3Rpb24oYSwgZikgewogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChmKGFbaV0pID09PSB0cnVlKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBmYWxzZTsKfTsKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIGxvY2F0aW9uIGlzIG51bGwgb3IgaGFzIHVuZGVmaW5lZCBsb25naXR1ZGUgb3IgbGF0aXR1ZGUgdmFsdWVzLgogKgogKiBAcGFyYW0gbG9jYXRpb246IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgbGF0aXR1ZGUuCiAqICAgICAgICAgICAgImxvbmdpdHVkZSI6IChOdW1iZXIpIFRoZSBsb25naXR1ZGUuCiAqICAgICAgICB9CiAqIEByZXR1cm4gYm9vbGVhbgogKi8KdW5kZWZpbmVkTG9jYXRpb24gPSBmdW5jdGlvbihsb2NhdGlvbikgewogICAgcmV0dXJuIG51bGxPclVuZGVmaW5lZChsb2NhdGlvbikgfHwgbnVsbE9yVW5kZWZpbmVkKGxvY2F0aW9uLmxhdGl0dWRlKSB8fCBudWxsT3JVbmRlZmluZWQobG9jYXRpb24ubG9uZ2l0dWRlKTsKfTsKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHZhbHVlIGlzIG51bGwgb3IgdW5kZWZpbmVkLgogKgogKiBAcGFyYW0gdmFsdWU6IGEgdmFsdWUgb2YgYW55IHR5cGUKICogQHJldHVybiBib29sZWFuCiAqLwpudWxsT3JVbmRlZmluZWQgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQ7Cn07CgovKioKICogQ2FsY3VsYXRlcyB0aGUgZGlzdGFuY2VzIGJldHdlZW4gdGhlIHR3byBsb2NhdGlvbnMuCiAqCiAqIEBwYXJhbSBmaXJzdDogewogKiAgICAgICAgICAgICJsYXRpdHVkZSI6IChOdW1iZXIpIFRoZSBmaXJzdCBsYXRpdHVkZS4KICogICAgICAgICAgICAibG9uZ2l0dWRlIjogKE51bWJlcikgVGhlIGZpcnN0IGxvbmdpdHVkZS4KICogICAgICAgIH0KICogQHBhcmFtIHNlY29uZDogewogKiAgICAgICAgICAgICJsYXRpdHVkZSI6IChOdW1iZXIpIFRoZSBzZWNvbmQgbGF0aXR1ZGUuCiAqICAgICAgICAgICAgImxvbmdpdHVkZSI6IChOdW1iZXIpIFRoZSBzZWNvbmQgbG9uZ2l0dWRlLgogKiAgICAgICAgfQogKiBAcmV0dXJuIE51bWJlciBUaGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgdHdvIGxvY2F0aW9ucy4KICovCmNhbGN1bGF0ZURpc3RhbmNlID0gZnVuY3Rpb24oZmlyc3QsIHNlY29uZCkgewogICAgdmFyIGZhY3RvciA9IChNYXRoLlBJIC8gMTgwKSwKICAgICAgICB0aGV0YSwKICAgICAgICBkaXN0OwogICAgZnVuY3Rpb24gZGVncmVlc1RvUmFkaWFucyhkZWdyZWVzKSB7CiAgICAgICAgcmV0dXJuIGRlZ3JlZXMgKiBmYWN0b3I7CiAgICB9CiAgICBmdW5jdGlvbiByYWRpYW5zVG9EZWdyZWVzKHJhZGlhbnMpIHsKICAgICAgICByZXR1cm4gcmFkaWFucyAvIGZhY3RvcjsKICAgIH0KICAgIHRoZXRhID0gZmlyc3QubG9uZ2l0dWRlIC0gc2Vjb25kLmxvbmdpdHVkZTsKICAgIGRpc3QgPSBNYXRoLnNpbihkZWdyZWVzVG9SYWRpYW5zKGZpcnN0LmxhdGl0dWRlKSkgKiBNYXRoLnNpbihkZWdyZWVzVG9SYWRpYW5zKHNlY29uZC5sYXRpdHVkZSkpCiAgICAgICAgKyBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKGZpcnN0LmxhdGl0dWRlKSkgKiBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKHNlY29uZC5sYXRpdHVkZSkpCiAgICAgICAgKiBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKHRoZXRhKSk7CiAgICBkaXN0ID0gTWF0aC5hY29zKGRpc3QpOwogICAgZGlzdCA9IHJhZGlhbnNUb0RlZ3JlZXMoZGlzdCk7CiAgICBkaXN0ID0gZGlzdCAqIDYwICogMS4xNTE1OwogICAgcmV0dXJuIGRpc3Q7Cn07CgovKioKICogQ29udmVydHMgYSBTdHJpbmcgaG9sZGluZyBhIGRlbGltaXRlZCBzZXF1ZW5jZSBvZiB2YWx1ZXMgaW50byBhbiBhcnJheS4KICoKICogQHBhcmFtIHRleHQgKFN0cmluZykgVGhlIFN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBhIGRlbGltaXRlZCBzZXF1ZW5jZSBvZiB2YWx1ZXMuCiAqIEBwYXJhbSBkZWxpbWl0ZXIgKFN0cmluZykgVGhlIGNoYXJhY3RlciBkZWxpbWl0aW5nIHZhbHVlcyB3aXRoaW4gdGhlIHRleHQgU3RyaW5nLgogKiBAcmV0dXJuIChBcnJheSkgVGhlIGNvbW1hIHNlcGFyYXRlZCB2YWx1ZXMuCiAqLwpzcGxpdEFuZFRyaW0gPSBmdW5jdGlvbih0ZXh0LCBkZWxpbWl0ZXIpIHsKCiAgICB2YXIgcmVzdWx0cyA9IFtdLAogICAgICAgIGksCiAgICAgICAgdmFsdWVzLAogICAgICAgIHZhbHVlOwogICAgaWYgKHRleHQgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgIH0KCiAgICB2YWx1ZXMgPSB0ZXh0LnNwbGl0KGRlbGltaXRlcik7CiAgICBmb3IgKGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV0udHJpbSgpOwogICAgICAgIGlmICh2YWx1ZSAhPT0gIiIpIHsKICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdHM7Cn07CgovKioKICogQ29udmVydHMgdmFsdWUgdG8gYSBwZXJjZW50YWdlIG9mIHJhbmdlLgogKgogKiBAcGFyYW0gdmFsdWUgKE51bWJlcikgVGhlIGFjdHVhbCBudW1iZXIgdG8gYmUgY29udmVydGVkIHRvIGEgcGVyY2VudGFnZS4KICogQHBhcmFtIHJhbmdlIChOdW1iZXIpIFRoZSB0b3RhbCBudW1iZXIgb2YgdmFsdWVzIChpLmUuIHJlcHJlc2VudHMgMTAwJSkuCiAqIEByZXR1cm4gKE51bWJlcikgVGhlIHBlcmNlbnRhZ2UuCiAqLwpjYWxjdWxhdGVQZXJjZW50YWdlID0gZnVuY3Rpb24odmFsdWUsIHJhbmdlKSB7CiAgICBpZiAocmFuZ2UgPT09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiBwYXJzZUZsb2F0KCh2YWx1ZSAvIHJhbmdlKS50b1ByZWNpc2lvbigyKSkgKiAxMDA7Cn07CgovKioKICogQ3JlYXRlcyBhIG5ldyBhcnJheSBjb250YWluaW5nIG9ubHkgdGhvc2UgZWxlbWVudHMgZm91bmQgaW4gYm90aCBhcnJheXMgcmVjZWl2ZWQgYXMgYXJndW1lbnRzLgogKgogKiBAcGFyYW0gZmlyc3QgKEFycmF5KSBUaGUgZmlyc3QgYXJyYXkuCiAqIEBwYXJhbSBzZWNvbmQgKEFycmF5KSBUaGUgc2Vjb25kIGFycmF5LgogKiBAcmV0dXJuIChBcnJheSkgVGhlIGVsZW1lbnRzIHRoYXQgZm91bmQgaW4gZmlyc3QgYW5kIHNlY29uZC4KICovCmNhbGN1bGF0ZUludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGZpcnN0LCBzZWNvbmQpIHsKICAgIHJldHVybiBmaXJzdC5maWx0ZXIoZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgIHJldHVybiBzZWNvbmQuaW5kZXhPZihlbGVtZW50KSAhPT0gLTE7CiAgICB9KTsKfTsKCmZ1bmN0aW9uIGdldFZhbHVlKG9iaiwgYXR0cmlidXRlUGF0aCkgewogICAgdmFyIHZhbHVlID0gb2JqLAogICAgICAgIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYXR0cmlidXRlUGF0aC5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICB2YWx1ZSA9IHZhbHVlW2F0dHJpYnV0ZVBhdGhbaV1dOwogICAgfQogICAgcmV0dXJuIHZhbHVlOwp9CgoKZnVuY3Rpb24gaXNMZWFmTm9kZShhdHRyaWJ1dGVDb25maWcpIHsKICAgIHJldHVybiBhdHRyaWJ1dGVDb25maWcuY29tcGFyYXRvciAhPT0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBnZXRBdHRyaWJ1dGVQYXRocyhhdHRyaWJ1dGVDb25maWcsIGF0dHJpYnV0ZVBhdGgpIHsKCiAgICB2YXIgYXR0cmlidXRlUGF0aHMgPSBbXSwKICAgICAgICBhdHRyaWJ1dGVOYW1lLAogICAgICAgIGF0dHJQYXRocywKICAgICAgICBhdHRyUGF0aCwKICAgICAgICBpOwoKICAgIGZvciAoYXR0cmlidXRlTmFtZSBpbiBhdHRyaWJ1dGVDb25maWcpIHsKICAgICAgICBpZiAoYXR0cmlidXRlQ29uZmlnLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKSB7CgogICAgICAgICAgICBpZiAoaXNMZWFmTm9kZShhdHRyaWJ1dGVDb25maWdbYXR0cmlidXRlTmFtZV0pKSB7CiAgICAgICAgICAgICAgICBhdHRyUGF0aCA9IGF0dHJpYnV0ZVBhdGguc2xpY2UoKTsKICAgICAgICAgICAgICAgIGF0dHJQYXRoLnB1c2goYXR0cmlidXRlTmFtZSk7CiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVQYXRocy5wdXNoKGF0dHJQYXRoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGF0dHJQYXRoID0gYXR0cmlidXRlUGF0aC5zbGljZSgpOwogICAgICAgICAgICAgICAgYXR0clBhdGgucHVzaChhdHRyaWJ1dGVOYW1lKTsKICAgICAgICAgICAgICAgIGF0dHJQYXRocyA9IGdldEF0dHJpYnV0ZVBhdGhzKGF0dHJpYnV0ZUNvbmZpZ1thdHRyaWJ1dGVOYW1lXSwgYXR0clBhdGgpOwogICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGF0dHJQYXRocy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVBhdGhzLnB1c2goYXR0clBhdGhzW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYXR0cmlidXRlUGF0aHM7Cn0KCmZ1bmN0aW9uIGdldERldmljZVByaW50QXR0cmlidXRlUGF0aHMoYXR0cmlidXRlQ29uZmlnKSB7CiAgICByZXR1cm4gZ2V0QXR0cmlidXRlUGF0aHMoYXR0cmlidXRlQ29uZmlnLCBbXSk7Cn0KCmZ1bmN0aW9uIGhhc1JlcXVpcmVkQXR0cmlidXRlcyhkZXZpY2VQcmludCwgYXR0cmlidXRlQ29uZmlnKSB7CgogICAgdmFyIGF0dHJpYnV0ZVBhdGhzID0gZ2V0RGV2aWNlUHJpbnRBdHRyaWJ1dGVQYXRocyhhdHRyaWJ1dGVDb25maWcpLAogICAgICAgIGksCiAgICAgICAgYXR0clZhbHVlLAogICAgICAgIGF0dHJDb25maWc7CgogICAgZm9yIChpID0gMDsgaSA8IGF0dHJpYnV0ZVBhdGhzLmxlbmd0aDsgaSsrKSB7CgogICAgICAgIGF0dHJWYWx1ZSA9IGdldFZhbHVlKGRldmljZVByaW50LCBhdHRyaWJ1dGVQYXRoc1tpXSk7CiAgICAgICAgYXR0ckNvbmZpZyA9IGdldFZhbHVlKGF0dHJpYnV0ZUNvbmZpZywgYXR0cmlidXRlUGF0aHNbaV0pOwoKICAgICAgICBpZiAoYXR0ckNvbmZpZy5yZXF1aXJlZCAmJiBhdHRyVmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBsb2dnZXIud2FybmluZygiRGV2aWNlIFByaW50IHByb2ZpbGUgbWlzc2luZyByZXF1aXJlZCBhdHRyaWJ1dGUsICIgKyBhdHRyaWJ1dGVQYXRoc1tpXSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgbG9nZ2VyLm1lc3NhZ2UoImRldmljZSBwcmludCBoYXMgcmVxdWlyZWQgYXR0cmlidXRlcyIpOwogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIGNvbXBhcmVEZXZpY2VQcmludFByb2ZpbGVzKGF0dHJpYnV0ZUNvbmZpZywgZGV2aWNlUHJpbnQsIGRldmljZVByaW50UHJvZmlsZXMsIG1heFBlbmFsdHlQb2ludHMpIHsKCiAgICB2YXIgYXR0cmlidXRlUGF0aHMgPSBnZXREZXZpY2VQcmludEF0dHJpYnV0ZVBhdGhzKGF0dHJpYnV0ZUNvbmZpZyksCiAgICAgICAgZGFvID0gc2hhcmVkU3RhdGUuZ2V0KCdfRGV2aWNlSWREYW8nKSwKICAgICAgICByZXN1bHRzLAogICAgICAgIGosCiAgICAgICAgYWdncmVnYXRlZENvbXBhcmlzb25SZXN1bHQsCiAgICAgICAgaSwKICAgICAgICBjdXJyZW50VmFsdWUsCiAgICAgICAgc3RvcmVkVmFsdWUsCiAgICAgICAgYXR0ckNvbmZpZywKICAgICAgICBjb21wYXJpc29uUmVzdWx0LAogICAgICAgIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdCwKICAgICAgICBzZWxlY3RlZFByb2ZpbGUsCiAgICAgICAgY3VyRGV2aWNlUHJpbnRQcm9maWxlLAogICAgICAgIHZhbHM7CgogICAgcmVzdWx0cyA9IFtdOwogICAgZm9yIChqID0gMDsgaiA8IGRldmljZVByaW50UHJvZmlsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjdXJEZXZpY2VQcmludFByb2ZpbGUgPSBKU09OLnBhcnNlKG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuanNvbihkZXZpY2VQcmludFByb2ZpbGVzW2pdKSk7CiAgICAgICAgYWdncmVnYXRlZENvbXBhcmlzb25SZXN1bHQgPSBuZXcgQ29tcGFyaXNvblJlc3VsdCgpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdHRyaWJ1dGVQYXRocy5sZW5ndGg7IGkrKykgewoKICAgICAgICAgICAgY3VycmVudFZhbHVlID0gZ2V0VmFsdWUoZGV2aWNlUHJpbnQsIGF0dHJpYnV0ZVBhdGhzW2ldKTsKICAgICAgICAgICAgc3RvcmVkVmFsdWUgPSBnZXRWYWx1ZShjdXJEZXZpY2VQcmludFByb2ZpbGUuZGV2aWNlUHJpbnQsIGF0dHJpYnV0ZVBhdGhzW2ldKTsKICAgICAgICAgICAgYXR0ckNvbmZpZyA9IGdldFZhbHVlKGF0dHJpYnV0ZUNvbmZpZywgYXR0cmlidXRlUGF0aHNbaV0pOwoKICAgICAgICAgICAgaWYgKHN0b3JlZFZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBjb21wYXJpc29uUmVzdWx0ID0gbmV3IENvbXBhcmlzb25SZXN1bHQoYXR0ckNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbXBhcmlzb25SZXN1bHQgPSBhdHRyQ29uZmlnLmNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBhdHRyQ29uZmlnLmFyZ3MpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJDb21wYXJpbmcgYXR0cmlidXRlIHBhdGg6ICIgKyBhdHRyaWJ1dGVQYXRoc1tpXQogICAgICAgICAgICAgICAgICAgICsgIiwgQ29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IiArIGNvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKCkgKyAiLCBwZW5hbHR5UG9pbnRzPSIKICAgICAgICAgICAgICAgICAgICArIGNvbXBhcmlzb25SZXN1bHQucGVuYWx0eVBvaW50cyArICIsIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWU9IgogICAgICAgICAgICAgICAgICAgICsgY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5hZGRDb21wYXJpc29uUmVzdWx0KGNvbXBhcmlzb25SZXN1bHQpOwogICAgICAgIH0KICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkFnZ3JlZ2F0ZWQgY29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IgogICAgICAgICAgICAgICAgKyBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKSArICIsIHBlbmFsdHlQb2ludHM9IgogICAgICAgICAgICAgICAgKyBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5wZW5hbHR5UG9pbnRzICsgIiwgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZT0iCiAgICAgICAgICAgICAgICArIGFnZ3JlZ2F0ZWRDb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0cy5wdXNoKHsKICAgICAgICAgICAga2V5OiBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdCwKICAgICAgICAgICAgdmFsdWU6IGRldmljZVByaW50UHJvZmlsZXNbal0KICAgICAgICB9KTsKICAgIH0KCiAgICBpZiAocmVzdWx0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXN1bHRzLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LmNvbXBhcmUoYS5rZXksIGIua2V5KTsKICAgIH0pOwogICAgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0ID0gcmVzdWx0c1swXS5rZXk7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU2VsZWN0ZWQgY29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IiArIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKQogICAgICAgICAgICArICIsIHBlbmFsdHlQb2ludHM9IiArIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdC5wZW5hbHR5UG9pbnRzICsgIiwgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZT0iCiAgICAgICAgICAgICsgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUpOwogICAgfQoKICAgIHNlbGVjdGVkUHJvZmlsZSA9IG51bGw7CiAgICBpZiAoc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHMgPD0gbWF4UGVuYWx0eVBvaW50cykgewogICAgICAgIHNlbGVjdGVkUHJvZmlsZSA9IHJlc3VsdHNbMF0udmFsdWU7CiAgICAgICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJTZWxlY3RlZCBwcm9maWxlOiAiICsgc2VsZWN0ZWRQcm9maWxlICsKICAgICAgICAgICAgICAgICIgd2l0aCAiICsgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHMgKyAiIHBlbmFsdHkgcG9pbnRzIik7CiAgICAgICAgfQogICAgfQoKICAgIGlmIChzZWxlY3RlZFByb2ZpbGUgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyogdXBkYXRlIHByb2ZpbGUgKi8KICAgIHNlbGVjdGVkUHJvZmlsZS5wdXQoInNlbGVjdGlvbkNvdW50ZXIiLAogICAgICAgIGphdmEubGFuZy5JbnRlZ2VyLnZhbHVlT2YocGFyc2VJbnQoc2VsZWN0ZWRQcm9maWxlLmdldCgic2VsZWN0aW9uQ291bnRlciIpLCAxMCkgKyAxKSk7CiAgICBzZWxlY3RlZFByb2ZpbGUucHV0KCJsYXN0U2VsZWN0ZWREYXRlIiwgamF2YS5sYW5nLkxvbmcudmFsdWVPZihuZXcgRGF0ZSgpLmdldFRpbWUoKSkpOwogICAgc2VsZWN0ZWRQcm9maWxlLnB1dCgiZGV2aWNlUHJpbnQiLCBkZXZpY2VQcmludCk7CgogICAgdmFscyA9IFtdOwogICAgZm9yIChpID0gMDsgaSA8IGRldmljZVByaW50UHJvZmlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YWxzLnB1c2gob3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uKGRldmljZVByaW50UHJvZmlsZXNbaV0pKTsKICAgIH0KCiAgICBkYW8uc2F2ZURldmljZVByb2ZpbGVzKHVzZXJuYW1lLCByZWFsbSwgdmFscyk7CgogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIG1hdGNoRGV2aWNlUHJpbnQoKSB7CgogICAgaWYgKCF1c2VybmFtZSkgewogICAgICAgIGxvZ2dlci5lcnJvcigiVXNlcm5hbWUgbm90IHNldC4gQ2Fubm90IGNvbXBhcmUgdXNlcidzIGRldmljZSBwcmludCBwcm9maWxlcy4iKTsKICAgICAgICBhdXRoU3RhdGUgPSBGQUlMRUQ7CiAgICB9IGVsc2UgewoKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoImNsaWVudCBkZXZpY2VQcmludDogIiArIGNsaWVudFNjcmlwdE91dHB1dERhdGEpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGdldFByb2ZpbGVzID0gZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzRXhwaXJlZFByb2ZpbGUoZGV2aWNlUHJpbnRQcm9maWxlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cGlyYXRpb25EYXRlID0gbmV3IERhdGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFNlbGVjdGVkRGF0ZTsKICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uRGF0ZS5zZXREYXRlKGV4cGlyYXRpb25EYXRlLmdldERhdGUoKSAtIGNvbmZpZy5wcm9maWxlRXhwaXJhdGlvbik7CgogICAgICAgICAgICAgICAgICAgIGxhc3RTZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkZXZpY2VQcmludFByb2ZpbGUubGFzdFNlbGVjdGVkRGF0ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXN0U2VsZWN0ZWREYXRlIDwgZXhwaXJhdGlvbkRhdGU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Tm90RXhwaXJlZFByb2ZpbGVzKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAgICBkYW8gPSBzaGFyZWRTdGF0ZS5nZXQoJ19EZXZpY2VJZERhbycpLAogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGVzLAogICAgICAgICAgICAgICAgICAgICAgICBpdGVyOwoKICAgICAgICAgICAgICAgICAgICBwcm9maWxlcyA9IGRhby5nZXREZXZpY2VQcm9maWxlcyh1c2VybmFtZSwgcmVhbG0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlciA9IHByb2ZpbGVzLml0ZXJhdG9yKCk7CgogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUgPSBpdGVyLm5leHQoKS5nZXRPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNFeHBpcmVkUHJvZmlsZShwcm9maWxlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwcm9maWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoInN0b3JlZCBub24tZXhwaXJlZCBwcm9maWxlczogIiArIHJlc3VsdHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Tm90RXhwaXJlZFByb2ZpbGVzKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRldmljZVByaW50ID0gSlNPTi5wYXJzZShjbGllbnRTY3JpcHRPdXRwdXREYXRhKSwKICAgICAgICAgICAgZGV2aWNlUHJpbnRQcm9maWxlcyA9IGdldFByb2ZpbGVzKCk7CgogICAgICAgIGlmICghaGFzUmVxdWlyZWRBdHRyaWJ1dGVzKGRldmljZVByaW50LCBjb25maWcuYXR0cmlidXRlcykpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoImRldmljZVByaW50Lmhhc1JlcXVpcmVkQXR0cmlidXRlczogZmFsc2UiKTsKICAgICAgICAgICAgLy8gV2lsbCBmYWlsIHRoaXMgbW9kdWxlIGJ1dCBmYWxsLXRocm91Z2ggdG8gbmV4dCBtb2R1bGUuIFdoaWNoIHNob3VsZCBiZSBPVFAuCiAgICAgICAgICAgIGF1dGhTdGF0ZSA9IEZBSUxFRDsKICAgICAgICB9IGVsc2UgaWYgKGNvbXBhcmVEZXZpY2VQcmludFByb2ZpbGVzKGNvbmZpZy5hdHRyaWJ1dGVzLCBkZXZpY2VQcmludCwgZGV2aWNlUHJpbnRQcm9maWxlcywgY29uZmlnLm1heFBlbmFsdHlQb2ludHMpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJkZXZpY2VQcmludC5oYXNWYWxpZFByb2ZpbGU6IHRydWUiKTsKICAgICAgICAgICAgYXV0aFN0YXRlID0gU1VDQ0VTUzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2dnZXIubWVzc2FnZSgiZGV2aWNlUHJpbnQuaGFzVmFsaWRQcm9maWxlOiBmYWxzZSIpOwogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoJ2RldmljZVByaW50UHJvZmlsZScsIEpTT04uc3RyaW5naWZ5KGRldmljZVByaW50KSk7CiAgICAgICAgICAgIC8vIFdpbGwgZmFpbCB0aGlzIG1vZHVsZSBidXQgZmFsbC10aHJvdWdoIHRvIG5leHQgbW9kdWxlLiBXaGljaCBzaG91bGQgYmUgT1RQLgogICAgICAgICAgICBhdXRoU3RhdGUgPSBGQUlMRUQ7CiAgICAgICAgfQogICAgfQp9CgptYXRjaERldmljZVByaW50KCk7\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_SERVER_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"452d73ee-c6f3-4f4e-9dae-e75bb3886cbd\",\"name\":\"Copy to transientState\",\"description\":\"Copy sharedState to transientState\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkKfQppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKQp9CmlmIChzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoIl9pZCIsIHNoYXJlZFN0YXRlLmdldCgiX2lkIikpCn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"58c824ae-84ed-4724-82cd-db128fc3f6c\",\"name\":\"Normalized Profile to Managed User\",\"description\":\"Converts a normalized social profile into a managed user\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgbWFuYWdlZFVzZXIgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlck5hbWUiLCBub3JtYWxpemVkUHJvZmlsZS51c2VybmFtZSkpKQoKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQoKLy8gaWYgdGhlIGdpdmVuTmFtZSBhbmQgZmFtaWx5TmFtZSBpcyBudWxsIG9yIGVtcHR5Ci8vIHRoZW4gYWRkIGEgYm9vbGVhbiBmbGFnIHRvIHRoZSBzaGFyZWQgc3RhdGUgdG8gaW5kaWNhdGUgbmFtZXMgYXJlIG5vdCBwcmVzZW50Ci8vIHRoaXMgY291bGQgYmUgdXNlZCBlbHNld2hlcmUKLy8gZm9yIGVnLiB0aGlzIGNvdWxkIGJlIHVzZWQgaW4gYSBzY3JpcHRlZCBkZWNpc2lvbiBub2RlIHRvIGJ5LXBhc3MgcGF0Y2hpbmcKLy8gdGhlIHVzZXIgb2JqZWN0IHdpdGggYmxhbmsgdmFsdWVzIHdoZW4gZ2l2ZW5OYW1lICBhbmQgZmFtaWx5TmFtZSBpcyBub3QgcHJlc2VudApib29sZWFuIG5vR2l2ZW5OYW1lID0gbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmFzU3RyaW5nKCk/LnRyaW0oKSkKYm9vbGVhbiBub0ZhbWlseU5hbWUgPSBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZS5hc1N0cmluZygpPy50cmltKCkpCnNoYXJlZFN0YXRlLnB1dCgibmFtZUVtcHR5T3JOdWxsIiwgbm9HaXZlbk5hbWUgJiYgbm9GYW1pbHlOYW1lKQoKcmV0dXJuIG1hbmFnZWRVc2VyCg==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"238bd3c1-6396-470b-8411-b175a292dfeb\",\"name\":\"Populate Customer as Type\",\"description\":\"Places 'customer' in the 'entityType' attribute\",\"script\":\"bG9nZ2VyLmVycm9yKCdQb3BUeXBlQXNDdXN0b21lcjogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJ1c2VyTmFtZSIpOwp2YXIgaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIl9pZCIpOwpsb2dnZXIuZXJyb3IoJ1VzZXJOYW1lJyArIHVzZXJuYW1lICsgJyBfaWQ6ICcgKyBpZCk7CnZhciBteVR5cGUgPSAiY3VzdG9tZXIiOwoKc2V0T2JqZWN0QXR0cmlidXRlKCJkZXNjcmlwdGlvbiIsIG15VHlwZSk7CnNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIseyJ1c2VyTmFtZSI6dXNlcm5hbWUsImRlc2NyaXB0aW9uIjpteVR5cGV9KTsKbG9nZ2VyLmVycm9yKCdNeSBUeXBlID0gJyArIG15VHlwZSk7CgpmdW5jdGlvbiBzZXRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgICB9Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"36185679-b74f-479c-b1aa-6f6e852cca11\",\"name\":\"Suspend Authentication\",\"description\":\"Suspend authentication\",\"script\":\"LyogU3VzcGVuZCBBdXRoZW50aWNhdGlvbgogKiAKICogU3VzcGVuZCBBdXRoZW50aWNhdGlvbi4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKCiAgICB2YXIgYW5jaG9yID0gImFuY2hvci0iLmNvbmNhdChnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4JykpOwogICAgdmFyIGhhbGlnbiA9ICJsZWZ0IjsKICAgIHZhciBtZXNzYWdlID0gIjxoND5DdXJyZW50IFN0YXRlIFZhbHVlczwvaDQ+Ii5jb25jYXQoCiAgICAgICAgIjxwPjxiPlNoYXJlZCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5UcmFuc2llbnQgU3RhdGU8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHRyYW5zaWVudFN0YXRlLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpLmNvbmNhdCgKICAgICAgICAiPHA+PGI+UmVxdWVzdCBIZWFkZXJzPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICByZXF1ZXN0SGVhZGVycy50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKQogICAgdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICAgICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgICAgICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICAgICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgICAgICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuY2xhc3NOYW1lID0gXCJcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLnN0eWxlID0gXCJ0ZXh0LWFsaWduOiBsZWZ0OyBpbmxpbmUtc2l6ZTogNDMwcHg7IG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7XCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICAgICAiICB9XG4iKS5jb25jYXQoCiAgICAgICJ9KSIpCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgICAgICkuYnVpbGQoKQogICAgfQogICAgZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgIC8qCiAgICAgICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAgICAgKiAKICAgICAgKiBFeGFtcGxlOgogICAgICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICAgICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAgICAgKi8KICAgIGZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICAgIHZhciB2ID0gcjsKICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgICAgIH0pOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7b88752e-5529-459c-a970-1fb78ff0d87f\",\"name\":\"Set Email Verified\",\"description\":\"Set eMail attribute to Verified\",\"script\":\"LyoKICogVXBkYXRlIHRoZSBlbWFpbCB2ZXJpZmllZCBhdHRyaWJ1dGUgZnJVbmluZGV4ZWRTdHJpbmc1CiAqLwoKbG9nZ2VyLmVycm9yKCdTZXQgRW1haWwgVmVyaWZpZWQ6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgidXNlck5hbWUiKTsKLy92YXIgaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIl9pZCIpOwpsb2dnZXIuZXJyb3IoJ1NldCBFbWFpbCBWZXJpZmllZDogdXNlck5hbWUgJyArIHVzZXJuYW1lKTsKCgoKc2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiLCAidmVyaWZpZWQiKTsKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIix7InVzZXJOYW1lIjp1c2VybmFtZSwiZnJVbmluZGV4ZWRTdHJpbmc1IjoidmVyaWZpZWQifSk7CgpmdW5jdGlvbiBzZXRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgICB9Cn0Kb3V0Y29tZSA9ICJ0cnVlIjsKbG9nZ2VyLmVycm9yKCdTZXQgRW1haWwgVmVyaWZpZWQ6IEVORCcp\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"23e88721-ea4a-4da2-bfba-33d82fd0317d\",\"name\":\"Inspect Username\",\"description\":\"Reads the shared state \\\"_id\\\" attribute. Fetches the userName (uid0 object from the users. Saves the userName to shared state. (in both userName and username). Then returns outcome if the username starts with \\\"anon-\\\" outcome = anonymous. Otherwise outcome = known.\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKCnZhciB0aGVfaWQgPSAgc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKTsKCnZhciB1c2VyTmFtZSA9IHNpbmdsZVZhbHVlKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodGhlX2lkLCAidWlkIikpOwoKCgpzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgdXNlck5hbWUpOwpzaGFyZWRTdGF0ZS5wdXQoInVzZXJOYW1lIiwgdXNlck5hbWUpOwoKCi8vdXNlck5hbWUubGFzdEluZGV4T2YoImFub24tIiwwKSBjaGVja3MgaWYgdXNlcm5hbWUgc3RhcnRzIHdpdGggYW5vbi0uICAKLy9IYXZpbmcgaXNzdWVzIHNwZWNpZmljYWxseSB3aXRoICJzdGFydHNXaXRoIiBmdW5jdGlvbgppZih1c2VyTmFtZS5sYXN0SW5kZXhPZigiYW5vbi0iLDApPT09MCkKICAgewogICAgIG91dGNvbWUgPSAiYW5vbnltb3VzIjsKICAgICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJUeXBlIiwgImFub255bW91cyIpOwogICB9CmVsc2UKICAgewogICBvdXRjb21lID0gImtub3duIjsKICAgICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJUeXBlIiwgImtub3duIik7CiAgIH0KCgoKZnVuY3Rpb24gc2luZ2xlVmFsdWUoeCkKewoJaWYoeC5zaXplKCk+MCkKICAgIHsKICAgIAlyZXR1cm4geC5pdGVyYXRvcigpLm5leHQoKTsKICAgIH0KICAgIAogIHJldHVybiAiIjsKICAKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e3f46912-22de-40ac-a3c7-7c3ce9142643\",\"name\":\"AT_MFAMethod_sms\",\"description\":\"This script puts 'sms' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3NtczogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKQpsb2dnZXIuZXJyb3IoJ0FUX01GQU1ldGhvZF9zbXM6IF9pZCAnICsgdXNlcm5hbWUpOwp2YXIgYXR0cmlidXRlID0gImZyLWF0dHItc3RyMiIKCmlkUmVwb3NpdG9yeS5zZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSwgWyJzbXMiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfc21zOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a064f7b7-29c5-480b-ac09-d3d122829278\",\"name\":\"Sanitize objectAttributes\",\"description\":\"Sanitize objectAttributes\",\"script\":\"LyoKewogICAgInVzZXJOYW1lIjogInNob2xtZXMiLAogICAgImdpdmVuTmFtZSI6ICJTaGVybG9jayIsCiAgICAic24iOiAiSG9sbWVzIiwKICAgICJtYWlsIjogImluZm85MThAMDYxNTJhbGVydHMuc2VjdXJpdHkub3JnIiwKICAgICJ0ZWxlcGhvbmVOdW1iZXIiOiAsCiAgICAicG9zdGFsQWRkcmVzcyI6ICIyMjFCIEJha2VyIFN0cmVldCIsCiAgICAiY2l0eSI6ICJMb25kb24iLAogICAgInN0YXRlUHJvdmluY2UiOiAsCiAgICAicG9zdGFsQ29kZSI6ICJOVzEiLAogICAgImNvdW50cnkiOiAiVW5pdGVkIFN0YXRlcyIsCiAgICAicHJlZmVyZW5jZXMiOiB7CiAgICAgICAgIm1hcmtldGluZyI6IGZhbHNlLAogICAgICAgICJ1cGRhdGVzIjogdHJ1ZQogICAgfQp9CiovCmxvZ2dlci5lcnJvcigiU2FuaXRpemUgb2JqZWN0QXR0cmlidXRlczogc3RhcnQiKTsKb3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CmlmIChhdHRycykgewogIHZhciBrZXlzID0gWwogICAgInVzZXJOYW1lIiwKICAgICJnaXZlbk5hbWUiLAogICAgInNuIiwKICAgICJtYWlsIiwKICAgICJ0ZWxlcGhvbmVOdW1iZXIiLAogICAgInBvc3RhbEFkZHJlc3MiLAogICAgImNpdHkiLAogICAgInN0YXRlUHJvdmluY2UiLAogICAgInBvc3RhbENvZGUiLAogICAgImNvdW50cnkiLAogICAgImZySW5kZXhlZFN0cmluZzIiCiAgXQogIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBpZiAoYXR0cnMuZ2V0KGtleSkgJiYgYXR0cnMuZ2V0KGtleSkudG9TdHJpbmcoKSA9PSAiIikgewogICAgICBsb2dnZXIuZXJyb3IoIlNhbml0aXplIG9iamVjdEF0dHJpYnV0ZXM6IHJlbW92ZSAiLmNvbmNhdChrZXkpKTsKICAgICAgYXR0cnMucmVtb3ZlKGtleSk7CiAgICB9CiAgfSkKfQppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJwYXNzd29yZCIpLnRvU3RyaW5nKCkgIT09ICIiKSB7CiAgbG9nZ2VyLmVycm9yKCJTYW5pdGl6ZSBvYmplY3RBdHRyaWJ1dGVzOiBwcmVzZXJ2ZSBwYXNzd29yZCBpbiBzaGFyZWQgc3RhdGUiKTsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoInBhc3N3b3JkIiwgdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJwYXNzd29yZCIpLnRvU3RyaW5nKCkpOwp9CmxvZ2dlci5lcnJvcigiU2FuaXRpemUgb2JqZWN0QXR0cmlidXRlczogZW5kIik7CgovKgogKiBQcm9wZXJseSBzZXQgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQobmFtZSwgdmFsdWUpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjoiK3ZhbHVlKyJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d3102a25-056d-4e34-973b-577ced8cc9b7\",\"name\":\"Has Email Changed\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJIYXMgRW1haWwgQ2hhbmdlZDogc3RhcnQiKTsKb3V0Y29tZSA9ICJ1bmNoYW5nZWQiOwppZiAoZ2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiKSkgewogIG91dGNvbWUgPSAiY2hhbmdlZCI7Cn0KbG9nZ2VyLmVycm9yKCJIYXMgRW1haWwgQ2hhbmdlZDogZW5kIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIEdldCBvYmplY3RBdHRyaWJ1dGUgdmFsdWUKICovCmZ1bmN0aW9uIGdldE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKS50b1N0cmluZygpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"9535446c-0ff6-4a76-8576-616599119d64\",\"name\":\"Remove Button\",\"description\":\"Remove button from page.\",\"script\":\"LyogUmVtb3ZlIEJ1dHRvbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBIaWRlIGJ1dHRvbnMgb24gdGhlIGpvdXJuZXkgcGFnZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2J1dHRvbicpKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnfSkiCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICB2YXIgbWVzc2FnZSA9ICIgIgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIG1lc3NhZ2UKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d22f9a0c-426a-4466-b95e-d0f125b0d5fa\",\"name\":\"OAuth2 Access Token Modification Script\",\"description\":\"Default global script for OAuth2 Access Token Modification\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTktMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCBsZXRzIHlvdSBtb2RpZnkgaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIGFuIE9BdXRoMiBhY2Nlc3MgdG9rZW4KICogd2l0aCBtZXRob2RzIHByb3ZpZGVkIGJ5IHRoZSBBY2Nlc3NUb2tlbiAoMSkgaW50ZXJmYWNlLgogKiBUaGUgY2hhbmdlcyBtYWRlIHRvIE9BdXRoMiBhY2Nlc3MgdG9rZW5zIHdpbGwgZGlyZWN0bHkgaW1wYWN0IHRoZSBzaXplIG9mIHRoZSBDVFMgdG9rZW5zLAogKiBhbmQsIHNpbWlsYXJseSwgdGhlIHNpemUgb2YgdGhlIEpXVHMgaWYgY2xpZW50LWJhc2VkIE9BdXRoMiB0b2tlbnMgYXJlIHV0aWxpemVkLgogKiBXaGVuIGFkZGluZy91cGRhdGluZyBmaWVsZHMgbWFrZSBzdXJlIHRoYXQgdGhlIHRva2VuIHNpemUgcmVtYWlucyB3aXRoaW4gY2xpZW50L3VzZXItYWdlbnQgbGltaXRzLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogYWNjZXNzVG9rZW4gLSBBY2Nlc3NUb2tlbiAoMSkuCiAqICAgICAgICAgICAgICAgVGhlIGFjY2VzcyB0b2tlbiB0byBiZSB1cGRhdGVkLgogKiAgICAgICAgICAgICAgIE11dGFibGUgb2JqZWN0LCBhbGwgY2hhbmdlcyB0byB0aGUgYWNjZXNzIHRva2VuIHdpbGwgYmUgcmVmbGVjdGVkLgogKiBzY29wZXMgLSBTZXQ8U3RyaW5nPiAoNikuCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICogcmVxdWVzdFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgY29udGFpbnMgYSBtYXAgb2YgcmVxdWVzdCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVcmkgLSBUaGUgcmVxdWVzdCBVUkkuCiAqICAgICAgICAgICAgICAgICAgICAgcmVhbG0gLSBUaGUgcmVhbG0gdGhhdCB0aGUgcmVxdWVzdCByZWxhdGVzIHRvLgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQYXJhbXMgLSBBIG1hcCBvZiB0aGUgcmVxdWVzdCBwYXJhbXMgYW5kL29yIHBvc3RlZCBkYXRhLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFYWNoIHZhbHVlIGlzIGEgbGlzdCBvZiBvbmUgb3IgbW9yZSBwcm9wZXJ0aWVzLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQbGVhc2Ugbm90ZSB0aGF0IHRoZXNlIHNob3VsZCBiZSBoYW5kbGVkIGluIGFjY29yZGFuY2Ugd2l0aCBPV0FTUCBiZXN0IHByYWN0aWNlczoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS92dWxuZXJhYmlsaXRpZXMvVW5zYWZlX3VzZV9vZl9SZWZsZWN0aW9uLgogKiBjbGllbnRQcm9wZXJ0aWVzIC0gVW5tb2RpZmlhYmxlIE1hcCAoNSkuCiAqICAgICAgICAgICAgICAgICAgICBQcmVzZW50IGlmIHRoZSBjbGllbnQgc3BlY2lmaWVkIGluIHRoZSByZXF1ZXN0IHdhcyBpZGVudGlmaWVkLCBjb250YWlucyBhIG1hcCBvZiBjbGllbnQgcHJvcGVydGllczoKICogICAgICAgICAgICAgICAgICAgIGNsaWVudElkIC0gVGhlIGNsaWVudCdzIFVSSSBmb3IgdGhlIHJlcXVlc3QgbG9jYWxlLgogKiAgICAgICAgICAgICAgICAgICAgYWxsb3dlZEdyYW50VHlwZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIGdyYW50IHR5cGVzIChvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLkdyYW50VHlwZSkgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkUmVzcG9uc2VUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgcmVzcG9uc2UgdHlwZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU2NvcGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCBzY29wZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzIC0gQSBtYXAgb2YgdGhlIGN1c3RvbSBwcm9wZXJ0aWVzIG9mIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdHMgb3IgbWFwcyB3aWxsIGJlIGluY2x1ZGVkIGFzIHN1Yi1tYXBzOyBmb3IgZXhhbXBsZToKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21NYXBbS2V5MV09VmFsdWUxIHdpbGwgYmUgcmV0dXJuZWQgYXMgY3VzdG9tTWFwIC0+IEtleTEgLT4gVmFsdWUxLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvIGFkZCBjdXN0b20gcHJvcGVydGllcyB0byBhIGNsaWVudCwgdXBkYXRlIHRoZSBDdXN0b20gUHJvcGVydGllcyBmaWVsZAogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIEFNIENvbnNvbGUgPiBSZWFsbSBOYW1lID4gQXBwbGljYXRpb25zID4gT0F1dGggMi4wID4gQ2xpZW50cyA+IENsaWVudCBJRCA+IEFkdmFuY2VkLgogKiBpZGVudGl0eSAtIEFNSWRlbnRpdHkgKDMpLgogKiAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyLgogKiBzZXNzaW9uIC0gU1NPVG9rZW4gKDQpLgogKiAgICAgICAgICAgUHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QuCiAqIHNjcmlwdE5hbWUgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgc2NyaXB0LgogKiBsb2dnZXIgLSBBbHdheXMgcHJlc2VudCwgdGhlICJPQXV0aDJQcm92aWRlciIgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiAgICAgICAgICBDb3JyZXNwb25kaW5nIGxvZyBmaWxlcyB3aWxsIGJlIHByZWZpeGVkIHdpdGg6IHNjcmlwdHMuT0FVVEgyX0FDQ0VTU19UT0tFTl9NT0RJRklDQVRJT04uCiAqIGh0dHBDbGllbnQgLSBIVFRQIENsaWVudCAoOCkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIEhUVFAgQ2xpZW50IGluc3RhbmNlOgogKiAgICAgICAgICAgICAgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvc2NyaXB0aW5nLWd1aWRlL3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50Lmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtaHR0cC1jbGllbnQuCiAqCiAqIFJldHVybiAtIG5vIHZhbHVlIGlzIGV4cGVjdGVkLCBjaGFuZ2VzIHNoYWxsIGJlIG1hZGUgdG8gdGhlIGFjY2Vzc1Rva2VuIHBhcmFtZXRlciBkaXJlY3RseS4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgQWNjZXNzVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvQWNjZXNzVG9rZW4uaHRtbC4KICogKDMpIEFNSWRlbnRpdHkgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9zdW4vaWRlbnRpdHkvaWRtL0FNSWRlbnRpdHkuaHRtbC4KICogKDQpIFNTT1Rva2VuIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vaXBsYW5ldC9zc28vU1NPVG9rZW4uaHRtbC4KICogKDUpIE1hcCAtIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvSGFzaE1hcC5odG1sLAogKiAgICAgICAgICAgb3IgaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqICg2KSBTZXQgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hTZXQuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKi8KCi8qIEVYQU1QTEUKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QsCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlc3BvbnNlCiAgICApOwoKICAgIC8vIEFsd2F5cyBpbmNsdWRlcyB0aGlzIGZpZWxkIGluIHRoZSB0b2tlbi4KICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkKCdrZXkxJywgJ3ZhbHVlMScpOwoKICAgIC8vIFJlY2VpdmVzIGFuZCBhZGRzIHRvIHRoZSBhY2Nlc3MgdG9rZW4gYWRkaXRpb25hbCB2YWx1ZXMgYnkgcGVyZm9ybWluZyBhIFJFU1QgY2FsbCB0byBhbiBleHRlcm5hbCBzZXJ2aWNlLgogICAgLy8gV0FSTklORzogQmVsb3csIHlvdSB3aWxsIGZpbmQgYSByZWZlcmVuY2UgdG8gYSB0aGlyZC1wYXJ0eSBzaXRlLCB3aGljaCBpcyBwcm92aWRlZCBvbmx5IGFzIGFuIGV4YW1wbGUuCiAgICB2YXIgdXJpID0gJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cyc7CgogICAgdHJ5IHsKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmckphdmEuUmVxdWVzdCgpOwoKICAgICAgICAvLyBZb3UgY2FuIGNoYWluIG1ldGhvZHMgdGhhdCByZXR1cm4gdGhlIHJlcXVlc3Qgb2JqZWN0LgogICAgICAgIHJlcXVlc3Quc2V0VXJpKHVyaSkKICAgICAgICAgICAgLnNldE1ldGhvZCgnUE9TVCcpCiAgICAgICAgICAgIC5zZXRFbnRpdHkoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgdXBkYXRlZEZpZWxkczogewogICAgICAgICAgICAgICAgICAgIGtleTI6ICd2YWx1ZTInLAogICAgICAgICAgICAgICAgICAgIGtleTM6ICd2YWx1ZTMnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgLy8gWW91IGNhbiBjYWxsIGEgbWV0aG9kIHdoZW4gY2hhaW5pbmcgaXMgbm90IHBvc3NpYmxlLgogICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnKTsKCiAgICAgICAgLy8gU2VuZHMgdGhlIHJlcXVlc3QgYW5kIHJlY2VpdmVzIHRoZSByZXNwb25zZS4KICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0T3JUaHJvdygpOwoKICAgICAgICAvLyBDaGVja3MgaWYgdGhlIHJlc3BvbnNlIHN0YXR1cyBpcyBhcyBleHBlY3RlZC4KICAgICAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkgPT09IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5TdGF0dXMuQ1JFQVRFRCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CgogICAgICAgICAgICAvLyBTZXQgbXVsdGlwbGUgdG9rZW4gZmllbGRzIGF0IG9uY2UuCiAgICAgICAgICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkcyhyZXN1bHQudXBkYXRlZEZpZWxkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdVbmFibGUgdG8gb2J0YWluIGFjY2VzcyB0b2tlbiBtb2RpZmljYXRpb25zLiBTdGF0dXM6ICcgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICcuIENvbnRlbnQ6ICcgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5lcnJvcignVGhlIHJlcXVlc3QgcHJvY2Vzc2luZyB3YXMgaW50ZXJydXB0ZWQuICcgKyBlKTsKCiAgICAgICAgLy8gVGhlIGFjY2VzcyB0b2tlbiByZXF1ZXN0IGZhaWxzIHdpdGggdGhlIEhUVFAgNTAwIGVycm9yIGluIHRoaXMgY2FzZS4KICAgICAgICB0aHJvdyAoJ1VuYWJsZSB0byBvYnRhaW4gcmVzcG9uc2UgZnJvbTogJyArIHVyaSk7CiAgICB9CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgaWRlbnRpdHkgYXR0cmlidXRlIHZhbHVlcyB0byB0aGUgYWNjZXNzIHRva2VuLgogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ21haWwnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ21haWwnKSk7CiAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgncGhvbmUnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ3RlbGVwaG9uZU51bWJlcicpLnRvQXJyYXkoKVswXSk7CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgdGhlIHNlc3Npb24gcHJvcGVydHkgdmFsdWVzLgogICAgLy8gTk9URTogc2Vzc2lvbiBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igbm9uLWludGVyYWN0aXZlIGF1dGhvcml6YXRpb24gZ3JhbnRzLgogICAgaWYgKHNlc3Npb24pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgnaXBBZGRyZXNzJywgc2Vzc2lvbi5nZXRQcm9wZXJ0eSgnSG9zdCcpKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignVW5hYmxlIHRvIHJldHJpZXZlIHNlc3Npb24gcHJvcGVydHkgdmFsdWUuICcgKyBlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gUmVtb3ZlcyBhIG5hdGl2ZSBmaWVsZCBmcm9tIHRoZSB0b2tlbiBlbnRyeSwgdGhhdCB3YXMgc2V0IGJ5IEFNLgogICAgLy8gV0FSTklORzogcmVtb3ZpbmcgbmF0aXZlIGZpZWxkcyBmcm9tIHRoZSB0b2tlbiBtYXkgcmVzdWx0IGluIGxvc3Mgb2YgZnVuY3Rpb25hbGl0eS4KICAgIC8vIGFjY2Vzc1Rva2VuLnJlbW92ZVRva2VuTmFtZSgpCgogICAgLy8gTm8gcmV0dXJuIHZhbHVlIGlzIGV4cGVjdGVkLiBMZXQgaXQgYmUgdW5kZWZpbmVkLgp9KCkpOwoqLw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"5e854779-6ec1-4c39-aeba-0477e0986646\",\"name\":\"Config Provider\",\"description\":\"Default global script for Config Provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyoqCiAqIFRoZSBmb2xsb3dpbmcgc2NyaXB0IGlzIGEgc2ltcGxpZmllZCB0ZW1wbGF0ZSBmb3IgdW5kZXJzdGFuZGluZyBob3cgdG8gYnVpbGQKICogdXAgYSBjb25maWcgTWFwIG9iamVjdCB3aXRoIGN1c3RvbSB2YWx1ZXMuIFRoZSBDb25maWcgUHJvdmlkZXIgTm9kZSB3aWxsIHRoZW4KICogcHJvdmlkZSB0aGlzIGNvbmZpZyBNYXAgdG8gdGhlIGRlc2lyZWQgbm9kZSB0eXBlLiBJdCBpcyBpbXBvcnRhbnQgdGhhdCB0aGUgTWFwCiAqIHlvdSBidWlsZCBoZXJlIGlzIG5hbWVkICdjb25maWcnLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICoKICogbm9kZVN0YXRlIC0gTm9kZSBTdGF0ZSAoMSkKICogICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGlzIHJlcHJlc2VudHMgdGhlIGN1cnJlbnQgdmFsdWVzIHN0b3JlZCBpbiB0aGUgbm9kZSBzdGF0ZS4KICoKICogaWRSZXBvc2l0b3J5IC0gUHJvZmlsZSBEYXRhICgyKQogKiAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGEgcmVwb3NpdG9yeSB0byByZXRyaWV2ZSB1c2VyIGluZm9ybWF0aW9uLgogKgogKiBzZWNyZXRzIC0gQ3JlZGVudGlhbHMgYW5kIFNlY3JldHMgKDMpCiAqICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgYW4gaW50ZXJmYWNlIHRvIGFjY2VzcyB0aGUgU2VjcmV0cyBBUEkgZnJvbSBhIHNjcmlwdGluZyBjb250ZXh0LgogKgogKiByZXF1ZXN0SGVhZGVycyAoNCkgLSBNYXAgKDUpCiAqICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgYW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyBmb3IgYWNjZXNzaW5nIGhlYWRlcnMgaW4gdGhlIGxvZ2luIHJlcXVlc3QuCiAqCiAqIGxvZ2dlciAtIERlYnVnIExvZ2dpbmcgKDYpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGVidWcgbG9nZ2VyIGluc3RhbmNlLgogKgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDcpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgSFRUUCBjbGllbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBtYWtlIGV4dGVybmFsIEhUVFAgcmVxdWVzdHMuCiAqCiAqIHJlYWxtIC0gU3RyaW5nIChwcmltaXRpdmUpLgogKiAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIG5hbWUgb2YgdGhlIHJlYWxtIHRoZSB1c2VyIGlzIGF1dGhlbnRpY2F0aW5nIHRvLgogKgogKiBleGlzdGluZ1Nlc3Npb24gLSBNYXA8U3RyaW5nLCBTdHJpbmc+ICg1KQogKiAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4gVGhlIHJldHVybmVkIG1hcCBmcm9tCiAqICAgICAgICAgIFNTT1Rva2VuLmdldFByb3BlcnRpZXMoKSAoOCkKICoKICogcmVxdWVzdFBhcmFtZXRlcnMgLSBNYXAgKDUpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGF1dGhlbnRpY2F0aW9uIHJlcXVlc3QgcGFyYW1ldGVycy4KICoKICoKICogT3V0cHV0czoKICoKICogY29uZmlnIC0gTWFwICg1KQogKiAgICAgICAgICAgRGVmaW5lIGFuZCBmaWxsIGEgTWFwIG9iamVjdCBuYW1lZCAnY29uZmlnJyB3aXRoIGN1c3RvbSB2YWx1ZXMsIHRoaXMgd2lsbCBkZWZpbmUgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZQogKiAgICAgICAgICAgYXNzb2NpYXRlZCBub2RlIHNlbGVjdGVkIGluIHRoZSBDb25maWdQcm92aWRlck5vZGUuCiAqCiAqIFJlZmVyZW5jZToKICogKDEpIE5vZGUgU3RhdGUgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvaWRjbG91ZC1hbS9sYXRlc3QvYXV0aGVudGljYXRpb24tZ3VpZGUvc2NyaXB0aW5nLWFwaS1ub2RlLmh0bWwjc2NyaXB0aW5nLWFwaS1ub2RlLW5vZGVTdGF0ZQogKiAoMikgUHJvZmlsZSBEYXRhIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcuMS9hdXRoZW50aWNhdGlvbi1ndWlkZS9zY3JpcHRpbmctYXBpLW5vZGUuaHRtbCNzY3JpcHRpbmctYXBpLW5vZGUtaWQtcmVwbwogKiAoMykgQ3JlZGVudGlhbHMgYW5kIFNlY3JldHMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy4xL2F1dGhlbnRpY2F0aW9uLWd1aWRlL3NjcmlwdGluZy1hcGktbm9kZS5odG1sI3NjcmlwdGluZy1hcGktYXV0aG4tc2VjcmV0cwogKiAoNCkgUmVxdWVzdCBIZWFkZXJzIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXV0aGVudGljYXRpb24tZ3VpZGUvc2NyaXB0aW5nLWFwaS1ub2RlLmh0bWwjc2NyaXB0aW5nLWFwaS1ub2RlLXJlcXVlc3RIZWFkZXJzLgogKiAoNSkgTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9NYXAuaHRtbAogKiAoNikgRGVidWcgTG9nZ2luZyAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICg3KSBIVFRQIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKiAoOCkgU1NPVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9pcGxhbmV0L3Nzby9TU09Ub2tlbi5odG1sLgogKi8KCmNvbmZpZyA9IG5vZGVTdGF0ZS5nZXQoJ25vZGVDb25maWcnKS5hc01hcCgpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"CONFIG_PROVIDER_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"aed630f7-2101-4423-a2bc-9494b67c2728\",\"name\":\"AT_MFAMethod_fido\",\"description\":\"This script puts 'fido' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX2ZpZG86IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfZmlkbzogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbImZpZG8iXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfZmlkbzogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"073a64d4-37c9-486d-8c59-6583494644b9\",\"name\":\"FRAAS-7955 Transient State Only\",\"description\":\"FRAAS-7955 Transient State Only\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC10cmFuc2llbnQiKTsKc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXRyYW5zaWVudCIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC10cmFuc2llbnRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gdHJhbnNpZW50IHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgdmFyIHRyYW5zaWVudFN0b3JhZ2UgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAodHJhbnNpZW50U3RvcmFnZS5wdXQpIHsKICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICB0cmFuc2llbnRTdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgIHRyYW5zaWVudFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"fbc563cb-eced-4e1b-9cd4-022680347668\",\"name\":\"FRAAS-7955 Show Object Values\",\"description\":\"FRAAS-7955 Show Object Values\",\"script\":\"dmFyIG91dGNvbWUgPSB0cnVlOwoKLy8gUmVxdWlyZXMgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBhdXRoIG5vZGUgdG8gcmV0cmlldmUgcmVhbCB1c2VyIElEIGZyb20gSURNCnZhciB1c2VyaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpOwoKLy8gUmV0cmlldmUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZXMKdmFyIHVzZXJOYW1lID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJ1aWQiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp2YXIgZmlyc3ROYW1lID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp2YXIgbGFzdE5hbWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgInNuIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKTsKdmFyIGVtYWlsID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJtYWlsIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKTsKCnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjxoND5PYmplY3QgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICI8cD48Yj5Vc2VybmFtZTwvYj46ICIpLmNvbmNhdCh1c2VyTmFtZSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPkZpcnN0IE5hbWU8L2I+OiAiKS5jb25jYXQoZmlyc3ROYW1lKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+TGFzdCBOYW1lPC9iPjogIikuY29uY2F0KGxhc3ROYW1lKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+RW1haWw8L2I+OiAiKS5jb25jYXQoZW1haWwpLmNvbmNhdCgiPC9wPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"653d0d28-7888-4741-902f-a142637f2d05\",\"name\":\"Set Company To Smokin\",\"description\":\"Set company in node state\",\"script\":\"LyogU2V0IENvbXBhbnkgVG8gU21va2luCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFNldCBjb21wYW55IHRvIFNtb2tpbiBpbiBub2RlIHN0YXRlCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogICAgbm9kZVN0YXRlLnB1dFNoYXJlZCgiY29tcGFueSIsICJTbW9raW4iKTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"53c50dbd-5331-4739-bea1-4c5e9bf553f2\",\"name\":\"Twilio IVR: Welcome Message\",\"description\":\"Welcome message\",\"script\":\"LyogVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIlRoYW5rIHlvdSBmb3IgY2FsbGluZyBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"92741813-dac1-4910-ae07-ceac92a048c1\",\"name\":\"AT_Optin-Always\",\"description\":\"This script puts 'always' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdhbHdheXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbImFsd2F5cyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1d475815-72cb-42eb-aafd-4026989d28a7\",\"name\":\"Social Identity Provider Profile Transformation Script\",\"description\":\"Default global script for Social Identity Provider Profile Transformation\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyogRGVmYXVsdCBTb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgUHJvZmlsZSBUcmFuc2Zvcm1hdGlvbiBzY3JpcHQgdG8gdXNlIGFzIGEgdGVtcGxhdGUgZm9yIG5ldyBzY3JpcHRzICov\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"809330cf-874c-4d57-a8f1-5882c6dd855b\",\"name\":\"Normalized idddataweb Profile to Managed User\",\"description\":\"Converts a normalized social profile for iddataweb into a Managed user\",\"script\":\"LyogTm9ybWFsaXplZCBpZGRkYXRhd2ViIFByb2ZpbGUgdG8gTWFuYWdlZCBVc2VyCiAqIENvcHlyaWdodCAyMDIyIEZvcmdlUm9jayBBUy4gQWxsIFJpZ2h0cyBSZXNlcnZlZAogKgogKiBVc2Ugb2YgdGhpcyBjb2RlIHJlcXVpcmVzIGEgY29tbWVyY2lhbCBzb2Z0d2FyZSBsaWNlbnNlIHdpdGggRm9yZ2VSb2NrIEFTLgogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLiBOb3QgZm9yIHByb2R1Y3Rpb24gdXNlLgogKiBNb2RpZmllZCBieSBTdGVwaGVuIFBheW5lLCAyMDIxLU1hci0zMAogKi8KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKaW1wb3J0IG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUKbG9nZ2VyLmVycm9yKCJOb3JtYWxpemVkX1Byb2ZpbGVfSUREYXRhV2ViOiBTdGFydCAiICsgbm9ybWFsaXplZFByb2ZpbGUpOwoKSnNvblZhbHVlIG1hbmFnZWRVc2VyID0ganNvbihvYmplY3QoCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmdpdmVuTmFtZSksCiAgICAgICAgZmllbGQoInNuIiwgbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZSksCiAgICAgICAgZmllbGQoInVzZXJOYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUudXNlcm5hbWUpKSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQppZiAobm9ybWFsaXplZFByb2ZpbGUuRE9CLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoImZySW5kZXhlZFN0cmluZzIiLCBub3JtYWxpemVkUHJvZmlsZS5ET0IpCgpyZXR1cm4gbWFuYWdlZFVzZXIK\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ab917dad-6fdb-46c2-8c8c-42f094ebeea1\",\"name\":\"IDP Re-Lookup\",\"description\":\"Perform IDP re-lookup based on the Organization ID from the initial lookup. Set users' external IDP in shared state for further processing.\",\"script\":\"LyogSURQIFJlLUxvb2t1cAogKiAKICogUGVyZm9ybSBJRFAgcmUtbG9va3VwIGJhc2VkIG9uIHRoZSBPcmdhbml6YXRpb24gSUQgZnJvbSB0aGUgaW5pdGlhbCBsb29rdXAuIAogKiBTZXQgdXNlcnMnIGV4dGVybmFsIElEUCBpbiBzaGFyZWQgc3RhdGUgZm9yIGZ1cnRoZXIgcHJvY2Vzc2luZy4KICogCiAqIFRoaXMgc2NyaXB0IHJlcXVpcmVzIHBhcmFtZXRyaXphdGlvbi4gTWFrZSBzdXJlIHlvdSBjYXJlZnVsbHkgcmV2aWV3IHRoZSBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIFJlLUxvb2t1cDogc3RhcnQiKTsKICAJb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAJdmFyIG9yZ0lkID0gcmVmZXJlci5zZWFyY2hQYXJhbS5vOwogIAlzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgcmVmZXJlci5zZWFyY2hQYXJhbS51KTsKCiAgCS8qIEJlZ2luIENvbmZpZ3VyYXRpb24gKi8KICAKICAgIC8vIGxvbmctbGl2ZWQgdG9rZW4sIGV4cGlyZXM6IEZyaWRheSwgSmFudWFyeSAxNiwgMjAzMiA5OjQ1OjE0IFBNIEdNVC0wNjowMAogICAgdmFyIElETV9BUElfVE9LRU4gPSAiZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKSVV6STFOaUo5LmV5SnpkV0lpT2lKbE1XRTFZelU1T0MwNE1HVXlMVFJoWkdNdFlqTTBOUzB6TVdRd01tVXlPVGhqTkdJaUxDSmpkSE1pT2lKUFFWVlVTREpmUjFKQlRsUmZVMFZVSWl3aVlYVjBhRjlzWlhabGJDSTZNQ3dpWVhWa2FYUlVjbUZqYTJsdVowbGtJam9pTkdZek1Ea3hZVGt0WmpVME5pMDBNRGRpTFRrek5qTXRNMlJpWkdKaVpqWXpNRGMwTFRNMU56Y3dPU0lzSW5OMVltNWhiV1VpT2lKbE1XRTFZelU1T0MwNE1HVXlMVFJoWkdNdFlqTTBOUzB6TVdRd01tVXlPVGhqTkdJaUxDSnBjM01pT2lKb2RIUndjem92TDI5d1pXNWhiUzEyYjJ4clpYSXRaR1YyTG1admNtZGxZbXh2WTJ0ekxtTnZiVG8wTkRNdllXMHZiMkYxZEdneUwyRnNjR2hoSWl3aWRHOXJaVzVPWVcxbElqb2lZV05qWlhOelgzUnZhMlZ1SWl3aWRHOXJaVzVmZEhsd1pTSTZJa0psWVhKbGNpSXNJbUYxZEdoSGNtRnVkRWxrSWpvaUxVSXhRbFJVTTNGcU5pMDRaa2QzYTJkNmJ6Z3pOemxTUmpWSkxqQTROa05KZFRGeU9VTkNObFJPY0VJd1YzUTVPRkV5TlRKWWN5SXNJbUYxWkNJNklqWTVaREExWXpFeExXVTRabVV0TkdGbE5TMWhOMk01TFRJeU5USmhOR1E0TldSbU5DSXNJbTVpWmlJNk1UWTBNalUyTXpreE5Dd2laM0poYm5SZmRIbHdaU0k2SW5CaGMzTjNiM0prSWl3aWMyTnZjR1VpT2xzaVpuSTZhV1J0T2lvaVhTd2lZWFYwYUY5MGFXMWxJam94TmpReU5UWXpPVEUwTENKeVpXRnNiU0k2SWk5aGJIQm9ZU0lzSW1WNGNDSTZNVGsxTnpreU16a3hOQ3dpYVdGMElqb3hOalF5TlRZek9URTBMQ0psZUhCcGNtVnpYMmx1SWpvek1UVXpOakF3TURBc0ltcDBhU0k2SWkxQ01VSlVWRE54YWpZdE9HWkhkMnRuZW04NE16YzVVa1kxU1M1Q1NIRlpOVnAzYzBsR05WcE1iRXR2Y0dOdlVsVkdWSE5MVWpBaUxDSnRZWGxmWVdOMElqcDdJbU5zYVdWdWRGOXBaQ0k2V3lJMk9XUXdOV014TVMxbE9HWmxMVFJoWlRVdFlUZGpPUzB5TWpVeVlUUmtPRFZrWmpRaVhYMTkuZjJObXdIVnRla0g5M2pPNy1qTTZta0ZSY3V2RU4zV3pjS3NILVJBUG5sYyI7CgogICAgLy8gSURNIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSURNX0FQSV9VUkkgPSByZWZlcmVyLm9yaWdpbiArICIvb3BlbmlkbS9tYW5hZ2VkL2FscGhhX29yZ2FuaXphdGlvbi8iKyBvcmdJZCArICI/X2ZpZWxkcz1uYW1lLGRlc2NyaXB0aW9uLGlkcE5hbWUsaWRwVHlwZSxpZHBEb21haW5zLGlkcEpvdXJuZXksaWRwVGhlbWUsaWRwUGVyc2lzdCI7CgogIAkvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnR0VUJyk7CiAgICByZXF1ZXN0LnNldFVyaShJRE1fQVBJX1VSSSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiQmVhcmVyICIgKyBJRE1fQVBJX1RPS0VOKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIFJlLUxvb2t1cDogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCQogIAlpZiAocmVzdWx0KSB7CiAgCQlvdXRjb21lID0gInRydWUiOwogICAgICAgIHZhciByb3V0ZWRJRFBzID0gW3Jlc3VsdF07CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJyb3V0ZWRJRFBzIiwgcm91dGVkSURQcyk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSZS1Mb29rdXA6IEZvdW5kIElEUCIpOwogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSZS1Mb29rdXA6IGVuZCBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3d97c436-42c0-4dd0-a571-ea6f34f752b3\",\"name\":\"Itsme Profile Normalization\",\"description\":\"Normalizes raw profile data from Itsme\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKaW1wb3J0IG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUKCkpzb25WYWx1ZSBtYW5hZ2VkVXNlciA9IGpzb24ob2JqZWN0KAogICAgICAgIGZpZWxkKCJpZCIsIHJhd1Byb2ZpbGUuc3ViKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmdpdmVuX25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5mYW1pbHlfbmFtZSksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQpyZXR1cm4gbWFuYWdlZFVzZXI=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"c9fa3899-c3ce-4833-af83-64d709202600\",\"name\":\"Twilio IVR: Verify Security PIN\",\"description\":\"Verify security PIN\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gRm9yIElEIENsb3VkIHVzZSAiX2lkIiwgZm9yIGNsYXNzaWMgZGVwbG95bWVudHMgdXNlICJ1c2VybmFtZSIKdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKCi8vIFJldHJpZXZlIHRoZSBpZGVudGlmaWVkIGNhbGxlcidzIFBJTiAoaW4gSURNOiBmclVuaW5kZXhlZEludGVnZXI1LCBpbiBBTTogZnItYXR0ci1pbnQ1KQp2YXIgc2VjdXJpdHlQSU4gPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgImZyLWF0dHItaW50NSIpLml0ZXJhdG9yKCkubmV4dCgpOwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiVG8gdmVyaWZ5IEkgaGF2ZSB0aGUgcmlnaHQgYWNjb3VudCwgcGxlYXNlIGVudGVyIHlvdXIgNC1kaWdpdCBzZWN1cml0eSBQSU4uIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRJbnB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIGlucHV0ID0gbmV3IFRleHRJbnB1dENhbGxiYWNrKHByb21wdCk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQoaW5wdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgICAJdmFyIGFuc3dlciA9IG5ldyBTdHJpbmcoY2FsbGJhY2tzLmdldCgwKS5nZXRUZXh0KCkpLnJlcGxhY2UoL1teMC05XS9nLCAiIik7CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFZlcmlmeSBTZWN1cml0eSBQSU46IGNhbGxiYWNrcyByZWNlaXZlZCIpOwogICAgCWlmIChhbnN3ZXIgPT0gc2VjdXJpdHlQSU4pIHsKICAgICAgCQlvdXRjb21lID0gInRydWUiOwogICAgCX0KCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTjogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogIAl9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ce6fbbcf-5d9a-471b-bcc1-448758a6374a\",\"name\":\"MobileOTP: Validate OTP In Profile Attribute\",\"description\":\"Validate OTP in profile attribute\",\"script\":\"LyoKICogVmFsaWRhdGUgT1RQIGluIHVzZXIgcHJvZmlsZSBhdHRyaWJ1dGUgYWdhaW5zdCBPVFAgaW4gc2hhcmVkIHN0YXRlCiAqLwpvdXRjb21lID0gImZhbHNlIjsKdmFyIE9UUF9MRU5HVEggPSA4OwoKaWYgKHNoYXJlZFN0YXRlLmdldCgibW9iaWxlT1RQIikpIHsKICAJdmFyIHByb2ZpbGVPVFAgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCAiZnItYXR0ci1pbnQ1Iik7Cn0KCmZ1bmN0aW9uIGNoZWNrUGFzc3dvcmQocHJvZmlsZU9UUCwgcGFzc3dvcmQpIHsKCXZhciBvbmVUaW1lUGFzc3dvcmQgPSBwcm9maWxlT1RQLnN1YnN0cmluZygwLDcpOwoJdmFyIHBhc3N3b3JkVGltZXN0YW1wID0gTnVtYmVyKHByb2ZpbGVPVFAuc3Vic3RyaW5nKDgpKTsKCgl2YXIgcGFzc3dvcmRNYXRjaGVzID0gb25lVGltZVBhc3N3b3JkCiAgICAgICAgJiYgKG9uZVRpbWVQYXNzd29yZCA9PSBwYXNzd29yZCkKICAgICAgICAmJiBwYXNzd29yZFRpbWVzdGFtcCAhPSBudWxsCiAgICAgICAgJiYgaXNXaXRoaW5FeHBpcnlUaW1lKHBhc3N3b3JkVGltZXN0YW1wKTsKCXJldHVybiBwYXNzd29yZE1hdGNoZXM7Cn0KCmZ1bmN0aW9uIGlzV2l0aGluRXhwaXJ5VGltZShwYXNzd29yZFRpbWVzdGFtcCkgewogICAgICAgIEluc3RhbnQgcHJldmlvdXMgPSBJbnN0YW50Lm9mRXBvY2hTZWNvbmQocGFzc3dvcmRUaW1lc3RhbXApOwogICAgICAgIER1cmF0aW9uIHBhc3N3b3JkRXhwaXJ5ID0gRHVyYXRpb24ub2ZNaW51dGVzKGNvbmZpZy5wYXNzd29yZEV4cGlyeVRpbWUoKSk7CiAgICAgICAgSW5zdGFudCBub3cgPSBUaW1lLmdldENsb2NrKCkuaW5zdGFudCgpOwogICAgICAgIGxvZ2dlci5kZWJ1ZygicHJldmlvdXMge30gXG4gcGFzc3dvcmRFeHBpcnkge30gXG4gbm93IHt9IiwgcHJldmlvdXMsIHBhc3N3b3JkRXhwaXJ5LCBub3cpOwogICAgICAgIGJvb2xlYW4gd2l0aGluRXhwaXJ5VGltZSA9IER1cmF0aW9uLmJldHdlZW4ocHJldmlvdXMucGx1cyhwYXNzd29yZEV4cGlyeSksIG5vdykuaXNOZWdhdGl2ZSgpOwogICAgICAgIGxvZ2dlci5kZWJ1Zygid2l0aGluRXhwaXJ5VGltZSB7fSIsIHdpdGhpbkV4cGlyeVRpbWUpOwogICAgICAgIHJldHVybiB3aXRoaW5FeHBpcnlUaW1lOwp9CgovKgogICAgcHJpdmF0ZSBBY3Rpb24gY2hlY2tQYXNzd29yZChUcmVlQ29udGV4dCBjb250ZXh0LCBTdHJpbmcgcGFzc3dvcmQpIHsKICAgICAgICBKc29uVmFsdWUgb25lVGltZVBhc3N3b3JkID0gY29udGV4dC5nZXRTdGF0ZShPTkVfVElNRV9QQVNTV09SRCk7CiAgICAgICAgSnNvblZhbHVlIHBhc3N3b3JkVGltZXN0YW1wID0gY29udGV4dC5nZXRTdGF0ZShPTkVfVElNRV9QQVNTV09SRF9USU1FU1RBTVApOwoKICAgICAgICBib29sZWFuIHBhc3N3b3JkTWF0Y2hlcyA9IG9uZVRpbWVQYXNzd29yZCAhPSBudWxsICYmIG9uZVRpbWVQYXNzd29yZC5pc1N0cmluZygpCiAgICAgICAgICAgICAgICAmJiBvbmVUaW1lUGFzc3dvcmQuYXNTdHJpbmcoKS5lcXVhbHMocGFzc3dvcmQpCiAgICAgICAgICAgICAgICAmJiBwYXNzd29yZFRpbWVzdGFtcCAhPSBudWxsICYmIHBhc3N3b3JkVGltZXN0YW1wLmlzTnVtYmVyKCkKICAgICAgICAgICAgICAgICYmIGlzV2l0aGluRXhwaXJ5VGltZShwYXNzd29yZFRpbWVzdGFtcC5hc0xvbmcoKSk7CiAgICAgICAgbG9nZ2VyLmRlYnVnKCJwYXNzd29yZE1hdGNoZXMge30iLCBwYXNzd29yZE1hdGNoZXMpOwogICAgICAgIHJldHVybiBnb1RvKHBhc3N3b3JkTWF0Y2hlcykuYnVpbGQoKTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaXNXaXRoaW5FeHBpcnlUaW1lKGxvbmcgcGFzc3dvcmRUaW1lc3RhbXApIHsKICAgICAgICBJbnN0YW50IHByZXZpb3VzID0gSW5zdGFudC5vZkVwb2NoU2Vjb25kKHBhc3N3b3JkVGltZXN0YW1wKTsKICAgICAgICBEdXJhdGlvbiBwYXNzd29yZEV4cGlyeSA9IER1cmF0aW9uLm9mTWludXRlcyhjb25maWcucGFzc3dvcmRFeHBpcnlUaW1lKCkpOwogICAgICAgIEluc3RhbnQgbm93ID0gVGltZS5nZXRDbG9jaygpLmluc3RhbnQoKTsKICAgICAgICBsb2dnZXIuZGVidWcoInByZXZpb3VzIHt9IFxuIHBhc3N3b3JkRXhwaXJ5IHt9IFxuIG5vdyB7fSIsIHByZXZpb3VzLCBwYXNzd29yZEV4cGlyeSwgbm93KTsKICAgICAgICBib29sZWFuIHdpdGhpbkV4cGlyeVRpbWUgPSBEdXJhdGlvbi5iZXR3ZWVuKHByZXZpb3VzLnBsdXMocGFzc3dvcmRFeHBpcnkpLCBub3cpLmlzTmVnYXRpdmUoKTsKICAgICAgICBsb2dnZXIuZGVidWcoIndpdGhpbkV4cGlyeVRpbWUge30iLCB3aXRoaW5FeHBpcnlUaW1lKTsKICAgICAgICByZXR1cm4gd2l0aGluRXhwaXJ5VGltZTsKICAgIH0KICAgICov\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"fe5e303b-9ed7-4853-84fe-0ae43e2254d5\",\"name\":\"Display Username\",\"description\":\"Display the username in an HTML dialog.\",\"script\":\"LyogRGlzcGxheSBVc2VybmFtZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBEaXNwbGF5IHRoZSB1c2VybmFtZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICB0cnkgewogICAgdmFyIG91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgdXNlcm5hbWUgPSBub2RlU3RhdGUuZ2V0KCd1c2VybmFtZScpLmFzU3RyaW5nKCk7CgogICAgLy8gU3BlY2lmeSB0aGUgbWVzc2FnZSB5b3Ugd2FudCB0byBkaXNwbGF5LiBZb3UgbWF5IHVzZSBIVE1MIGZvciBmb3JtYXR0aW5nLiBBdm9pZCBsaW5lIGJyZWFrcyEgVXNlIDxicj4gaW5zdGVhZC4KICAgIHZhciBtZXNzYWdlID0gJzxoNT4nK3VzZXJuYW1lKyc8L2g1Pic7CgogICAgdmFyIGFuY2hvciA9ICdhbmNob3ItJytnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIFwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4gXAogICAgICBmdW5jdGlvbiAoZSkge1xuIFwKICAgICAgICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gXAogICAgICAgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIrYW5jaG9yKyInKSB7XG4gXAogICAgICAgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIittZXNzYWdlKyInO1xuIFwKICAgICAgICB9XG4gXAogICAgICB9KSI7CiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgICAgICkuYnVpbGQoKQogICAgfQogICAgZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGxvZ2dlci5lcnJvcignRXJyb3I6ICcgKyBlcnJvcik7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdlcnJvcicsIGVycm9yLm1lc3NhZ2UpOwogIH0KCiAgIC8qCiAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAqIAogICAgKiBFeGFtcGxlOgogICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgKi8KICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgIH0pOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d70df7a8-6390-409d-b821-166272a9a9c8\",\"name\":\"Collect Inner Tree Evaluator Config\",\"description\":\"Collect all the configuration items required for the Inner Tree Evaluator to function properly.\",\"script\":\"LyogQ29sbGVjdCBJbm5lciBUcmVlIEV2YWx1YXRvciBDb25maWcKICogCiAqIENvbGxlY3QgYWxsIHRoZSBjb25maWd1cmF0aW9uIGl0ZW1zIHJlcXVpcmVkIGZvciB0aGUgSW5uZXIgVHJlZSBFdmFsdWF0b3IgdG8gZnVuY3Rpb24gcHJvcGVybHkuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciBjb25maWcgPSB7CiAgICAgICAgInRyZWUiOiAiTG9naW4iLAogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXSk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygidHJlZSIsIGNvbmZpZy50cmVlKSwKICAgICAgICAgIAluZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDApLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMCkuZ2V0TmFtZSgpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgibm9kZUNvbmZpZyIsIGNvbmZpZyk7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3cb43516-ae69-433a-8787-501d45db14e9\",\"name\":\"debug\",\"description\":\"Display sharedState, transientState, and headers.\",\"script\":\"LyogZGVidWcKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRGlzcGxheSBzaGFyZWRTdGF0ZSwgdHJhbnNpZW50U3RhdGUsIGFuZCBoZWFkZXJzLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwp2YXIgb3V0cHV0ID0gdHJ1ZTsKCnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjxwPjxiPlNoYXJlZCBTdGF0ZTwvYj46PGJyLz4iLmNvbmNhdCgKICAJc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgCXRyYW5zaWVudFN0YXRlLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpLmNvbmNhdCgKICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogIAlyZXF1ZXN0SGVhZGVycy50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKQp2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuY2xhc3NOYW1lID0gXCJ0ZXh0LWxlZnRcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICIgIH1cbiIpLmNvbmNhdCgKICAifSkiKQp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgKSwKICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"eea1e530-8cf4-4875-af75-11396e6a8859\",\"name\":\"Embed Cookie Consent\",\"description\":\"Embed cookie consent JavaScript snippet.\",\"script\":\"LyogRW1iZWQgQ29va2llIENvbnNlbnQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRW1iZWQgYSBPbmVUcnVzdCBjb29raWUgY29uc2VudCBKYXZhU2NyaXB0IGluIGEgbG9naW4vcmVnaXN0cmF0aW9uIGpvdXJuZXkuCiAqIAogKiBUaGlzIHNjcmlwdCBuZWVkcyB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgbm90IHdvcmsgcHJvcGVybHkgYXMgaXMuIEl0CiAqIHJlcXVpcmVzIGEgdmFsaWQgT25lVHJ1c3QgS2V5LgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCgovKgogKiBCRUdJTiBTQ1JJUFQgQ09ORklHVVJBVElPTgogKgogKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gT05FVFJVU1QgS0VZCiAqLwp2YXIgT05FVFJVU1RfS0VZID0gIjhhODRlOGNiLWUzZmEtNGQ3YS1iMWFmLTIwMTc5Y2FkZGFiYiI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCnZhciBzY3JpcHQgPSAnJy5jb25jYXQoCiAgCSd2YXIganMxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7XG4nKS5jb25jYXQoCgknanMxLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjtcbicpLmNvbmNhdCgKICAJJ2pzMS5jaGFyc2V0ID0gIlVURi04IjtcbicpLmNvbmNhdCgKCSdqczEuc3JjID0gImh0dHBzOi8vY2RuLmNvb2tpZWxhdy5vcmcvc2NyaXB0dGVtcGxhdGVzL290U0RLU3R1Yi5qcyI7XG4nKS5jb25jYXQoCgknanMxLnNldEF0dHJpYnV0ZSgiZGF0YS1kb21haW4tc2NyaXB0IiwgIicpLmNvbmNhdChPTkVUUlVTVF9LRVkpLmNvbmNhdCgnIik7XG4nKS5jb25jYXQoCgknZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChqczEpO1xuJykuY29uY2F0KAogIAkndmFyIGpzMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO1xuJykuY29uY2F0KAoJJ2pzMi50eXBlID0gInRleHQvamF2YXNjcmlwdCI7XG4nKS5jb25jYXQoCiAgCSdqczIuaW5uZXJIVE1MID0gImZ1bmN0aW9uIE9wdGFub25XcmFwcGVyKCkgeyB9IjtcbicpLmNvbmNhdCgKCSdkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGpzMik7XG4nKQoKdmFyIG91dHB1dCA9IHRydWU7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0cHV0KS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"57807349-630f-496a-bccb-ea1011b8e945\",\"name\":\"MobileOTP: Extract Username, Password, OTP\",\"description\":\"Extract username, password, and OTP from request headers and put them in shared state for validation.\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIk1vYmlsZU9UUDogRXh0cmFjdCBVc2VybmFtZSwgUGFzc3dvcmQsIE9UUDogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgVVNFUk5BTUVfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tVXNlcm5hbWUiOwp2YXIgUEFTU1dPUkRfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tUGFzc3dvcmQiOwp2YXIgT1RQX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLU1vYmlsZU9UUCI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCm91dGNvbWUgPSAiZmFsc2UiOwoKdmFyIHVzZXJuYW1lID0gZ2V0SGVhZGVyKFVTRVJOQU1FX0hFQURFUl9OQU1FKSB8fCBudWxsOwp2YXIgcGFzc3dvcmQgPSBnZXRIZWFkZXIoUEFTU1dPUkRfSEVBREVSX05BTUUpIHx8IG51bGw7CnZhciBtb2JpbGVPVFAgPSBnZXRIZWFkZXIoT1RQX0hFQURFUl9OQU1FKSB8fCBudWxsOwoKaWYgKHVzZXJuYW1lICYmIHBhc3N3b3JkICYmIG1vYmlsZU9UUCkgewogIAlzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgdXNlcm5hbWUpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoInBhc3N3b3JkIiwgcGFzc3dvcmQpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoIm1vYmlsZU9UUCIsIG1vYmlsZU9UUCk7CiAgICBvdXRjb21lID0gInRydWUiOwp9Cgpsb2dnZXIud2FybmluZygiTW9iaWxlT1RQOiBFeHRyYWN0IFVzZXJuYW1lLCBQYXNzd29yZCwgT1RQOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwoKLyoKICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIHJlcXVlc3RlZCBoZWFkZXIKICovCmZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgCWlmIChyZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgJiYgcmVxdWVzdEhlYWRlcnMuZ2V0KGhlYWRlck5hbWUpLmdldCgwKSkgewogICAgCXJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICB9CiAgCXJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b63981d8-cb73-4e47-8749-e58654dcaa31\",\"name\":\"Phone Validator - Line Type\",\"description\":\"This script uses phonevalidator.com to determine the type of phone number stored in the user profile.\",\"script\":\"LyogUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFRoaXMgc2NyaXB0IHVzZXMgcGhvbmV2YWxpZGF0b3IuY29tIHRvIGRldGVybWluZSB0aGUgdHlwZSBvZiBwaG9uZSBudW1iZXIgc3RvcmVkIGluIHRoZSB1c2VyIHByb2ZpbGUuCiAqIEdldCB5b3VyIG93biBBUEkgS2V5IGF0IGh0dHBzOi8vd3d3LnBob25ldmFsaWRhdG9yLmNvbQogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIENFTEwgUEhPTkUKICogLSBMQU5ETElORQogKiAtIFZPSVAKICogLSBUT0xMLUZSRUUKICogLSBVTktOT1dOCiAqIC0gZmFpbGVkCiAqLwpsb2dnZXIud2FybmluZygiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBzdGFydCIpOwoKaWYgKGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIikgfHwgKHNoYXJlZFN0YXRlLmdldCgiX2lkIikgJiYgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAidGVsZXBob25lTnVtYmVyIikuaXRlcmF0b3IoKS5oYXNOZXh0KCkpKSB7CgogICAgLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqCiAgCSAqIFBob25lIFZhbGlkYXRvciAtIExpbmUgVHlwZSBBUEkgQ29uZmlndXJhdGlvbgogIAkgKiBHZXQgeW91ciBvd24gQVBJIEtleSBhdCBodHRwczovL3d3dy5waG9uZXZhbGlkYXRvci5jb20KICAgICAqLwogICAgdmFyIFBWX0FQSV9LRVkgPSAiODQ5ZDU2NGEtNTk0ZC00YmRlLWI2OTEtYWZlNWRkYWRkNTQ3IjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwoKICAJdmFyIFBWX0FQSV9UWVBFID0gImJhc2ljIjsKICAgIHZhciBQVl9BUElfUEhPTkUgPSBnZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoInRlbGVwaG9uZU51bWJlciIpIHx8IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkubmV4dCgpOwogICAgdmFyIFBWX0FQSV9VUkkgPSAiaHR0cHM6Ly93d3cucGhvbmV2YWxpZGF0b3IuY29tL2FwaS92Mi9waG9uZXNlYXJjaD9hcGlrZXk9Ii5jb25jYXQoUFZfQVBJX0tFWSkuY29uY2F0KCImcGhvbmU9IikuY29uY2F0KFBWX0FQSV9QSE9ORSkuY29uY2F0KCImdHlwZT0iKS5jb25jYXQoUFZfQVBJX1RZUEUpOwkKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoUFZfQVBJX1VSSSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwoKICAgIGlmIChyZXN1bHRbIlN0YXR1c0NvZGUiXT09IjIwMCIpIHsKICAgICAgICBvdXRjb21lID0gcmVzdWx0WyJQaG9uZUJhc2ljIl1bIkxpbmVUeXBlIl07CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgIH0KICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBTdGF0dXNDb2RlID0gIi5jb25jYXQocmVzdWx0WyJTdGF0dXNDb2RlIl0pKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBTdGF0dXNNZXNzYWdlID0gIi5jb25jYXQocmVzdWx0WyJTdGF0dXNNZXNzYWdlIl0pKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBvdXRjb21lID0gIi5jb25jYXQob3V0Y29tZSkpOwp9IGVsc2UgewogIAlvdXRjb21lID0gImZhaWxlZCI7CiAgCWxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBObyB1c2VyIG9yIHBob25lIG51bWJlciBmb3VuZCEgVXNlICdJZGVudGlmeSBFeGlzdGluZyBVc2VyIG5vZGUgYmVmb3JlIHRoaXMgc2NyaXB0IHRvIHBvcHVsYXRlIHRoZSB1c2VyJ3MgX2lkIGluIHNoYXJlZCBzdGF0ZSBvciBwdXQgYSB2YWxpZCBjZWxsIHBob25lIG51bWJlciBpbnRvIHNoYXJlZFN0YXRlLm9iamVjdEF0dHJpYnV0ZXMudGVsZXBob25lTnVtYmVyISciKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBvdXRjb21lID0gIi5jb25jYXQob3V0Y29tZSkpOwp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICByZXR1cm4gc3RvcmFnZS5uYW1lOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"df559f35-82b2-4091-9b2a-6329f9c40b95\",\"name\":\"AT_MFAMethod_push\",\"description\":\"This script puts 'push' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdwdXNoJyBpbnRvIHRoZSBhdHRyaWJ1dGUgZnJVbmluZGV4ZWRTdHJpbmcyCiAgLSBIZWFsdGhjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMiA9IGZyLWF0dHItc3RyMiA9IHNtc3xmaWRvfG1haWx8cHVzaCAgTUZBIHR5cGUKICAtIEhlYWx0Y2FyZSBkZW1vOiBmclVuaW5kZXhlZFN0cmluZzMgPSBmci1hdHRyLXN0cjMgPSBNRkEgT3B0LWluID0gYWx3YXlzfG5ld3xuZXZlcnxwYXNzd29yZGxlc3MKICovCgpsb2dnZXIuZXJyb3IoJ0FUX01GQU1ldGhvZF9wdXNoOiBTVEFSVCcpCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3B1c2g6IF9pZCAnICsgdXNlcm5hbWUpOwp2YXIgYXR0cmlidXRlID0gImZyLWF0dHItc3RyMiIKCmlkUmVwb3NpdG9yeS5zZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSwgWyJwdXNoIl0pOwoKCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3B1c2g6IE5ldyB2YWx1ZSBmb3IgJyArIGF0dHJpYnV0ZSArICc6ICcgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKTsKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7dce8f07-d9fe-4752-94b9-ff99dfd0433b\",\"name\":\"Twilio IVR: Parse Call Parameters\",\"description\":\"Parse parameters of the incoming call.\",\"script\":\"LyogVHdpbGlvIElWUiBJbnRlZ3JhdGlvbgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwoKbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFBhcnNlIENhbGwgUGFyYW1ldGVyczogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBUd2lsaW8gSVZSIENvbmZpZ3VyYXRpb24gUGFyYW1ldGVycwogKgogKiBUaGVzZSBhcmUgdXNlZCB0byBwcm90ZWN0IHRoaXMgam91cm5leSBzbyBpdCBpcyBvbmx5IGJlaW5nIGV4ZWN1dGVkIGJ5IHlvdXIgVHdpbGlvIGFjY291bnQuCiAqLwp2YXIgVFdJTElPX0FDQ09VTlRfU0lEID0gIkFDNzUwNDE1ZTMxNjNhMmU1N2I3YWVlYTdlZWQ4MmQ5NDQiOwp2YXIgVFdJTElPX1BIT05FX05VTUJFUiA9ICIrMTMxNzY0NDMxMDciOwoKLy8ga2VlcCB0aGUgcGFyYW1zIHRvIGEgbWluaW11bSB0byBtaW5pbWl6ZSBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIHNpemUKdmFyIGNhbGxQYXJhbXMgPSB7CiAgLy8iQ2FsbFNpZCIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJDYWxsU2lkIikuZ2V0KDApKSwKICAiQWNjb3VudFNpZCIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJBY2NvdW50U2lkIikuZ2V0KDApKSwKICAiRnJvbSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJGcm9tIikuZ2V0KDApKSwKICAiVG8iIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG8iKS5nZXQoMCkpLAogIC8vIkNhbGxTdGF0dXMiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiQ2FsbFN0YXR1cyIpLmdldCgwKSksCiAgLy8iQXBpVmVyc2lvbiIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJBcGlWZXJzaW9uIikuZ2V0KDApKSwKICAvLyJEaXJlY3Rpb24iIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRGlyZWN0aW9uIikuZ2V0KDApKSwKICAvLyJGb3J3YXJkZWRGcm9tIiA6IGRlY29kZVVSSUNvbXBvbmVudChyZXF1ZXN0UGFyYW1ldGVycy5nZXQoIkZvcndhcmRlZEZyb20iKS5nZXQoMCkpLAogIC8vIkNhbGxlck5hbWUiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiQ2FsbGVyTmFtZUNhbGxlck5hbWUiKS5nZXQoMCkpLAogIC8vIlBhcmVudENhbGxTaWQiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiUGFyZW50Q2FsbFNpZCIpLmdldCgwKSksCiAgLy8iRnJvbUNpdHkiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbUNpdHkiKS5nZXQoMCkpLAogIC8vIkZyb21TdGF0ZSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJGcm9tU3RhdGUiKS5nZXQoMCkpLAogIC8vIkZyb21aaXAiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbVppcCIpLmdldCgwKSksCiAgLy8iRnJvbUNvdW50cnkiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbUNvdW50cnkiKS5nZXQoMCkpLAogIC8vIlRvQ2l0eSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJUb0NpdHkiKS5nZXQoMCkpLAogIC8vIlRvU3RhdGUiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG9TdGF0ZSIpLmdldCgwKSksCiAgLy8iVG9aaXAiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG9aaXAiKS5nZXQoMCkpLAogIC8vIlRvQ291bnRyeSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJUb0NvdW50cnkiKS5nZXQoMCkpLAp9OwoKLyogRW5kIFR3aWxpbyBJVlIgQ29uZmlndXJhdGlvbiBQYXJhbWV0ZXJzIAogKi8KCmlmIChjYWxsUGFyYW1zLkFjY291bnRTaWQgPT0gVFdJTElPX0FDQ09VTlRfU0lEICYmCiAgICBjYWxsUGFyYW1zLlRvID09IFRXSUxJT19QSE9ORV9OVU1CRVIpIAp7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgICBzaGFyZWRTdGF0ZS5wdXQoIlR3aWxpb0lWUkNhbGxQYXJhbXMiLCBjYWxsUGFyYW1zKTsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIiwgY2FsbFBhcmFtcy5Gcm9tKTsKfQoKbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFBhcnNlIENhbGwgUGFyYW1ldGVyczogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"790045fa-a325-4e3e-96f8-d4a91b32e9de\",\"name\":\"HIBP Password Breach Analysis\",\"description\":\"Use Have I Been Pwned Password to check if password has been breached.\",\"script\":\"LyogSElCUCBQYXNzd29yZCBCcmVhY2ggQW5hbHlzaXMKICoKICogQXV0aG9yczogam9uLmtuaWdodEBmb3JnZXJvY2suY29tLCB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVXNlIEhhdmUgSSBCZWVuIFB3bmVkIFBhc3N3b3JkIHRvIGNoZWNrIGlmIHBhc3N3b3JkIGhhcyBiZWVuIGJyZWFjaGVkLgogKiBDYWxscyBISUJQIEFQSSB0byByZXRyaWV2ZSB0aGUgY291bnQgb2YgbWF0Y2hpbmcgcGFzc3dvcmRzIGluIGJyZWFjaGVkIAogKiBwYXNzd29yZCBkYXRhYmFzZQogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIFBhc3N3b3JkIG9yIFBsYXRmb3JtIFBhc3N3b3JkIGNvbGxlY3RvciBub2RlcyBiZWZvcmUKICogaXQgY2FuIG9wZXJhdGUuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gY2xlYXIKICogICBUaGUgbnVtYmVyIG9mIGJyZWFjaGVzIGZvciBwYXNzd29yZCB3YXMgZWl0aGVyIHplcm8gb3IgbGVzcyB0aGFuIHRoZSAKICogICB2YWx1ZSBvZiBUSFJFU0hPTEQKICogLSBicmVhY2hlZCAKICogICBUaGUgbnVtYmVyIG9mIGluY2lkZW50cyBvZiB0aGUgcGFzc3dvcmQgaW4gdGhlIGJyZWFjaGVkIHBhc3N3b3JkIAogKiAgIGRhdGFiYXNlIGV4Y2VlZHMgVEhSRVNIT0xECiAqIC0gZmFpbGVkCiAqICAgVGhlIEFQSSBjYWxsIHdhcyByZWplY3RlZC4KICovCihmdW5jdGlvbiAoKSB7CiAgICB2YXIgVVNFUl9BR0VOVD0iRm9yZ2VSb2NrIjsKICAJLy8gUGxlYXNlIHJlcGxhY2Ugd2l0aCB5b3VyIEhJQlAga2V5CiAgICB2YXIgSElCUF9BUElfS0VZPSIxMWJlNWQ4NjgxMmE0OTNkOWNiYmVjOGM3MmQ2NWZjOCI7CiAgICB2YXIgVEhSRVNIT0xEPTA7CgogICAgZnVuY3Rpb24gdG9IZXhTdHJpbmcoYnl0ZUFycmF5KSB7CiAgICAgICAgdmFyIHMgPSAnJzsKICAgICAgICBieXRlQXJyYXkuZm9yRWFjaChmdW5jdGlvbihieXRlKSB7CiAgICAgICAgICAgIHMgKz0gKCcwJyArIChieXRlICYgMHhGRikudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CgogICAgb3V0Y29tZSA9ICJmYWlsZWQiOwoKICAgIHZhciBtZCA9IGphdmEuc2VjdXJpdHkuTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZSgnU0hBLTEnKTsKICAJdmFyIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwovLyAgCXZhciBwYXNzd29yZCA9IG5ldyBqYXZhLmxhbmcuU3RyaW5nKCIiKTsKLy8gIAlpZiAobm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKSkgewovLyAgICAgIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwovLyAgICB9CiAgICB2YXIgYnl0ZUFycmF5ID0gcGFzc3dvcmQuZ2V0Qnl0ZXMoIlVURi04Iik7CiAgICBtZC51cGRhdGUoYnl0ZUFycmF5KTsKICAgIHZhciBkaWdlc3QgPSBtZC5kaWdlc3QoKTsKICAgIHZhciBoZXggPSBTdHJpbmcodG9IZXhTdHJpbmcoZGlnZXN0KSkudG9VcHBlckNhc2UoKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoJ2h0dHBzOi8vYXBpLnB3bmVkcGFzc3dvcmRzLmNvbS9yYW5nZS8nICsgaGV4LnN1YnN0cmluZygwLDUpKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQWNjZXB0IiwiKi8qIik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsImFwcGxpY2F0aW9uL2pzb24iKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiVXNlci1BZ2VudCIsIFVTRVJfQUdFTlQpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJoaWJwLWFwaS1rZXkiLCBISUJQX0FQSV9LRVkpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKCiAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkuZ2V0Q29kZSgpID09PSAyMDApIHsKICAgICAgICB2YXIgbWF4ID0gMDsKICAgICAgICBvdXRjb21lID0gImNsZWFyIjsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCk7CiAgICAgICAgdmFyIGxpbmVzID0gcmVzdWx0LnNwbGl0KCdcbicpOwogICAgICAgIGZvciAoaT0wOyBpPGxpbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwcmVmaXggPSBsaW5lc1tpXS5zcGxpdCgnOicpWzBdOwogICAgICAgICAgICBpZiAoU3RyaW5nKGhleC5zdWJzdHJpbmcoMCw1KSArIHByZWZpeCkgPT0gaGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBsaW5lc1tpXS5zcGxpdCgnOicpWzFdOwogICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4KSBtYXggPSBjb3VudDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWF4ID4gVEhSRVNIT0xEKSBvdXRjb21lID0gImJyZWFjaGVkIjsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoImhpYnBfcGFzc3dvcmRfY291bnQiLCBtYXgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b2277f93-01e0-45c7-b23c-7fab2d5b49b4\",\"name\":\"Store Old Name\",\"description\":\"null\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJ1c2VyTmFtZSIpCnZhciByZXN1bHQgPSB1c2VyTmFtZTsKCmxvZ2dlci5lcnJvcigicmVzdWx0ID0gIiArIHJlc3VsdCk7CgovL29iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIsIHJlc3VsdCkKb2JqZWN0QXR0cmlidXRlcy5wdXQoImZyVW5pbmRleGVkU3RyaW5nMSIscmVzdWx0KQpzaGFyZWRTdGF0ZS5wdXQoImZyVW5pbmRleGVkU3RyaW5nMSIscmVzdWx0KQoKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0QXR0cmlidXRlcyk7CgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5dbd53c6-67ff-4a43-84c3-90c5cf5da35a\",\"name\":\"OTP Valid\",\"description\":\"Return TextOutputCallback indicating the provided OTP was valid.\",\"script\":\"LyogT1RQIFZhbGlkCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJldHVybiBUZXh0T3V0cHV0Q2FsbGJhY2sgaW5kaWNhdGluZyB0aGUgcHJvdmlkZWQgT1RQIHdhcyB2YWxpZC4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopCmlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICJWQUxJRCIKICAgICAgICApCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b1fd9b38-fc54-46c6-9199-3d0de0abfaee\",\"name\":\"Display ESV\",\"description\":\"Display the value of an ESV\",\"script\":\"LyoKICogQmVnaW4gY29uZmlndXJhdGlvbgogKgogKiBNb2RpZnkgdGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgdG8gYWRhcHQgdG8geW91ciBuZWVkcwogKi8KCi8vIFNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheS4gWW91IG1heSB1c2UgSFRNTCBmb3IgZm9ybWF0dGluZy4gQXZvaWQgbGluZSBicmVha3MhIFVzZSA8YnI+IGluc3RlYWQuCnZhciBtZXNzYWdlID0gIjxoNT4iLmNvbmNhdChzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5hZG1pbi50b2tlbiIpKS5jb25jYXQoIjwvaDU+IikKCi8vIENob29zZSB0aGUgaG9yaXpvbnRhbCBhbGlnbm1lbnQgb2YgeW91ciBtZXNzYWdlLiBVc2UgbGVmdCwgY2VudGVyLCByaWdodC4KdmFyIGhhbGlnbiA9ICJsZWZ0IjsKLyoKICogRW5kIGNvbmZpZ3VyYXRpb24KICovCgp2YXIgb3V0cHV0ID0gdHJ1ZTsKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIn0pIikKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopCmlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGFuY2hvcgogICAgICAgICksCiAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygidHJ1ZSIpLmJ1aWxkKCk7Cn0KCiAvKgogICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAqIAogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"f995b849-02c0-4b30-b8eb-e8dba1dd3454\",\"name\":\"AT_MFAMethod_mail\",\"description\":\"This script puts 'mail' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX21haWw6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfbWFpbDogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm1haWwiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfbWFpbDogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8862ca8f-7770-4af5-a888-ac0df0947f36\",\"name\":\"LinkedIn Profile Normalization\",\"description\":\"Normalizes raw profile data from LinkedIn\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5maXJzdE5hbWUubG9jYWxpemVkLmdldCgwKSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmxhc3ROYW1lLmxvY2FsaXplZC5nZXQoMCkpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucHJvZmlsZVBpY3R1cmUuZGlzcGxheUltYWdlKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVsZW1lbnRzLmdldCgwKS5nZXQoImhhbmRsZX4iKS5lbWFpbEFkZHJlc3MpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZWxlbWVudHMuZ2V0KDApLmdldCgiaGFuZGxlfiIpLmVtYWlsQWRkcmVzcykpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"312e951f-70c5-49d2-a9ae-93aef909d5df\",\"name\":\"Salesforce Profile Normalization\",\"description\":\"Normalizes raw profile data from Salesforce\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJfaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIHJhd1Byb2ZpbGUuZ2l2ZW5fbmFtZSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmZhbWlseV9uYW1lKSwKICAgICAgICBmaWVsZCgicGhvdG9VcmwiLCByYXdQcm9maWxlLnBpY3R1cmUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJsb2NhbGUiLCByYXdQcm9maWxlLnpvbmVJbmZvKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"0cf351ab-e656-4c39-833b-88195f7fc738\",\"name\":\"AT_DebugSharedState - imported (1)\",\"description\":\"Debug Shared State to callbacks.\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIFNjcmlwdCB0byBkaXNwbGF5IHNoYXJlZFN0YXRlIGluIEludGVsbGlnZW50IEFjY2VzcyBKb3VybmV5IGZvciBkZWJ1Z2dpbmcKICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwpvdXRjb21lID0gInRydWUiOwp3aXRoIChmcikgewogIGlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICB2YXIgY2FsbGJhY2sgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgInNoYXJlZFN0YXRlOiAiLmNvbmNhdChzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIlxudHJhbnNpZW50U3RhdGU6ICIpLmNvbmNhdCh0cmFuc2llbnRTdGF0ZS50b1N0cmluZygpKSk7CiAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChjYWxsYmFjaykuYnVpbGQoKTsKICB9IGVsc2UgewogICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1550ad56-df9f-4dad-9803-6c3a2545d8f4\",\"name\":\"Set Theme from URL\",\"description\":\"Detect and preserve currently active theme before setting new theme from query param in the request URL.\",\"script\":\"LyogU2V0IFRoZW1lIGZyb20gVVJMCiAqIAogKiBEZXRlY3QgYW5kIHByZXNlcnZlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWUgYmVmb3JlIHNldHRpbmcgbmV3IHRoZW1lIGZyb20gcXVlcnkgcGFyYW0gaW4gdGhlIHJlcXVlc3QgVVJMLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCQogIAl2YXIgdGhlbWUgPSAiIjsKICAJaWYgKHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgidGhlbWVJZCIpKSB7CiAgICAgIAl0aGVtZSA9IHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgidGhlbWVJZCIpLmdldCgwKTsKICAgIH0KCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIG5vIHRoZW1lIHNldCwgZGlzY292ZXIgYWN0aXZlIHRoZW1lIGZyb20gVUkKICAgIGlmICghdGhlbWUgJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjawogIAllbHNlIGlmICghdGhlbWUgJiYgY2FsbGJhY2tzLnNpemUoKSA9PT0gMikgewogICAgICAgIC8vIGRpZCB3ZSBnZXQgdGhlIGlkIG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIHRoZW1lPwogICAgICAgIGlmIChjYWxsYmFja3MuZ2V0KDApLmdldFZhbHVlKCkgIT09ICJ0aGVtZS1pZC0iK2FuY2hvcikgewogICAgICAgICAgCXNoYXJlZFN0YXRlLnB1dCgidGhlbWVJZCIsIGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSk7CiAgICAgICAgfQogICAgfQogIAkvLyB0aGVtZSByZXF1ZXN0ZWQgaW4gVVJMLCBzZXQgaXQgYW5kIHByZXNlcnZlIGl0CiAgCWVsc2UgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgCS8vIHByZXNlcnZlIHRoZW1lIGluIHNoYXJlZCBzdGF0ZQogICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgdGhlbWUpOwogICAgICAgIC8vIHNldCBuZXcgdGhlbWUKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0KICAJZWxzZSB7CiAgICAgICAgLy8gY29udGludWUKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"9de3eb62-f131-4fac-a294-7bd170fd4acb\",\"name\":\"Scripted Policy Condition\",\"description\":\"Default global script for Scripted Policy Conditions\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTUtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCi8qKgogKiBUaGlzIGlzIGEgUG9saWN5IENvbmRpdGlvbiBleGFtcGxlIHNjcmlwdC4gSXQgZGVtb25zdHJhdGVzIGhvdyB0byBhY2Nlc3MgYSB1c2VyJ3MgaW5mb3JtYXRpb24sCiAqIHVzZSB0aGF0IGluZm9ybWF0aW9uIGluIGV4dGVybmFsIEhUVFAgY2FsbHMgYW5kIG1ha2UgYSBwb2xpY3kgZGVjaXNpb24gYmFzZWQgb24gdGhlIG91dGNvbWUuCiAqLwoKdmFyIHVzZXJBZGRyZXNzLCB1c2VySVAsIHJlc291cmNlSG9zdDsKCmlmICh2YWxpZGF0ZUFuZEluaXRpYWxpemVQYXJhbWV0ZXJzKCkpIHsKCiAgICB2YXIgY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9IGdldENvdW50cnlGcm9tVXNlckFkZHJlc3MoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJDb3VudHJ5IHJldHJpZXZlZCBmcm9tIHVzZXIncyBhZGRyZXNzOiAiICsgY291bnRyeUZyb21Vc2VyQWRkcmVzcyk7CiAgICB2YXIgY291bnRyeUZyb21Vc2VySVAgPSBnZXRDb3VudHJ5RnJvbVVzZXJJUCgpOwogICAgbG9nZ2VyLm1lc3NhZ2UoIkNvdW50cnkgcmV0cmlldmVkIGZyb20gdXNlcidzIElQOiAiICsgY291bnRyeUZyb21Vc2VySVApOwogICAgdmFyIGNvdW50cnlGcm9tUmVzb3VyY2VVUkkgPSBnZXRDb3VudHJ5RnJvbVJlc291cmNlVVJJKCk7CiAgICBsb2dnZXIubWVzc2FnZSgiQ291bnRyeSByZXRyaWV2ZWQgZnJvbSByZXNvdXJjZSBVUkk6ICIgKyBjb3VudHJ5RnJvbVJlc291cmNlVVJJKTsKCiAgICBpZiAoY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9PT0gY291bnRyeUZyb21Vc2VySVAgJiYgY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9PT0gY291bnRyeUZyb21SZXNvdXJjZVVSSSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBdXRob3JpemF0aW9uIFN1Y2NlZWRlZCIpOwogICAgICAgIHJlc3BvbnNlQXR0cmlidXRlcy5wdXQoImNvdW50cnlPZk9yaWdpbiIsIFtjb3VudHJ5RnJvbVVzZXJBZGRyZXNzXSk7CiAgICAgICAgYXV0aG9yaXplZCA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBdXRob3JpemF0aW9uIEZhaWxlZCIpOwogICAgICAgIGF1dGhvcml6ZWQgPSBmYWxzZTsKICAgIH0KCn0gZWxzZSB7CiAgICBsb2dnZXIubWVzc2FnZSgiUmVxdWlyZWQgcGFyYW1ldGVycyBub3QgZm91bmQuIEF1dGhvcml6YXRpb24gRmFpbGVkLiIpOwogICAgYXV0aG9yaXplZCA9IGZhbHNlOwp9CgovKioKICogVXNlIHRoZSB1c2VyJ3MgYWRkcmVzcyB0byBsb29rdXAgdGhlaXIgY291bnRyeSBvZiByZXNpZGVuY2UuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgdXNlcidzIGNvdW50cnkgb2YgcmVzaWRlbmNlLgogKi8KZnVuY3Rpb24gZ2V0Q291bnRyeUZyb21Vc2VyQWRkcmVzcygpIHsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRVcmkoImh0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9hZGRyZXNzPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXNlckFkZHJlc3MpKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgZ2VvY29kZSA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgZ2VvY29kZS5yZXN1bHRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IGdlb2NvZGUucmVzdWx0c1tpXTsKICAgICAgICB2YXIgajsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgcmVzdWx0LmFkZHJlc3NfY29tcG9uZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAocmVzdWx0LmFkZHJlc3NfY29tcG9uZW50c1tpXS50eXBlc1swXSA9PSAiY291bnRyeSIpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuYWRkcmVzc19jb21wb25lbnRzW2ldLmxvbmdfbmFtZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIFVzZSB0aGUgdXNlcidzIElQIHRvIGxvb2t1cCB0aGUgY291bnRyeSBmcm9tIHdoaWNoIHRoZSByZXF1ZXN0IG9yaWdpbmF0ZWQuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgY291bnRyeSBmcm9tIHdoaWNoIHRoZSByZXF1ZXN0IG9yaWdpbmF0ZWQuCiAqLwpmdW5jdGlvbiBnZXRDb3VudHJ5RnJvbVVzZXJJUCgpIHsKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iICsgdXNlcklQKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdC5jb3VudHJ5OwogICAgfQp9CgovKioKICogVXNlIHRoZSByZXF1ZXN0ZWQgcmVzb3VyY2UncyBob3N0IG5hbWUgdG8gbG9va3VwIHRoZSBjb3VudHJ5IHdoZXJlIHRoZSByZXNvdXJjZSBpcyBob3N0ZWQuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgY291bnRyeSBpbiB3aGljaCB0aGUgcmVzb3VyY2UgaXMgaG9zdGVkLgogKi8KZnVuY3Rpb24gZ2V0Q291bnRyeUZyb21SZXNvdXJjZVVSSSgpIHsKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iICsgZW5jb2RlVVJJQ29tcG9uZW50KHJlc291cmNlSG9zdCkpOwogIAlyZXF1ZXN0LnNldE1ldGhvZCgiR0VUIik7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgbG9nUmVzcG9uc2UocmVzcG9uc2UpOwoKICAgIHZhciByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gcmVzdWx0LmNvdW50cnk7CiAgICB9Cn0KCi8qKgogKiBSZXRyaWV2ZSBhbmQgdmFsaWRhdGUgdGhlIHZhcmlhYmxlcyByZXF1aXJlZCB0byBtYWtlIHRoZSBleHRlcm5hbCBIVFRQIGNhbGxzLgogKgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2lsbCBiZSB0cnVlIGlmIHZhbGlkYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAqLwpmdW5jdGlvbiB2YWxpZGF0ZUFuZEluaXRpYWxpemVQYXJhbWV0ZXJzKCkgewogICAgdmFyIHVzZXJBZGRyZXNzU2V0ID0gaWRlbnRpdHkuZ2V0QXR0cmlidXRlKCJwb3N0YWxBZGRyZXNzIik7CiAgICBpZiAodXNlckFkZHJlc3NTZXQgPT0gbnVsbCB8fCB1c2VyQWRkcmVzc1NldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gYWRkcmVzcyBzcGVjaWZpZWQgZm9yIHVzZXI6ICIgKyB1c2VybmFtZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdXNlckFkZHJlc3MgPSB1c2VyQWRkcmVzc1NldC5pdGVyYXRvcigpLm5leHQoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyIGFkZHJlc3M6ICIgKyB1c2VyQWRkcmVzcyk7CgogICAgaWYgKCFlbnZpcm9ubWVudCkgewogICAgICAgIGxvZ2dlci53YXJuaW5nKCJObyBlbnZpcm9ubWVudCBwYXJhbWV0ZXJzIHNwZWNpZmllZCBpbiB0aGUgZXZhbHVhdGlvbiByZXF1ZXN0LiIpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB2YXIgaXBTZXQgPSBlbnZpcm9ubWVudC5nZXQoIklQIik7CiAgICBpZiAoaXBTZXQgPT0gbnVsbCB8fCBpcFNldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gSVAgc3BlY2lmaWVkIGluIHRoZSBldmFsdWF0aW9uIHJlcXVlc3QgZW52aXJvbm1lbnQgcGFyYW1ldGVycy4iKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB1c2VySVAgPSBpcFNldC5pdGVyYXRvcigpLm5leHQoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyIElQOiAiICsgdXNlcklQKTsKCiAgICBpZiAoIXJlc291cmNlVVJJKSB7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIk5vIHJlc291cmNlIFVSSSBzcGVjaWZpZWQuIik7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmVzb3VyY2VIb3N0ID0gcmVzb3VyY2VVUkkubWF0Y2goL14oLio6XC9cLykod3d3XC4pPyhbQS1aYS16MC05XC1cLl0rKSg6WzAtOV0rKT8oLiopJC8pWzNdOwogICAgbG9nZ2VyLm1lc3NhZ2UoIlJlc291cmNlIGhvc3Q6ICIgKyByZXNvdXJjZUhvc3QpOwoKICAgIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBsb2dSZXNwb25zZShyZXNwb25zZSkgewogICAgbG9nZ2VyLm1lc3NhZ2UoIlVzZXIgUkVTVCBDYWxsLiBTdGF0dXM6ICIgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICIsIEJvZHk6ICIgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7Cn0=\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"POLICY_CONDITION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"dbe0bf9a-72aa-49d5-8483-9db147985a47\",\"name\":\"ADFS Profile Normalization (JS)\",\"description\":\"Normalizes raw profile data from ADFS\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCByZXR1cm5zIHRoZSBzb2NpYWwgaWRlbnRpdHkgcHJvZmlsZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGF1dGhlbnRpY2F0aW5nIHVzZXIKICogaW4gYSBzdGFuZGFyZCBmb3JtIGV4cGVjdGVkIGJ5IHRoZSBTb2NpYWwgUHJvdmlkZXIgSGFuZGxlciBOb2RlLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogcmF3UHJvZmlsZSAtIFRoZSBzb2NpYWwgaWRlbnRpdHkgcHJvdmlkZXIgcHJvZmlsZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGF1dGhlbnRpY2F0aW5nIHVzZXIuCiAqICAgICAgICAgICAgICBKc29uVmFsdWUgKDEpLgogKiBsb2dnZXIgLSBUaGUgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiByZWFsbSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICBUaGUgbmFtZSBvZiB0aGUgcmVhbG0gdGhlIHVzZXIgaXMgYXV0aGVudGljYXRpbmcgdG8uCiAqIHJlcXVlc3RIZWFkZXJzIC0gVHJlZU1hcCAoMikuCiAqICAgICAgICAgICAgICAgICAgVGhlIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgZm9yIGFjY2Vzc2luZyBoZWFkZXJzIGluIHRoZSBsb2dpbiByZXF1ZXN0OgogKiAgICAgICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2F1dGhlbnRpY2F0aW9uLWd1aWRlL3NjcmlwdGluZy1hcGktbm9kZS5odG1sI3NjcmlwdGluZy1hcGktbm9kZS1yZXF1ZXN0SGVhZGVycy4KICogcmVxdWVzdFBhcmFtZXRlcnMgLSBUcmVlTWFwICgyKS4KICogICAgICAgICAgICAgICAgICAgICBUaGUgb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGF1dGhlbnRpY2F0aW9uIHJlcXVlc3QgcGFyYW1ldGVycy4KICogc2VsZWN0ZWRJZHAgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICAgVGhlIHNvY2lhbCBpZGVudGl0eSBwcm92aWRlciBuYW1lLiBGb3IgZXhhbXBsZTogZ29vZ2xlLgogKiBzaGFyZWRTdGF0ZSAtIExpbmtlZEhhc2hNYXAgKDMpLgogKiAgICAgICAgICAgICAgIFRoZSBvYmplY3QgdGhhdCBob2xkcyB0aGUgc3RhdGUgb2YgdGhlIGF1dGhlbnRpY2F0aW9uIHRyZWUgYW5kIGFsbG93cyBkYXRhIGV4Y2hhbmdlIGJldHdlZW4gdGhlIHN0YXRlbGVzcyBub2RlczoKICogICAgICAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hdXRoLW5vZGVzL2NvcmUtYWN0aW9uLmh0bWwjYWNjZXNzaW5nLXRyZWUtc3RhdGUuCiAqIHRyYW5zaWVudFN0YXRlIC0gTGlua2VkSGFzaE1hcCAoMykuCiAqICAgICAgICAgICAgICAgICAgVGhlIG9iamVjdCBmb3Igc3RvcmluZyBzZW5zaXRpdmUgaW5mb3JtYXRpb24gdGhhdCBtdXN0IG5vdCBsZWF2ZSB0aGUgc2VydmVyIHVuZW5jcnlwdGVkLAogKiAgICAgICAgICAgICAgICAgIGFuZCB0aGF0IG1heSBub3QgbmVlZCB0byBwZXJzaXN0IGJldHdlZW4gYXV0aGVudGljYXRpb24gcmVxdWVzdHMgZHVyaW5nIHRoZSBhdXRoZW50aWNhdGlvbiBzZXNzaW9uOgogKiAgICAgICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2F1dGgtbm9kZXMvY29yZS1hY3Rpb24uaHRtbCNhY2Nlc3NpbmctdHJlZS1zdGF0ZS4KICoKICogUmV0dXJuIC0gYSBKc29uVmFsdWUgKDEpLgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqCiAqICAgICAgICAgIFRoaXMgc2NyaXB0J3MgbGFzdCBzdGF0ZW1lbnQgc2hvdWxkIHJlc3VsdCBpbiBhIEpzb25WYWx1ZSAoMSkgd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6CiAqICAgICAgICAgIHsKICogICAgICAgICAgICAgIHsiZGlzcGxheU5hbWUiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiZW1haWwiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiZmFtaWx5TmFtZSI6ICJjb3JyZXNwb25kaW5nLXNvY2lhbC1pZGVudGl0eS1wcm92aWRlci12YWx1ZSJ9LAogKiAgICAgICAgICAgICAgeyJnaXZlbk5hbWUiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiaWQiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsibG9jYWxlIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0sCiAqICAgICAgICAgICAgICB7InBob3RvVXJsIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0sCiAqICAgICAgICAgICAgICB7InVzZXJuYW1lIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0KICogICAgICAgICAgfQogKgogKiAgICAgICAgICBUaGUgY29uc3VtZXIgb2YgdGhpcyBkYXRhIGRlZmluZXMgd2hpY2gga2V5cyBhcmUgcmVxdWlyZWQgYW5kIHdoaWNoIGFyZSBvcHRpb25hbC4KICogICAgICAgICAgRm9yIGV4YW1wbGUsIHRoZSBzY3JpcHQgYXNzb2NpYXRlZCB3aXRoIHRoZSBTb2NpYWwgUHJvdmlkZXIgSGFuZGxlciBOb2RlIGFuZCwKICogICAgICAgICAgdWx0aW1hdGVseSwgdGhlIG1hbmFnZWQgb2JqZWN0IGNyZWF0ZWQvdXBkYXRlZCB3aXRoIHRoaXMgZGF0YQogKiAgICAgICAgICB3aWxsIGV4cGVjdCBjZXJ0YWluIGtleXMgdG8gYmUgcG9wdWxhdGVkLgogKiAgICAgICAgICBJbiBzb21lIGNvbW1vbiBkZWZhdWx0IGNvbmZpZ3VyYXRpb25zLCB0aGUgZm9sbG93aW5nIGtleXMgYXJlIHJlcXVpcmVkIHRvIGJlIG5vdCBlbXB0eToKICogICAgICAgICAgdXNlcm5hbWUsIGdpdmVuTmFtZSwgZmFtaWx5TmFtZSwgZW1haWwuCiAqCiAqICAgICAgICAgIEZyb20gUkZDNDUxNzogQSB2YWx1ZSBvZiB0aGUgRGlyZWN0b3J5IFN0cmluZyBzeW50YXggaXMgYSBzdHJpbmcgb2Ygb25lIG9yIG1vcmUKICogICAgICAgICAgYXJiaXRyYXJ5IGNoYXJhY3RlcnMgZnJvbSB0aGUgVW5pdmVyc2FsIENoYXJhY3RlciBTZXQgKFVDUykuCiAqICAgICAgICAgIEEgemVyby1sZW5ndGggY2hhcmFjdGVyIHN0cmluZyBpcyBub3QgcGVybWl0dGVkLgogKgogKiAoMSkgSnNvblZhbHVlIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL2pzb24vSnNvblZhbHVlLmh0bWwuCiAqICgyKSBUcmVlTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9UcmVlTWFwLmh0bWwuCiAqICgzKSBMaW5rZWRIYXNoTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqLwoKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZQogICAgKTsKCiAgICB2YXIgbm9ybWFsaXplZFByb2ZpbGVEYXRhID0gZnJKYXZhLkpzb25WYWx1ZS5qc29uKGZySmF2YS5Kc29uVmFsdWUub2JqZWN0KCkpOwogIAogICAgICAvL2xvZ2dlci5tZXNzYWdlKCdTZWd1aW4gcmF3UHJvZmlsZTogJytyYXdQcm9maWxlKTsKCiAgICBub3JtYWxpemVkUHJvZmlsZURhdGEucHV0KCdpZCcsIHJhd1Byb2ZpbGUuZ2V0KCdzdWInKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2Rpc3BsYXlOYW1lJywgcmF3UHJvZmlsZS5nZXQoJ2dpdmVuTmFtZScpLmFzU3RyaW5nKCkgKyAnICcgKyByYXdQcm9maWxlLmdldCgnc24nKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2VtYWlsJywgcmF3UHJvZmlsZS5nZXQoJ21haWwnKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2dpdmVuTmFtZScsIHJhd1Byb2ZpbGUuZ2V0KCdnaXZlbk5hbWUnKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2ZhbWlseU5hbWUnLCByYXdQcm9maWxlLmdldCgnc24nKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ3VzZXJuYW1lJywgcmF3UHJvZmlsZS5nZXQoJ3VwbicpLmFzU3RyaW5nKCkpOwogICAgbm9ybWFsaXplZFByb2ZpbGVEYXRhLnB1dCgncm9sZXMnLCByYXdQcm9maWxlLmdldCgncm9sZXMnKS5hc1N0cmluZygpKTsKICAKICAgICAgLy9sb2dnZXIubWVzc2FnZSgnU2VndWluIG5vcm1hbGl6ZWRQcm9maWxlRGF0YTogJytub3JtYWxpemVkUHJvZmlsZURhdGEpOwoKICAgIHJldHVybiBub3JtYWxpemVkUHJvZmlsZURhdGE7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"9f9814f6-a13d-4ad9-b954-8fca5ba5efaf\",\"name\":\"AT_IdDataWebSocialPolicyDecision\",\"description\":\"Script to validate that ID DataWeb Identity Proofing passed.\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiBVc2UuIAogKiBNb2RpZmllZCBieSBTdGVwaGVuIFBheW5lCiAqIEFUX0lkRGF0YVdlYlNvY2lhbFBvbGljeURlY2lzaW9uLCBTY3JpcHQgdG8gdmFsaWRhdGUgdGhhdCBJRCBEYXRhV2ViIElkZW50aXR5IFByb29maW5nIHBhc3NlZC4gCiAqLwovKiAqLwoKbG9nZ2VyLmVycm9yKCJBVF9JZERhdGFXZWJTb2NpYWxQb2xpY3lEZWNpc2lvbiA6IHN0YXJ0Iik7Cm91dGNvbWUgPSAiZXJyb3IiOwoKdmFyIFByb29mUmVzdWx0cyA9IHNoYXJlZFN0YXRlLmdldCgiY2xhaW1zX3NldCIpLmdldCgicG9saWN5RGVjaXNpb24iKTsKdmFyIFByb29mU2NvcmUgPSBzaGFyZWRTdGF0ZS5nZXQoImNsYWltc19zZXQiKS5nZXQoImlkd1Jpc2tTY29yZSIpOwoKaWYgKFByb29mUmVzdWx0cyA9PSBudWxsICkgewogIG91dGNvbWUgPSAibnVsbCI7Cn0KZWxzZSBpZiAoUHJvb2ZSZXN1bHRzID0gImFwcHJvdmUiICkgewogIG91dGNvbWUgPSAiYXBwcm92ZSI7CiAgc2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZEludGVnZXIxIiwyKTsKICBzZXRPYmplY3RBdHRyaWJ1dGUoImZyVW5pbmRleGVkU3RyaW5nMSIsICJpZGRhdGF3ZWIgcmVzdWx0OiAiICsgUHJvb2ZSZXN1bHRzICsgIiBpZGRhdHdlYiBzY29yZTogIiArIFByb29mU2NvcmUpOwp9CmVsc2UgaWYgKFByb29mUmVzdWx0cyA9ICJkZW55IiApIHsKICBvdXRjb21lID0gImRlbnkiOwp9CmVsc2UgewogIG91dGNvbWUgPSAiZXJyb3IiCn0KCmZ1bmN0aW9uIHNldE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgICAgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KG5hbWUsIHZhbHVlKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"31142dea-c9af-4e31-916b-37076dcbffbf\",\"name\":\"AT_MFAMethod_oath\",\"description\":\"Script that puts \\\"oath\\\" in the fr-attr-str2 attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX29hdGg6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfb2F0aDogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm9hdGgiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfb2F0aDogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1244e639-4a31-401d-ab61-d75133d8dc9e\",\"name\":\"Instagram Profile Normalization\",\"description\":\"Normalizes raw profile data from Instagram\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"aaaea08e-aaf5-4848-84d6-7fe105de8934\",\"name\":\"AT_Optin-Never\",\"description\":\"The script puts \\\"never\\\" into the MFA Opt-in attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICduZXZlcicgaW50byB0aGUgYXR0cmlidXRlIGZyVW5pbmRleGVkU3RyaW5nMwogIC0gSGVhbHRoY2FyZSBkZW1vOiBmclVuaW5kZXhlZFN0cmluZzIgPSBmci1hdHRyLXN0cjIgPSBzbXN8Zmlkb3xtYWlsfHB1c2ggIE1GQSB0eXBlCiAgLSBIZWFsdGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmczID0gZnItYXR0ci1zdHIzID0gTUZBIE9wdC1pbiA9IGFsd2F5c3xuZXd8bmV2ZXJ8cGFzc3dvcmRsZXNzCiAqLwoKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKQpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBfaWQgJyArIHVzZXJuYW1lKTsKdmFyIGF0dHJpYnV0ZSA9ICJmci1hdHRyLXN0cjMiCgppZFJlcG9zaXRvcnkuc2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUsIFsibmV2ZXIiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8a768bb3-01cd-46b8-881c-b77f5a26c283\",\"name\":\"Onfido-Meta-Tags\",\"description\":\"Write Onfido HTML Meta Tags\",\"script\":\"LyogV3JpdGUgSFRNTCBNZXRhIFRhZ3MKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd3JpdGVzIG1ldGEgdGFncyB0byB0aGUgaGVhZGVyLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICkKCiAgZnVuY3Rpb24gY3JlYXRlU2NyaXB0KCkgewogICAgcmV0dXJuIFN0cmluZygiXG5cCiAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcblwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVxuXAogICAgKS5mb3JFYWNoKFxuXAogICAgICBmdW5jdGlvbiAoZSkge1xuXAogICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOyBcblwKICAgICAgICBtZXRhLm5hbWUgPSBcImF1dGhvclwiOyBcblwKICAgICAgICBtZXRhLmNvbnRlbnQgPSBcIkpvaG4gRG9lXCI7IFxuXAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobWV0YSk7IFxuXAogICAgICB9XG5cCiAgICApIik7CiAgfQoKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soY3JlYXRlU2NyaXB0KCkpCiAgICAgICkuYnVpbGQoKQogIH0gZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"355a8b7c-9e3c-40c1-a873-68127e483adf\",\"name\":\"KerberosLogin: Extract Username\",\"description\":\"Extract Username from request.\",\"script\":\"LyogS2VyYmVyb3NMb2dpbjogRXh0cmFjdCBVc2VybmFtZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8KCmxvZ2dlci53YXJuaW5nKCJLZXJiZXJvc0xvZ2luOiBFeHRyYWN0IFVzZXJuYW1lOiBzdGFydCIpOwpvdXRjb21lID0gImZhbHNlIjsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgVVNFUk5BTUVfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tVXNlcm5hbWUiOwovKgogKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICovCgp2YXIgdXNlcm5hbWUgPSBnZXRIZWFkZXIoVVNFUk5BTUVfSEVBREVSX05BTUUpOwppZiAodXNlcm5hbWUpIHsKCQogIAlvdXRjb21lID0gInRydWUiOwogICAgc2hhcmVkU3RhdGUucHV0KCJ1c2VybmFtZSIsIHVzZXJuYW1lKTsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCB1c2VybmFtZSk7Cn0KCmxvZ2dlci53YXJuaW5nKCJLZXJiZXJvc0xvZ2luOiBFeHRyYWN0IFVzZXJuYW1lOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwoKLyoKICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIHJlcXVlc3RlZCBoZWFkZXIKICovCmZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgCWlmIChyZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgJiYgcmVxdWVzdEhlYWRlcnMuZ2V0KGhlYWRlck5hbWUpLmdldCgwKSkgewogICAgCXJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICB9CiAgCXJldHVybiBudWxsOwp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHN0b3JhZ2UucHV0KSB7CgkgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d6469639-249f-4df1-9e03-335cd3e37b3d\",\"name\":\"Get Email\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJHZXQgRW1haWw6IHN0YXJ0Iik7Cm91dGNvbWUgPSAidHJ1ZSI7CmlmIChnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCBnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikpOwp9CmxvZ2dlci5lcnJvcigiR2V0IEVtYWlsOiBlbmQiKTsKCi8qCiAqIEdldCBwcm9maWxlIGF0dHJpYnV0ZQogKi8KZnVuY3Rpb24gZ2V0UHJvZmlsZUF0dHJpYnV0ZShuYW1lKSB7CiAgICByZXR1cm4gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCBuYW1lKS5pdGVyYXRvcigpLm5leHQoKTsKfQoKLyoKICogUHJvcGVybHkgc2V0IGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgICAgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KG5hbWUsIHZhbHVlKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d25a1315-8beb-4a0c-84bf-534214fed087\",\"name\":\"MobileOTP: Prepare Reset Of OTP Profile Attribute\",\"description\":\"Prepare Reset Of OTP Profile Attribute\",\"script\":\"LyoKICogUmVzZXQgT1RQIHByb2ZpbGUgYXR0cmlidXRlIGluIE9iamVjdEF0dHJpYnV0ZXMgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICovCm91dGNvbWUgPSAidHJ1ZSI7CgpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImZyLWF0dHItaW50NSIsICIwIik7CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"73cecbfc-dad0-4395-be6a-6858ee3a80e5\",\"name\":\"Microsoft Profile Normalization\",\"description\":\"Normalizes raw profile data from Microsoft\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyoKewogICAgIkBvZGF0YS5jb250ZXh0IjogImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wLyRtZXRhZGF0YSN1c2Vycy8kZW50aXR5IiwKICAgICJAb2RhdGEuaWQiOiAiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tL3YyLzcxMWZmYTljLTU5NzItNDcxMy1hY2UzLTY4OGM5NzMyNjE0YS9kaXJlY3RvcnlPYmplY3RzLzdkNzc1OWUyLTM2ZDgtNGU2NC1iMTczLTNmODkwZDdkNDZkNi9NaWNyb3NvZnQuRGlyZWN0b3J5U2VydmljZXMuVXNlciIsCiAgICAiYnVzaW5lc3NQaG9uZXMiOiBbCiAgICAgICAgIjE4MDE0NzM1NDUxIgogICAgXSwKICAgICJkaXNwbGF5TmFtZSI6ICJWb2xrZXIgU2NoZXViZXIiLAogICAgImdpdmVuTmFtZSI6ICJWb2xrZXIiLAogICAgImpvYlRpdGxlIjogbnVsbCwKICAgICJtYWlsIjogInZzY2hldWJlckB2c2NoZXViZXIub25taWNyb3NvZnQuY29tIiwKICAgICJtb2JpbGVQaG9uZSI6IG51bGwsCiAgICAib2ZmaWNlTG9jYXRpb24iOiBudWxsLAogICAgInByZWZlcnJlZExhbmd1YWdlIjogbnVsbCwKICAgICJzdXJuYW1lIjogIlNjaGV1YmVyIiwKICAgICJ1c2VyUHJpbmNpcGFsTmFtZSI6ICJ2c2NoZXViZXJAdnNjaGV1YmVyLm9ubWljcm9zb2Z0LmNvbSIsCiAgICAiaWQiOiAiN2Q3NzU5ZTItMzZkOC00ZTY0LWIxNzMtM2Y4OTBkN2Q0NmQ2Igp9CiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci5tZXNzYWdlKCJLYXVhaSBNaWNyb3NvZnQgUHJvZmlsZSBOb3JtYWxpemF0aW9uOiByYXdQcm9maWxlPXt9IiwgcmF3UHJvZmlsZSkKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmRpc3BsYXlOYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbk5hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5zdXJuYW1lKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLnVzZXJQcmluY2lwYWxOYW1lKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJQcmluY2lwYWxOYW1lKSwKICAgICAgICBmaWVsZCgiZ3JvdXBzIiwgcmF3UHJvZmlsZS5ncm91cHMpKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5e6d276c-c5ca-434a-a682-725bb9ab8168\",\"name\":\"AT_getMail2\",\"description\":\"Get email, and set Company and selectedIdP to the Domain\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiBVc2UuCiAqIFRoaXMgc2NyaXB0IGdldHMgdGhlIG1haWwgYXR0cmlidXRlIGZyb20gc2hhcmVkIHN0YXRlIGZvciBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQgYW5kIHNldHMgdGhlIGNvcnJlY3QKICogc2hhcmVkU3RhdGUgdmFyaWFibGUgdG8gbWF0Y2ggdGhlIHNlbGVjdGVkIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciAoY29uZmlndXJlZCBpbiBBTSBTb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgU2VydmljZQogKiBTZWNvbmRhcnkgQ29uZmlndXJhdGlvbnMuIEl0IGFsc28gc2V0cyB0aGUgQ29tcGFueSBuYW1lIHRvIGF1dG9tYXRpY2FsbHkgcHV0IHRoZSB1c2VyIGluIHRoZSBjb3JyZWN0IG9yZ2FuaXphdGlvbi4KICovCmxvZ2dlci5lcnJvcigiQVRfZ2V0TWFpbDI6IHN0YXJ0Iik7Cm91dGNvbWUgPSAiTG9jYWwiOwoKCi8vICdpZiAoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSAmJiBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLmhhc05leHQoKSkgeycKaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpKSB7CiAgdmFyIG1haWwgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIm1haWwiKTsKICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBtYWlsOiIgKyBtYWlsKTsKCgogIGlmIChtYWlsLmluZGV4T2YoJ0Bwcm92aWRlcicpICE9PSAtMSkgewogICAgICBvdXRjb21lID0gIk9JREMiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgInByb3ZpZGVyIik7CiAgICAgIHNldE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkU3RyaW5nNSIsICJwcm92aWRlciIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBQcm92aWRlciIpOwogIH0KCiAgaWYgKG1haWwuaW5kZXhPZignQGVtcGxveWVyJykgIT09IC0xKSB7CiAgICAgIG91dGNvbWUgPSAiT0lEQyI7CiAgICAgIHNoYXJlZFN0YXRlLnB1dCgic2VsZWN0ZWRJZHAiLCAiZW1wbG95ZXIiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImVtcGxveWVyIik7CiAgICAgIGxvZ2dlci5lcnJvcigiQVRfZ2V0TWFpbDI6IE91dGNvbWU6IEVtcGxveWVyIik7CiAgfQogIGlmIChtYWlsLmluZGV4T2YoJ0BwYXllcicpICE9PSAtMSkgewogICAgICBvdXRjb21lID0gIk9JREMiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgInBheWVyIik7CiAgICAgIHNldE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkU3RyaW5nNSIsICJwYXllciIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBQYXllciIpOwogIH0KICBpZiAobWFpbC5pbmRleE9mKCdAZ21haWwnKSAhPT0gLTEpIHsKICAgICAgb3V0Y29tZSA9ICJPSURDIjsKICAgICAgc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJnb29nbGUiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImdvb2dsZSIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBnb29nbGUiKTsKICB9CiAgICBpZiAobWFpbC5pbmRleE9mKCdAaGVhbHRoJykgIT09IC0xKSB7CiAgICAgIG91dGNvbWUgPSAiTG9jYWwiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgImhlYWx0aGNhcmVJREMiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImhlYWx0aGNhcmVJREMiKTsKICAgICAgbG9nZ2VyLmVycm9yKCJBVF9nZXRNYWlsMjogT3V0Y29tZTogaGVhbHRoY2FyZUlEQyIpOwogIH0KfQoKZnVuY3Rpb24gc2V0T2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgfQogIGVsc2UgewogICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgfQp9Cg==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"4855aac0-1efd-49c0-a153-3b9aadc911a6\",\"name\":\"Populate Username From Email\",\"description\":\"Populate Username From Email\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBnZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiKSkKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ1c2VyTmFtZSIsIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgibWFpbCIpKQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIG51bGw7Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5a845c31-2c60-40fc-91cb-f6c1fc0a5c1b\",\"name\":\"AT_SetSocialIddataweb\",\"description\":\"Set the shared state to select Id DataWeb as the social provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICogQVRfU2V0U29jaWFsSWRkYXRhd2ViLCBTY3JpcHQgdG8gc2V0IHRoZSBzb2NpYWwgcHJvdmlkZXIgdHlwZSB0byBJRERhdGFXZWIKKi8Kc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJpZGRhdGF3ZWIiKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"48f17202-039f-4d40-b7fc-4ce380f1b929\",\"name\":\"Collect SAML2 Node Config\",\"description\":\"Collect all the configuration items required for the SAML2 Node to function properly.\",\"script\":\"LyogQ29sbGVjdCBTQU1MMiBOb2RlIENvbmZpZwogKiAKICogQ29sbGVjdCBhbGwgdGhlIGNvbmZpZ3VyYXRpb24gaXRlbXMgcmVxdWlyZWQgZm9yIHRoZSBTQU1MMiBOb2RlIHRvIGZ1bmN0aW9uIHByb3Blcmx5LgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogIAl2YXIgY29uZmlnID0gewogICAgICAgICJtZXRhQWxpYXMiOiAiL2lTUEF6dXJlIiwKICAgICAgICAiYWxsb3dDcmVhdGUiOiBmYWxzZSwKICAgICAgICAic2xvRW5hYmxlZCI6IGZhbHNlLAogICAgICAgICJhdXRobkNvbnRleHRDbGFzc1JlZiI6IFtdLAogICAgICAgICJhdXRobkNvbnRleHREZWNsUmVmIjogW10sCiAgICAgICAgImF1dGhDb21wYXJpc29uIjogIkVYQUNUIiwKICAgICAgICAibmFtZUlkRm9ybWF0IjogInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIiwKICAgICAgICAicmVxdWVzdEJpbmRpbmciOiAiSFRUUF9SRURJUkVDVCIsCiAgICAgICAgImJpbmRpbmciOiAiSFRUUF9QT1NUIiwKICAgICAgICAiZm9yY2VBdXRobiI6IGZhbHNlLAogICAgICAgICJpZHBFbnRpdHlJZCI6ICJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MTFmZmE5Yy01OTcyLTQ3MTMtYWNlMy02ODhjOTczMjYxNGEvIiwKICAgICAgICAiaXNQYXNzaXZlIjogZmFsc2UsCiAgICAgICAgInNsb1JlbGF5U3RhdGUiOiAiIgogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXSk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWV0YUFsaWFzIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImFsbG93Q3JlYXRlIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soInNsb0VuYWJsZWQiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYXV0aG5Db250ZXh0Q2xhc3NSZWYiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYXV0aG5Db250ZXh0RGVjbFJlZiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJhdXRoQ29tcGFyaXNvbiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJuYW1lSWRGb3JtYXQiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygicmVxdWVzdEJpbmRpbmciKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYmluZGluZyIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJmb3JjZUF1dGhuIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImlkcEVudGl0eUlkIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImlzUGFzc2l2ZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJzbG9SZWxheVN0YXRlIiksCiAgICAgICAgICAJbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpOwogICAgfQogICAgZWxzZSB7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgwKS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDApLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDEpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKSA9PT0gJ3RydWUnKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDIpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDIpLmdldE5hbWUoKSA9PT0gJ3RydWUnKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDMpLmdldFByb21wdCgpXSA9IFtjYWxsYmFja3MuZ2V0KDMpLmdldE5hbWUoKV07CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg0KS5nZXRQcm9tcHQoKV0gPSBbY2FsbGJhY2tzLmdldCg0KS5nZXROYW1lKCldOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoNSkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCg1KS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg2KS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDYpLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDcpLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoNykuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoOCkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCg4KS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg5KS5nZXRQcm9tcHQoKV0gPSAoY2FsbGJhY2tzLmdldCg5KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgxMCkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxMCkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMTEpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDExKS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgxMikuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxMikuZ2V0TmFtZSgpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgibm9kZUNvbmZpZyIsIGNvbmZpZyk7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7dd80834-e7b2-4737-85a7-40434bb19dde\",\"name\":\"Impersonate: Update Session Properties\",\"description\":\"Store the impersontor and impersonatee profile information in session properties.\",\"script\":\"LyogSW1wZXJzb25hdGU6IFVwZGF0ZSBTZXNzaW9uIFByb3BlcnRpZXMKICogCiAqIFN0b3JlIHRoZSBpbXBlcnNvbnRvciBhbmQgaW1wZXJzb25hdGVlIHByb2ZpbGUgaW5mb3JtYXRpb24gaW4gc2Vzc2lvbiBwcm9wZXJ0aWVzLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogamFrZS5mZWFzZWxAZm9yZ2Vyb2NrLmNvbSwgdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJJbXBlcnNvbmF0ZTogVXBkYXRlIFNlc3Npb24gUHJvcGVydGllczogc3RhcnQiKTsKICAJb3V0Y29tZSA9ICJ0cnVlIjsKICAKICAgIHZhciBnb1RvID0gb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24uZ29UbzsKICAgIG15R290byA9IGdvVG8ob3V0Y29tZSk7CiAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJ1c2VyTmFtZSIsIHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSk7CiAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJpbXBlcnNvbmF0b3IiLCBzaGFyZWRTdGF0ZS5nZXQoImltcGVyc29uYXRvciIpKTsKCiAgCWxvZ2dlci5tZXNzYWdlKCJJbXBlcnNvbmF0ZTogVXBkYXRlIFNlc3Npb24gUHJvcGVydGllczogZG9uZSBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKICAgIGFjdGlvbiA9IG15R290by5idWlsZCgpOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5b3b2c47-0248-46f4-8a1c-8a495d249037\",\"name\":\"Save/restore perpetrator\",\"description\":\"null\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKaWYgKHNoYXJlZFN0YXRlLmdldCgicGVycGV0cmF0b3IiKSkKewogIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBzaGFyZWRTdGF0ZS5nZXQoInBlcnBldHJhdG9yIikpOwovLyAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7Ci8vCXNoYXJlZFN0YXRlLnJlbW92ZSgib2JqZWN0QXR0cmlidXRlcyIpOwovLyAgfQogIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIHt9KTsKfQplbHNlCnsKICBzaGFyZWRTdGF0ZS5wdXQoInBlcnBldHJhdG9yIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKTsKICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgCiAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgidXNlck5hbWUiKSkgewoJc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucmVtb3ZlKCJ1c2VyTmFtZSIpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"38f698de-fe11-43d2-8480-44e1312d121d\",\"name\":\"FRAAS-7955 Both States\",\"description\":\"FRAAS-7955 Both States\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC1zaGFyZWQiKTsKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXNoYXJlZCIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC1zaGFyZWRAY29tcGFueS5jb20iKTsKCnNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC10cmFuc2llbnQiKTsKc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXRyYW5zaWVudCIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC10cmFuc2llbnRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiB0cmFuc2llbnQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHRyYW5zaWVudFN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmICh0cmFuc2llbnRTdG9yYWdlLnB1dCkgewogICAgICAgICAgICB0cmFuc2llbnRTdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAgIHRyYW5zaWVudFN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgdHJhbnNpZW50U3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"f26cc0de-ee31-4114-8a32-27799bb49357\",\"name\":\"Setup MFA Choice\",\"description\":\"null\",\"script\":\"LyoKICogQWRhcHQgdGhlIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGJlbG93CiAqLwoKLy8gZG8gbm90IGNoYW5nZSwgbXVzdCBiZSBhIHJhbmRvbSBpZGVudGlmaWVyCnZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CgovLyBzcGVjaWZ5IHRoZSBob3Jpem9udGFsIGFsaWdubWVudCBvZiB0aGUgbWVzc2FnZTogbGVmdCwgY2VudGVyLCByaWdodAp2YXIgaGFsaWduID0gImNlbnRlciI7CgovLyBzcGVjaWZ5IHRoZSBzdHlsZSB0byBhcHBseSB0byB0aGUgYnV0dG9uIGluIHRoZSBtZXNzYWdlIHRvIG1ha2UgaXQgbG9vayBsaWtlIGEgbGluawp2YXIgbGlua0J1dHRvblN0eWxlID0gImJvcmRlcjogMDsgY29sb3I6ICMxMDlDRjE7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IjsKCi8vIHNwZWNpZnkgdGhlIGxpbmsgYnV0dG9uIEhUTUwgZWxlbWVudC4gb25seSBtb2RpZnkgdGhlIHRleHQgYmV0d2VlbiB0aGUgPGJ1dHRvbj4gYW5kIDwvYnV0dG9uPiB0YWdzLgp2YXIgbGlua0J1dHRvbiA9ICI8YnV0dG9uIGlkPVwic2tpcC1saW5rLSIuY29uY2F0KGFuY2hvcikuY29uY2F0KCJcIiB0eXBlPVwic3VibWl0XCIgc3R5bGU9XCIiKS5jb25jYXQobGlua0J1dHRvblN0eWxlKS5jb25jYXQoIlwiPnNraXAgZm9yIG5vdy48L2J1dHRvbj4iKTsKCi8vIHNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheSBhbmQgcGxhY2UgdGhlIGxpbmtCdXR0b24gYW55d2hlcmUKdmFyIG1lc3NhZ2UgPSAiUGxlYXNlIHNlbGVjdCB5b3VyIHByZWZlcmVkIGZhY3RvciBvciIuY29uY2F0KGxpbmtCdXR0b24pOwoKLy8gc3BlY2lmeSB0aGUgY2hvaWNlcyB5b3Ugd2FudCB0byBvZmZlciB0aGUgdXNlci4KdmFyIGNob2ljZXMgPSBbIlNNUyIsIkZpZG8iLCJQdXNoIl07CgovLyBzcGVjaWZ5IHRoZSBkZWZhdWx0IGNob2ljZS4gdGhpcyBzZXR0aW5nIG11c3QgYmUgYSB2YWxpZCAwLWJhc2VkIGluZGV4IG9mIHRoZSBjaG9pY2VzIGFycmF5IGFib3ZlLgp2YXIgZGVmYXVsdENob2ljZSA9IDA7CgovKgogKiBBbGwgdGhlIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGFyZSBhYm92ZSB0aGlzIGNvbW1lbnQuCiAqCiAqIERPIE5PVCBNQUtFIEFOWSBDSEFOR0VTIEJFTE9XIQogKi8KCi8vIGZpbmQgdGhlIFRleHRPdXRwdXRDYWxsYmFjayB3aXRoIHRoZSBtZXNzYWdlX2FuY2hvcgovLyBhbmQgcmVwbGFjZSB0aGUgbWVzc2FnZV9hbmNob3Igd2l0aCB0aGUgbWVzc2FnZQp2YXIgZGlzcGxheU1lc3NhZ2VTY3JpcHQgPSAiIi5jb25jYXQoCiAgIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIikuY29uY2F0KAogICIgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpXG4iKS5jb25jYXQoCiAgIikuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiICBmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgICAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgICAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnbWVzc2FnZS0iKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICAgIH1cbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIikiKQoKLy8gaGlqYWNrIHRoZSBsaW5rIGJ1dHRvbiBpbiB0aGUgbWVzc2FnZSBhbmQ6Ci8vIC0gZmluZCB0aGUgSGlkZGVuVmFsdWVDYWxsYmFjayBhbmQgc2V0IGl0cyB2YWx1ZSB0byAiU2tpcCIKLy8gLSB0aGVuIHNpbXVsYXRlIGEgbG9naW4gYnV0dG9uIGNsaWNrCnZhciBza2lwT3B0aW9uU2NyaXB0ID0gIiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNraXAtbGluay0iKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIlwiKS5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiIpLmNvbmNhdCgKICAiICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNraXAtaW5wdXQtIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCJcIikudmFsdWUgPSBcIlNraXBcIjtcbiIpLmNvbmNhdCgKICAiICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luQnV0dG9uXzBcIikuY2xpY2soKTtcbiIpLmNvbmNhdCgKICAiICByZXR1cm4gZmFsc2U7XG4iKS5jb25jYXQoCiAgIn0iKQoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLkNvbmZpcm1hdGlvbkNhbGxiYWNrLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5IaWRkZW5WYWx1ZUNhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKCmlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICJtZXNzYWdlLSIuY29uY2F0KGFuY2hvcikKICAgICAgICApLAogICAgICAgIG5ldyBmci5Db25maXJtYXRpb25DYWxsYmFjaygKICAgICAgICAgICAgZnIuQ29uZmlybWF0aW9uQ2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGNob2ljZXMsCiAgICAgICAgICAgIGRlZmF1bHRDaG9pY2UKICAgICAgICApLAogICAgICAgIG5ldyBmci5IaWRkZW5WYWx1ZUNhbGxiYWNrKCJza2lwLWlucHV0LSIuY29uY2F0KGFuY2hvciksICJmYWxzZSIpLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soZGlzcGxheU1lc3NhZ2VTY3JpcHQpLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2tpcE9wdGlvblNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIC8vIGRpZCB0aGUgdXNlciBza2lwPwogIGlmIChjYWxsYmFja3MuZ2V0KDIpLmdldFZhbHVlKCkgPT0gIlNraXAiKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygiU2tpcCIpLmJ1aWxkKCk7CiAgfQogIC8vIHVzZXIgZGlkbid0IHNraXAsIHBpY2sgdGhlIHJpZ2h0IG91dGNvbWUKICBlbHNlIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKGNob2ljZXNbY2FsbGJhY2tzLmdldCgxKS5nZXRTZWxlY3RlZEluZGV4KCldKS5idWlsZCgpOwogIH0KfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"2a076e9e-75a9-46b5-b971-10ffafbdf652\",\"name\":\"Goto Specified Decision\",\"description\":\"Return true if a goto param has been specified, false otherwise.\",\"script\":\"LyogR290byBTcGVjaWZpZWQgRGVjaXNpb24KICogCiAqIFJldHVybiB0cnVlIGlmIGEgZ290byBwYXJhbSBoYXMgYmVlbiBzcGVjaWZpZWQsIGZhbHNlIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IHJlcXVpcmUgY29uZmlndXJhdGlvbi4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgbG9nZ2VyLm1lc3NhZ2UoIkdvdG8gU3BlY2lmaWVkIERlY2lzaW9uOiBzdGFydCIpOwogIAlvdXRjb21lID0gImZhbHNlIjsKICAJdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwogIAlpZiAocmVmZXJlci5zZWFyY2hQYXJhbS5nb3RvKSB7CiAgICAgIAlvdXRjb21lID0gInRydWUiOwogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIkdvdG8gU3BlY2lmaWVkIERlY2lzaW9uOiBlbmQgW291dGNvbWU9e31dIiwgb3V0Y29tZSk7CgogICAgLyoKICAgICAqIFBhcnNlIGEgVVJMIGludG8gaXRzIGNvbXBvbmVudHMgYW5kIG1ha2UgdGhlbSBlYXNpbHkgYWNjZXNzaWJsZSBieSBuYW1lCiAgICAgKgogICAgICogVXNlIGluIGEgU2NyaXB0ZSBEZWNpc2lvbiBOb2RlIFNjcmlwdCBhcyBmb2xsb3dzOgogICAgICogdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwogICAgICogdmFyIG9yaWdpbiA9IHJlZmVyZXIub3JpZ2luOwogICAgICogCiAgICAgKiBlLmcuOiBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8KICAgICAqIHsKICAgICAqICAgICBoYXNoOiAnIy8nLAogICAgICogICAgIGhvc3Q6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhvc3RuYW1lOiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBocmVmOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvJywKICAgICAqICAgICBvcmlnaW46ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgcGF0aG5hbWU6ICcvYW0vWFVJLycsCiAgICAgKiAgICAgcG9ydDogJycsCiAgICAgKiAgICAgcHJvdG9jb2w6ICdodHRwcycsCiAgICAgKiAgICAgc2VhcmNoOiAnP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltJywKICAgICAqICAgICB1c2VybmFtZTogJycsCiAgICAgKiAgICAgcGFzc3dvcmQ6ICcnLAogICAgICogICAgIHNlYXJjaFBhcmFtOiB7CiAgICAgKiAgICAgICAgIHJlYWxtOiAnL2JyYXZvJywKICAgICAqICAgICAgICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICogICAgICAgICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScKICAgICAqICAgICB9CiAgICAgKiB9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHBhcnNlVXJsKGhyZWYpIHsKICAgICAgICB2YXIgbSA9IGhyZWYubWF0Y2goL14oKFteOlwvPyNdKyk6Pyg/OlwvXC8oKD86KFteXC8/IzpdKik6KFteXC8/IzpdKilAKT8oW15cLz8jOl0qKSg/OjooW15cLz8jOl0qKSk/KSkpPyhbXj8jXSopKFw/W14jXSopPygjLiopPyQvKSwKICAgICAgICByID0gewogICAgICAgICAgICBoYXNoOiBtWzEwXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgLy8gIy8KICAgICAgICAgICAgaG9zdDogbVszXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIG9wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBob3N0bmFtZTogbVs2XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhyZWY6IG1bMF0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8KICAgICAgICAgICAgb3JpZ2luOiBtWzFdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIHBhdGhuYW1lOiBtWzhdIHx8IChtWzFdID8gIi8iIDogIiIpLCAgICAvLyAvYW0vWFVJLwogICAgICAgICAgICBwb3J0OiBtWzddIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHByb3RvY29sOiBtWzJdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBodHRwcwogICAgICAgICAgICBzZWFyY2g6IG1bOV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltCiAgICAgICAgICAgIHVzZXJuYW1lOiBtWzRdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcGFzc3dvcmQ6IG1bNV0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBzZWFyY2hQYXJhbToge30gICAgICAgICAgICAgICAgICAgICAgICAgLy8geyByZWFsbTogJy9icmF2bycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VmFsdWU6ICdJbml0aWF0ZU93bmVyQ2xhaW0nIH0KICAgICAgICB9OwogICAgICAgIGlmIChyLnByb3RvY29sLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAgIHIucHJvdG9jb2wgPSAiZmlsZTovLy8iICsgci5wcm90b2NvbC50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICByLm9yaWdpbiA9IHIucHJvdG9jb2wgKyAiLy8iICsgci5ob3N0OwogICAgICAgIH0KICAgICAgICBpZiAoci5zZWFyY2gubGVuZ3RoID4gMikgewogICAgICAgICAgICB2YXIgcXVlcnkgPSAoci5zZWFyY2guaW5kZXhPZignPycpID09PSAwKSA/IHIuc2VhcmNoLnN1YnN0cigxKSA6IHIuc2VhcmNoOwogICAgICAgICAgICB2YXIgdmFycyA9IHF1ZXJ5LnNwbGl0KCcmJyk7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgcGFpciA9IHZhcnNbaV0uc3BsaXQoJz0nKTsKICAgICAgICAgICAgci5zZWFyY2hQYXJhbVtkZWNvZGVVUklDb21wb25lbnQocGFpclswXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHIuaHJlZiA9IHIub3JpZ2luICsgci5wYXRobmFtZSArIHIuc2VhcmNoICsgci5oYXNoOwogICAgICAgIHJldHVybiByOwogICAgfTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"76421cb0-0550-43e7-89f8-51ad1d95d306\",\"name\":\"Set Theme\",\"description\":\"Detect and preserve currently active theme before setting the new theme.\",\"script\":\"LyogU2V0IFRoZW1lCiAqIAogKiBEZXRlY3QgYW5kIHByZXNlcnZlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWUgYmVmb3JlIHNldHRpbmcgdGhlIG5ldyB0aGVtZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAlvdXRjb21lID0gInRydWUiOwogIAkKICAJdmFyIHRoZW1lID0gIkV4cGFuc2VfTUZBIjsKCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIGRpc2NvdmVyIGFjdGl2ZSB0aGVtZSBmcm9tIFVJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjayBhbmQgc2V0IG5ldyB0aGVtZQogIAllbHNlIGlmIChjYWxsYmFja3Muc2l6ZSgpID09PSAyKSB7CiAgICAgICAgLy8gZGlkIHdlIGdldCB0aGUgaWQgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWU/CiAgICAgICAgaWYgKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSAhPT0gInRoZW1lLWlkLSIrYW5jaG9yKSB7CiAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgY2FsbGJhY2tzLmdldCgwKS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gc2V0IG5ldyB0aGVtZQogICAgCXZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAJbmV3IGZyLlBvbGxpbmdXYWl0Q2FsbGJhY2soIjEwMCIsICJQbGVhc2Ugd2FpdCAuLi4iKQogICAgICAgICkud2l0aFN0YWdlKHN0YWdlKS5idWlsZCgpOwogICAgfQogIAllbHNlIHsKICAgICAgICAvLyBjb250aW51ZQogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgIC8qCiAgICAgICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAgICAgKiAKICAgICAgKiBFeGFtcGxlOgogICAgICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICAgICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAgICAgKi8KICAgIGZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICAgIHZhciB2ID0gcjsKICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgICAgIH0pOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"c9cb4b1e-1cd3-4e5b-8f56-140f83ba9f6d\",\"name\":\"FrodoTestScript1\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a31a1796-8410-46b8-82ca-eb0c6e901775\",\"name\":\"Collect Set Custom Cookie Node Config\",\"description\":\"Collect all the configuration items required for the Set Custom Cookie node to function properly.\",\"script\":\"LyogQ29sbGVjdCBTZXQgQ3VzdG9tIENvb2tpZSBOb2RlIENvbmZpZwogKiAKICogQ29sbGVjdCBhbGwgdGhlIGNvbmZpZ3VyYXRpb24gaXRlbXMgcmVxdWlyZWQgZm9yIHRoZSBTZXQgQ3VzdG9tIENvb2tpZSBub2RlIHRvIGZ1bmN0aW9uIHByb3Blcmx5LgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogIAl2YXIgY29uZmlnID0gewoJCSJuYW1lIjogIm9yZW8iLAoJCSJ2YWx1ZSI6ICJvcmlnaW5hbCIsCgkJImRvbWFpbiI6ICIuc2NoZXViZXIuaW8iLAoJCSJwYXRoIjogIi8iLAoJCSJtYXhBZ2UiOiAzNjAwLAoJCSJ1c2VIdHRwT25seUNvb2tpZSI6IHRydWUsCgkJInVzZVNlY3VyZUNvb2tpZSI6IHRydWUsCgkJInNhbWVTaXRlIjogIk5PTkUiCgl9OwogIAogIAl2YXIgc2NyaXB0ID0gIiI7CiAgICBzY3JpcHQgKz0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCI7CiAgICBzY3JpcHQgKz0gIiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSI7CiAgICBzY3JpcHQgKz0gIikuZm9yRWFjaCgiOwogICAgc2NyaXB0ICs9ICIgICAgZnVuY3Rpb24gKGlucHV0LGkpIHsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIGNvbnNvbGUubG9nKCdpbnB1dCAnK2kpOyIKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIgY29uZmlnID0gSlNPTi5wYXJzZSgnIitKU09OLnN0cmluZ2lmeShjb25maWcpKyInKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoY29uZmlnKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIGlmIChpbnB1dC50eXBlID09PSAndGV4dCcpIHsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgY29uZmlnW2tleXNbaV1dKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBLZXlib2FyZEV2ZW50KCAnaW5wdXQnICwgeydrZXknOidFbnRlcid9ICkpOyI7CiAgICBzY3JpcHQgKz0gIiAgICAgICAgfSI7CiAgICBzY3JpcHQgKz0gIiAgICB9IjsKICAgIHNjcmlwdCArPSAiKTsiOwogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5OYW1lQ2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJuYW1lIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soInZhbHVlIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImRvbWFpbiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJwYXRoIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soIm1heEFnZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJ1c2VIdHRwT25seUNvb2tpZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJ1c2VTZWN1cmVDb29raWUiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygic2FtZVNpdGUiKSwKICAgICAgICAgIAluZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDApLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMCkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMSkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxKS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgyKS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDIpLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDMpLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMykuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoNCkuZ2V0UHJvbXB0KCldID0gcGFyc2VJbnQoY2FsbGJhY2tzLmdldCg0KS5nZXROYW1lKCksIDEwKS50b0ZpeGVkKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg1KS5nZXRQcm9tcHQoKV0gPSAoIiIrY2FsbGJhY2tzLmdldCg1KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg2KS5nZXRQcm9tcHQoKV0gPSAoIiIrY2FsbGJhY2tzLmdldCg2KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg3KS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDcpLmdldE5hbWUoKTsKICAgICAgCW5vZGVTdGF0ZS5wdXRTaGFyZWQoIm5vZGVDb25maWciLCBjb25maWcpOwogICAgCWFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3156d7e9-1589-4ffb-a659-37a1647ee03d\",\"name\":\"Normalized ADFS Profile to Managed User\",\"description\":\"Converts a normalized social profile coming from ADFS into a managed user\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgbWFuYWdlZFVzZXIgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlck5hbWUiLCBub3JtYWxpemVkUHJvZmlsZS51c2VybmFtZSkpKQoKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQptYW5hZ2VkVXNlci5wdXQoImFjY291bnRTdGF0dXMiLCAobm9ybWFsaXplZFByb2ZpbGUucm9sZXMuYXNTdHJpbmcoKSA9PSAiZmlkYy12b2xrZXItZGV2LWFkbWlucyIpID8gJ0FjdGl2ZScgOiAnSW5hY3RpdmUnKQoKLy8gaWYgdGhlIGdpdmVuTmFtZSBhbmQgZmFtaWx5TmFtZSBpcyBudWxsIG9yIGVtcHR5Ci8vIHRoZW4gYWRkIGEgYm9vbGVhbiBmbGFnIHRvIHRoZSBzaGFyZWQgc3RhdGUgdG8gaW5kaWNhdGUgbmFtZXMgYXJlIG5vdCBwcmVzZW50Ci8vIHRoaXMgY291bGQgYmUgdXNlZCBlbHNld2hlcmUKLy8gZm9yIGVnLiB0aGlzIGNvdWxkIGJlIHVzZWQgaW4gYSBzY3JpcHRlZCBkZWNpc2lvbiBub2RlIHRvIGJ5LXBhc3MgcGF0Y2hpbmcKLy8gdGhlIHVzZXIgb2JqZWN0IHdpdGggYmxhbmsgdmFsdWVzIHdoZW4gZ2l2ZW5OYW1lICBhbmQgZmFtaWx5TmFtZSBpcyBub3QgcHJlc2VudApib29sZWFuIG5vR2l2ZW5OYW1lID0gbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmFzU3RyaW5nKCk/LnRyaW0oKSkKYm9vbGVhbiBub0ZhbWlseU5hbWUgPSBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZS5hc1N0cmluZygpPy50cmltKCkpCnNoYXJlZFN0YXRlLnB1dCgibmFtZUVtcHR5T3JOdWxsIiwgbm9HaXZlbk5hbWUgJiYgbm9GYW1pbHlOYW1lKQoKcmV0dXJuIG1hbmFnZWRVc2VyCg==\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30\",\"name\":\"Amazon Profile Normalization\",\"description\":\"Normalizes raw profile data from Amazon\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJfaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"50cde102-d4b6-44c4-9ba7-8564af05ae08\",\"name\":\"Select Theme from URL\",\"description\":\"Select and apply theme from query param in the request URL.\",\"script\":\"LyogU2VsZWN0IFRoZW1lIGZyb20gVVJMCiAqIAogKiBTZWxlY3QgYW5kIGFwcGx5IHRoZW1lIGZyb20gcXVlcnkgcGFyYW0gaW4gdGhlIHJlcXVlc3QgVVJMLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciB0aGVtZSA9ICIiOwogIAlpZiAocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJ0aGVtZUlkIikpIHsKICAgICAgCXRoZW1lID0gcmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJ0aGVtZUlkIikuZ2V0KDApOwogICAgfQoKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"71545db5-ce01-46b1-b79f-d41af36bd548\",\"name\":\"Onfido-CaptureEvidence\",\"description\":\"Capture Evidence\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2FwdHVyZUV2aWRlbmNlOiBTdGFydCIpOwovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICovCnZhciBvbmZpZG9fYXV0aF90b2tlbiA9IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0F1dGhUb2tlbiIpKTsKdmFyIG9uZmlkb19kaWFsb2dfdGl0bGUgPSAiSm9pbiB0aGUgRXhwYW5zZSBmYW1pbHkhIjsKdmFyIG9uZmlkb19kaWFsb2dfbXNnMSA9ICJUbyBvcGVuIGFuIEV4cGFuc2UgYWNjb3VudCwgd2Ugd2lsbCBuZWVkIHRvIHZlcmlmeSB5b3VyIGlkZW50aXR5LiI7CnZhciBvbmZpZG9fZGlhbG9nX21zZzIgPSAiSXQgd2lsbCBvbmx5IHRha2UgYSBjb3VwbGUgb2YgbWludXRlcy4iOwp2YXIgb25maWRvX2NvdW50cnlfY29kZSA9ICJVUyI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCnZhciBtb2JpbGUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKTsKdmFyIHNtc051bWJlciA9ICIiOwppZiAobW9iaWxlICYmIG1vYmlsZS5pdGVyYXRvcigpLmhhc05leHQoKSkgewogICAgc21zTnVtYmVyID0gU3RyaW5nKG1vYmlsZS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKTsKfQoKLy8gSW5qZWN0IE9uZmlkbyBTREsgaW50byBsb2dpbiBwYWdlCm9uZmlkb1NjcmlwdCA9IFN0cmluZygidmFyIGJvZHk9ZG9jdW1lbnQuYm9keTtcbiIgKwogICAgInZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiIgKwogICAgImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxsYmFja3NQYW5lbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4iICsKICAgICJ2YXIgb25maWRvX2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4iICsKICAgICJvbmZpZG9fZGl2LmlkPVwib25maWRvLW1vdW50XCI7XG4iICsKICAgICJzY3JpcHQuc3JjID0gJ2h0dHBzOi8vYXNzZXRzLm9uZmlkby5jb20vd2ViLXNkay1yZWxlYXNlcy81LjIuMS9vbmZpZG8ubWluLmpzJztcbiIgKwogICAgInZhciBoZWFkID0gZG9jdW1lbnQuaGVhZDsgXG4gIiArCiAgICAidmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTsgIFxuIiArCiAgICAiICAgICBsaW5rLnR5cGUgPSBcInRleHQvY3NzXCI7IFxuICIgKwogICAgIiAgICAgbGluay5yZWwgPSBcInN0eWxlc2hlZXRcIjsgXG4gIiArCiAgICAiICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9hc3NldHMub25maWRvLmNvbS93ZWItc2RrLXJlbGVhc2VzLzUuMi4xL3N0eWxlLmNzcyc7IFxuICIgKwogICAgIiAgICBoZWFkLmFwcGVuZENoaWxkKGxpbmspOyBcbiAiICsKICAgICI7XG4iICsKICAgICJ2YXIgb25maWRvID0ge307XG4iICsKICAgICJzY3JpcHQub25sb2FkPWZ1bmN0aW9uKCkge1xuIiArCiAgICAiCW9uZmlkbz1PbmZpZG8uaW5pdCh7XG4iICsKICAgICIgICAgICAgdG9rZW46ICciICsgb25maWRvX2F1dGhfdG9rZW4gKyAiJywgXG4iICsKICAgICIgICAgICAgdXNlTW9kYWw6IHRydWUsIFxuIiArCiAgICAiICAgICAgIGlzTW9kYWxPcGVuOiB0cnVlLCBcbiIgKwogICAgIiAgICAgICBzbXNOdW1iZXJDb3VudHJ5Q29kZTogJyIgKyBvbmZpZG9fY291bnRyeV9jb2RlICsgIicsIFxuIiArCiAgICAiICAgICAgIHVzZXJEZXRhaWxzOiB7IFxuIiArCiAgICAiICAgICAgICAgICBzbXNOdW1iZXI6ICciICsgc21zTnVtYmVyICsgIicgXG4iICsKICAgICIgICAgICAgfSwgXG4iICsKICAgICIgICAgICAgc3RlcHM6IFtcbiIgKwogICAgIiAgICAgICAgICAge1xuIiArCiAgICAiICAgICAgICAgICAgICAgdHlwZTond2VsY29tZScsXG4iICsKICAgICIgICAgICAgICAgICAgICBvcHRpb25zOntcbiIgKwogICAgIiAgICAgICAgICAgICAgICAgICB0aXRsZTonIiArIG9uZmlkb19kaWFsb2dfdGl0bGUgKyAiJyxcbiIgKwogICAgIiAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbnM6W1xuIiArCiAgICAiICAgICAgICAgICAgICAgICAgICAgICAnIiArIG9uZmlkb19kaWFsb2dfbXNnMSArICInLFxuIiArCiAgICAiICAgICAgICAgICAgICAgICAgICAgICAnIiArIG9uZmlkb19kaWFsb2dfbXNnMiArICInLFxuIiArCiAgICAiICAgICAgICAgICAgICAgICAgIF1cbiIgKwogICAgIiAgICAgICAgICAgICAgIH1cbiIgKwogICAgIiAgICAgICAgICB9LFxuIiArCiAgICAiICAgICAgICAgICdkb2N1bWVudCcsXG4iICsKICAgICIgICAgICAgICAgJ2ZhY2UnLFxuIiArCiAgICAiICAgICAgICAgICdjb21wbGV0ZScsXG4iICsKICAgICIgICAgICAgXSxcbiIgKwogICAgIiAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbihkYXRhKXsgY29uc29sZS5sb2coJ0RPTkUnKTsgb25maWRvLnNldE9wdGlvbnMoeyBpc01vZGFsT3BlbjpmYWxzZSB9KTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnV0dG9uXzAnKS5jbGljaygpOyB9IFxuIiArCiAgICAiICAgIH0pXG4iICsKICAgICJ9O1xuIiArCiAgICAiZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuIik7Cgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5OYW1lQ2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKTsKCndpdGggKGZyKSB7CiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGxvZ2dlci5lcnJvcigiT25maWRvLUNhcHR1cmVFdmlkZW5jZTogU2VuZGluZyBjYWxsYmFja3MiKTsKICAgICAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChuZXcgU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKG9uZmlkb1NjcmlwdCkpLmJ1aWxkKCk7CiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5lcnJvcigiT25maWRvLUNhcHR1cmVFdmlkZW5jZTogRW5kIChvdXRjb21lPXRydWUpIik7CiAgICAgICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"70e8aa07-aa8f-4ec3-b9fb-6f6f8aa14e3c\",\"name\":\"IPQS Email Address\",\"description\":\"Analyze an email address using the IPQualityScore (IPQS) service.\",\"script\":\"LyogSVBRUyBFbWFpbCBBZGRyZXNzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFuYWx5emUgYW4gZW1haWwgYWRkcmVzcyB1c2luZyB0aGUgSVBRdWFsaXR5U2NvcmUgKElQUVMpIHNlcnZpY2UuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHVua25vd24KICogLSB0aW1lZF9vdXQKICogLSBpbnZhbGlkCiAqIC0gdmFsaWRfdW5yZWFjaGFibGUKICogLSB2YWxpZF90ZW1wb3JhcnlfZXJyb3IKICogLSB2YWxpZF9hY2NlcHRzX2FsbAogKiAtIHZhbGlkX3ZlcmlmaWVkCiAqIC0gc3VzcGljaW91cwogKiAtIGZyYXVkdWxlbnQKICovCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiSVBRUyBFbWFpbCBBZGRyZXNzOiBzdGFydCIpOwoKICAgIG91dGNvbWUgPSAidW5rbm93biI7CgogICAgdmFyIGVtYWlsID0gZ2V0RW1haWwoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJJUFFTIEVtYWlsIEFkZHJlc3M6IG1haWw9Ii5jb25jYXQoZW1haWwpKTsKCiAgICBpZiAoZW1haWwpIHsKCiAgICAgICAgLy8gSVBRUyBBUEkgQ29uZmlndXJhdGlvbgogICAgICAgIHZhciBJUFFTX0FQSV9LRVkgPSBzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5pcHFzLmFwaS5rZXkiKTsKICAgICAgICB2YXIgSVBRU19PUFRJT05TID0gInN0cmljdG5lc3M9MCZ0aW1lb3V0PTEiOwogICAgICAgIHZhciBJUFFTX0FQSV9VUkkgPSAiaHR0cHM6Ly9pcHF1YWxpdHlzY29yZS5jb20vYXBpL2pzb24vZW1haWwvIi5jb25jYXQoSVBRU19BUElfS0VZKS5jb25jYXQoIi8iKS5jb25jYXQoZW1haWwpLmNvbmNhdCgiPyIpLmNvbmNhdChJUFFTX09QVElPTlMpOwoKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgICAgICByZXF1ZXN0LnNldFVyaShJUFFTX0FQSV9VUkkpOwoKICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICAgICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJJUFFTIEVtYWlsIEFkZHJlc3M6IEpTT04gcmVzdWx0OiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeShyZXN1bHQpKSk7CgogICAgICAgIC8vIHByZXNlcnZlIHJlc3VsdCBpbiB0cmFuc2llbnQgc3RhdGUKICAgICAgICB0cmFuc2llbnRTdGF0ZS5wdXQoIklQUVNfRW1haWxfQWRkcmVzcyIsIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgICAgICBpZiAocmVzdWx0LnRpbWVkX291dCkgewogICAgICAgICAgICBvdXRjb21lID0gInRpbWVkX291dCI7CiAgICAgICAgfSAKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSAxMDApIHsKICAgICAgICAgICAgICAgIG91dGNvbWUgPSAiZnJhdWR1bGVudCI7CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSA3NSkgewogICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJzdXNwaWNpb3VzIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN3aXRjaChyZXN1bHQub3ZlcmFsbF9zY29yZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJpbnZhbGlkIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICBvdXRjb21lID0gInZhbGlkX3VucmVhY2hhYmxlIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICBvdXRjb21lID0gInZhbGlkX3RlbXBvcmFyeV9lcnJvciI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJ2YWxpZF9hY2NlcHRzX2FsbCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJ2YWxpZF92ZXJpZmllZCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJJUFFTIEVtYWlsIEFkZHJlc3M6IG5vIGVtYWlsIGFkZHJlc3MhIik7CiAgICB9CgogICAgbG9nZ2VyLm1lc3NhZ2UoIk9JUFFTIEVtYWlsIEFkZHJlc3M6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgogICAgLyoKICAgICAqICEhISBBU1NVTUVTIElEIENMT1VEICEhIQogICAgICoKICAgICAqIFJldHVybnMgdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzIGZyb20gc2hhcmVkIHN0YXRlIG9yIHRoZSByZXBvc2l0b3J5LgogICAgICovCiAgICBmdW5jdGlvbiBnZXRFbWFpbCgpIHsKICAgICAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJtYWlsIikpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpOwogICAgICAgIH0KICAgICAgICB2YXIgYXR0ciA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgIm1haWwiKTsKICAgICAgICBpZiAoYXR0ciAmJiBhdHRyLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgIHJldHVybiBhdHRyLml0ZXJhdG9yKCkubmV4dCgpLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQogIAogIAoKICAgICAgICAvKiBTYW1wbGUgSVBRUyBSRVNUIEFQSSBSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiU3VjY2Vzcy4iLAogICAgICAgICAgICAic3VjY2VzcyI6IHRydWUsCiAgICAgICAgICAgICJ2YWxpZCI6IHRydWUsCiAgICAgICAgICAgICJkaXNwb3NhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICJzbXRwX3Njb3JlIjogMywKICAgICAgICAgICAgIm92ZXJhbGxfc2NvcmUiOiA0LAogICAgICAgICAgICAiZmlyc3RfbmFtZSI6ICJVbmtub3duIiwKICAgICAgICAgICAgImdlbmVyaWMiOiBmYWxzZSwKICAgICAgICAgICAgImNvbW1vbiI6IHRydWUsCiAgICAgICAgICAgICJkbnNfdmFsaWQiOiB0cnVlLAogICAgICAgICAgICAiaG9uZXlwb3QiOiB0cnVlLAogICAgICAgICAgICAiZGVsaXZlcmFiaWxpdHkiOiAibWVkaXVtIiwKICAgICAgICAgICAgImZyZXF1ZW50X2NvbXBsYWluZXIiOiBmYWxzZSwKICAgICAgICAgICAgInNwYW1fdHJhcF9zY29yZSI6ICJoaWdoIiwKICAgICAgICAgICAgImNhdGNoX2FsbCI6IGZhbHNlLAogICAgICAgICAgICAidGltZWRfb3V0IjogZmFsc2UsCiAgICAgICAgICAgICJzdXNwZWN0IjogZmFsc2UsCiAgICAgICAgICAgICJyZWNlbnRfYWJ1c2UiOiBmYWxzZSwKICAgICAgICAgICAgImZyYXVkX3Njb3JlIjogNzAsCiAgICAgICAgICAgICJzdWdnZXN0ZWRfZG9tYWluIjogIk5cL0EiLAogICAgICAgICAgICAibGVha2VkIjogdHJ1ZSwKICAgICAgICAgICAgImRvbWFpbl9hZ2UiOiB7CiAgICAgICAgICAgICAgICAiaHVtYW4iOiAiMjYgeWVhcnMgYWdvIiwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiA4MDgyODY0MDAsCiAgICAgICAgICAgICAgICAiaXNvIjogIjE5OTUtMDgtMTNUMDA6MDA6MDAtMDQ6MDAiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmaXJzdF9zZWVuIjogewogICAgICAgICAgICAgICAgImh1bWFuIjogIjQgeWVhcnMgYWdvIiwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiAxNDgzMjUwNDYxLAogICAgICAgICAgICAgICAgImlzbyI6ICIyMDE3LTAxLTAxVDAxOjAxOjAxLTA1OjAwIgogICAgICAgICAgICB9LAogICAgICAgICAgICAic2FuaXRpemVkX2VtYWlsIjogInZzY2hldWJlckBnbWFpbC5jb20iLAogICAgICAgICAgICAicmVxdWVzdF9pZCI6ICI0dVRPUUd3ZmRGVzNiciIKICAgICAgICB9CiAgICAqLwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"36863ffb-40ec-48b9-94b1-9a99f71cc3b5\",\"name\":\"OIDC Claims Script\",\"description\":\"Default global script for OIDC claims\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d82a4ad6-cd8a-437b-af55-7373e50d685b\",\"name\":\"Collect Replay Password (frUnindexedString2)\",\"description\":\"Collect Replay Password (frUnindexedString2).\",\"script\":\"LyogQ29sbGVjdCBBbmQgRW5jcnlwdCBDdXN0b20gUGFzc3dvcmQKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBTZWUgY29weXJpZ2h0IG5vdGljZXMsIGNvbmRpdGlvbnMsIGFuZCBkaXNjbGFpbWVycyBhdCB0aGUgYm90dG9tIG9mIHRoaXMgc2NyaXB0LgogKiAKICogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CgkidXNlIHN0cmljdCI7dmFyIHNqY2w9e2NpcGhlcjp7fSxoYXNoOnt9LGtleWV4Y2hhbmdlOnt9LG1vZGU6e30sbWlzYzp7fSxjb2RlYzp7fSxleGNlcHRpb246e2NvcnJ1cHQ6ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJDT1JSVVBUOiAiK3RoaXMubWVzc2FnZX07dGhpcy5tZXNzYWdlPW1lc3NhZ2V9LGludmFsaWQ6ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJJTlZBTElEOiAiK3RoaXMubWVzc2FnZX07dGhpcy5tZXNzYWdlPW1lc3NhZ2V9LGJ1ZzpmdW5jdGlvbihtZXNzYWdlKXt0aGlzLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIkJVRzogIit0aGlzLm1lc3NhZ2V9O3RoaXMubWVzc2FnZT1tZXNzYWdlfSxub3RSZWFkeTpmdW5jdGlvbihtZXNzYWdlKXt0aGlzLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIk5PVCBSRUFEWTogIit0aGlzLm1lc3NhZ2V9O3RoaXMubWVzc2FnZT1tZXNzYWdlfX19O3NqY2wuY2lwaGVyLmFlcz1mdW5jdGlvbihrZXkpe2lmKCF0aGlzLl90YWJsZXNbMF1bMF1bMF0pe3RoaXMuX3ByZWNvbXB1dGUoKX12YXIgaSxqLHRtcCxlbmNLZXksZGVjS2V5LHNib3g9dGhpcy5fdGFibGVzWzBdWzRdLGRlY1RhYmxlPXRoaXMuX3RhYmxlc1sxXSxrZXlMZW49a2V5Lmxlbmd0aCxyY29uPTE7aWYoa2V5TGVuIT09NCYma2V5TGVuIT09NiYma2V5TGVuIT09OCl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImludmFsaWQgYWVzIGtleSBzaXplIil9dGhpcy5fa2V5PVtlbmNLZXk9a2V5LnNsaWNlKDApLGRlY0tleT1bXV07Zm9yKGk9a2V5TGVuO2k8NCprZXlMZW4rMjg7aSsrKXt0bXA9ZW5jS2V5W2ktMV07aWYoaSVrZXlMZW49PT0wfHxrZXlMZW49PT04JiZpJWtleUxlbj09PTQpe3RtcD1zYm94W3RtcD4+PjI0XTw8MjRec2JveFt0bXA+PjE2JjI1NV08PDE2XnNib3hbdG1wPj44JjI1NV08PDhec2JveFt0bXAmMjU1XTtpZihpJWtleUxlbj09PTApe3RtcD10bXA8PDhedG1wPj4+MjRecmNvbjw8MjQ7cmNvbj1yY29uPDwxXihyY29uPj43KSoyODN9fWVuY0tleVtpXT1lbmNLZXlbaS1rZXlMZW5dXnRtcH1mb3Ioaj0wO2k7aisrLGktLSl7dG1wPWVuY0tleVtqJjM/aTppLTRdO2lmKGk8PTR8fGo8NCl7ZGVjS2V5W2pdPXRtcH1lbHNle2RlY0tleVtqXT1kZWNUYWJsZVswXVtzYm94W3RtcD4+PjI0XV1eZGVjVGFibGVbMV1bc2JveFt0bXA+PjE2JjI1NV1dXmRlY1RhYmxlWzJdW3Nib3hbdG1wPj44JjI1NV1dXmRlY1RhYmxlWzNdW3Nib3hbdG1wJjI1NV1dfX19O3NqY2wuY2lwaGVyLmFlcy5wcm90b3R5cGU9e2VuY3J5cHQ6ZnVuY3Rpb24oZGF0YSl7cmV0dXJuIHRoaXMuX2NyeXB0KGRhdGEsMCl9LGRlY3J5cHQ6ZnVuY3Rpb24oZGF0YSl7cmV0dXJuIHRoaXMuX2NyeXB0KGRhdGEsMSl9LF90YWJsZXM6W1tbXSxbXSxbXSxbXSxbXV0sW1tdLFtdLFtdLFtdLFtdXV0sX3ByZWNvbXB1dGU6ZnVuY3Rpb24oKXt2YXIgZW5jVGFibGU9dGhpcy5fdGFibGVzWzBdLGRlY1RhYmxlPXRoaXMuX3RhYmxlc1sxXSxzYm94PWVuY1RhYmxlWzRdLHNib3hJbnY9ZGVjVGFibGVbNF0saSx4LHhJbnYsZD1bXSx0aD1bXSx4Mix4NCx4OCxzLHRFbmMsdERlYztmb3IoaT0wO2k8MjU2O2krKyl7dGhbKGRbaV09aTw8MV4oaT4+NykqMjgzKV5pXT1pfWZvcih4PXhJbnY9MDshc2JveFt4XTt4Xj14Mnx8MSx4SW52PXRoW3hJbnZdfHwxKXtzPXhJbnZeeEludjw8MV54SW52PDwyXnhJbnY8PDNeeEludjw8NDtzPXM+PjhecyYyNTVeOTk7c2JveFt4XT1zO3Nib3hJbnZbc109eDt4OD1kW3g0PWRbeDI9ZFt4XV1dO3REZWM9eDgqMTY4NDMwMDleeDQqNjU1MzdeeDIqMjU3XngqMTY4NDMwMDg7dEVuYz1kW3NdKjI1N15zKjE2ODQzMDA4O2ZvcihpPTA7aTw0O2krKyl7ZW5jVGFibGVbaV1beF09dEVuYz10RW5jPDwyNF50RW5jPj4+ODtkZWNUYWJsZVtpXVtzXT10RGVjPXREZWM8PDI0XnREZWM+Pj44fX1mb3IoaT0wO2k8NTtpKyspe2VuY1RhYmxlW2ldPWVuY1RhYmxlW2ldLnNsaWNlKDApO2RlY1RhYmxlW2ldPWRlY1RhYmxlW2ldLnNsaWNlKDApfX0sX2NyeXB0OmZ1bmN0aW9uKGlucHV0LGRpcil7aWYoaW5wdXQubGVuZ3RoIT09NCl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImludmFsaWQgYWVzIGJsb2NrIHNpemUiKX12YXIga2V5PXRoaXMuX2tleVtkaXJdLGE9aW5wdXRbMF1ea2V5WzBdLGI9aW5wdXRbZGlyPzM6MV1ea2V5WzFdLGM9aW5wdXRbMl1ea2V5WzJdLGQ9aW5wdXRbZGlyPzE6M11ea2V5WzNdLGEyLGIyLGMyLG5Jbm5lclJvdW5kcz1rZXkubGVuZ3RoLzQtMixpLGtJbmRleD00LG91dD1bMCwwLDAsMF0sdGFibGU9dGhpcy5fdGFibGVzW2Rpcl0sdDA9dGFibGVbMF0sdDE9dGFibGVbMV0sdDI9dGFibGVbMl0sdDM9dGFibGVbM10sc2JveD10YWJsZVs0XTtmb3IoaT0wO2k8bklubmVyUm91bmRzO2krKyl7YTI9dDBbYT4+PjI0XV50MVtiPj4xNiYyNTVdXnQyW2M+PjgmMjU1XV50M1tkJjI1NV1ea2V5W2tJbmRleF07YjI9dDBbYj4+PjI0XV50MVtjPj4xNiYyNTVdXnQyW2Q+PjgmMjU1XV50M1thJjI1NV1ea2V5W2tJbmRleCsxXTtjMj10MFtjPj4+MjRdXnQxW2Q+PjE2JjI1NV1edDJbYT4+OCYyNTVdXnQzW2ImMjU1XV5rZXlba0luZGV4KzJdO2Q9dDBbZD4+PjI0XV50MVthPj4xNiYyNTVdXnQyW2I+PjgmMjU1XV50M1tjJjI1NV1ea2V5W2tJbmRleCszXTtrSW5kZXgrPTQ7YT1hMjtiPWIyO2M9YzJ9Zm9yKGk9MDtpPDQ7aSsrKXtvdXRbZGlyPzMmLWk6aV09c2JveFthPj4+MjRdPDwyNF5zYm94W2I+PjE2JjI1NV08PDE2XnNib3hbYz4+OCYyNTVdPDw4XnNib3hbZCYyNTVdXmtleVtrSW5kZXgrK107YTI9YTthPWI7Yj1jO2M9ZDtkPWEyfXJldHVybiBvdXR9fTtzamNsLmJpdEFycmF5PXtiaXRTbGljZTpmdW5jdGlvbihhLGJzdGFydCxiZW5kKXthPXNqY2wuYml0QXJyYXkuX3NoaWZ0UmlnaHQoYS5zbGljZShic3RhcnQvMzIpLDMyLShic3RhcnQmMzEpKS5zbGljZSgxKTtyZXR1cm4gYmVuZD09PXVuZGVmaW5lZD9hOnNqY2wuYml0QXJyYXkuY2xhbXAoYSxiZW5kLWJzdGFydCl9LGV4dHJhY3Q6ZnVuY3Rpb24oYSxic3RhcnQsYmxlbmd0aCl7dmFyIHgsc2g9TWF0aC5mbG9vcigtYnN0YXJ0LWJsZW5ndGgmMzEpO2lmKChic3RhcnQrYmxlbmd0aC0xXmJzdGFydCkmLTMyKXt4PWFbYnN0YXJ0LzMyfDBdPDwzMi1zaF5hW2JzdGFydC8zMisxfDBdPj4+c2h9ZWxzZXt4PWFbYnN0YXJ0LzMyfDBdPj4+c2h9cmV0dXJuIHgmKDE8PGJsZW5ndGgpLTF9LGNvbmNhdDpmdW5jdGlvbihhMSxhMil7aWYoYTEubGVuZ3RoPT09MHx8YTIubGVuZ3RoPT09MCl7cmV0dXJuIGExLmNvbmNhdChhMil9dmFyIGxhc3Q9YTFbYTEubGVuZ3RoLTFdLHNoaWZ0PXNqY2wuYml0QXJyYXkuZ2V0UGFydGlhbChsYXN0KTtpZihzaGlmdD09PTMyKXtyZXR1cm4gYTEuY29uY2F0KGEyKX1lbHNle3JldHVybiBzamNsLmJpdEFycmF5Ll9zaGlmdFJpZ2h0KGEyLHNoaWZ0LGxhc3R8MCxhMS5zbGljZSgwLGExLmxlbmd0aC0xKSl9fSxiaXRMZW5ndGg6ZnVuY3Rpb24oYSl7dmFyIGw9YS5sZW5ndGgseDtpZihsPT09MCl7cmV0dXJuIDB9eD1hW2wtMV07cmV0dXJuKGwtMSkqMzIrc2pjbC5iaXRBcnJheS5nZXRQYXJ0aWFsKHgpfSxjbGFtcDpmdW5jdGlvbihhLGxlbil7aWYoYS5sZW5ndGgqMzI8bGVuKXtyZXR1cm4gYX1hPWEuc2xpY2UoMCxNYXRoLmNlaWwobGVuLzMyKSk7dmFyIGw9YS5sZW5ndGg7bGVuPWxlbiYzMTtpZihsPjAmJmxlbil7YVtsLTFdPXNqY2wuYml0QXJyYXkucGFydGlhbChsZW4sYVtsLTFdJjIxNDc0ODM2NDg+Pmxlbi0xLDEpfXJldHVybiBhfSxwYXJ0aWFsOmZ1bmN0aW9uKGxlbix4LF9lbmQpe2lmKGxlbj09PTMyKXtyZXR1cm4geH1yZXR1cm4oX2VuZD94fDA6eDw8MzItbGVuKStsZW4qMTA5OTUxMTYyNzc3Nn0sZ2V0UGFydGlhbDpmdW5jdGlvbih4KXtyZXR1cm4gTWF0aC5yb3VuZCh4LzEwOTk1MTE2Mjc3NzYpfHwzMn0sZXF1YWw6ZnVuY3Rpb24oYSxiKXtpZihzamNsLmJpdEFycmF5LmJpdExlbmd0aChhKSE9PXNqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGIpKXtyZXR1cm4gZmFsc2V9dmFyIHg9MCxpO2ZvcihpPTA7aTxhLmxlbmd0aDtpKyspe3h8PWFbaV1eYltpXX1yZXR1cm4geD09PTB9LF9zaGlmdFJpZ2h0OmZ1bmN0aW9uKGEsc2hpZnQsY2Fycnksb3V0KXt2YXIgaSxsYXN0Mj0wLHNoaWZ0MjtpZihvdXQ9PT11bmRlZmluZWQpe291dD1bXX1mb3IoO3NoaWZ0Pj0zMjtzaGlmdC09MzIpe291dC5wdXNoKGNhcnJ5KTtjYXJyeT0wfWlmKHNoaWZ0PT09MCl7cmV0dXJuIG91dC5jb25jYXQoYSl9Zm9yKGk9MDtpPGEubGVuZ3RoO2krKyl7b3V0LnB1c2goY2Fycnl8YVtpXT4+PnNoaWZ0KTtjYXJyeT1hW2ldPDwzMi1zaGlmdH1sYXN0Mj1hLmxlbmd0aD9hW2EubGVuZ3RoLTFdOjA7c2hpZnQyPXNqY2wuYml0QXJyYXkuZ2V0UGFydGlhbChsYXN0Mik7b3V0LnB1c2goc2pjbC5iaXRBcnJheS5wYXJ0aWFsKHNoaWZ0K3NoaWZ0MiYzMSxzaGlmdCtzaGlmdDI+MzI/Y2Fycnk6b3V0LnBvcCgpLDEpKTtyZXR1cm4gb3V0fSxfeG9yNDpmdW5jdGlvbih4LHkpe3JldHVyblt4WzBdXnlbMF0seFsxXV55WzFdLHhbMl1eeVsyXSx4WzNdXnlbM11dfSxieXRlc3dhcE06ZnVuY3Rpb24oYSl7dmFyIGksdixtPTY1MjgwO2ZvcihpPTA7aTxhLmxlbmd0aDsrK2kpe3Y9YVtpXTthW2ldPXY+Pj4yNHx2Pj4+OCZtfCh2Jm0pPDw4fHY8PDI0fXJldHVybiBhfX07c2pjbC5jb2RlYy51dGY4U3RyaW5nPXtmcm9tQml0czpmdW5jdGlvbihhcnIpe3ZhciBvdXQ9IiIsYmw9c2pjbC5iaXRBcnJheS5iaXRMZW5ndGgoYXJyKSxpLHRtcDtmb3IoaT0wO2k8YmwvODtpKyspe2lmKChpJjMpPT09MCl7dG1wPWFycltpLzRdfW91dCs9U3RyaW5nLmZyb21DaGFyQ29kZSh0bXA+Pj44Pj4+OD4+PjgpO3RtcDw8PTh9cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUob3V0KSl9LHRvQml0czpmdW5jdGlvbihzdHIpe3N0cj11bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSk7dmFyIG91dD1bXSxpLHRtcD0wO2ZvcihpPTA7aTxzdHIubGVuZ3RoO2krKyl7dG1wPXRtcDw8OHxzdHIuY2hhckNvZGVBdChpKTtpZigoaSYzKT09PTMpe291dC5wdXNoKHRtcCk7dG1wPTB9fWlmKGkmMyl7b3V0LnB1c2goc2pjbC5iaXRBcnJheS5wYXJ0aWFsKDgqKGkmMyksdG1wKSl9cmV0dXJuIG91dH19O3NqY2wuY29kZWMuYmFzZTY0PXtfY2hhcnM6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLGZyb21CaXRzOmZ1bmN0aW9uKGFycixfbm9FcXVhbHMsX3VybCl7dmFyIG91dD0iIixpLGJpdHM9MCxjPXNqY2wuY29kZWMuYmFzZTY0Ll9jaGFycyx0YT0wLGJsPXNqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGFycik7aWYoX3VybCl7Yz1jLnN1YnN0cigwLDYyKSsiLV8ifWZvcihpPTA7b3V0Lmxlbmd0aCo2PGJsOyl7b3V0Kz1jLmNoYXJBdCgodGFeYXJyW2ldPj4+Yml0cyk+Pj4yNik7aWYoYml0czw2KXt0YT1hcnJbaV08PDYtYml0cztiaXRzKz0yNjtpKyt9ZWxzZXt0YTw8PTY7Yml0cy09Nn19d2hpbGUob3V0Lmxlbmd0aCYzJiYhX25vRXF1YWxzKXtvdXQrPSI9In1yZXR1cm4gb3V0fSx0b0JpdHM6ZnVuY3Rpb24oc3RyLF91cmwpe3N0cj1zdHIucmVwbGFjZSgvXHN8PS9nLCIiKTt2YXIgb3V0PVtdLGksYml0cz0wLGM9c2pjbC5jb2RlYy5iYXNlNjQuX2NoYXJzLHRhPTAseDtpZihfdXJsKXtjPWMuc3Vic3RyKDAsNjIpKyItXyJ9Zm9yKGk9MDtpPHN0ci5sZW5ndGg7aSsrKXt4PWMuaW5kZXhPZihzdHIuY2hhckF0KGkpKTtpZih4PDApe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJ0aGlzIGlzbid0IGJhc2U2NCEiKX1pZihiaXRzPjI2KXtiaXRzLT0yNjtvdXQucHVzaCh0YV54Pj4+Yml0cyk7dGE9eDw8MzItYml0c31lbHNle2JpdHMrPTY7dGFePXg8PDMyLWJpdHN9fWlmKGJpdHMmNTYpe291dC5wdXNoKHNqY2wuYml0QXJyYXkucGFydGlhbChiaXRzJjU2LHRhLDEpKX1yZXR1cm4gb3V0fX07c2pjbC5jb2RlYy5iYXNlNjR1cmw9e2Zyb21CaXRzOmZ1bmN0aW9uKGFycil7cmV0dXJuIHNqY2wuY29kZWMuYmFzZTY0LmZyb21CaXRzKGFyciwxLDEpfSx0b0JpdHM6ZnVuY3Rpb24oc3RyKXtyZXR1cm4gc2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHN0ciwxKX19O3NqY2wuaGFzaC5zaGEyNTY9ZnVuY3Rpb24oaGFzaCl7aWYoIXRoaXMuX2tleVswXSl7dGhpcy5fcHJlY29tcHV0ZSgpfWlmKGhhc2gpe3RoaXMuX2g9aGFzaC5faC5zbGljZSgwKTt0aGlzLl9idWZmZXI9aGFzaC5fYnVmZmVyLnNsaWNlKDApO3RoaXMuX2xlbmd0aD1oYXNoLl9sZW5ndGh9ZWxzZXt0aGlzLnJlc2V0KCl9fTtzamNsLmhhc2guc2hhMjU2Lmhhc2g9ZnVuY3Rpb24oZGF0YSl7cmV0dXJuKG5ldyBzamNsLmhhc2guc2hhMjU2KS51cGRhdGUoZGF0YSkuZmluYWxpemUoKX07c2pjbC5oYXNoLnNoYTI1Ni5wcm90b3R5cGU9e2Jsb2NrU2l6ZTo1MTIscmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oPXRoaXMuX2luaXQuc2xpY2UoMCk7dGhpcy5fYnVmZmVyPVtdO3RoaXMuX2xlbmd0aD0wO3JldHVybiB0aGlzfSx1cGRhdGU6ZnVuY3Rpb24oZGF0YSl7aWYodHlwZW9mIGRhdGE9PT0ic3RyaW5nIil7ZGF0YT1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKGRhdGEpfXZhciBpLGI9dGhpcy5fYnVmZmVyPXNqY2wuYml0QXJyYXkuY29uY2F0KHRoaXMuX2J1ZmZlcixkYXRhKSxvbD10aGlzLl9sZW5ndGgsbmw9dGhpcy5fbGVuZ3RoPW9sK3NqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGRhdGEpO2lmKG5sPjkwMDcxOTkyNTQ3NDA5OTEpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJDYW5ub3QgaGFzaCBtb3JlIHRoYW4gMl41MyAtIDEgYml0cyIpfWlmKHR5cGVvZiBVaW50MzJBcnJheSE9PSJ1bmRlZmluZWQiKXt2YXIgYz1uZXcgVWludDMyQXJyYXkoYik7dmFyIGo9MDtmb3IoaT01MTIrb2wtKDUxMitvbCY1MTEpO2k8PW5sO2krPTUxMil7dGhpcy5fYmxvY2soYy5zdWJhcnJheSgxNipqLDE2KihqKzEpKSk7ais9MX1iLnNwbGljZSgwLDE2KmopfWVsc2V7Zm9yKGk9NTEyK29sLSg1MTIrb2wmNTExKTtpPD1ubDtpKz01MTIpe3RoaXMuX2Jsb2NrKGIuc3BsaWNlKDAsMTYpKX19cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGksYj10aGlzLl9idWZmZXIsaD10aGlzLl9oO2I9c2pjbC5iaXRBcnJheS5jb25jYXQoYixbc2pjbC5iaXRBcnJheS5wYXJ0aWFsKDEsMSldKTtmb3IoaT1iLmxlbmd0aCsyO2kmMTU7aSsrKXtiLnB1c2goMCl9Yi5wdXNoKE1hdGguZmxvb3IodGhpcy5fbGVuZ3RoLzQyOTQ5NjcyOTYpKTtiLnB1c2godGhpcy5fbGVuZ3RofDApO3doaWxlKGIubGVuZ3RoKXt0aGlzLl9ibG9jayhiLnNwbGljZSgwLDE2KSl9dGhpcy5yZXNldCgpO3JldHVybiBofSxfaW5pdDpbXSxfa2V5OltdLF9wcmVjb21wdXRlOmZ1bmN0aW9uKCl7dmFyIGk9MCxwcmltZT0yLGZhY3Rvcixpc1ByaW1lO2Z1bmN0aW9uIGZyYWMoeCl7cmV0dXJuKHgtTWF0aC5mbG9vcih4KSkqNDI5NDk2NzI5NnwwfWZvcig7aTw2NDtwcmltZSsrKXtpc1ByaW1lPXRydWU7Zm9yKGZhY3Rvcj0yO2ZhY3RvcipmYWN0b3I8PXByaW1lO2ZhY3RvcisrKXtpZihwcmltZSVmYWN0b3I9PT0wKXtpc1ByaW1lPWZhbHNlO2JyZWFrfX1pZihpc1ByaW1lKXtpZihpPDgpe3RoaXMuX2luaXRbaV09ZnJhYyhNYXRoLnBvdyhwcmltZSwxLzIpKX10aGlzLl9rZXlbaV09ZnJhYyhNYXRoLnBvdyhwcmltZSwxLzMpKTtpKyt9fX0sX2Jsb2NrOmZ1bmN0aW9uKHcpe3ZhciBpLHRtcCxhLGIsaD10aGlzLl9oLGs9dGhpcy5fa2V5LGgwPWhbMF0saDE9aFsxXSxoMj1oWzJdLGgzPWhbM10saDQ9aFs0XSxoNT1oWzVdLGg2PWhbNl0saDc9aFs3XTtmb3IoaT0wO2k8NjQ7aSsrKXtpZihpPDE2KXt0bXA9d1tpXX1lbHNle2E9d1tpKzEmMTVdO2I9d1tpKzE0JjE1XTt0bXA9d1tpJjE1XT0oYT4+PjdeYT4+PjE4XmE+Pj4zXmE8PDI1XmE8PDE0KSsoYj4+PjE3XmI+Pj4xOV5iPj4+MTBeYjw8MTVeYjw8MTMpK3dbaSYxNV0rd1tpKzkmMTVdfDB9dG1wPXRtcCtoNysoaDQ+Pj42Xmg0Pj4+MTFeaDQ+Pj4yNV5oNDw8MjZeaDQ8PDIxXmg0PDw3KSsoaDZeaDQmKGg1Xmg2KSkra1tpXTtoNz1oNjtoNj1oNTtoNT1oNDtoND1oMyt0bXB8MDtoMz1oMjtoMj1oMTtoMT1oMDtoMD10bXArKGgxJmgyXmgzJihoMV5oMikpKyhoMT4+PjJeaDE+Pj4xM15oMT4+PjIyXmgxPDwzMF5oMTw8MTleaDE8PDEwKXwwfWhbMF09aFswXStoMHwwO2hbMV09aFsxXStoMXwwO2hbMl09aFsyXStoMnwwO2hbM109aFszXStoM3wwO2hbNF09aFs0XStoNHwwO2hbNV09aFs1XStoNXwwO2hbNl09aFs2XStoNnwwO2hbN109aFs3XStoN3wwfX07c2pjbC5tb2RlLmNjbT17bmFtZToiY2NtIixfcHJvZ3Jlc3NMaXN0ZW5lcnM6W10sbGlzdGVuUHJvZ3Jlc3M6ZnVuY3Rpb24oY2Ipe3NqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnB1c2goY2IpfSx1bkxpc3RlblByb2dyZXNzOmZ1bmN0aW9uKGNiKXt2YXIgaW5kZXg9c2pjbC5tb2RlLmNjbS5fcHJvZ3Jlc3NMaXN0ZW5lcnMuaW5kZXhPZihjYik7aWYoaW5kZXg+LTEpe3NqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnNwbGljZShpbmRleCwxKX19LF9jYWxsUHJvZ3Jlc3NMaXN0ZW5lcjpmdW5jdGlvbih2YWwpe3ZhciBwPXNqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnNsaWNlKCksaTtmb3IoaT0wO2k8cC5sZW5ndGg7aSs9MSl7cFtpXSh2YWwpfX0sZW5jcnlwdDpmdW5jdGlvbihwcmYscGxhaW50ZXh0LGl2LGFkYXRhLHRsZW4pe3ZhciBMLG91dD1wbGFpbnRleHQuc2xpY2UoMCksdGFnLHc9c2pjbC5iaXRBcnJheSxpdmw9dy5iaXRMZW5ndGgoaXYpLzgsb2w9dy5iaXRMZW5ndGgob3V0KS84O3RsZW49dGxlbnx8NjQ7YWRhdGE9YWRhdGF8fFtdO2lmKGl2bDw3KXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiY2NtOiBpdiBtdXN0IGJlIGF0IGxlYXN0IDcgYnl0ZXMiKX1mb3IoTD0yO0w8NCYmb2w+Pj44Kkw7TCsrKXt9aWYoTDwxNS1pdmwpe0w9MTUtaXZsfWl2PXcuY2xhbXAoaXYsOCooMTUtTCkpO3RhZz1zamNsLm1vZGUuY2NtLl9jb21wdXRlVGFnKHByZixwbGFpbnRleHQsaXYsYWRhdGEsdGxlbixMKTtvdXQ9c2pjbC5tb2RlLmNjbS5fY3RyTW9kZShwcmYsb3V0LGl2LHRhZyx0bGVuLEwpO3JldHVybiB3LmNvbmNhdChvdXQuZGF0YSxvdXQudGFnKX0sZGVjcnlwdDpmdW5jdGlvbihwcmYsY2lwaGVydGV4dCxpdixhZGF0YSx0bGVuKXt0bGVuPXRsZW58fDY0O2FkYXRhPWFkYXRhfHxbXTt2YXIgTCx3PXNqY2wuYml0QXJyYXksaXZsPXcuYml0TGVuZ3RoKGl2KS84LG9sPXcuYml0TGVuZ3RoKGNpcGhlcnRleHQpLG91dD13LmNsYW1wKGNpcGhlcnRleHQsb2wtdGxlbiksdGFnPXcuYml0U2xpY2UoY2lwaGVydGV4dCxvbC10bGVuKSx0YWcyO29sPShvbC10bGVuKS84O2lmKGl2bDw3KXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiY2NtOiBpdiBtdXN0IGJlIGF0IGxlYXN0IDcgYnl0ZXMiKX1mb3IoTD0yO0w8NCYmb2w+Pj44Kkw7TCsrKXt9aWYoTDwxNS1pdmwpe0w9MTUtaXZsfWl2PXcuY2xhbXAoaXYsOCooMTUtTCkpO291dD1zamNsLm1vZGUuY2NtLl9jdHJNb2RlKHByZixvdXQsaXYsdGFnLHRsZW4sTCk7dGFnMj1zamNsLm1vZGUuY2NtLl9jb21wdXRlVGFnKHByZixvdXQuZGF0YSxpdixhZGF0YSx0bGVuLEwpO2lmKCF3LmVxdWFsKG91dC50YWcsdGFnMikpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5jb3JydXB0KCJjY206IHRhZyBkb2Vzbid0IG1hdGNoIil9cmV0dXJuIG91dC5kYXRhfSxfbWFjQWRkaXRpb25hbERhdGE6ZnVuY3Rpb24ocHJmLGFkYXRhLGl2LHRsZW4sb2wsTCl7dmFyIG1hYyx0bXAsaSxtYWNEYXRhPVtdLHc9c2pjbC5iaXRBcnJheSx4b3I9dy5feG9yNDttYWM9W3cucGFydGlhbCg4LChhZGF0YS5sZW5ndGg/MTw8NjowKXx0bGVuLTI8PDJ8TC0xKV07bWFjPXcuY29uY2F0KG1hYyxpdik7bWFjWzNdfD1vbDttYWM9cHJmLmVuY3J5cHQobWFjKTtpZihhZGF0YS5sZW5ndGgpe3RtcD13LmJpdExlbmd0aChhZGF0YSkvODtpZih0bXA8PTY1Mjc5KXttYWNEYXRhPVt3LnBhcnRpYWwoMTYsdG1wKV19ZWxzZSBpZih0bXA8PTQyOTQ5NjcyOTUpe21hY0RhdGE9dy5jb25jYXQoW3cucGFydGlhbCgxNiw2NTUzNCldLFt0bXBdKX1tYWNEYXRhPXcuY29uY2F0KG1hY0RhdGEsYWRhdGEpO2ZvcihpPTA7aTxtYWNEYXRhLmxlbmd0aDtpKz00KXttYWM9cHJmLmVuY3J5cHQoeG9yKG1hYyxtYWNEYXRhLnNsaWNlKGksaSs0KS5jb25jYXQoWzAsMCwwXSkpKX19cmV0dXJuIG1hY30sX2NvbXB1dGVUYWc6ZnVuY3Rpb24ocHJmLHBsYWludGV4dCxpdixhZGF0YSx0bGVuLEwpe3ZhciBtYWMsaSx3PXNqY2wuYml0QXJyYXkseG9yPXcuX3hvcjQ7dGxlbi89ODtpZih0bGVuJTJ8fHRsZW48NHx8dGxlbj4xNil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImNjbTogaW52YWxpZCB0YWcgbGVuZ3RoIil9aWYoYWRhdGEubGVuZ3RoPjQyOTQ5NjcyOTV8fHBsYWludGV4dC5sZW5ndGg+NDI5NDk2NzI5NSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygiY2NtOiBjYW4ndCBkZWFsIHdpdGggNEdpQiBvciBtb3JlIGRhdGEiKX1tYWM9c2pjbC5tb2RlLmNjbS5fbWFjQWRkaXRpb25hbERhdGEocHJmLGFkYXRhLGl2LHRsZW4sdy5iaXRMZW5ndGgocGxhaW50ZXh0KS84LEwpO2ZvcihpPTA7aTxwbGFpbnRleHQubGVuZ3RoO2krPTQpe21hYz1wcmYuZW5jcnlwdCh4b3IobWFjLHBsYWludGV4dC5zbGljZShpLGkrNCkuY29uY2F0KFswLDAsMF0pKSl9cmV0dXJuIHcuY2xhbXAobWFjLHRsZW4qOCl9LF9jdHJNb2RlOmZ1bmN0aW9uKHByZixkYXRhLGl2LHRhZyx0bGVuLEwpe3ZhciBlbmMsaSx3PXNqY2wuYml0QXJyYXkseG9yPXcuX3hvcjQsY3RyLGw9ZGF0YS5sZW5ndGgsYmw9dy5iaXRMZW5ndGgoZGF0YSksbj1sLzUwLHA9bjtjdHI9dy5jb25jYXQoW3cucGFydGlhbCg4LEwtMSldLGl2KS5jb25jYXQoWzAsMCwwXSkuc2xpY2UoMCw0KTt0YWc9dy5iaXRTbGljZSh4b3IodGFnLHByZi5lbmNyeXB0KGN0cikpLDAsdGxlbik7aWYoIWwpe3JldHVybnt0YWc6dGFnLGRhdGE6W119fWZvcihpPTA7aTxsO2krPTQpe2lmKGk+bil7c2pjbC5tb2RlLmNjbS5fY2FsbFByb2dyZXNzTGlzdGVuZXIoaS9sKTtuKz1wfWN0clszXSsrO2VuYz1wcmYuZW5jcnlwdChjdHIpO2RhdGFbaV1ePWVuY1swXTtkYXRhW2krMV1ePWVuY1sxXTtkYXRhW2krMl1ePWVuY1syXTtkYXRhW2krM11ePWVuY1szXX1yZXR1cm57dGFnOnRhZyxkYXRhOncuY2xhbXAoZGF0YSxibCl9fX07c2pjbC5taXNjLmhtYWM9ZnVuY3Rpb24oa2V5LEhhc2gpe3RoaXMuX2hhc2g9SGFzaD1IYXNofHxzamNsLmhhc2guc2hhMjU2O3ZhciBleEtleT1bW10sW11dLGksYnM9SGFzaC5wcm90b3R5cGUuYmxvY2tTaXplLzMyO3RoaXMuX2Jhc2VIYXNoPVtuZXcgSGFzaCxuZXcgSGFzaF07aWYoa2V5Lmxlbmd0aD5icyl7a2V5PUhhc2guaGFzaChrZXkpfWZvcihpPTA7aTxicztpKyspe2V4S2V5WzBdW2ldPWtleVtpXV45MDk1MjI0ODY7ZXhLZXlbMV1baV09a2V5W2ldXjE1NDk1NTY4Mjh9dGhpcy5fYmFzZUhhc2hbMF0udXBkYXRlKGV4S2V5WzBdKTt0aGlzLl9iYXNlSGFzaFsxXS51cGRhdGUoZXhLZXlbMV0pO3RoaXMuX3Jlc3VsdEhhc2g9bmV3IEhhc2godGhpcy5fYmFzZUhhc2hbMF0pfTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUuZW5jcnlwdD1zamNsLm1pc2MuaG1hYy5wcm90b3R5cGUubWFjPWZ1bmN0aW9uKGRhdGEpe2lmKCF0aGlzLl91cGRhdGVkKXt0aGlzLnVwZGF0ZShkYXRhKTtyZXR1cm4gdGhpcy5kaWdlc3QoZGF0YSl9ZWxzZXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiZW5jcnlwdCBvbiBhbHJlYWR5IHVwZGF0ZWQgaG1hYyBjYWxsZWQhIil9fTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLl9yZXN1bHRIYXNoPW5ldyB0aGlzLl9oYXNoKHRoaXMuX2Jhc2VIYXNoWzBdKTt0aGlzLl91cGRhdGVkPWZhbHNlfTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKGRhdGEpe3RoaXMuX3VwZGF0ZWQ9dHJ1ZTt0aGlzLl9yZXN1bHRIYXNoLnVwZGF0ZShkYXRhKX07c2pjbC5taXNjLmhtYWMucHJvdG90eXBlLmRpZ2VzdD1mdW5jdGlvbigpe3ZhciB3PXRoaXMuX3Jlc3VsdEhhc2guZmluYWxpemUoKSxyZXN1bHQ9bmV3IHRoaXMuX2hhc2godGhpcy5fYmFzZUhhc2hbMV0pLnVwZGF0ZSh3KS5maW5hbGl6ZSgpO3RoaXMucmVzZXQoKTtyZXR1cm4gcmVzdWx0fTtzamNsLm1pc2MucGJrZGYyPWZ1bmN0aW9uKHBhc3N3b3JkLHNhbHQsY291bnQsbGVuZ3RoLFByZmYpe2NvdW50PWNvdW50fHwxZTQ7aWYobGVuZ3RoPDB8fGNvdW50PDApe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJpbnZhbGlkIHBhcmFtcyB0byBwYmtkZjIiKX1pZih0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIil7cGFzc3dvcmQ9c2pjbC5jb2RlYy51dGY4U3RyaW5nLnRvQml0cyhwYXNzd29yZCl9aWYodHlwZW9mIHNhbHQ9PT0ic3RyaW5nIil7c2FsdD1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKHNhbHQpfVByZmY9UHJmZnx8c2pjbC5taXNjLmhtYWM7dmFyIHByZj1uZXcgUHJmZihwYXNzd29yZCksdSx1aSxpLGosayxvdXQ9W10sYj1zamNsLmJpdEFycmF5O2ZvcihrPTE7MzIqb3V0Lmxlbmd0aDwobGVuZ3RofHwxKTtrKyspe3U9dWk9cHJmLmVuY3J5cHQoYi5jb25jYXQoc2FsdCxba10pKTtmb3IoaT0xO2k8Y291bnQ7aSsrKXt1aT1wcmYuZW5jcnlwdCh1aSk7Zm9yKGo9MDtqPHVpLmxlbmd0aDtqKyspe3Vbal1ePXVpW2pdfX1vdXQ9b3V0LmNvbmNhdCh1KX1pZihsZW5ndGgpe291dD1iLmNsYW1wKG91dCxsZW5ndGgpfXJldHVybiBvdXR9O3NqY2wucHJuZz1mdW5jdGlvbihkZWZhdWx0UGFyYW5vaWEpe3RoaXMuX3Bvb2xzPVtuZXcgc2pjbC5oYXNoLnNoYTI1Nl07dGhpcy5fcG9vbEVudHJvcHk9WzBdO3RoaXMuX3Jlc2VlZENvdW50PTA7dGhpcy5fcm9iaW5zPXt9O3RoaXMuX2V2ZW50SWQ9MDt0aGlzLl9jb2xsZWN0b3JJZHM9e307dGhpcy5fY29sbGVjdG9ySWROZXh0PTA7dGhpcy5fc3RyZW5ndGg9MDt0aGlzLl9wb29sU3RyZW5ndGg9MDt0aGlzLl9uZXh0UmVzZWVkPTA7dGhpcy5fa2V5PVswLDAsMCwwLDAsMCwwLDBdO3RoaXMuX2NvdW50ZXI9WzAsMCwwLDBdO3RoaXMuX2NpcGhlcj11bmRlZmluZWQ7dGhpcy5fZGVmYXVsdFBhcmFub2lhPWRlZmF1bHRQYXJhbm9pYTt0aGlzLl9jb2xsZWN0b3JzU3RhcnRlZD1mYWxzZTt0aGlzLl9jYWxsYmFja3M9e3Byb2dyZXNzOnt9LHNlZWRlZDp7fX07dGhpcy5fY2FsbGJhY2tJPTA7dGhpcy5fTk9UX1JFQURZPTA7dGhpcy5fUkVBRFk9MTt0aGlzLl9SRVFVSVJFU19SRVNFRUQ9Mjt0aGlzLl9NQVhfV09SRFNfUEVSX0JVUlNUPTY1NTM2O3RoaXMuX1BBUkFOT0lBX0xFVkVMUz1bMCw0OCw2NCw5NiwxMjgsMTkyLDI1NiwzODQsNTEyLDc2OCwxMDI0XTt0aGlzLl9NSUxMSVNFQ09ORFNfUEVSX1JFU0VFRD0zZTQ7dGhpcy5fQklUU19QRVJfUkVTRUVEPTgwfTtzamNsLnBybmcucHJvdG90eXBlPXtyYW5kb21Xb3JkczpmdW5jdGlvbihud29yZHMscGFyYW5vaWEpe3ZhciBvdXQ9W10saSxyZWFkaW5lc3M9dGhpcy5pc1JlYWR5KHBhcmFub2lhKSxnO2lmKHJlYWRpbmVzcz09PXRoaXMuX05PVF9SRUFEWSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLm5vdFJlYWR5KCJnZW5lcmF0b3IgaXNuJ3Qgc2VlZGVkIil9ZWxzZSBpZihyZWFkaW5lc3MmdGhpcy5fUkVRVUlSRVNfUkVTRUVEKXt0aGlzLl9yZXNlZWRGcm9tUG9vbHMoIShyZWFkaW5lc3MmdGhpcy5fUkVBRFkpKX1mb3IoaT0wO2k8bndvcmRzO2krPTQpe2lmKChpKzEpJXRoaXMuX01BWF9XT1JEU19QRVJfQlVSU1Q9PT0wKXt0aGlzLl9nYXRlKCl9Zz10aGlzLl9nZW40d29yZHMoKTtvdXQucHVzaChnWzBdLGdbMV0sZ1syXSxnWzNdKX10aGlzLl9nYXRlKCk7cmV0dXJuIG91dC5zbGljZSgwLG53b3Jkcyl9LHNldERlZmF1bHRQYXJhbm9pYTpmdW5jdGlvbihwYXJhbm9pYSxhbGxvd1plcm9QYXJhbm9pYSl7aWYocGFyYW5vaWE9PT0wJiZhbGxvd1plcm9QYXJhbm9pYSE9PSJTZXR0aW5nIHBhcmFub2lhPTAgd2lsbCBydWluIHlvdXIgc2VjdXJpdHk7IHVzZSBpdCBvbmx5IGZvciB0ZXN0aW5nIil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoIlNldHRpbmcgcGFyYW5vaWE9MCB3aWxsIHJ1aW4geW91ciBzZWN1cml0eTsgdXNlIGl0IG9ubHkgZm9yIHRlc3RpbmciKX10aGlzLl9kZWZhdWx0UGFyYW5vaWE9cGFyYW5vaWF9LGFkZEVudHJvcHk6ZnVuY3Rpb24oZGF0YSxlc3RpbWF0ZWRFbnRyb3B5LHNvdXJjZSl7c291cmNlPXNvdXJjZXx8InVzZXIiO3ZhciBpZCxpLHRtcCx0PShuZXcgRGF0ZSkudmFsdWVPZigpLHJvYmluPXRoaXMuX3JvYmluc1tzb3VyY2VdLG9sZFJlYWR5PXRoaXMuaXNSZWFkeSgpLGVycj0wLG9iak5hbWU7aWQ9dGhpcy5fY29sbGVjdG9ySWRzW3NvdXJjZV07aWYoaWQ9PT11bmRlZmluZWQpe2lkPXRoaXMuX2NvbGxlY3Rvcklkc1tzb3VyY2VdPXRoaXMuX2NvbGxlY3RvcklkTmV4dCsrfWlmKHJvYmluPT09dW5kZWZpbmVkKXtyb2Jpbj10aGlzLl9yb2JpbnNbc291cmNlXT0wfXRoaXMuX3JvYmluc1tzb3VyY2VdPSh0aGlzLl9yb2JpbnNbc291cmNlXSsxKSV0aGlzLl9wb29scy5sZW5ndGg7c3dpdGNoKHR5cGVvZiBkYXRhKXtjYXNlIm51bWJlciI6aWYoZXN0aW1hdGVkRW50cm9weT09PXVuZGVmaW5lZCl7ZXN0aW1hdGVkRW50cm9weT0xfXRoaXMuX3Bvb2xzW3JvYmluXS51cGRhdGUoW2lkLHRoaXMuX2V2ZW50SWQrKywxLGVzdGltYXRlZEVudHJvcHksdCwxLGRhdGF8MF0pO2JyZWFrO2Nhc2Uib2JqZWN0IjpvYmpOYW1lPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRhKTtpZihvYmpOYW1lPT09IltvYmplY3QgVWludDMyQXJyYXldIil7dG1wPVtdO2ZvcihpPTA7aTxkYXRhLmxlbmd0aDtpKyspe3RtcC5wdXNoKGRhdGFbaV0pfWRhdGE9dG1wfWVsc2V7aWYob2JqTmFtZSE9PSJbb2JqZWN0IEFycmF5XSIpe2Vycj0xfWZvcihpPTA7aTxkYXRhLmxlbmd0aCYmIWVycjtpKyspe2lmKHR5cGVvZiBkYXRhW2ldIT09Im51bWJlciIpe2Vycj0xfX19aWYoIWVycil7aWYoZXN0aW1hdGVkRW50cm9weT09PXVuZGVmaW5lZCl7ZXN0aW1hdGVkRW50cm9weT0wO2ZvcihpPTA7aTxkYXRhLmxlbmd0aDtpKyspe3RtcD1kYXRhW2ldO3doaWxlKHRtcD4wKXtlc3RpbWF0ZWRFbnRyb3B5Kys7dG1wPXRtcD4+PjF9fX10aGlzLl9wb29sc1tyb2Jpbl0udXBkYXRlKFtpZCx0aGlzLl9ldmVudElkKyssMixlc3RpbWF0ZWRFbnRyb3B5LHQsZGF0YS5sZW5ndGhdLmNvbmNhdChkYXRhKSl9YnJlYWs7Y2FzZSJzdHJpbmciOmlmKGVzdGltYXRlZEVudHJvcHk9PT11bmRlZmluZWQpe2VzdGltYXRlZEVudHJvcHk9ZGF0YS5sZW5ndGh9dGhpcy5fcG9vbHNbcm9iaW5dLnVwZGF0ZShbaWQsdGhpcy5fZXZlbnRJZCsrLDMsZXN0aW1hdGVkRW50cm9weSx0LGRhdGEubGVuZ3RoXSk7dGhpcy5fcG9vbHNbcm9iaW5dLnVwZGF0ZShkYXRhKTticmVhaztkZWZhdWx0OmVycj0xfWlmKGVycil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygicmFuZG9tOiBhZGRFbnRyb3B5IG9ubHkgc3VwcG9ydHMgbnVtYmVyLCBhcnJheSBvZiBudW1iZXJzIG9yIHN0cmluZyIpfXRoaXMuX3Bvb2xFbnRyb3B5W3JvYmluXSs9ZXN0aW1hdGVkRW50cm9weTt0aGlzLl9wb29sU3RyZW5ndGgrPWVzdGltYXRlZEVudHJvcHk7aWYob2xkUmVhZHk9PT10aGlzLl9OT1RfUkVBRFkpe2lmKHRoaXMuaXNSZWFkeSgpIT09dGhpcy5fTk9UX1JFQURZKXt0aGlzLl9maXJlRXZlbnQoInNlZWRlZCIsTWF0aC5tYXgodGhpcy5fc3RyZW5ndGgsdGhpcy5fcG9vbFN0cmVuZ3RoKSl9dGhpcy5fZmlyZUV2ZW50KCJwcm9ncmVzcyIsdGhpcy5nZXRQcm9ncmVzcygpKX19LGlzUmVhZHk6ZnVuY3Rpb24ocGFyYW5vaWEpe3ZhciBlbnRyb3B5UmVxdWlyZWQ9dGhpcy5fUEFSQU5PSUFfTEVWRUxTW3BhcmFub2lhIT09dW5kZWZpbmVkP3BhcmFub2lhOnRoaXMuX2RlZmF1bHRQYXJhbm9pYV07aWYodGhpcy5fc3RyZW5ndGgmJnRoaXMuX3N0cmVuZ3RoPj1lbnRyb3B5UmVxdWlyZWQpe3JldHVybiB0aGlzLl9wb29sRW50cm9weVswXT50aGlzLl9CSVRTX1BFUl9SRVNFRUQmJihuZXcgRGF0ZSkudmFsdWVPZigpPnRoaXMuX25leHRSZXNlZWQ/dGhpcy5fUkVRVUlSRVNfUkVTRUVEfHRoaXMuX1JFQURZOnRoaXMuX1JFQURZfWVsc2V7cmV0dXJuIHRoaXMuX3Bvb2xTdHJlbmd0aD49ZW50cm9weVJlcXVpcmVkP3RoaXMuX1JFUVVJUkVTX1JFU0VFRHx0aGlzLl9OT1RfUkVBRFk6dGhpcy5fTk9UX1JFQURZfX0sZ2V0UHJvZ3Jlc3M6ZnVuY3Rpb24ocGFyYW5vaWEpe3ZhciBlbnRyb3B5UmVxdWlyZWQ9dGhpcy5fUEFSQU5PSUFfTEVWRUxTW3BhcmFub2lhP3BhcmFub2lhOnRoaXMuX2RlZmF1bHRQYXJhbm9pYV07aWYodGhpcy5fc3RyZW5ndGg+PWVudHJvcHlSZXF1aXJlZCl7cmV0dXJuIDF9ZWxzZXtyZXR1cm4gdGhpcy5fcG9vbFN0cmVuZ3RoPmVudHJvcHlSZXF1aXJlZD8xOnRoaXMuX3Bvb2xTdHJlbmd0aC9lbnRyb3B5UmVxdWlyZWR9fSxzdGFydENvbGxlY3RvcnM6ZnVuY3Rpb24oKXtpZih0aGlzLl9jb2xsZWN0b3JzU3RhcnRlZCl7cmV0dXJufXRoaXMuX2V2ZW50TGlzdGVuZXI9e2xvYWRUaW1lQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fbG9hZFRpbWVDb2xsZWN0b3IpLG1vdXNlQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fbW91c2VDb2xsZWN0b3IpLGtleWJvYXJkQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fa2V5Ym9hcmRDb2xsZWN0b3IpLGFjY2VsZXJvbWV0ZXJDb2xsZWN0b3I6dGhpcy5fYmluZCh0aGlzLl9hY2NlbGVyb21ldGVyQ29sbGVjdG9yKSx0b3VjaENvbGxlY3Rvcjp0aGlzLl9iaW5kKHRoaXMuX3RvdWNoQ29sbGVjdG9yKX07aWYod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIix0aGlzLl9ldmVudExpc3RlbmVyLmxvYWRUaW1lQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLm1vdXNlQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5cHJlc3MiLHRoaXMuX2V2ZW50TGlzdGVuZXIua2V5Ym9hcmRDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJkZXZpY2Vtb3Rpb24iLHRoaXMuX2V2ZW50TGlzdGVuZXIuYWNjZWxlcm9tZXRlckNvbGxlY3RvcixmYWxzZSk7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsdGhpcy5fZXZlbnRMaXN0ZW5lci50b3VjaENvbGxlY3RvcixmYWxzZSl9ZWxzZSBpZihkb2N1bWVudC5hdHRhY2hFdmVudCl7ZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ubG9hZCIsdGhpcy5fZXZlbnRMaXN0ZW5lci5sb2FkVGltZUNvbGxlY3Rvcik7ZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ubW91c2Vtb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLm1vdXNlQ29sbGVjdG9yKTtkb2N1bWVudC5hdHRhY2hFdmVudCgia2V5cHJlc3MiLHRoaXMuX2V2ZW50TGlzdGVuZXIua2V5Ym9hcmRDb2xsZWN0b3IpfWVsc2V7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygiY2FuJ3QgYXR0YWNoIGV2ZW50Iil9dGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQ9dHJ1ZX0sc3RvcENvbGxlY3RvcnM6ZnVuY3Rpb24oKXtpZighdGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQpe3JldHVybn1pZih3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcil7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLHRoaXMuX2V2ZW50TGlzdGVuZXIubG9hZFRpbWVDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLHRoaXMuX2V2ZW50TGlzdGVuZXIubW91c2VDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlwcmVzcyIsdGhpcy5fZXZlbnRMaXN0ZW5lci5rZXlib2FyZENvbGxlY3RvcixmYWxzZSk7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImRldmljZW1vdGlvbiIsdGhpcy5fZXZlbnRMaXN0ZW5lci5hY2NlbGVyb21ldGVyQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLnRvdWNoQ29sbGVjdG9yLGZhbHNlKX1lbHNlIGlmKGRvY3VtZW50LmRldGFjaEV2ZW50KXtkb2N1bWVudC5kZXRhY2hFdmVudCgib25sb2FkIix0aGlzLl9ldmVudExpc3RlbmVyLmxvYWRUaW1lQ29sbGVjdG9yKTtkb2N1bWVudC5kZXRhY2hFdmVudCgib25tb3VzZW1vdmUiLHRoaXMuX2V2ZW50TGlzdGVuZXIubW91c2VDb2xsZWN0b3IpO2RvY3VtZW50LmRldGFjaEV2ZW50KCJrZXlwcmVzcyIsdGhpcy5fZXZlbnRMaXN0ZW5lci5rZXlib2FyZENvbGxlY3Rvcil9dGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQ9ZmFsc2V9LGFkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayl7dGhpcy5fY2FsbGJhY2tzW25hbWVdW3RoaXMuX2NhbGxiYWNrSSsrXT1jYWxsYmFja30scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihuYW1lLGNiKXt2YXIgaSxqLGNicz10aGlzLl9jYWxsYmFja3NbbmFtZV0sanNUZW1wPVtdO2ZvcihqIGluIGNicyl7aWYoY2JzLmhhc093blByb3BlcnR5KGopJiZjYnNbal09PT1jYil7anNUZW1wLnB1c2goail9fWZvcihpPTA7aTxqc1RlbXAubGVuZ3RoO2krKyl7aj1qc1RlbXBbaV07ZGVsZXRlIGNic1tqXX19LF9iaW5kOmZ1bmN0aW9uKGZ1bmMpe3ZhciB0aGF0PXRoaXM7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuYy5hcHBseSh0aGF0LGFyZ3VtZW50cyl9fSxfZ2VuNHdvcmRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTw0O2krKyl7dGhpcy5fY291bnRlcltpXT10aGlzLl9jb3VudGVyW2ldKzF8MDtpZih0aGlzLl9jb3VudGVyW2ldKXticmVha319cmV0dXJuIHRoaXMuX2NpcGhlci5lbmNyeXB0KHRoaXMuX2NvdW50ZXIpfSxfZ2F0ZTpmdW5jdGlvbigpe3RoaXMuX2tleT10aGlzLl9nZW40d29yZHMoKS5jb25jYXQodGhpcy5fZ2VuNHdvcmRzKCkpO3RoaXMuX2NpcGhlcj1uZXcgc2pjbC5jaXBoZXIuYWVzKHRoaXMuX2tleSl9LF9yZXNlZWQ6ZnVuY3Rpb24oc2VlZFdvcmRzKXt0aGlzLl9rZXk9c2pjbC5oYXNoLnNoYTI1Ni5oYXNoKHRoaXMuX2tleS5jb25jYXQoc2VlZFdvcmRzKSk7dGhpcy5fY2lwaGVyPW5ldyBzamNsLmNpcGhlci5hZXModGhpcy5fa2V5KTtmb3IodmFyIGk9MDtpPDQ7aSsrKXt0aGlzLl9jb3VudGVyW2ldPXRoaXMuX2NvdW50ZXJbaV0rMXwwO2lmKHRoaXMuX2NvdW50ZXJbaV0pe2JyZWFrfX19LF9yZXNlZWRGcm9tUG9vbHM6ZnVuY3Rpb24oZnVsbCl7dmFyIHJlc2VlZERhdGE9W10sc3RyZW5ndGg9MCxpO3RoaXMuX25leHRSZXNlZWQ9cmVzZWVkRGF0YVswXT0obmV3IERhdGUpLnZhbHVlT2YoKSt0aGlzLl9NSUxMSVNFQ09ORFNfUEVSX1JFU0VFRDtmb3IoaT0wO2k8MTY7aSsrKXtyZXNlZWREYXRhLnB1c2goTWF0aC5yYW5kb20oKSo0Mjk0OTY3Mjk2fDApfWZvcihpPTA7aTx0aGlzLl9wb29scy5sZW5ndGg7aSsrKXtyZXNlZWREYXRhPXJlc2VlZERhdGEuY29uY2F0KHRoaXMuX3Bvb2xzW2ldLmZpbmFsaXplKCkpO3N0cmVuZ3RoKz10aGlzLl9wb29sRW50cm9weVtpXTt0aGlzLl9wb29sRW50cm9weVtpXT0wO2lmKCFmdWxsJiZ0aGlzLl9yZXNlZWRDb3VudCYxPDxpKXticmVha319aWYodGhpcy5fcmVzZWVkQ291bnQ+PTE8PHRoaXMuX3Bvb2xzLmxlbmd0aCl7dGhpcy5fcG9vbHMucHVzaChuZXcgc2pjbC5oYXNoLnNoYTI1Nik7dGhpcy5fcG9vbEVudHJvcHkucHVzaCgwKX10aGlzLl9wb29sU3RyZW5ndGgtPXN0cmVuZ3RoO2lmKHN0cmVuZ3RoPnRoaXMuX3N0cmVuZ3RoKXt0aGlzLl9zdHJlbmd0aD1zdHJlbmd0aH10aGlzLl9yZXNlZWRDb3VudCsrO3RoaXMuX3Jlc2VlZChyZXNlZWREYXRhKX0sX2tleWJvYXJkQ29sbGVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMSl9LF9tb3VzZUNvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIHgseTt0cnl7eD1ldi54fHxldi5jbGllbnRYfHxldi5vZmZzZXRYfHwwO3k9ZXYueXx8ZXYuY2xpZW50WXx8ZXYub2Zmc2V0WXx8MH1jYXRjaChlcnIpe3g9MDt5PTB9aWYoeCE9MCYmeSE9MCl7dGhpcy5hZGRFbnRyb3B5KFt4LHldLDIsIm1vdXNlIil9dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMCl9LF90b3VjaENvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIHRvdWNoPWV2LnRvdWNoZXNbMF18fGV2LmNoYW5nZWRUb3VjaGVzWzBdO3ZhciB4PXRvdWNoLnBhZ2VYfHx0b3VjaC5jbGllbnRYLHk9dG91Y2gucGFnZVl8fHRvdWNoLmNsaWVudFk7dGhpcy5hZGRFbnRyb3B5KFt4LHldLDEsInRvdWNoIik7dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMCl9LF9sb2FkVGltZUNvbGxlY3RvcjpmdW5jdGlvbigpe3RoaXMuX2FkZEN1cnJlbnRUaW1lVG9FbnRyb3B5KDIpfSxfYWRkQ3VycmVudFRpbWVUb0VudHJvcHk6ZnVuY3Rpb24oZXN0aW1hdGVkRW50cm9weSl7aWYodHlwZW9mIHdpbmRvdyE9PSJ1bmRlZmluZWQiJiZ3aW5kb3cucGVyZm9ybWFuY2UmJnR5cGVvZiB3aW5kb3cucGVyZm9ybWFuY2Uubm93PT09ImZ1bmN0aW9uIil7dGhpcy5hZGRFbnRyb3B5KHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSxlc3RpbWF0ZWRFbnRyb3B5LCJsb2FkdGltZSIpfWVsc2V7dGhpcy5hZGRFbnRyb3B5KChuZXcgRGF0ZSkudmFsdWVPZigpLGVzdGltYXRlZEVudHJvcHksImxvYWR0aW1lIil9fSxfYWNjZWxlcm9tZXRlckNvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIGFjPWV2LmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkueHx8ZXYuYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eS55fHxldi5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lno7aWYod2luZG93Lm9yaWVudGF0aW9uKXt2YXIgb3I9d2luZG93Lm9yaWVudGF0aW9uO2lmKHR5cGVvZiBvcj09PSJudW1iZXIiKXt0aGlzLmFkZEVudHJvcHkob3IsMSwiYWNjZWxlcm9tZXRlciIpfX1pZihhYyl7dGhpcy5hZGRFbnRyb3B5KGFjLDIsImFjY2VsZXJvbWV0ZXIiKX10aGlzLl9hZGRDdXJyZW50VGltZVRvRW50cm9weSgwKX0sX2ZpcmVFdmVudDpmdW5jdGlvbihuYW1lLGFyZyl7dmFyIGosY2JzPXNqY2wucmFuZG9tLl9jYWxsYmFja3NbbmFtZV0sY2JzVGVtcD1bXTtmb3IoaiBpbiBjYnMpe2lmKGNicy5oYXNPd25Qcm9wZXJ0eShqKSl7Y2JzVGVtcC5wdXNoKGNic1tqXSl9fWZvcihqPTA7ajxjYnNUZW1wLmxlbmd0aDtqKyspe2Nic1RlbXBbal0oYXJnKX19fTtzamNsLnJhbmRvbT1uZXcgc2pjbC5wcm5nKDYpOyhmdW5jdGlvbigpe2Z1bmN0aW9uIGdldENyeXB0b01vZHVsZSgpe3RyeXtyZXR1cm4gcmVxdWlyZSgiY3J5cHRvIil9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fXRyeXt2YXIgYnVmLGNyeXB0LGFiO2lmKHR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIiYmbW9kdWxlLmV4cG9ydHMmJihjcnlwdD1nZXRDcnlwdG9Nb2R1bGUoKSkmJmNyeXB0LnJhbmRvbUJ5dGVzKXtidWY9Y3J5cHQucmFuZG9tQnl0ZXMoMTAyNC84KTtidWY9bmV3IFVpbnQzMkFycmF5KG5ldyBVaW50OEFycmF5KGJ1ZikuYnVmZmVyKTtzamNsLnJhbmRvbS5hZGRFbnRyb3B5KGJ1ZiwxMDI0LCJjcnlwdG8ucmFuZG9tQnl0ZXMiKX1lbHNlIGlmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIiYmdHlwZW9mIFVpbnQzMkFycmF5IT09InVuZGVmaW5lZCIpe2FiPW5ldyBVaW50MzJBcnJheSgzMik7aWYod2luZG93LmNyeXB0byYmd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMpe3dpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFiKX1lbHNlIGlmKHdpbmRvdy5tc0NyeXB0byYmd2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyl7d2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhYil9ZWxzZXtyZXR1cm59c2pjbC5yYW5kb20uYWRkRW50cm9weShhYiwxMDI0LCJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIil9ZWxzZXt9fWNhdGNoKGUpe2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIiYmd2luZG93LmNvbnNvbGUpe2NvbnNvbGUubG9nKCJUaGVyZSB3YXMgYW4gZXJyb3IgY29sbGVjdGluZyBlbnRyb3B5IGZyb20gdGhlIGJyb3dzZXI6Iik7Y29uc29sZS5sb2coZSl9fX0pKCk7c2pjbC5qc29uPXtkZWZhdWx0czp7djoxLGl0ZXI6MWU0LGtzOjEyOCx0czo2NCxtb2RlOiJjY20iLGFkYXRhOiIiLGNpcGhlcjoiYWVzIn0sX2VuY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQscGxhaW50ZXh0LHBhcmFtcyxycCl7cGFyYW1zPXBhcmFtc3x8e307cnA9cnB8fHt9O3ZhciBqPXNqY2wuanNvbixwPWouX2FkZCh7aXY6c2pjbC5yYW5kb20ucmFuZG9tV29yZHMoNCwwKX0sai5kZWZhdWx0cyksdG1wLHBycCxhZGF0YTtqLl9hZGQocCxwYXJhbXMpO2FkYXRhPXAuYWRhdGE7aWYodHlwZW9mIHAuc2FsdD09PSJzdHJpbmciKXtwLnNhbHQ9c2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHAuc2FsdCl9aWYodHlwZW9mIHAuaXY9PT0ic3RyaW5nIil7cC5pdj1zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5pdil9aWYoIXNqY2wubW9kZVtwLm1vZGVdfHwhc2pjbC5jaXBoZXJbcC5jaXBoZXJdfHx0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIiYmcC5pdGVyPD0xMDB8fHAudHMhPT02NCYmcC50cyE9PTk2JiZwLnRzIT09MTI4fHxwLmtzIT09MTI4JiZwLmtzIT09MTkyJiZwLmtzIT09MjU2fHwocC5pdi5sZW5ndGg8Mnx8cC5pdi5sZW5ndGg+NCkpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGVuY3J5cHQ6IGludmFsaWQgcGFyYW1ldGVycyIpfWlmKHR5cGVvZiBwYXNzd29yZD09PSJzdHJpbmciKXt0bXA9c2pjbC5taXNjLmNhY2hlZFBia2RmMihwYXNzd29yZCxwKTtwYXNzd29yZD10bXAua2V5LnNsaWNlKDAscC5rcy8zMik7cC5zYWx0PXRtcC5zYWx0fWVsc2UgaWYoc2pjbC5lY2MmJnBhc3N3b3JkIGluc3RhbmNlb2Ygc2pjbC5lY2MuZWxHYW1hbC5wdWJsaWNLZXkpe3RtcD1wYXNzd29yZC5rZW0oKTtwLmtlbXRhZz10bXAudGFnO3Bhc3N3b3JkPXRtcC5rZXkuc2xpY2UoMCxwLmtzLzMyKX1pZih0eXBlb2YgcGxhaW50ZXh0PT09InN0cmluZyIpe3BsYWludGV4dD1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKHBsYWludGV4dCl9aWYodHlwZW9mIGFkYXRhPT09InN0cmluZyIpe3AuYWRhdGE9YWRhdGE9c2pjbC5jb2RlYy51dGY4U3RyaW5nLnRvQml0cyhhZGF0YSl9cHJwPW5ldyBzamNsLmNpcGhlcltwLmNpcGhlcl0ocGFzc3dvcmQpO2ouX2FkZChycCxwKTtycC5rZXk9cGFzc3dvcmQ7aWYocC5tb2RlPT09ImNjbSImJnNqY2wuYXJyYXlCdWZmZXImJnNqY2wuYXJyYXlCdWZmZXIuY2NtJiZwbGFpbnRleHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7cC5jdD1zamNsLmFycmF5QnVmZmVyLmNjbS5lbmNyeXB0KHBycCxwbGFpbnRleHQscC5pdixhZGF0YSxwLnRzKX1lbHNle3AuY3Q9c2pjbC5tb2RlW3AubW9kZV0uZW5jcnlwdChwcnAscGxhaW50ZXh0LHAuaXYsYWRhdGEscC50cyl9cmV0dXJuIHB9LGVuY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQscGxhaW50ZXh0LHBhcmFtcyxycCl7dmFyIGo9c2pjbC5qc29uLHA9ai5fZW5jcnlwdC5hcHBseShqLGFyZ3VtZW50cyk7cmV0dXJuIGouZW5jb2RlKHApfSxfZGVjcnlwdDpmdW5jdGlvbihwYXNzd29yZCxjaXBoZXJ0ZXh0LHBhcmFtcyxycCl7cGFyYW1zPXBhcmFtc3x8e307cnA9cnB8fHt9O3ZhciBqPXNqY2wuanNvbixwPWouX2FkZChqLl9hZGQoai5fYWRkKHt9LGouZGVmYXVsdHMpLGNpcGhlcnRleHQpLHBhcmFtcyx0cnVlKSxjdCx0bXAscHJwLGFkYXRhPXAuYWRhdGE7aWYodHlwZW9mIHAuc2FsdD09PSJzdHJpbmciKXtwLnNhbHQ9c2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHAuc2FsdCl9aWYodHlwZW9mIHAuaXY9PT0ic3RyaW5nIil7cC5pdj1zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5pdil9aWYoIXNqY2wubW9kZVtwLm1vZGVdfHwhc2pjbC5jaXBoZXJbcC5jaXBoZXJdfHx0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIiYmcC5pdGVyPD0xMDB8fHAudHMhPT02NCYmcC50cyE9PTk2JiZwLnRzIT09MTI4fHxwLmtzIT09MTI4JiZwLmtzIT09MTkyJiZwLmtzIT09MjU2fHwhcC5pdnx8KHAuaXYubGVuZ3RoPDJ8fHAuaXYubGVuZ3RoPjQpKXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgianNvbiBkZWNyeXB0OiBpbnZhbGlkIHBhcmFtZXRlcnMiKX1pZih0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIil7dG1wPXNqY2wubWlzYy5jYWNoZWRQYmtkZjIocGFzc3dvcmQscCk7cGFzc3dvcmQ9dG1wLmtleS5zbGljZSgwLHAua3MvMzIpO3Auc2FsdD10bXAuc2FsdH1lbHNlIGlmKHNqY2wuZWNjJiZwYXNzd29yZCBpbnN0YW5jZW9mIHNqY2wuZWNjLmVsR2FtYWwuc2VjcmV0S2V5KXtwYXNzd29yZD1wYXNzd29yZC51bmtlbShzamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5rZW10YWcpKS5zbGljZSgwLHAua3MvMzIpfWlmKHR5cGVvZiBhZGF0YT09PSJzdHJpbmciKXthZGF0YT1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKGFkYXRhKX1wcnA9bmV3IHNqY2wuY2lwaGVyW3AuY2lwaGVyXShwYXNzd29yZCk7aWYocC5tb2RlPT09ImNjbSImJnNqY2wuYXJyYXlCdWZmZXImJnNqY2wuYXJyYXlCdWZmZXIuY2NtJiZwLmN0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2N0PXNqY2wuYXJyYXlCdWZmZXIuY2NtLmRlY3J5cHQocHJwLHAuY3QscC5pdixwLnRhZyxhZGF0YSxwLnRzKX1lbHNle2N0PXNqY2wubW9kZVtwLm1vZGVdLmRlY3J5cHQocHJwLHAuY3QscC5pdixhZGF0YSxwLnRzKX1qLl9hZGQocnAscCk7cnAua2V5PXBhc3N3b3JkO2lmKHBhcmFtcy5yYXc9PT0xKXtyZXR1cm4gY3R9ZWxzZXtyZXR1cm4gc2pjbC5jb2RlYy51dGY4U3RyaW5nLmZyb21CaXRzKGN0KX19LGRlY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQsY2lwaGVydGV4dCxwYXJhbXMscnApe3ZhciBqPXNqY2wuanNvbjtyZXR1cm4gai5fZGVjcnlwdChwYXNzd29yZCxqLmRlY29kZShjaXBoZXJ0ZXh0KSxwYXJhbXMscnApfSxlbmNvZGU6ZnVuY3Rpb24ob2JqKXt2YXIgaSxvdXQ9InsiLGNvbW1hPSIiO2ZvcihpIGluIG9iail7aWYob2JqLmhhc093blByb3BlcnR5KGkpKXtpZighaS5tYXRjaCgvXlthLXowLTldKyQvaSkpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGVuY29kZTogaW52YWxpZCBwcm9wZXJ0eSBuYW1lIil9b3V0Kz1jb21tYSsnIicraSsnIjonO2NvbW1hPSIsIjtzd2l0Y2godHlwZW9mIG9ialtpXSl7Y2FzZSJudW1iZXIiOmNhc2UiYm9vbGVhbiI6b3V0Kz1vYmpbaV07YnJlYWs7Y2FzZSJzdHJpbmciOm91dCs9JyInK2VzY2FwZShvYmpbaV0pKyciJzticmVhaztjYXNlIm9iamVjdCI6b3V0Kz0nIicrc2pjbC5jb2RlYy5iYXNlNjQuZnJvbUJpdHMob2JqW2ldLDApKyciJzticmVhaztkZWZhdWx0OnRocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5idWcoImpzb24gZW5jb2RlOiB1bnN1cHBvcnRlZCB0eXBlIil9fX1yZXR1cm4gb3V0KyJ9In0sZGVjb2RlOmZ1bmN0aW9uKHN0cil7c3RyPXN0ci5yZXBsYWNlKC9ccy9nLCIiKTtpZighc3RyLm1hdGNoKC9eXHsuKn0kLykpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGRlY29kZTogdGhpcyBpc24ndCBqc29uISIpfXZhciBhPXN0ci5yZXBsYWNlKC9eXHt8fSQvZywiIikuc3BsaXQoLywvKSxvdXQ9e30saSxtO2ZvcihpPTA7aTxhLmxlbmd0aDtpKyspe2lmKCEobT1hW2ldLm1hdGNoKC9eXHMqKD86KFsiJ10/KShbYS16XVthLXowLTldKilcMSlccyo6XHMqKD86KC0/XGQrKXwiKFthLXowLTkrXC8lKl8uQD1cLV0qKSJ8KHRydWV8ZmFsc2UpKSQvaSkpKXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgianNvbiBkZWNvZGU6IHRoaXMgaXNuJ3QganNvbiEiKX1pZihtWzNdIT1udWxsKXtvdXRbbVsyXV09cGFyc2VJbnQobVszXSwxMCl9ZWxzZSBpZihtWzRdIT1udWxsKXtvdXRbbVsyXV09bVsyXS5tYXRjaCgvXihjdHxhZGF0YXxzYWx0fGl2KSQvKT9zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMobVs0XSk6dW5lc2NhcGUobVs0XSl9ZWxzZSBpZihtWzVdIT1udWxsKXtvdXRbbVsyXV09bVs1XT09PSJ0cnVlIn19cmV0dXJuIG91dH0sX2FkZDpmdW5jdGlvbih0YXJnZXQsc3JjLHJlcXVpcmVTYW1lKXtpZih0YXJnZXQ9PT11bmRlZmluZWQpe3RhcmdldD17fX1pZihzcmM9PT11bmRlZmluZWQpe3JldHVybiB0YXJnZXR9dmFyIGk7Zm9yKGkgaW4gc3JjKXtpZihzcmMuaGFzT3duUHJvcGVydHkoaSkpe2lmKHJlcXVpcmVTYW1lJiZ0YXJnZXRbaV0hPT11bmRlZmluZWQmJnRhcmdldFtpXSE9PXNyY1tpXSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoInJlcXVpcmVkIHBhcmFtZXRlciBvdmVycmlkZGVuIil9dGFyZ2V0W2ldPXNyY1tpXX19cmV0dXJuIHRhcmdldH0sX3N1YnRyYWN0OmZ1bmN0aW9uKHBsdXMsbWludXMpe3ZhciBvdXQ9e30saTtmb3IoaSBpbiBwbHVzKXtpZihwbHVzLmhhc093blByb3BlcnR5KGkpJiZwbHVzW2ldIT09bWludXNbaV0pe291dFtpXT1wbHVzW2ldfX1yZXR1cm4gb3V0fSxfZmlsdGVyOmZ1bmN0aW9uKHNyYyxmaWx0ZXIpe3ZhciBvdXQ9e30saTtmb3IoaT0wO2k8ZmlsdGVyLmxlbmd0aDtpKyspe2lmKHNyY1tmaWx0ZXJbaV1dIT09dW5kZWZpbmVkKXtvdXRbZmlsdGVyW2ldXT1zcmNbZmlsdGVyW2ldXX19cmV0dXJuIG91dH19O3NqY2wuZW5jcnlwdD1zamNsLmpzb24uZW5jcnlwdDtzamNsLmRlY3J5cHQ9c2pjbC5qc29uLmRlY3J5cHQ7c2pjbC5taXNjLl9wYmtkZjJDYWNoZT17fTtzamNsLm1pc2MuY2FjaGVkUGJrZGYyPWZ1bmN0aW9uKHBhc3N3b3JkLG9iail7dmFyIGNhY2hlPXNqY2wubWlzYy5fcGJrZGYyQ2FjaGUsYyxjcCxzdHIsc2FsdCxpdGVyO29iaj1vYmp8fHt9O2l0ZXI9b2JqLml0ZXJ8fDFlMztjcD1jYWNoZVtwYXNzd29yZF09Y2FjaGVbcGFzc3dvcmRdfHx7fTtjPWNwW2l0ZXJdPWNwW2l0ZXJdfHx7Zmlyc3RTYWx0Om9iai5zYWx0JiZvYmouc2FsdC5sZW5ndGg/b2JqLnNhbHQuc2xpY2UoMCk6c2pjbC5yYW5kb20ucmFuZG9tV29yZHMoMiwwKX07c2FsdD1vYmouc2FsdD09PXVuZGVmaW5lZD9jLmZpcnN0U2FsdDpvYmouc2FsdDtjW3NhbHRdPWNbc2FsdF18fHNqY2wubWlzYy5wYmtkZjIocGFzc3dvcmQsc2FsdCxvYmouaXRlcik7cmV0dXJue2tleTpjW3NhbHRdLnNsaWNlKDApLHNhbHQ6c2FsdC5zbGljZSgwKX19O2lmKHR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIiYmbW9kdWxlLmV4cG9ydHMpe21vZHVsZS5leHBvcnRzPXNqY2x9aWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiIpe2RlZmluZShbXSxmdW5jdGlvbigpe3JldHVybiBzamNsfSl9Cgl2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgogIAlsb2dnZXIubWVzc2FnZSgiQ29sbGVjdCBBbmQgRW5jcnlwdCBDdXN0b20gUGFzc3dvcmQ6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gInRydWUiOwogIAogICAgLyogQmVnaW4gQ29uZmlndXJhdGlvbiAqLwogIAkKICAJLy8gQXR0cmlidXRlIG5hbWUKICAJdmFyIGlkbUF0dHJOYW1lID0gImZyVW5pbmRleGVkU3RyaW5nMiI7IC8vIEFNOiAiZnItYXR0ci1zdHIyIgogIAkKICAJLy8gUGljayBhIHNoYXJlZCBzZWNyZXQgdG8gdXNlIGZvciBlbmNyeXB0aW9uIGFuZCBkZWNyeXB0aW9uCiAgICB2YXIgc2hhcmVkU2VjcmV0ID0gIlJhaW5ib3dQb25pZXNIYXZlTm9TdHJpcGVzIjsKCiAgCS8vIEZpbmUtdHVuZSBlbmNyeXB0aW9uIHNldHRpbmdzLiBEZWZhdWx0IGl0ZXJhdGlvbnMgYXJlIDEwaywgdG8gc3BlZWQgdXAgdGhlIHByb2Nlc3MsIGl0J3MgcmVkdWNlZCB0byAxayBoZXJlLgogIAl2YXIgZW5jcnlwdGlvblBhcmFtZXRlcnMgPSB7ICJpdGVyIiA6IDEwMDAgfTsKICAJCiAgICAvLyBCdWlsZCBvdXQgdGhlIHBhc3N3b3JkIHByb21wdAogICAgdmFyIHByb21wdCA9ICJSZXBsYXkgUGFzc3dvcmQiOwoKICAgIC8qIEVuZCBDb25maWd1cmF0aW9uICovCiAgCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCgkgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5QYXNzd29yZENhbGxiYWNrLAogICAgICAJamF2YS5sYW5nLlN0cmluZwogICAgKQoJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgbmV3IGZyLlBhc3N3b3JkQ2FsbGJhY2socHJvbXB0LCBmYWxzZSkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9IAogICAgZWxzZSB7CiAgICAgIAkvLyBQYXNzd29yZENhbGxiYWNrIHJldHVybnMgdGhlIHBhc3N3b3JkIGFzIGEgY2hhcltdLCB3aGljaCBpcyBub3QgdGhlIHNhbWUgYXMgYSBKUyBjaGFyIGFycmF5LiBJdCBtdXN0IGJlIGNvbnZlcnRlZCB0byBhIHByb3BlciBzdHJpbmcgdXNpbmcgdGhlIGphdmEubGFuZy5TdGluZy52YWx1ZU9mKGNoYXJbXSkgbWV0aG9kLgogICAgICAgIHZhciBwYXNzd29yZCA9IG5ldyBTdHJpbmcoZnIuU3RyaW5nLnZhbHVlT2YoY2FsbGJhY2tzLmdldCgwKS5nZXRQYXNzd29yZCgpKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBjYWxsYmFja3MgcmVjZWl2ZWQiKTsKCiAgICAgIAkvKgogICAgICAgIHZhciBjaXBoZXJQYXNzd29yZEpzb24gPSBzamNsLmVuY3J5cHQoc2hhcmVkU2VjcmV0LCBwYXNzd29yZCwgZW5jcnlwdGlvblBhcmFtZXRlcnMpOwogICAgICAgIC8vc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKGlkbUF0dHJOYW1lLCBCYXNlNjQuZW5jb2RlKEpTT04uc3RyaW5naWZ5KGNpcGhlclBhc3N3b3JkSnNvbikpKTsKICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoaWRtQXR0ck5hbWUsIEpTT04uc3RyaW5naWZ5KGNpcGhlclBhc3N3b3JkSnNvbikpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJDb2xsZWN0IEFuZCBFbmNyeXB0IEN1c3RvbSBQYXNzd29yZDogY2lwaGVyUGFzc3dvcmRKc29uPSIrSlNPTi5zdHJpbmdpZnkoY2lwaGVyUGFzc3dvcmRKc29uKSk7CiAgICAgICAgKi8KICAgICAgCiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBwYXNzd29yZD0iK0Jhc2U2NC5lbmNvZGUocGFzc3dvcmQpKTsKICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoaWRtQXR0ck5hbWUsIEJhc2U2NC5lbmNvZGUocGFzc3dvcmQpKTsKCiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgLyoKICAgICAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgICAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAgICAgICBpZiAoc3RvcmFnZS5wdXQpIHsKICAgICAgICAgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgICAJdmFyIG9iamVjdCA9IHsKICAgICAgICAgICAgICAJbmFtZTogdmFsdWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0KTsKICAgICAgICAgICAgLy9zaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgICAgIH0KICAgIH0KfSgpKTsKLyogU0pDTCBpcyBvcGVuLiBZb3UgY2FuIHVzZSwgbW9kaWZ5IGFuZCByZWRpc3RyaWJ1dGUgaXQgdW5kZXIgYSBCU0QKbGljZW5zZSBvciB1bmRlciB0aGUgR05VIEdQTCwgdmVyc2lvbiAyLjAuCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMi1DbGF1c2UKCkNvcHlyaWdodCAoYykgMjAwOS0yMDE1LCBFbWlseSBTdGFyaywgTWlrZSBIYW1idXJnIGFuZCBEYW4gQm9uZWggYXQKU3RhbmZvcmQgVW5pdmVyc2l0eS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KClJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAptb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlCm1ldDoKCjEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0Cm5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KCjIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0Cm5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUKZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi4KClRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgIkFTCklTIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRApUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEKUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUCkhPTERFUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwKU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEClRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IKUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRgpMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORwpORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMKU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9HUEwtMi4wCgpUaGUgU3RhbmZvcmQgSmF2YXNjcmlwdCBDcnlwdG8gTGlicmFyeSAoaG9zdGVkIGhlcmUgb24gR2l0SHViKSBpcyBhCnByb2plY3QgYnkgdGhlIFN0YW5mb3JkIENvbXB1dGVyIFNlY3VyaXR5IExhYiB0byBidWlsZCBhIHNlY3VyZSwKcG93ZXJmdWwsIGZhc3QsIHNtYWxsLCBlYXN5LXRvLXVzZSwgY3Jvc3MtYnJvd3NlciBsaWJyYXJ5IGZvcgpjcnlwdG9ncmFwaHkgaW4gSmF2YXNjcmlwdC4KCkNvcHlyaWdodCAoYykgMjAwOS0yMDE1LCBFbWlseSBTdGFyaywgTWlrZSBIYW1idXJnIGFuZCBEYW4gQm9uZWggYXQKU3RhbmZvcmQgVW5pdmVyc2l0eS4KClRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0CnVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZQpGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyCm9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgpUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwgYnV0CldJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVSBHZW5lcmFsClB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgpZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZwp3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLAo1OSBUZW1wbGUgUGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAwMjExMS0xMzA3IFVTQSAqLwoKLyoKICogQmFzZTY0IGVuY29kZSAvIGRlY29kZQogKiAgaHR0cDovL3d3dy53ZWJ0b29sa2l0LmluZm8vCiAqIAogKiBFeGFtcGxlOgogKiBCYXNlNjQuZW5jb2RlKCdzb21lIHN0cmluZycpCiAqIEJhc2U2NC5kZWNvZGUoJ3NvbWUgZW5jb2RlZCBzdHJpbmcnKQogKi8=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"739bdc48-fd24-4c52-b353-88706d75558a\",\"name\":\"Check Username\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a186232a-683d-48ce-8893-d6f92652ec82\",\"name\":\"IPQS IP Address\",\"description\":\"Analyze an IP address using the IPQualityScore (IPQS) service.\",\"script\":\"LyogSVBRUyBJUCBBZGRyZXNzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFuYWx5emUgYW4gSVAgYWRkcmVzcyB1c2luZyB0aGUgSVBRdWFsaXR5U2NvcmUgKElQUVMpIHNlcnZpY2UuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIGhpZ2gKICogLSBzdXNwaWNpb3VzCiAqIC0gbG93CiAqIC0gdW5rbm93bgogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci53YXJuaW5nKCJJUFFTIElQIEFkZHJlc3M6IHN0YXJ0Iik7CgogICAgb3V0Y29tZSA9ICJ1bmtub3duIjsKCiAgICB2YXIgaXAgPSBnZXRDbGllbnRJUEFkZHJlc3MoKTsKICAgIGxvZ2dlci53YXJuaW5nKCJJUFFTIElQIEFkZHJlc3M6IGlwPSIuY29uY2F0KGlwKSk7CgogICAgaWYgKGlwKSB7CgogICAgICAgIC8vIElQUVMgQVBJIENvbmZpZ3VyYXRpb24KICAgICAgICB2YXIgSVBRU19BUElfS0VZID0gc3lzdGVtRW52LmdldFByb3BlcnR5KCJlc3YuaXBxcy5hcGkua2V5Iik7CiAgICAgICAgdmFyIElQUVNfT1BUSU9OUyA9ICJzdHJpY3RuZXNzPTAmYWxsb3dfcHVibGljX2FjY2Vzc19wb2ludHM9dHJ1ZSZ1c2VyX2FnZW50PSIuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChnZXRIZWFkZXIoInVzZXItYWdlbnQiKSkpLmNvbmNhdCgiJnVzZXJfbGFuZ3VhZ2U9IikuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChnZXRIZWFkZXIoImFjY2VwdC1sYW5ndWFnZSIpKSk7CiAgICAgICAgdmFyIElQUVNfQVBJX1VSSSA9ICJodHRwczovL2lwcXVhbGl0eXNjb3JlLmNvbS9hcGkvanNvbi9pcC8iLmNvbmNhdChJUFFTX0FQSV9LRVkpLmNvbmNhdCgiLyIpLmNvbmNhdChpcCkuY29uY2F0KCI/IikuY29uY2F0KElQUVNfT1BUSU9OUyk7CgogICAgICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICAgICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgICAgIHJlcXVlc3Quc2V0VXJpKElQUVNfQVBJX1VSSSk7CgogICAgICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIklQUVMgSVAgQWRkcmVzczogSlNPTiByZXN1bHQ6ICIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpKTsKCiAgICAgICAgLy8gcHJlc2VydmUgcmVzdWx0IGluIHRyYW5zaWVudCBzdGF0ZQogICAgICAgIHRyYW5zaWVudFN0YXRlLnB1dCgiSVBRU19JUF9BZGRyZXNzIiwgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogICAgICAgIGlmIChyZXN1bHQuZnJhdWRfc2NvcmUgPj0gODUpIHsKICAgICAgICAgICAgb3V0Y29tZSA9ICJoaWdoIjsKICAgICAgICB9IAogICAgICAgIGVsc2UgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSA3NSkgewogICAgICAgICAgICBvdXRjb21lID0gInN1c3BpY2lvdXMiOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgb3V0Y29tZSA9ICJsb3ciOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5lcnJvcigiSVBRUyBJUCBBZGRyZXNzOiBubyBjbGllbnQgaXAhIik7CiAgICB9CgogICAgbG9nZ2VyLndhcm5pbmcoIk9JUFFTIElQIEFkZHJlc3M6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgogICAgLyoKICAgICAqICEhISBBU1NVTUVTIElEIENMT1VEICEhIQogICAgICoKICAgICAqIFJldHVybnMgdGhlIGNsaWVudCdzIElQIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q2xpZW50SVBBZGRyZXNzKCkgewogICAgICAgIHJldHVybiBnZXRIZWFkZXIoIngtZm9yd2FyZGVkLWZvciIpLnNwbGl0KCcsJylbMF07CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCk7CiAgICB9CgogICAgICAgIC8qIFNhbXBsZSBJUFFTIFJFU1QgQVBJIFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICAic3VjY2VzcyI6IHRydWUsCiAgICAgICAgICAgICJtZXNzYWdlIjogIlN1Y2Nlc3MiLAogICAgICAgICAgICAiZnJhdWRfc2NvcmUiOiAxMDAsCiAgICAgICAgICAgICJjb3VudHJ5X2NvZGUiOiAiVVMiLAogICAgICAgICAgICAicmVnaW9uIjogIldhc2hpbmd0b24iLAogICAgICAgICAgICAiY2l0eSI6ICJTZWF0dGxlIiwKICAgICAgICAgICAgIklTUCI6ICJFbWVyYWxkIE9uaW9uIiwKICAgICAgICAgICAgIkFTTiI6IDM5NjUwNywKICAgICAgICAgICAgIm9wZXJhdGluZ19zeXN0ZW0iOiAiTWFjIDEwLjE2IiwKICAgICAgICAgICAgImJyb3dzZXIiOiAiRmlyZWZveCA4NS4wIiwKICAgICAgICAgICAgIm9yZ2FuaXphdGlvbiI6ICJFbWVyYWxkIE9uaW9uIiwKICAgICAgICAgICAgImxhdGl0dWRlIjogNDcuNiwKICAgICAgICAgICAgImxvbmdpdHVkZSI6IC0xMjIuMzMsCiAgICAgICAgICAgICJpc19jcmF3bGVyIjogZmFsc2UsCiAgICAgICAgICAgICJ0aW1lem9uZSI6ICJBbWVyaWNhXC9DaGljYWdvIiwKICAgICAgICAgICAgIm1vYmlsZSI6IGZhbHNlLAogICAgICAgICAgICAiaG9zdCI6ICIyNjIwOjE4YzowOjE5Mjo6MjMyIiwKICAgICAgICAgICAgInByb3h5IjogdHJ1ZSwKICAgICAgICAgICAgInZwbiI6IHRydWUsCiAgICAgICAgICAgICJ0b3IiOiB0cnVlLAogICAgICAgICAgICAiYWN0aXZlX3ZwbiI6IGZhbHNlLAogICAgICAgICAgICAiYWN0aXZlX3RvciI6IHRydWUsCiAgICAgICAgICAgICJkZXZpY2VfYnJhbmQiOiAiTlwvQSIsCiAgICAgICAgICAgICJkZXZpY2VfbW9kZWwiOiAiTlwvQSIsCiAgICAgICAgICAgICJyZWNlbnRfYWJ1c2UiOiB0cnVlLAogICAgICAgICAgICAiYm90X3N0YXR1cyI6IGZhbHNlLAogICAgICAgICAgICAiY29ubmVjdGlvbl90eXBlIjogIlByZW1pdW0gcmVxdWlyZWQuIiwKICAgICAgICAgICAgImFidXNlX3ZlbG9jaXR5IjogIlByZW1pdW0gcmVxdWlyZWQuIiwKICAgICAgICAgICAgInJlcXVlc3RfaWQiOiAiNHVUTzc4cER4eXIzUFAiCiAgICAgICAgfQogICAgKi8KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"472534ec-a25f-468d-a606-3fb1935190df\",\"name\":\"WeChat Profile Normalization\",\"description\":\"Normalizes raw profile data from WeChat\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLm9wZW5pZCksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uaWNrbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5oZWFkaW1ndXJsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLm5pY2tuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"a7a78773-445b-4eca-bb93-409e86bced81\",\"name\":\"GitHub Profile Normalization\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUubG9naW4pKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"2ada53cd-5d37-4592-9c7f-5711271229c2\",\"name\":\"Has Profile Changed\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJIYXMgUHJvZmlsZSBDaGFuZ2VkOiBzdGFydCIpOwpvdXRjb21lID0gInVuY2hhbmdlZCI7CmlmIChnZXRPYmplY3RBdHRyaWJ1dGUoIm9sZF9naXZlbk5hbWUiKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJvbGRfc24iKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJvbGRfdGVsZXBob25lTnVtYmVyIikpIHsKICBvdXRjb21lID0gImNoYW5nZWQiOwp9CmxvZ2dlci5lcnJvcigiSGFzIFByb2ZpbGUgQ2hhbmdlZDogZW5kIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIEdldCBvYmplY3RBdHRyaWJ1dGUgdmFsdWUKICovCmZ1bmN0aW9uIGdldE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKS50b1N0cmluZygpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b703581a-e112-42b9-bc24-6db8bced5a13\",\"name\":\"Display States\",\"description\":\"Display sharedState and transientState.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICAgICAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICBzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAgICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgICAgICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAgICAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgICAgICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAgICAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2Uuc3R5bGUgPSBcInRleHQtYWxpZ246IGxlZnQ7IGlubGluZS1zaXplOiA0MzBweDsgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDtcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgICAgICIgIH1cbiIpLmNvbmNhdCgKICAgICAgIn0pIikKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIGlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBhbmNob3IKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAgLyoKICAgICAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICAgICAqIAogICAgICAqIEV4YW1wbGU6CiAgICAgICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICAgICAgdmFyIHYgPSByOwogICAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgICAgfSk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ed685f9f-5909-4726-86e8-22bd38b47663\",\"name\":\"Normalized Profile to Identity\",\"description\":\"Converts a normalized social profile into an Identity\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgaWRlbnRpdHkgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgiY24iLCBub3JtYWxpemVkUHJvZmlsZS5kaXNwbGF5TmFtZSksCiAgICAgICAgZmllbGQoInVzZXJOYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUudXNlcm5hbWUpLAogICAgICAgIGZpZWxkKCJpcGxhbmV0LWFtLXVzZXItYWxpYXMtbGlzdCIsIHNlbGVjdGVkSWRwICsgJy0nICsgbm9ybWFsaXplZFByb2ZpbGUuaWQuYXNTdHJpbmcoKSkpKQoKcmV0dXJuIGlkZW50aXR5\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"8d786082-b00c-4756-9fe0-7f06f7efe6e9\",\"name\":\"AT_DebugSharedState\",\"description\":\"Debug Shared state\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2suIE5vdCBmb3IgcHJvZHVjdGlvbiB1c2UuCiAqIFNjcmlwdCB0byBkaXNwbGF5IHNoYXJlZFN0YXRlIGluIEludGVsbGlnZW50IEFjY2VzcyBKb3VybmV5IGZvciBkZWJ1Z2dpbmcKICovCi8qIGRlYnVnCiAqQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiBEaXNwbGF5IHNoYXJlZFN0YXRlLCB0cmFuc2llbnRTdGF0ZSwgYW5kIGhlYWRlcnMuCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCnZhciBvdXRwdXQgPSB0cnVlOwoKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIGhhbGlnbiA9ICJsZWZ0IjsKdmFyIG1lc3NhZ2UgPSAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIuY29uY2F0KAogIAlzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+VHJhbnNpZW50IFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAJdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPlJlcXVlc3QgSGVhZGVyczwvYj46PGJyLz4iKS5jb25jYXQoCiAgCXJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwp9CgogLyoKICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgKgogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"847aab1b-c739-4d64-b26c-180f96cba02b\",\"name\":\"Select Theme by Browser Language\",\"description\":\"Select and apply theme from based on the browser language in the request.\",\"script\":\"LyogU2VsZWN0IFRoZW1lIGJ5IEJyb3dzZXIgTGFuZ3VhZ2UKICogCiAqIFNlbGVjdCBhbmQgYXBwbHkgdGhlbWUgZnJvbSBiYXNlZCBvbiB0aGUgYnJvd3NlciBsYW5ndWFnZSBpbiB0aGUgcmVxdWVzdC4KICogCiAqIFRoaXMgc2NyaXB0IG5lZWRzIHRvIGJlIHBhcmFtZXRyaXplZCEKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLyogQmVnaW4gU2NyaXB0IENvbmZpZ3VyYXRpb24gKi8KCiAgICAvLyB0aGUgc2NyaXB0IGV4cGVjdHMgdGhlIHRoZW1lcyB0byBiZSBuYW1lZCA8YmFzZVRoZW1lPl88bGFuZ3VhZ2U+LCBlLmcuICJaYXJkb3pfZW4iCiAgICB2YXIgYmFzZVRoZW1lID0gIlphcmRveiI7CgogICAgLy8gYWRkIGFsbCB0aGUgbGFuZ3VhZ2UgY29kZXMgeW91IHdhbnQgdG8gc3VwcG9ydAogICAgdmFyIHN1cHBvcnRlZExhbmd1YWdlcyA9IFsiZGUiLCAiZW4iLCAiZnIiXTsKCiAgICAvLyBzcGVjaWZ5IHRoZSBkZWZhdWx0IGxhbmd1YWdlIHRvIGZhbGwgYmFjayBvbiBpZiB0aGUgYnJvd3NlciBsYW5ndWFnZSBpcyBub3QgYSBzdXBwb3J0ZWQgbGFuZ3VhZ2UKICAgIHZhciBkZWZhdWx0TGFuZ3VhZ2UgPSAiZW4iOwoKICAgIC8qIEVuZCBTY3JpcHQgQ29uZmlndXJhdGlvbiAgICovCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgICB2YXIgdGhlbWUgPSBnZXRUaGVtZUJ5TGFuZ3VhZ2UoYmFzZVRoZW1lKTsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICB2YXIgc3RhZ2UgPSAidGhlbWVJZD0iICsgdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAvKgogICAgICogUmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgdGhlbWUgdG8gc2VsZWN0IGJhc2VkIG9uIGJyb3dzZXIgbGFuZ3VhZ2UKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0VGhlbWVCeUxhbmd1YWdlKHRoZW1lKSB7CiAgICAgICAgdmFyIGxhbmd1YWdlSGVhZGVyID0gZ2V0SGVhZGVyKCJhY2NlcHQtbGFuZ3VhZ2UiKTsKICAgICAgICB2YXIgbGFuZ3VhZ2UgPSBsYW5ndWFnZUhlYWRlci5zcGxpdCgnOycpWzBdLnNwbGl0KCcsJylbMF0uc3BsaXQoJy0nKVswXTsKICAgICAgICBpZiAoc3VwcG9ydGVkTGFuZ3VhZ2VzLmluZGV4T2YobGFuZ3VhZ2UpIDwgMCkgewogICAgICAgICAgICBsYW5ndWFnZSA9IGRlZmF1bHRMYW5ndWFnZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoZW1lICsgIl8iICsgbGFuZ3VhZ2U7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkgKyAiIjsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a8f10e93-3f6c-4d6c-b6a3-a8453e3d6b3a\",\"name\":\"ResetPasswordReplayCredentials\",\"description\":\"Reset the attributes holding replay credentials for the IG replay use case.\",\"script\":\"LyogUmVzZXRQYXNzd29yZFJlcGxheUNyZWRlbnRpYWxzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJlc2V0IHRoZSBhdHRyaWJ1dGVzIGhvbGRpbmcgcmVwbGF5IGNyZWRlbnRpYWxzIGZvciB0aGUgSUcgcmVwbGF5IHVzZSBjYXNlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkIGZvciB5b3VyIGVudi4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIG91dGNvbWUgPSAidHJ1ZSI7CiAgdmFyIFJFUExBWV9VU0VSTkFNRV9JRE1fQVRUUiA9ICJmclVuaW5kZXhlZFN0cmluZzEiOwogIHZhciBSRVBMQVlfUEFTU1dPUkRfSURNX0FUVFIgPSAiZnJVbmluZGV4ZWRTdHJpbmcyIjsKICAKICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoUkVQTEFZX1VTRVJOQU1FX0lETV9BVFRSLCBudWxsKTsKICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoUkVQTEFZX1BBU1NXT1JEX0lETV9BVFRSLCBudWxsKTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1f389a3d-21cf-417c-a6d3-42ea620071f0\",\"name\":\"ForgeRock Internal: OIDC Claims Script\",\"description\":\"Internal OIDC Claims script\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"91d197de-5916-4dca-83b5-9a4df26e7159\",\"name\":\"WordPress Profile Normalization\",\"description\":\"Normalizes raw profile data from WordPress\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJuYW1lKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmRpc3BsYXlfbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5hdmF0YXJfVVJMKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"123725a9-2119-4efd-a6b0-456f3ccd34b7\",\"name\":\"deviceprofile_to_attribute\",\"description\":\"null\",\"script\":\"dmFyIG9iamVjdEF0dHJpYnV0ZXMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKdmFyIGRldmljZUhhc2ggPSBzaGFyZWRTdGF0ZS5nZXQoImRldmljZUhhc2giKTsKCnNoYXJlZFN0YXRlLnB1dCgiZnJJbmRleGVkU3RyaW5nMSIgLCBkZXZpY2VIYXNoICk7CgoKCmlmKG9iamVjdEF0dHJpYnV0ZXMgPT09IG51bGwgfHwgb2JqZWN0QXR0cmlidXRlcyA9PT0gdW5kZWZpbmVkKQp7CgoKIG9iamVjdEF0dHJpYnV0ZXMgPSB7CiAgIAkJCQkJICJ1c2VyTmFtZSIgOiAiYW5vbi0iLmNvbmNhdChkZXZpY2VIYXNoKSwKICAgICAgICAgICAgICAgICAgICAgImdpdmVuTmFtZSIgOiAiICIsCiAgICAgICAgICAgICAgICAgICAgICJzbiIgOiAiICIsCiAgICAgICAgICAgICAgICAgICAgICJtYWlsIiA6ICJhbm9uLSIuY29uY2F0KGRldmljZUhhc2gpLmNvbmNhdCgiQG15dGVzdHJ1bi5jb20iKSwKICAgICAgICAgICAgICAgICAgICAgImZySW5kZXhlZFN0cmluZzEiIDogZGV2aWNlSGFzaAogICAgICAgICAgICAgICAgICAgIH0KfQplbHNlCnsKCiAgICBvYmplY3RBdHRyaWJ1dGVzLnB1dCgidXNlck5hbWUiLCAgImFub24tIi5jb25jYXQoZGV2aWNlSGFzaCkpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoImdpdmVuTmFtZSIsICIgIik7CiAgICBvYmplY3RBdHRyaWJ1dGVzLnB1dCgic24iLCAiICIpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoIm1haWwiLCAiYW5vbi0iLmNvbmNhdChkZXZpY2VIYXNoKS5jb25jYXQoIkBteXRlc3RydW4uY29tIikpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoImZySW5kZXhlZFN0cmluZzEiLCBkZXZpY2VIYXNoKTsKICAgCn0KCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLG9iamVjdEF0dHJpYnV0ZXMpOwogICAgCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"878816b3-2bb4-4b43-8001-10f926ddefff\",\"name\":\"Impersonate: Switch Actors And Become Impersonatee\",\"description\":\"Switch Actors And Become Impersonatee.\",\"script\":\"LyogSW1wZXJzb25hdGU6IFN3aXRjaCBBY3RvcnMgQW5kIEJlY29tZSBJbXBlcnNvbmF0ZWUKICoKICogU3dpdGNoIEFjdG9ycyBBbmQgQmVjb21lIEltcGVyc29uYXRlZS4KICoKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8KCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIud2FybmluZygiSW1wZXJzb25hdGU6IFN3aXRjaCBBY3RvcnM6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gImZhbHNlIjsKCiAgICB2YXIgaW1wZXJzb25hdGVlID0gc2hhcmVkU3RhdGUuZ2V0KCJpbXBlcnNvbmF0ZWUiKTsKICAgIHZhciBpbXBlcnNvbmF0b3IgPSBzaGFyZWRTdGF0ZS5nZXQoImltcGVyc29uYXRvciIpOwogICAgaWYgKGltcGVyc29uYXRlZSAmJiBpbXBlcnNvbmF0b3IpIHsKICAgICAgICBvdXRjb21lID0gInRydWUiOwogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBpbXBlcnNvbmF0ZWUpOwogICAgICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBpbXBlcnNvbmF0ZWUpOwogICAgfQoKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogU3dpdGNoIEFjdG9yczogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKICAKICAgIC8qCiAgICAgKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgICAgICB9CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"2997bd4d-14be-4dc6-8701-27f08d10b8b7\",\"name\":\"iddataweb Profile Normalization\",\"description\":\"Profile Normalization Script for idddataweb\",\"script\":\"LyovKgogKiBDb3B5cmlnaHQgMjAyMiBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4gTm90IGZvciBQcm9kdWN0aW9uIHVzZS4gCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICovCi8qIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdCBmb3IgSUQgRGF0YVdlYiAqLwppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKbG9nZ2VyLmVycm9yKCJpZGRhdGF3ZWJfU29jaWFsIElkZW50aXR5IFByb3ZpZGVyIFByb2ZpbGUgVHJhbnNmb3JtYXRpb24gc2NyaXB0OiBTdGFydCIpOwp1c2VyTmFtZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpOwpsb2dnZXIuZXJyb3IoImlkZGF0YXdlYl9Tb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgUHJvZmlsZSBUcmFuc2Zvcm1hdGlvbiBzY3JpcHQ6IHVzZXJOYW1lIiArIHVzZXJOYW1lICk7CnVzZXJuYW1lID0gdXNlck5hbWU7CnNoYXJlZFN0YXRlLnB1dCgidXNlck5hbWUiLCB1c2VyTmFtZSk7CgpyZXR1cm4ganNvbihvYmplY3QoCiAgICAgICAgZmllbGQoImlkIiwgcmF3UHJvZmlsZS5zdWIpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfZm5hbWUuYXNTdHJpbmcoKSArICIgIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmNhcGl0YWxpemUoKSApLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEZ1bGxOYW1lX2ZuYW1lLmFzU3RyaW5nKCkudG9Mb3dlckNhc2UoKS5jYXBpdGFsaXplKCkgKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmNhcGl0YWxpemUoKSApLAogICAgICAgIGZpZWxkKCJwb3N0YWxBZGRyZXNzIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2FkZHJlc3MpLAogICAgICAgIGZpZWxkKCJhZGRyZXNzTG9jYWxpdHkiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEFkZHJlc3NfbG9jYWxpdHkpLAogICAgICAgIGZpZWxkKCJhZGRyZXNzUmVnaW9uIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSksCiAgICAgICAgZmllbGQoInBvc3RhbENvZGUiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEFkZHJlc3NfcG9zdGFsX2NvZGUpLAogICAgICAgIGZpZWxkKCJjb3VudHJ5IiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2NvdW50cnkpLAogICAgICAgIGZpZWxkKCJkcml2ZXJzTGljZW5zZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRHJpdmVyc0xpY2Vuc2VOdW1iZXJfYWNxdWlyZWREcml2ZXJzTGljZW5zZU51bWJlciksCiAgICAgICAgZmllbGQoImRyaXZlcnNMaWNlbnNlSXNzdWVyIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfRHJpdmVyc0xpY2Vuc2VJc3N1ZXJDb2RlX0RyaXZlcnNMaWNlbnNlSXNzdWVyQ29kZSksCiAgCQlmaWVsZCgiRE9CIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRET0JfbW9udGguYXNTdHJpbmcoKSArICIvIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRE9CX2RheS5hc1N0cmluZygpICsgIi8iICsgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRET0JfeWVhci5hc1N0cmluZygpICksCgogICAgICAgIGZpZWxkKCJJRFdTY29yZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0lEV1Njb3JlKSwKICAgICAgICBmaWVsZCgicG9saWN5RGVjaXNpb24iLCByYXdQcm9maWxlLnBvbGljeURlY2lzaW9uX2NvbmNsdXNpb24pLAogICAgICAgIGZpZWxkKCJwaG9uZSIsIHJhd1Byb2ZpbGUudXNlckF0dHJpYnV0ZXNfSW50ZXJuYXRpb25hbFRlbGVwaG9uZV9kaWFsQ29kZS5hc1N0cmluZygpICsgcmF3UHJvZmlsZS51c2VyQXR0cmlidXRlc19JbnRlcm5hdGlvbmFsVGVsZXBob25lX3RlbGVwaG9uZS5hc1N0cmluZygpKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCB1c2VyTmFtZSApCiAgICAgICAvL2ZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfZm5hbWUuYXNTdHJpbmcoKSArICIuIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKSApCgogICApCikK\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"25d8a628-3556-4219-aaf5-2384e2e5f19a\",\"name\":\"Onfido-CreateApplicant\",\"description\":\"Create Applicant\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ3JlYXRlQXBwbGljYW50OiBTdGFydCIpOwoKLyoKICogISEhIEV4dGVuZCB5b3VyIGF1dGhlbnRpY2F0aW9uIHNlc3Npb24gdGltZSBzbyB5b3VyIGlkZW50aXR5IHByb29maW5nIGZsb3dzIGRvbid0IHRpbWUgb3V0ICEhIQogKgogKiBBdXRoZW50aWNhdGlvbiA+IFNldHRpbmdzID4gVHJlZXMgPiBNYXggRHVyYXRpb24gKE1pbnV0ZXMpCiAqCiAqIFNldCB0byAxNSBtaW51dGVzLgogKgogKi8KCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqCiAqIFJFUExBQ0UgV0lUSCBZT1VSIE9XTiBPTkZJRE8gQVBJIFRPS0VOCiAqLwp2YXIgT05GSURPX0FQSV9UT0tFTiA9ICJhcGlfbGl2ZS5TdFVkZnhkaUNGYi5ZcnpiYWR4Ql9SMi1xRzVsRlVjM2xXZzZKQWMzQ25xLSI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCi8vIFJlcXVpcmVzIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgYXV0aCBub2RlIHRvIHJldHJpZXZlIHJlYWwgdXNlciBJRCBmcm9tIElETQp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpOwoKLy8gUmV0cmlldmUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZXMgZm9yIGNvbXBhcmlzb24gd2l0aCBkb2N1bWVudCB2ZXJpZmljYXRpb24KLy8gdmFyIHJlcXVlc3RCb2R5SnNvbiA9IHsKLy8gICAgICJmaXJzdF9uYW1lIjogU3RyaW5nKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKSwKLy8gICAgICJsYXN0X25hbWUiOiBTdHJpbmcoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgInNuIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKSksCi8vICAgICAiZG9iIjogU3RyaW5nKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJmci1hdHRyLWlzdHIxIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKSkKLy8gfQp2YXIgcmVxdWVzdEJvZHlKc29uID0gewogICAgImZpcnN0X25hbWUiOiBTdHJpbmcoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgImdpdmVuTmFtZSIpLml0ZXJhdG9yKCkubmV4dCgpLnRvU3RyaW5nKCkpLAogICAgImxhc3RfbmFtZSI6IFN0cmluZyhpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCAic24iKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKQp9Cgp2YXIgZmFpbHVyZSA9IHRydWUKCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0CikKCnZhciByZXF1ZXN0ID0gbmV3IGZyLlJlcXVlc3QoKTsKcmVxdWVzdC5zZXRVcmkoImh0dHBzOi8vYXBpLm9uZmlkby5jb20vdjMvYXBwbGljYW50cy8iKTsKcmVxdWVzdC5zZXRNZXRob2QoIlBPU1QiKTsKcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCIpOwpyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pOwpyZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keUpzb24pKTsKCnZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ3JlYXRlQXBwbGljYW50OiBDcmVhdGUgYXBwbGljYW50IElEIHJlc3BvbnNlOiAiLmNvbmNhdChyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkpOwoKaWYgKHJlc3BvbnNlLmdldFN0YXR1cygpLmdldENvZGUoKSA9PT0gMjAxKSB7CiAgICB2YXIgYXBwbGljYW50SUQgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKS5pZDsKICAgIGZhaWx1cmUgPSAhYXBwbGljYW50SUQ7CiAgICBpZiAoIWZhaWx1cmUpIHNoYXJlZFN0YXRlLnB1dCgib25maWRvQXBwbGljYW50SUQiLCBhcHBsaWNhbnRJRCk7Cn0KZWxzZSB7CiAgICBmYWlsdXJlID0gdHJ1ZTsKfQoKLy8gR2V0IE9uZmlkbyBjbGllbnQgSldUIHRva2VuIHJlcXVpcmVkIGJ5IGNsaWVudCBTREsKaWYgKCFmYWlsdXJlKSB7CgkvLyBnZXQgdGhlIHJlZmVyZXIKCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAgIHZhciByZXF1ZXN0Qm9keUpzb24gPSB7CiAgICAgICAgImFwcGxpY2FudF9pZCI6IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0FwcGxpY2FudElEIikpLAogICAgICAgICJyZWZlcnJlciI6IHJlZmVyZXIub3JpZ2luLmNvbmNhdCgiLyIpCiAgICB9CgogICAgZmFpbHVyZSA9IHRydWU7CgogICAgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9hcGkub25maWRvLmNvbS92My9zZGtfdG9rZW4iKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCJQT1NUIik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pOwogICAgcmVxdWVzdC5nZXRFbnRpdHkoKS5zZXRTdHJpbmcoSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHlKc29uKSk7CgogICAgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICBsb2dnZXIuZXJyb3IoIk9uZmlkby1DcmVhdGVBcHBsaWNhbnQ6IEdldCBzZGsgdG9rZW4gcmVzcG9uc2U6ICIuY29uY2F0KHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKSk7CgogICAgaWYgKHJlc3BvbnNlLmdldFN0YXR1cygpLmdldENvZGUoKSA9PT0gMjAwKSB7CiAgICAgICAgdmFyIHRva2VuID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkudG9rZW4KICAgICAgICBmYWlsdXJlID0gIXRva2VuOwogICAgICAgIGlmICghZmFpbHVyZSkgc2hhcmVkU3RhdGUucHV0KCJvbmZpZG9BdXRoVG9rZW4iLCB0b2tlbik7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBmYWlsdXJlID0gdHJ1ZTsKICAgIH0KfQoKb3V0Y29tZSA9IGZhaWx1cmUgPyAiZmFsc2UiIDogInRydWUiOwpsb2dnZXIuZXJyb3IoIk9uZmlkby1DcmVhdGVBcHBsaWNhbnQ6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgovKgogKiBQYXJzZSBhIFVSTCBpbnRvIGl0cyBjb21wb25lbnRzIGFuZCBtYWtlIHRoZW0gZWFzaWx5IGFjY2Vzc2libGUgYnkgbmFtZQogKiAKICogZS5nLjogaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAqIHsKICogICAgIGhhc2g6ICcjLycsCiAqICAgICBob3N0OiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICogICAgIGhvc3RuYW1lOiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogKiAgICAgb3JpZ2luOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogKiAgICAgcGF0aG5hbWU6ICcvYW0vWFVJLycsCiAqICAgICBwb3J0OiAnJywKICogICAgIHByb3RvY29sOiAnaHR0cHMnLAogKiAgICAgc2VhcmNoOiAnP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltJywKICogICAgIHVzZXJuYW1lOiAnJywKICogICAgIHBhc3N3b3JkOiAnJywKICogICAgIHNlYXJjaFBhcmFtOiB7CiAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogKiAgICAgICAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICogICAgICAgICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScKICogICAgIH0KICogfQogKi8KZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgdmFyIG0gPSBocmVmLm1hdGNoKC9eKChbXjpcLz8jXSspOj8oPzpcL1wvKCg/OihbXlwvPyM6XSopOihbXlwvPyM6XSopQCk/KFteXC8/IzpdKikoPzo6KFteXC8/IzpdKikpPykpKT8oW14/I10qKShcP1teI10qKT8oIy4qKT8kLyksCiAgICByID0gewogICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgIGhvc3Q6IG1bM10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICBob3N0bmFtZTogbVs2XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgIG9yaWdpbjogbVsxXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgIHBhdGhuYW1lOiBtWzhdIHx8IChtWzFdID8gIi8iIDogIiIpLCAgICAvLyAvYW0vWFVJLwogICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICBwcm90b2NvbDogbVsyXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gaHR0cHMKICAgICAgICBzZWFyY2g6IG1bOV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltCiAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgIHBhc3N3b3JkOiBtWzVdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICBzZWFyY2hQYXJhbToge30gICAgICAgICAgICAgICAgICAgICAgICAgLy8geyByZWFsbTogJy9icmF2bycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJyB9CiAgICB9OwogICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICByLnByb3RvY29sID0gImZpbGU6Ly8vIiArIHIucHJvdG9jb2wudG9VcHBlckNhc2UoKTsKICAgICAgICByLm9yaWdpbiA9IHIucHJvdG9jb2wgKyAiLy8iICsgci5ob3N0OwogICAgfQogICAgaWYgKHIuc2VhcmNoLmxlbmd0aCA+IDIpIHsKICAgICAgICB2YXIgcXVlcnkgPSAoci5zZWFyY2guaW5kZXhPZignPycpID09PSAwKSA/IHIuc2VhcmNoLnN1YnN0cigxKSA6IHIuc2VhcmNoOwogICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcGFpciA9IHZhcnNbaV0uc3BsaXQoJz0nKTsKICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgfQogICAgfQogICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICByZXR1cm4gcjsKfTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"c253a7ac-ebc9-4268-9e62-89f38f98e4ab\",\"name\":\"CopyIDToObjectAttributes\",\"description\":\"null\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KCJfaWQiLCBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ae04e1a0-c662-43aa-9d80-21af78528b45\",\"name\":\"AAD Passthru Parse Access Token\",\"description\":\"Parse Access Token from Azure AD pass through authentication using the Resource Owner Password Credential flow\",\"script\":\"LyogQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBQYXJzZSBBY2Nlc3MgVG9rZW4gZnJvbSBBenVyZSBBRCBwYXNzIHRocm91Z2ggYXV0aGVudGljYXRpb24gdXNpbmcgdGhlIAogKiBSZXNvdXJjZSBPd25lciBQYXNzd29yZCBDcmVkZW50aWFsIGZsb3cKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgQUFEIFBhc3N0aHJ1IFJPUEMgc2NyaXB0IHRvIHJ1biBiZWZvcmUgYW5kIGZpbmlzaCB3aXRoIHRoZSAKICogIlZhbGlkIiBvdXRjb21lIChvbmx5IG91dGNvbWUgdGhhdCByZXN1bHRzIGluIGFuIGFjY2VzcyB0b2tlbikuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbjogc3RhcnQiKTsKCi8qCiAqIEJhc2U2NCBlbmNvZGUgLyBkZWNvZGUKICogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvLwogKiAKICogVXNhZ2U6CiAqIEJhc2U2NC5lbmNvZGUoJ3NvbWUgc3RyaW5nJykKICogQmFzZTY0LmRlY29kZSgnc29tZSBlbmNvZGVkIHN0cmluZycpCiAqLwp2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgpvdXRjb21lID0gImZhbHNlIjsKaWYgKHRyYW5zaWVudFN0YXRlLmdldCgiYWFkQWNjZXNzVG9rZW4iKSkgewogIAl0cnkgewogICAgICAgIHZhciBqc29uVG9rZW4gPSBwYXJzZUp3dCh0cmFuc2llbnRTdGF0ZS5nZXQoImFhZEFjY2Vzc1Rva2VuIikudG9TdHJpbmcoKSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJnaXZlbk5hbWUiLCBqc29uVG9rZW4uZ2l2ZW5fbmFtZSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsIGpzb25Ub2tlbi5mYW1pbHlfbmFtZSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJtYWlsIiwganNvblRva2VuLnVuaXF1ZV9uYW1lKTsKICAgICAgICBvdXRjb21lID0gInRydWUiCiAgICB9IGNhdGNoIChlKSB7CgkJbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBQYXJzZSBBY2Nlc3MgVG9rZW46IEV4Y2VwdGlvbjogIi5jb25jYXQoZSkpOwogICAgfQp9IGVsc2UgewogIAlvdXRjb21lID0gImZhbHNlIjsKICAJbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBQYXJzZSBBY2Nlc3MgVG9rZW46IE5vIGFjY2VzcyB0b2tlbiBmb3VuZCBpbiB0cmFuc2llbnQgc3RhdGUhIFVzZSBST1BDIHNjcmlwdCBiZWZvcmUgdGhpcyBzY3JpcHQgdG8gcG9wdWxhdGUgdHJhbnNpZW50IHN0YXRlISciKTsKfQpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbjogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTsKCi8qCiAqIFBhcnNlIGEgbm9uLWVuY3J5cHRlZCBKV1QgdG9rZW4gYW5kIHJldHVybiBpdHMgSlNPTiBib2R5IHdpdGhvdXQgaGVhZGVyIGFuZCBzaWduYXR1cmUKICovCmZ1bmN0aW9uIHBhcnNlSnd0ICh0b2tlbikgewogIAlyZXR1cm4gSlNPTi5wYXJzZShCYXNlNjQuZGVjb2RlKCIiLmNvbmNhdCh0b2tlbikuc3BsaXQoJy4nKVsxXSkucmVwbGFjZSgvXDAvZywgJycpKTsKfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"a71b5794-ba0e-426e-bb1b-351b2d942a08\",\"name\":\"AT_MFA_Method\",\"description\":\"Script to determine MFA Method - sms, mail, fido, push, oath, duo\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCB3aWxsIHJlYWQgdGhlIEZvcmdlUm9jayBJZGVudGl0eSBDbG91ZCBhdHRyaWJ1dGUgImZyVW5pbmRleGVkU3RyaW5nMiIgdG8gc2VlIHRoZSB1c2VyJ3MKICAtIE1GQSBPcHQtaW4gY2hvaWNlLiBvdXRjb21lcyB3aWxsIGJlICJlbXB0eSIgInNtcyIgIm1haWwiICJmaWRvIiAicHVzaCIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCgpsb2dnZXIuZXJyb3IoJ0FUX01GQV9NZXRob2Qgc2NyaXB0OiBTVEFSVCcpCmxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZDogdGhpczogIiArIE9iamVjdC5rZXlzKHRoaXMpKQpsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2Q6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSkKCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKbG9nZ2VyLmVycm9yKCJBVF9NRkFfTWV0aG9kOiB1c2VybmFtZTogIiArIHVzZXJuYW1lKQpsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2Q6IE1GQSBNZXRob2Q6ICIgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKQoKb3V0Y29tZSA9ICJlbXB0eSIKICAKaWYgKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkudG9BcnJheSgpLmxlbmd0aCkgewogIGxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZCAgaWRlbnRpdHkgYXR0cmlidXRlOiAiICsgYXR0cmlidXRlICsgIiBpcyBwcmVzZW50IiApOyAgCiAgdmFyIGNob2ljZSA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkuaXRlcmF0b3IoKS5uZXh0KCk7IAogIGxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZCAgaWRlbnRpdHkgYXR0cmlidXRlOiBjaG9pY2UgaXM6ICIgKyBjaG9pY2UgKQoKICBpZihjaG9pY2UgPT0gInNtcyIpewogICAgb3V0Y29tZSA9ICJzbXMiCgogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJwdXNoIikgewogICAgb3V0Y29tZSA9ICJwdXNoIgoKICB9IGVsc2UgaWYgKGNob2ljZSA9PSAibWFpbCIpIHsKICAgIG91dGNvbWUgPSAibWFpbCIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImZpZG8iKXsKICAgIG91dGNvbWUgPSAiZmlkbyIKCiAgfSAgZWxzZSBpZiAoY2hvaWNlID09ICJvYXRoIil7CiAgICBvdXRjb21lID0gIm9hdGgiCgogIH0gIGVsc2UgaWYgKGNob2ljZSA9PSAiZHVvIil7CiAgICBvdXRjb21lID0gImR1byIKCiAgfSAKCn0gZWxzZSB7CiAgb3V0Y29tZSA9ICJlbXB0eSIKICBsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2QgIG91dGNvbWUgaXMgbmV2ZXIgYmVjYXVzZSBhdHRyaWJ1dGUgZW1wdHkgIikKICAKfQoKbG9nZ2VyLmVycm9yKCJBVF9NRkFfTWV0aG9kOiBvdXRjb21lOiAiICsgb3V0Y29tZSk=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"35f56a51-cb99-410d-a7d2-7dc0bb9e4cb7\",\"name\":\"Post Redirect Language Selector\",\"description\":\"Use this script to switch to the preferred language after a node that redirects the browser (SAML2 node, Social IDP Handler node, etc.) or even to switch language mid-journey.\",\"script\":\"KGZ1bmN0aW9uICgpIHsKICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwgCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLnNwaS5SZWRpcmVjdENhbGxiYWNrCiAgKTsKCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsgCiAgICB2YXIgcGFyYW1zID0gcmVxdWVzdFBhcmFtZXRlcnMudG9TdHJpbmcoKTsKICAgIHBhcmFtcyA9IHBhcmFtcy5yZXBsYWNlKC9cWy9nLCAiIikucmVwbGFjZSgvXF0vZywgIiIpLnJlcGxhY2UoL1x7L2csICIiKS5yZXBsYWNlKC99L2csICIiKS5yZXBsYWNlKC8gL2csICIiKS5yZXBsYWNlKC8sL2csICImIik7CiAgICBwYXJhbXMgPSAiPyIgKyBwYXJhbXM7CiAgICB2YXIgcmVkaXJlY3QgPSBuZXcgZnIuUmVkaXJlY3RDYWxsYmFjayhwYXJhbXMgKyAiJmxvY2FsZT0iICsgImZyIiwgbnVsbCwgIkdFVCIpOwogICAgcmVkaXJlY3Quc2V0VHJhY2tpbmdDb29raWUodHJ1ZSk7CgogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgIHJlZGlyZWN0CiAgICApLmJ1aWxkKCk7CiAgfSAKICBlbHNlIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsgICAgICAgIAogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"2aab9d46-9363-4061-9f63-eb824e33c505\",\"name\":\"Logout\",\"description\":\"Logout.\",\"script\":\"LyogTG9nb3V0CiAqIAogKiBMb2dvdXQuCiAqIAogKiBUaGlzIHNjcmlwdCByZXF1aXJlcyBwYXJhbWV0cml6YXRpb24uIE1ha2Ugc3VyZSB5b3UgY2FyZWZ1bGx5IHJldmlldyB0aGUgY29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci5tZXNzYWdlKCJMb2dvdXQ6IHN0YXJ0Iik7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKCiAgCS8qIEJlZ2luIENvbmZpZ3VyYXRpb24gKi8KICAKICAJdmFyIEFNX1JFQUxNID0gImFscGhhIjsKICAgIAogICAgLy8gQU0gQVBJIENvbmZpZ3VyYXRpb24KICAgIHZhciBBTV9BUElfVVJJID0gcmVmZXJlci5vcmlnaW4gKyAiL2FtL2pzb24vIiArIEFNX1JFQUxNICsgIi9zZXNzaW9ucy8/X2FjdGlvbj1sb2dvdXQiOwoKICAJLyogRW5kIENvbmZpZ3VyYXRpb24gKi8KCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKEFNX0FQSV9VUkkpOwoJcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCIpOwoJcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb29raWUiLCByZXF1ZXN0SGVhZGVycy5nZXQoImNvb2tpZSIpLmdldCgwKSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkFjY2VwdC1BUEktVmVyc2lvbiIsICJyZXNvdXJjZT0zLjEiKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiTG9nb3V0OiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwogIAogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uc3BpLlJlZGlyZWN0Q2FsbGJhY2ssCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2sKICAgICkKICAgIC8vIHJlZGlyZWN0IHRvIHRoaXMgam91cm5leSBhZ2FpbgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlJlZGlyZWN0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICByZWZlcmVyLmhyZWYsCiAgICAgICAgICAgICAgICBudWxsLAogICAgICAgICAgICAgICAgIkdFVCIKICAgICAgICAgICAgKQogICAgICAgICkuYnVpbGQoKTsKICAgIH0KICAgIGVsc2UgewogICAgCWxvZ2dlci5tZXNzYWdlKCJMb2dvdXQ6IGVuZCBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKICAgIH0KCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"6ad22934-5d12-43a6-96a7-a2fba8d999bf\",\"name\":\"UOP Get Course ID\",\"description\":\"Call out to University of Phoenix Course Registration System and get current course.\",\"script\":\"LyogVU9QIEdldCBDb3Vyc2UgSUQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2FsbCBvdXQgdG8gVW5pdmVyc2l0eSBvZiBQaG9lbml4IENvdXJzZSBSZWdpc3RyYXRpb24gU3lzdGVtIGFuZCBnZXQgY3VycmVudCBjbGFzcy4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSBpdCBpcyBiZWluZyBjYWxsZWQuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gaGFzIGNsYXNzZXMKICogLSBubyBjbGFzc2VzCiAqIC0gZXJyb3IKICovCmxvZ2dlci53YXJuaW5nKCJVT1AgR2V0IENvdXJzZSBJRDogc3RhcnQiKTsKCm91dGNvbWUgPSAiZXJyb3IiOwoKaWYgKHNoYXJlZFN0YXRlLmdldCgiX2lkIikgJiYgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAibWFpbCIpLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CgogICAJLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVBJIFNFVFRJTkdTCiAgICAgKi8KICAJdmFyIGVtYWlsID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAibWFpbCIpLml0ZXJhdG9yKCkubmV4dCgpOwogICAgdmFyIFVPUF9DTEFTU19BUElfVVJJID0gImh0dHBzOi8vZHk0cnBldzV2YS5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9mb3JnZXJvY2svY291cnNlP2NvdXJzZUlkPUNFUzQyMiI7CiAgCS8vdmFyIFVPUF9DTEFTU19BUElfVVJJID0gImh0dHBzOi8vZHk0cnBldzV2YS5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9mb3JnZXJvY2svY291cnNlP2VtYWlsSWQ9Ii5jb25jYXQoZW1haWwpOwogICAgLyoKICAgICAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogICAgICovCgogICAgdmFyIHJlcXVlc3QgPSBuZXcgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QoKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFVPUF9DTEFTU19BUElfVVJJKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgVU9QQ2xhc3NJRCA9IHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpOwogICAgbG9nZ2VyLndhcm5pbmcoIlVPUCBHZXQgQ291cnNlIElEOiBBUEkgY2FsbCByZXN1bHQ6IENvdXJzZSBJRD0iLmNvbmNhdChVT1BDbGFzc0lEKSk7CgogICAgLyogU2FtcGxlIEFQSSByZXNwb25zZQogICAgQ0VTNDIxCgkqLwoKICAgIGlmIChVT1BDbGFzc0lEKSB7CiAgICAgICAgb3V0Y29tZSA9ICJoYXMgY2xhc3NlcyI7CgogICAgICAgIC8vIHByZXNlcnZlIHJlc3VsdCBpbiBzaGFyZWQgc3RhdGUKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoInVvcEN1cnJlbnRDbGFzc0lEIiwgVU9QQ2xhc3NJRCk7CiAgICB9IAogICAgZWxzZSBpZiAoVU9QQ2xhc3NJRCA9PT0gIiIpIHsKICAgICAgICBvdXRjb21lID0gIm5vIGNsYXNzZXMiOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgb3V0Y29tZSA9ICJlcnJvciI7CiAgICB9Cgp9IGVsc2UgewogICAgbG9nZ2VyLmVycm9yKCJVT1AgR2V0IENvdXJzZSBJRDogbm8gY2xhc3NlcyEiKTsKfQoKbG9nZ2VyLndhcm5pbmcoIlVPUCBHZXQgQ291cnNlIElEOiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"0ab1dd57-eafd-4063-8e60-65bfac8108b7\",\"name\":\"Check Existing Session\",\"description\":\"Check existing session and set username\",\"script\":\"aWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICd1bmRlZmluZWQnKQp7CiAgb3V0Y29tZSA9ICJoYXNTZXNzaW9uIjsKICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgZXhpc3RpbmdTZXNzaW9uLmdldCgiVXNlcklkIikpOwogIHNoYXJlZFN0YXRlLnB1dCgiX2lkIiwgZXhpc3RpbmdTZXNzaW9uLmdldCgiVXNlcklkIikpOwogIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewoJc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KCJ1c2VyTmFtZSIsIGV4aXN0aW5nU2Vzc2lvbi5nZXQoIlVzZXJJZCIpKTsKICB9CiAgZWxzZSB7CglzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCB7dXNlck5hbWU6IGV4aXN0aW5nU2Vzc2lvbi5nZXQoIlVzZXJJZCIpfSk7CiAgfQp9CmVsc2UKewogIG91dGNvbWUgPSAibm9TZXNzaW9uIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"181817ea-b8dc-4b3b-a366-99239f6f274d\",\"name\":\"Twilio IVR: Connect Caller\",\"description\":\"Connect caller to a real person.\",\"script\":\"LyogVHdpbGlvIElWUjogQ29ubmVjdCBDYWxsZXIKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBEZXBlbmRpbmcgb24gdGhlIGFtb3VudCBvZiBkYXRhIGNvbGxlY3RlZCB0aHJvdWdoIGNhbGxiYWNrcyBhbmQgaG93IG1hbnkgb2YgdGhlIGNhbGxQYXJhbXMKICogeW91IGFjdGl2YXRlIGJlbG93LCB5b3Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB5b3VyIGF1dGhlbnRpY2F0aW9uIHNlc3Npb24gZnJvbSBKV1QgdG8gQ1RTIG9yCiAqIE1lbW9yeS4KICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBDb25uZWN0IENhbGxlcjogc3RhcnQiKTsKb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBNZXNzYWdlCnZhciBtZXNzYWdlID0gIkknbSBjb25uZWN0aW5nIHlvdSB0byBhIHJlYWwgcGVyc29uIG5vdy4iOwoKLy8gVHdpTUwgdG8gc2VuZCBiYWNrIHRvIFR3aWxpbwp2YXIgdHdpbWwgPSBbIjxEaWFsIGFjdGlvbj1cIiIsICJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaXZyL2lkYyIsICJcIj4rMTgwMTQ3MzU0NTE8L0RpYWw+Il0uam9pbigiIik7CgovKiBFbmQgQ29uZmlndXJhdGlvbgogKi8KCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgCWNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJdmFyIHNjcmlwdCA9IG5ldyBTY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sodHdpbWwpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5zZW5kKG91dHB1dCwgc2NyaXB0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ29ubmVjdCBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ac9fc25e-3ad9-4f80-a796-2d9093795439\",\"name\":\"MFA Status\",\"description\":\"Check if MFA has already been performed for this journey. This allows journeys and inner journeys not to perform MFA multiple times.\",\"script\":\"LyogTUZBIFN0YXR1cwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDaGVjayBpZiBNRkEgaGFzIGFscmVhZHkgYmVlbiBwZXJmb3JtZWQgZm9yIHRoaXMgam91cm5leS4gCiAqIFRoaXMgYWxsb3dzIGpvdXJuZXlzIGFuZCBpbm5lciBqb3VybmV5cyBub3QgdG8gcGVyZm9ybSBNRkEgbXVsdGlwbGUgdGltZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8Kb3V0Y29tZSA9ICJmYWxzZSI7CmlmIChzaGFyZWRTdGF0ZS5nZXQoIm1mYVBlcmZvcm1lZCIpPT0idHJ1ZSIpIHsKICAJb3V0Y29tZSA9ICJ0cnVlIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ec8b314c-8e11-4364-93b9-a3e82d2a074a\",\"name\":\"Display Password\",\"description\":\"Display Password from nodeState\",\"script\":\"LyogRGlzcGxheSBQYXNzd29yZAogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBEaXNwbGF5IFBhc3N3b3JkIGNvbGxlY3RlZCB2aWEgUGxhdGZvcm0gUGFzc3dvcmQgbm9kZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KdmFyIHBhc3N3b3JkID0gInVuYWJsZSB0byByZXRyaWV2ZSEiOwppZiAobm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKSkgewogIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwp9CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBwYXNzd29yZAogICAgICAgICkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"39c08084-1238-43e8-857f-2e11005eac49\",\"name\":\"Alpha OAuth2 Access Token Modification Script\",\"description\":\"Default alpha realm script for OAuth2 Access Token Modification\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTktMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCBsZXRzIHlvdSBtb2RpZnkgaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIGFuIE9BdXRoMiBhY2Nlc3MgdG9rZW4KICogd2l0aCBtZXRob2RzIHByb3ZpZGVkIGJ5IHRoZSBBY2Nlc3NUb2tlbiAoMSkgaW50ZXJmYWNlLgogKiBUaGUgY2hhbmdlcyBtYWRlIHRvIE9BdXRoMiBhY2Nlc3MgdG9rZW5zIHdpbGwgZGlyZWN0bHkgaW1wYWN0IHRoZSBzaXplIG9mIHRoZSBDVFMgdG9rZW5zLAogKiBhbmQsIHNpbWlsYXJseSwgdGhlIHNpemUgb2YgdGhlIEpXVHMgaWYgY2xpZW50LWJhc2VkIE9BdXRoMiB0b2tlbnMgYXJlIHV0aWxpemVkLgogKiBXaGVuIGFkZGluZy91cGRhdGluZyBmaWVsZHMgbWFrZSBzdXJlIHRoYXQgdGhlIHRva2VuIHNpemUgcmVtYWlucyB3aXRoaW4gY2xpZW50L3VzZXItYWdlbnQgbGltaXRzLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogYWNjZXNzVG9rZW4gLSBBY2Nlc3NUb2tlbiAoMSkuCiAqICAgICAgICAgICAgICAgVGhlIGFjY2VzcyB0b2tlbiB0byBiZSB1cGRhdGVkLgogKiAgICAgICAgICAgICAgIE11dGFibGUgb2JqZWN0LCBhbGwgY2hhbmdlcyB0byB0aGUgYWNjZXNzIHRva2VuIHdpbGwgYmUgcmVmbGVjdGVkLgogKiBzY29wZXMgLSBTZXQ8U3RyaW5nPiAoNikuCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICogcmVxdWVzdFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgY29udGFpbnMgYSBtYXAgb2YgcmVxdWVzdCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVcmkgLSBUaGUgcmVxdWVzdCBVUkkuCiAqICAgICAgICAgICAgICAgICAgICAgcmVhbG0gLSBUaGUgcmVhbG0gdGhhdCB0aGUgcmVxdWVzdCByZWxhdGVzIHRvLgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQYXJhbXMgLSBBIG1hcCBvZiB0aGUgcmVxdWVzdCBwYXJhbXMgYW5kL29yIHBvc3RlZCBkYXRhLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFYWNoIHZhbHVlIGlzIGEgbGlzdCBvZiBvbmUgb3IgbW9yZSBwcm9wZXJ0aWVzLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQbGVhc2Ugbm90ZSB0aGF0IHRoZXNlIHNob3VsZCBiZSBoYW5kbGVkIGluIGFjY29yZGFuY2Ugd2l0aCBPV0FTUCBiZXN0IHByYWN0aWNlczoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS92dWxuZXJhYmlsaXRpZXMvVW5zYWZlX3VzZV9vZl9SZWZsZWN0aW9uLgogKiBjbGllbnRQcm9wZXJ0aWVzIC0gVW5tb2RpZmlhYmxlIE1hcCAoNSkuCiAqICAgICAgICAgICAgICAgICAgICBQcmVzZW50IGlmIHRoZSBjbGllbnQgc3BlY2lmaWVkIGluIHRoZSByZXF1ZXN0IHdhcyBpZGVudGlmaWVkLCBjb250YWlucyBhIG1hcCBvZiBjbGllbnQgcHJvcGVydGllczoKICogICAgICAgICAgICAgICAgICAgIGNsaWVudElkIC0gVGhlIGNsaWVudCdzIFVSSSBmb3IgdGhlIHJlcXVlc3QgbG9jYWxlLgogKiAgICAgICAgICAgICAgICAgICAgYWxsb3dlZEdyYW50VHlwZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIGdyYW50IHR5cGVzIChvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLkdyYW50VHlwZSkgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkUmVzcG9uc2VUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgcmVzcG9uc2UgdHlwZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU2NvcGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCBzY29wZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzIC0gQSBtYXAgb2YgdGhlIGN1c3RvbSBwcm9wZXJ0aWVzIG9mIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdHMgb3IgbWFwcyB3aWxsIGJlIGluY2x1ZGVkIGFzIHN1Yi1tYXBzOyBmb3IgZXhhbXBsZToKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21NYXBbS2V5MV09VmFsdWUxIHdpbGwgYmUgcmV0dXJuZWQgYXMgY3VzdG9tTWFwIC0+IEtleTEgLT4gVmFsdWUxLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvIGFkZCBjdXN0b20gcHJvcGVydGllcyB0byBhIGNsaWVudCwgdXBkYXRlIHRoZSBDdXN0b20gUHJvcGVydGllcyBmaWVsZAogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIEFNIENvbnNvbGUgPiBSZWFsbSBOYW1lID4gQXBwbGljYXRpb25zID4gT0F1dGggMi4wID4gQ2xpZW50cyA+IENsaWVudCBJRCA+IEFkdmFuY2VkLgogKiBpZGVudGl0eSAtIEFNSWRlbnRpdHkgKDMpLgogKiAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyLgogKiBzZXNzaW9uIC0gU1NPVG9rZW4gKDQpLgogKiAgICAgICAgICAgUHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QuCiAqIHNjcmlwdE5hbWUgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgc2NyaXB0LgogKiBsb2dnZXIgLSBBbHdheXMgcHJlc2VudCwgdGhlICJPQXV0aDJQcm92aWRlciIgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiAgICAgICAgICBDb3JyZXNwb25kaW5nIGxvZyBmaWxlcyB3aWxsIGJlIHByZWZpeGVkIHdpdGg6IHNjcmlwdHMuT0FVVEgyX0FDQ0VTU19UT0tFTl9NT0RJRklDQVRJT04uCiAqIGh0dHBDbGllbnQgLSBIVFRQIENsaWVudCAoOCkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIEhUVFAgQ2xpZW50IGluc3RhbmNlOgogKiAgICAgICAgICAgICAgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvc2NyaXB0aW5nLWd1aWRlL3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50Lmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtaHR0cC1jbGllbnQuCiAqCiAqIFJldHVybiAtIG5vIHZhbHVlIGlzIGV4cGVjdGVkLCBjaGFuZ2VzIHNoYWxsIGJlIG1hZGUgdG8gdGhlIGFjY2Vzc1Rva2VuIHBhcmFtZXRlciBkaXJlY3RseS4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgQWNjZXNzVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvQWNjZXNzVG9rZW4uaHRtbC4KICogKDMpIEFNSWRlbnRpdHkgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9zdW4vaWRlbnRpdHkvaWRtL0FNSWRlbnRpdHkuaHRtbC4KICogKDQpIFNTT1Rva2VuIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vaXBsYW5ldC9zc28vU1NPVG9rZW4uaHRtbC4KICogKDUpIE1hcCAtIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvSGFzaE1hcC5odG1sLAogKiAgICAgICAgICAgb3IgaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqICg2KSBTZXQgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hTZXQuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKi8KCi8qIEVYQU1QTEUKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QsCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlc3BvbnNlCiAgICApOwoKICAgIC8vIEFsd2F5cyBpbmNsdWRlcyB0aGlzIGZpZWxkIGluIHRoZSB0b2tlbi4KICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkKCdrZXkxJywgJ3ZhbHVlMScpOwoKICAgIC8vIFJlY2VpdmVzIGFuZCBhZGRzIHRvIHRoZSBhY2Nlc3MgdG9rZW4gYWRkaXRpb25hbCB2YWx1ZXMgYnkgcGVyZm9ybWluZyBhIFJFU1QgY2FsbCB0byBhbiBleHRlcm5hbCBzZXJ2aWNlLgogICAgLy8gV0FSTklORzogQmVsb3csIHlvdSB3aWxsIGZpbmQgYSByZWZlcmVuY2UgdG8gYSB0aGlyZC1wYXJ0eSBzaXRlLCB3aGljaCBpcyBwcm92aWRlZCBvbmx5IGFzIGFuIGV4YW1wbGUuCiAgICB2YXIgdXJpID0gJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cyc7CgogICAgdHJ5IHsKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmckphdmEuUmVxdWVzdCgpOwoKICAgICAgICAvLyBZb3UgY2FuIGNoYWluIG1ldGhvZHMgdGhhdCByZXR1cm4gdGhlIHJlcXVlc3Qgb2JqZWN0LgogICAgICAgIHJlcXVlc3Quc2V0VXJpKHVyaSkKICAgICAgICAgICAgLnNldE1ldGhvZCgnUE9TVCcpCiAgICAgICAgICAgIC5zZXRFbnRpdHkoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgdXBkYXRlZEZpZWxkczogewogICAgICAgICAgICAgICAgICAgIGtleTI6ICd2YWx1ZTInLAogICAgICAgICAgICAgICAgICAgIGtleTM6ICd2YWx1ZTMnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgLy8gWW91IGNhbiBjYWxsIGEgbWV0aG9kIHdoZW4gY2hhaW5pbmcgaXMgbm90IHBvc3NpYmxlLgogICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnKTsKCiAgICAgICAgLy8gU2VuZHMgdGhlIHJlcXVlc3QgYW5kIHJlY2VpdmVzIHRoZSByZXNwb25zZS4KICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0T3JUaHJvdygpOwoKICAgICAgICAvLyBDaGVja3MgaWYgdGhlIHJlc3BvbnNlIHN0YXR1cyBpcyBhcyBleHBlY3RlZC4KICAgICAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkgPT09IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5TdGF0dXMuQ1JFQVRFRCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CgogICAgICAgICAgICAvLyBTZXQgbXVsdGlwbGUgdG9rZW4gZmllbGRzIGF0IG9uY2UuCiAgICAgICAgICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkcyhyZXN1bHQudXBkYXRlZEZpZWxkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdVbmFibGUgdG8gb2J0YWluIGFjY2VzcyB0b2tlbiBtb2RpZmljYXRpb25zLiBTdGF0dXM6ICcgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICcuIENvbnRlbnQ6ICcgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5lcnJvcignVGhlIHJlcXVlc3QgcHJvY2Vzc2luZyB3YXMgaW50ZXJydXB0ZWQuICcgKyBlKTsKCiAgICAgICAgLy8gVGhlIGFjY2VzcyB0b2tlbiByZXF1ZXN0IGZhaWxzIHdpdGggdGhlIEhUVFAgNTAwIGVycm9yIGluIHRoaXMgY2FzZS4KICAgICAgICB0aHJvdyAoJ1VuYWJsZSB0byBvYnRhaW4gcmVzcG9uc2UgZnJvbTogJyArIHVyaSk7CiAgICB9CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgaWRlbnRpdHkgYXR0cmlidXRlIHZhbHVlcyB0byB0aGUgYWNjZXNzIHRva2VuLgogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ21haWwnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ21haWwnKSk7CiAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgncGhvbmUnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ3RlbGVwaG9uZU51bWJlcicpLnRvQXJyYXkoKVswXSk7CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgdGhlIHNlc3Npb24gcHJvcGVydHkgdmFsdWVzLgogICAgLy8gTk9URTogc2Vzc2lvbiBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igbm9uLWludGVyYWN0aXZlIGF1dGhvcml6YXRpb24gZ3JhbnRzLgogICAgaWYgKHNlc3Npb24pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgnaXBBZGRyZXNzJywgc2Vzc2lvbi5nZXRQcm9wZXJ0eSgnSG9zdCcpKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignVW5hYmxlIHRvIHJldHJpZXZlIHNlc3Npb24gcHJvcGVydHkgdmFsdWUuICcgKyBlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gUmVtb3ZlcyBhIG5hdGl2ZSBmaWVsZCBmcm9tIHRoZSB0b2tlbiBlbnRyeSwgdGhhdCB3YXMgc2V0IGJ5IEFNLgogICAgLy8gV0FSTklORzogcmVtb3ZpbmcgbmF0aXZlIGZpZWxkcyBmcm9tIHRoZSB0b2tlbiBtYXkgcmVzdWx0IGluIGxvc3Mgb2YgZnVuY3Rpb25hbGl0eS4KICAgIC8vIGFjY2Vzc1Rva2VuLnJlbW92ZVRva2VuTmFtZSgpCgogICAgLy8gTm8gcmV0dXJuIHZhbHVlIGlzIGV4cGVjdGVkLiBMZXQgaXQgYmUgdW5kZWZpbmVkLgp9KCkpOwoqLw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"849ef5f3-7481-4607-a668-f0b5bf47db4c\",\"name\":\"Twilio IVR: Goodbye Message\",\"description\":\"Goodbye Message\",\"script\":\"LyogVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIlRoYW5rIHlvdSBmb3IgY2FsbGluZyBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQuIEdvb2RieWUhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"b3824c66-2dff-4613-9e54-4a7577fdb765\",\"name\":\"TimeStamp_Login\",\"description\":\"Places a timestamp in the frIndexedMultivalued1 attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKCi8vdmFyIHRpbWVzdGFtcHMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoImZySW5kZXhlZE11bHRpdmFsdWVkMSIpOwoKCnZhciBsYXN0TG9naW4gPSBuZXcgRGF0ZSgpOwovKgp2YXIgZGF0ZXRpbWUgPSAiIisgY3VycmVudGRhdGUuZ2V0RGF0ZSgpICsgIi8iCiAgICAgICAgICAgICAgICArIChjdXJyZW50ZGF0ZS5nZXRNb250aCgpKzEpICArICIvIiAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0RnVsbFllYXIoKSArICIgQCAiICAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0SG91cnMoKSArICI6IiAgCiAgICAgICAgICAgICAgICArIGN1cnJlbnRkYXRlLmdldE1pbnV0ZXMoKSArICI6IiAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0U2Vjb25kcygpOwoqLwoKdmFyIG9iamVjdEF0dHJpYnV0ZXMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKCgpzaGFyZWRTdGF0ZS5wdXQoImxhc3QgTG9naW4iLGxhc3RMb2dpbi50b1N0cmluZygpKTsKCgoKCgpvYmplY3RBdHRyaWJ1dGVzLnB1dCgiZnJVbmluZGV4ZWRTdHJpbmcxIixsYXN0TG9naW4udG9TdHJpbmcoKSk7CgoKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIixvYmplY3RBdHRyaWJ1dGVzKTsKCgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"4ee5b182-1b09-45cc-97a9-0e609f0a2915\",\"name\":\"Resend OTP Option\",\"description\":\"Resend OTP Option\",\"script\":\"LyogQ1Jlc2VuZCBPVFAgT3B0aW9uCiAqCiAqIEF1dGhvcjogam9uLmtuaWdodEBmb3JnZXJvY2suY29tLCB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ29sbGVjdCBPVFAgYW5kIHZhbGlkYXRlIHRoZSBjb2xsZWN0ZWQgT1RQLiBBbHNvIG9mZmVyIGEgcmVzZW5kIG9wdGlvbi4KICogUmV0dXJuICJ0cnVlIiBpZiBjb2xsZWN0ZWQgT1RQIGlzIHZhbGlkLCAiZmFsc2UiIGlmIGNvbGxlY3RlZCBPVFAgaXMgaW52YWxpZCwgCiAqIGFuZCByZXNlbmQgaWYgdGhlIHVzZXIgc2VsZWN0ZWQgdGhlIHJlc2VuZCBidXR0b24uCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAtIHJlc2VuZAogKi8KKGZ1bmN0aW9uICgpIHsKICAvLyBob3cgbG9uZyB1bnRpbCB0aGUgInJlc2VuZCIgYnV0dG9uIGJlY29tZXMgZW5hYmxlZC4KICBERUxBWT0yMDsKICAKICAvLyBob3cgbG9uZyAoaW4gc2Vjb25kcykgc2hvdWxkIHRoZSBPVFAgYmUgYWNjZXB0ZWQgYXMgdmFsaWQKICBPVFBfVFRMID0gMzA7CgogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICApCgogIGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdCgpIHsKICAgICAgcmV0dXJuIFN0cmluZygiIFxuXAogICAgICAgICAgdmFyIENPVU5UID0gIiArIERFTEFZICsgIjsgXG5cCiAgICAgICAgICBmdW5jdGlvbiBnbyhvYnMpIHsgXG5cCiAgICAgICAgICAgICAgY29uc3QgcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtdnYtYXM9XCJPbmUgVGltZSBQYXNzY29kZVwiXScpWzBdOyBcblwKICAgICAgICAgICAgICBpZiAocCkgeyBcblwKICAgICAgICAgICAgICAgICAgdmFyIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgXG5cCiAgICAgICAgICAgICAgICAgIGIuaWQgPSAncmVzZW5kQnV0dG9uJzsgXG5cCiAgICAgICAgICAgICAgICAgIGIuY2xhc3NMaXN0LmFkZChcImJ0blwiLCBcIm10LTNcIiwgXCJidG4tc2Vjb25kYXJ5XCIsIFwiYnRuLXNtXCIpOyBcblwKICAgICAgICAgICAgICAgICAgYi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7IHAudmFsdWU9J19fX1JFU0VORF9fXyc7IHAuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpOyB9OyBcblwKICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSAnUmVzZW5kIENvZGUgLi4uICcgKyBDT1VOVCArICdzJzsgXG5cCiAgICAgICAgICAgICAgICAgIGIuZGlzYWJsZWQgPSB0cnVlOyBcblwKICAgICAgICAgICAgICAgICAgcC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShiLCBwLm5leHRTaWJsaW5nKTsgXG5cCiAgICAgICAgICAgICAgICAgIHZhciB0ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7IFxuXAogICAgICAgICAgICAgICAgICAgICAgaWYgKENPVU5UID09IDEpIHsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0KTsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgYi5kaXNhYmxlZCA9IGZhbHNlOyBcblwKICAgICAgICAgICAgICAgICAgICAgICAgICBiLmlubmVySFRNTCA9ICdSZXNlbmQgQ29kZSc7IFxuXAogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgQ09VTlQtLTsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSAnUmVzZW5kIENvZGUgLi4uICcgKyBDT1VOVCArICdzJzsgXG5cCiAgICAgICAgICAgICAgICAgICAgICB9IFxuXAogICAgICAgICAgICAgICAgICB9LCAxMDAwICk7IFxuXAogICAgICAgICAgICAgICAgICBpZiAob2JzKSBvYnMuZGlzY29ubmVjdCgpOyBcblwKICAgICAgICAgICAgICAgICAgcmV0dXJuOyBcblwKICAgICAgICAgICAgICB9IFxuXAogICAgICAgICAgfSBcblwKICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtkYXRhLXZ2LWFzPVwiT25lIFRpbWUgUGFzc2NvZGVcIl0nKVswXSkgZ28oKTsgXG5cCiAgICAgICAgICBlbHNlIHsgXG5cCiAgICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zLCBvYnMpID0+IHsgZ28ob2JzKTsgfSk7IFxuXAogICAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOyBcblwKICAgICAgICAgIH0gXG5cCiAgICAgICIpOwogIH0KCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKGNyZWF0ZVNjcmlwdCgpKSwKICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soIk9uZSBUaW1lIFBhc3Njb2RlIikKICAgICAgKS5idWlsZCgpCiAgfSBlbHNlIHsKICAgICAgdmFyIG90cFRpbWVzdGFtcCA9IE1hdGguZmxvb3IobmV3IGphdmEudXRpbC5EYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCk7CiAgICAgIHZhciBvdHAgPSBjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKTsKICAgICAgaWYgKG90cCA9PT0gIl9fX1JFU0VORF9fXyIpIHsKICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJyZXNlbmQiKS5idWlsZCgpOwogICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHNlbnRPdHAgPSBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpOwogICAgICAgICAgdmFyIHNlbnRPdHBUaW1lc3RhbXAgPSBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZFRpbWVzdGFtcCIpOwogICAgICAgICAgaWYgKHNlbnRPdHAgPT0gb3RwICYmIG90cFRpbWVzdGFtcCAtIE9UUF9UVEwgPj0gc2VudE90cFRpbWVzdGFtcCkgewogICAgICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICAgICAgCSAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJmYWxzZSIpLmJ1aWxkKCk7CiAgICAgICAgICB9CiAgICAgIH0KICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"cdea92a1-d2bf-4364-a525-fde8b7a95792\",\"name\":\"Get Lockout Status\",\"description\":\"null\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKdmFyIGxvY2tvdXREYXRhQXR0ciA9ICJzdW5BTUF1dGhJbnZhbGlkQXR0ZW1wdHNEYXRhIgp2YXIgYWNjb3VudFN0YXR1c0F0dHIgPSAiaW5ldFVzZXJTdGF0dXMiCgp2YXIgbG9ja291dERhdGEgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBsb2Nrb3V0RGF0YUF0dHIpCnZhciBhY2NvdW50U3RhdHVzID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYWNjb3VudFN0YXR1c0F0dHIpCgp0cmFuc2llbnRTdGF0ZS5wdXQoImxvY2tvdXREYXRhIiwgbG9ja291dERhdGEpCnRyYW5zaWVudFN0YXRlLnB1dCgiYWNjb3VudFN0YXR1cyIsIGFjY291bnRTdGF0dXMpCgpsb2dnZXIuZXJyb3IobG9ja291dERhdGEudG9TdHJpbmcoKSk=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"68d5a8e7-fcc9-4215-9e63-a01afe8fa849\",\"name\":\"IDP Lookup\",\"description\":\"Perform IDP lookup based on email domain. Set users' external IDP in shared state or continue to local authentication.\",\"script\":\"LyogSURQIExvb2t1cAogKiAKICogUGVyZm9ybSBJRFAgbG9va3VwIGJhc2VkIG9uIGVtYWlsIGRvbWFpbi4gU2V0IHVzZXJzJyBleHRlcm5hbCBJRFAgaW4gc2hhcmVkIHN0YXRlIG9yIGNvbnRpbnVlIHRvIGxvY2FsIGF1dGhlbnRpY2F0aW9uLgogKiAKICogVGhpcyBzY3JpcHQgcmVxdWlyZXMgcGFyYW1ldHJpemF0aW9uLiBNYWtlIHN1cmUgeW91IGNhcmVmdWxseSByZXZpZXcgdGhlIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVycy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSBvbmUKICogLSBtdWx0aXBsZQogKiAtIG5vbmUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci5tZXNzYWdlKCJJRFAgTG9va3VwOiBzdGFydCIpOwogIAlvdXRjb21lID0gIm5vbmUiOwogIAl2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIik7CiAgCXZhciBkb21haW4gPSB1c2VybmFtZS5zdWJzdHIodXNlcm5hbWUubGFzdEluZGV4T2YoIkAiKSsxKTsKICAJdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwoKICAJLyogQmVnaW4gQ29uZmlndXJhdGlvbiAqLwogIAogICAgLy8gbG9uZy1saXZlZCB0b2tlbgogICAgdmFyIElETV9BUElfVE9LRU4gPSBzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5hZG1pbi50b2tlbiIpOwogIAogICAgLy8gSURNIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSURNX0FQSV9VUkkgPSByZWZlcmVyLm9yaWdpbiArICIvb3BlbmlkbS9tYW5hZ2VkL2FscGhhX29yZ2FuaXphdGlvbj9fcXVlcnlGaWx0ZXI9aWRwRG9tYWlucytjbysnIiArIGRvbWFpbiArICInJl9maWVsZHM9bmFtZSxkZXNjcmlwdGlvbixpZHBOYW1lLGlkcFR5cGUsaWRwRG9tYWlucyxpZHBKb3VybmV5LGlkcFRoZW1lLGlkcFBlcnNpc3Qsc2FtbENvbmZpZyI7CgogIAkvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnR0VUJyk7CiAgICByZXF1ZXN0LnNldFVyaShJRE1fQVBJX1VSSSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiQmVhcmVyICIgKyBJRE1fQVBJX1RPS0VOKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCQogIAl2YXIgcm91dGVkSURQcyA9IHJlc3VsdC5yZXN1bHQubGVuZ3RoID8gcmVzdWx0LnJlc3VsdCA6IFt7fV07CiAgCS8vIHN0cmluZ2lmeSB0aGUgc2FtbENvbmZpZyBwcm9wZXJ0eQogIAlyb3V0ZWRJRFBzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlZElEUCwgaW5kZXgpIHsKICAgICAgCXJvdXRlZElEUHNbaW5kZXhdLnNhbWxDb25maWcgPSBKU09OLnN0cmluZ2lmeShyb3V0ZWRJRFAuc2FtbENvbmZpZyk7CiAgICB9KTsKICAJc2hhcmVkU3RhdGUucHV0KCJyb3V0ZWRJRFBzIiwgcm91dGVkSURQcyk7CglpZiAocmVzdWx0LnJlc3VsdENvdW50ID09PSAxKSB7CiAgICAJbG9nZ2VyLm1lc3NhZ2UoIklEUCBMb29rdXA6IEZvdW5kIGV4YWN0bHkgMSBJRFAiKTsKICAgICAgICBvdXRjb21lID0gIm9uZSI7CiAgICB9CiAgCWVsc2UgaWYgKHJlc3VsdC5yZXN1bHRDb3VudCA+IDEpIHsKICAgIAlsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogRm91bmQge30gSURQcyIsIHJlc3VsdC5yZXN1bHRDb3VudCk7CiAgICAgICAgb3V0Y29tZSA9ICJtdWx0aXBsZSI7CiAgICB9CiAgCWVsc2UgewogICAgCWxvZ2dlci5tZXNzYWdlKCJJRFAgTG9va3VwOiBGb3VuZCBubyBJRFBzIik7CiAgICB9CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogZW5kIFtvdXRjb21lPXt9XSIsIG91dGNvbWUpOwoKICAgIC8qCiAgICAgKiBQYXJzZSBhIFVSTCBpbnRvIGl0cyBjb21wb25lbnRzIGFuZCBtYWtlIHRoZW0gZWFzaWx5IGFjY2Vzc2libGUgYnkgbmFtZQogICAgICoKICAgICAqIFVzZSBpbiBhIFNjcmlwdGUgRGVjaXNpb24gTm9kZSBTY3JpcHQgYXMgZm9sbG93czoKICAgICAqIHZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAgICAqIHZhciBvcmlnaW4gPSByZWZlcmVyLm9yaWdpbjsKICAgICAqIAogICAgICogZS5nLjogaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAgICAgKiB7CiAgICAgKiAgICAgaGFzaDogJyMvJywKICAgICAqICAgICBob3N0OiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBob3N0bmFtZTogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaHJlZjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLycsCiAgICAgKiAgICAgb3JpZ2luOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIHBhdGhuYW1lOiAnL2FtL1hVSS8nLAogICAgICogICAgIHBvcnQ6ICcnLAogICAgICogICAgIHByb3RvY29sOiAnaHR0cHMnLAogICAgICogICAgIHNlYXJjaDogJz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbScsCiAgICAgKiAgICAgdXNlcm5hbWU6ICcnLAogICAgICogICAgIHBhc3N3b3JkOiAnJywKICAgICAqICAgICBzZWFyY2hQYXJhbTogewogICAgICogICAgICAgICByZWFsbTogJy9icmF2bycsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICAgICAqICAgICAgICAgYXV0aEluZGV4VmFsdWU6ICdJbml0aWF0ZU93bmVyQ2xhaW0nCiAgICAgKiAgICAgfQogICAgICogfQogICAgICovCiAgICBmdW5jdGlvbiBwYXJzZVVybChocmVmKSB7CiAgICAgICAgdmFyIG0gPSBocmVmLm1hdGNoKC9eKChbXjpcLz8jXSspOj8oPzpcL1wvKCg/OihbXlwvPyM6XSopOihbXlwvPyM6XSopQCk/KFteXC8/IzpdKikoPzo6KFteXC8/IzpdKikpPykpKT8oW14/I10qKShcP1teI10qKT8oIy4qKT8kLyksCiAgICAgICAgciA9IHsKICAgICAgICAgICAgaGFzaDogbVsxMF0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgIC8vICMvCiAgICAgICAgICAgIGhvc3Q6IG1bM10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaG9zdG5hbWU6IG1bNl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIG9wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBocmVmOiBtWzBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAgICAgICAgICAgIG9yaWdpbjogbVsxXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBwYXRobmFtZTogbVs4XSB8fCAobVsxXSA/ICIvIiA6ICIiKSwgICAgLy8gL2FtL1hVSS8KICAgICAgICAgICAgcG9ydDogbVs3XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwcm90b2NvbDogbVsyXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gaHR0cHMKICAgICAgICAgICAgc2VhcmNoOiBtWzldIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgIC8vID9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbQogICAgICAgICAgICB1c2VybmFtZTogbVs0XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHBhc3N3b3JkOiBtWzVdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgc2VhcmNoUGFyYW06IHt9ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHsgcmVhbG06ICcvYnJhdm8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJyB9CiAgICAgICAgfTsKICAgICAgICBpZiAoci5wcm90b2NvbC5sZW5ndGggPT0gMikgewogICAgICAgICAgICByLnByb3RvY29sID0gImZpbGU6Ly8vIiArIHIucHJvdG9jb2wudG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgci5vcmlnaW4gPSByLnByb3RvY29sICsgIi8vIiArIHIuaG9zdDsKICAgICAgICB9CiAgICAgICAgaWYgKHIuc2VhcmNoLmxlbmd0aCA+IDIpIHsKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gKHIuc2VhcmNoLmluZGV4T2YoJz8nKSA9PT0gMCkgPyByLnNlYXJjaC5zdWJzdHIoMSkgOiByLnNlYXJjaDsKICAgICAgICAgICAgdmFyIHZhcnMgPSBxdWVyeS5zcGxpdCgnJicpOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KCc9Jyk7CiAgICAgICAgICAgIHIuc2VhcmNoUGFyYW1bZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByLmhyZWYgPSByLm9yaWdpbiArIHIucGF0aG5hbWUgKyByLnNlYXJjaCArIHIuaGFzaDsKICAgICAgICByZXR1cm4gcjsKICAgIH07Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"021e434f-89b6-45fb-9d67-5147bc1650c3\",\"name\":\"Show Password Policy\",\"description\":\"null\",\"script\":\"dmFyIG91dHB1dCA9IHRydWU7CnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjx1bD48bGk+TXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZzwvbGk+Ii5jb25jYXQoCiAgICAiPGxpPk11c3QgYmUgbGVzcyB0aGFuIDY0IGNoYXJhY3RlcnMgbG9uZzwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IG5vdCBzaGFyZSBjaGFyYWN0ZXJzIHdpdGggZW1haWwsIHVzZXJuYW1lLCBmaXJzdCBuYW1lLCBsYXN0IG5hbWU8L2xpPiIpLmNvbmNhdCgKICAgICI8bGk+TXVzdCBoYXZlIGF0IGxlYXN0IDEgbG93ZXJjYXNlIGxldHRlcihzKTwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IGhhdmUgYXQgbGVhc3QgMSBjYXBpdGFsIGxldHRlcihzKTwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IGhhdmUgYXQgbGVhc3QgMSBudW1iZXIocyk8L2xpPiIpLmNvbmNhdCgKICAgICI8bGk+TXVzdCBoYXZlIGF0IGxlYXN0IDEgc3ltYm9sKHMpPC9saT48L3VsPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwp9CgogLyoKICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgKiAKICAqIEV4YW1wbGU6CiAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAqLwpmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgfSk7Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"16d15256-9670-482c-b4da-2547591be4c7\",\"name\":\"AT_SetSocialGoogle\",\"description\":\"Set the shared state to select Google as the social provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICogQVRfU2V0U29jaWFsSWRkYXRhd2ViLCBTY3JpcHQgdG8gc2V0IHRoZSBzb2NpYWwgcHJvdmlkZXIgdHlwZSB0byBJRERhdGFXZWIKKi8Kc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJnb29nbGUiKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"f1a2764b-d05a-4480-8f5f-78fda7814227\",\"name\":\"APIProtection: Reset States\",\"description\":\"APIProtection: Reset State\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IFJlc2V0IFN0YXRlczogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqCiAqIE91dGNvbWVzOgogKiAtICJ0cnVlIgogKi8KdmFyIEtFWV9IRUFERVJfTkFNRSA9ICJ4LWFwaS1rZXkiOwp2YXIgU0VDUkVUX0hFQURFUl9OQU1FID0gIngtYXBpLXNlY3JldCI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCm91dGNvbWUgPSAidHJ1ZSI7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpID09IHJlYWRWYWx1ZShLRVlfSEVBREVSX05BTUUpKSB7Cglsb2dnZXIud2FybmluZygiQVBJUHJvdGVjdGlvbjogUmVzZXQgU3RhdGVzOiByZXNldHRpbmcgdXNlcm5hbWUgdG86Ii5jb25jYXQocmVhZFZhbHVlKCJ1c2VybmFtZSIpKSk7CiAgCXNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCByZWFkVmFsdWUoInVzZXJuYW1lIikpOwp9CgppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpID09IHJlYWRUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUpKSB7Cglsb2dnZXIud2FybmluZygiQVBJUHJvdGVjdGlvbjogUmVzZXQgU3RhdGVzOiByZXNldHRpbmcgcGFzc3dvcmQiKTsKICAJdHJhbnNpZW50U3RhdGUucHV0KCJwYXNzd29yZCIsIHJlYWRUcmFuc2llbnRWYWx1ZSgicGFzc3dvcmQiKSk7Cn0KCmxvZ2dlci53YXJuaW5nKCJBUElQcm90ZWN0aW9uOiBSZXNldCBTdGF0ZXM6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgovKgogKiBSZWFkIHZhbHVlIGZyb20gc3RvcmFnZSBmb3IgQVBJUHJvdGVjdGlvbiBzY3JpcHQgdXNlCiAqLwpmdW5jdGlvbiByZWFkVmFsdWUobmFtZSkgewogIAl2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgiQVBJUHJvdGVjdGlvbiIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewoJICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogIAlyZXR1cm4gbnVsbDsKfQoKLyoKICogUmVhZCB0cmFuc2llbnQgdmFsdWUgZnJvbSBzdG9yYWdlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHJlYWRUcmFuc2llbnRWYWx1ZShuYW1lKSB7CiAgCXZhciB0cmFuc2llbnRTdG9yYWdlID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIik7CiAgICBpZiAodHJhbnNpZW50U3RvcmFnZSkgewogICAgICAJaWYgKHRyYW5zaWVudFN0b3JhZ2UuZ2V0KSB7CgkgICAgICAgIHJldHVybiB0cmFuc2llbnRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKS5nZXQobmFtZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJcmV0dXJuIHRyYW5zaWVudFN0b3JhZ2UubmFtZTsKICAgICAgICB9CiAgICB9CiAgCXJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"0ef43500-b374-435e-9411-3d9046013676\",\"name\":\"AT_Optin-New\",\"description\":\"This script puts 'new' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICduZXcnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm5ldyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1a916c19-8d81-47c5-9707-c3d33923304c\",\"name\":\"AT_CopyOTPToObjectAttributes\",\"description\":\"Copy an OTP generated by the \\\"HOTP Generator\\\" node to the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyoKICogQ29weSBhbiBPVFAgZ2VuZXJhdGVkIGJ5IHRoZSAiSE9UUCBHZW5lcmF0b3IiIG5vZGUgdG8gdGhlIElETSBwcm9maWxlIAogKiBzaGFyZWQgc3RhdGUgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICovCgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dCgiZGVzY3JpcHRpb24iLCB0cmFuc2llbnRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKQp9CmVsc2UgewogICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwge2Rlc2NyaXB0aW9uOiB0cmFuc2llbnRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpfSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e0666b8b-f625-4047-89d8-e7e91151027f\",\"name\":\"Twilio Voice OTP Sender\",\"description\":\"Twilio Voice OTP Sender\",\"script\":\"LyogVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXIKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd2lsbCBkZWxpdmVyIHRoZSBPVFAgdmlhIHZvaWNlIHRvIHRoZSBwaG9uZSBudW1iZXIgaW4gdGhlIHVzZXIncyBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBhbmQgSE9UUCBHZW5lcmF0b3Igbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHNlbnQKICogLSBmYWlsZWQKICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogc3RhcnQiKTsKCmlmIChzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpICYmIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CiAgICB2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgogICAgLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqLwogICAgdmFyIFRXSUxJT19BUElfU0lEID0gIkFDNzUwNDE1ZTMxNjNhMmU1N2I3YWVlYTdlZWQ4MmQ5NDQiOwogICAgdmFyIFRXSUxJT19BUElfVE9LRU4gPSAiY2UyODMzNTgwOGUwYmZjZGI2YjliYTkxYzNiOGFmYzMiOwogICAgdmFyIFRXSUxJT19BUElfRlJPTSA9ICIrMTMxNzY0NDMxMDciOwogICAgLyoKICAgICAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogICAgICovCiAgCiAgICAvLyBUd2lsaW8gU01TIE1lc3NhZ2UgQVBJIENvbmZpZ3VyYXRpb24KICAgIHZhciBUV0lMSU9fQVBJX1VSSSA9ICJodHRwczovL2FwaS50d2lsaW8uY29tLzIwMTAtMDQtMDEvQWNjb3VudHMvIi5jb25jYXQoVFdJTElPX0FQSV9TSUQpLmNvbmNhdCgiL0NhbGxzLmpzb24iKTsJCiAgICB2YXIgVFdJTElPX0FQSV9UTyA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkubmV4dCgpOwogIAl2YXIgT1RQID0gc2hhcmVkU3RhdGUuZ2V0KCJvbmVUaW1lUGFzc3dvcmQiKS5zcGxpdCgiIikuam9pbigiOyAiKTsKICAgIHZhciBUV0lMSU9fQVBJX1RXSU1MID0gIjxSZXNwb25zZT48UGF1c2UgbGVuZ3RoPScxJy8+PFNheSB2b2ljZT0nYWxpY2UnPllvdXIgb25lLXRpbWUgcGFzc3dvcmQgaXMgIi5jb25jYXQoT1RQKS5jb25jYXQoIjwvU2F5PjxQYXVzZSBsZW5ndGg9JzEnLz48U2F5PllvdXIgb25lLXRpbWUgcGFzc3dvcmQgaXMgIikuY29uY2F0KE9UUCkuY29uY2F0KCI8L1NheT48UGF1c2UgbGVuZ3RoPScxJy8+PFNheT5Hb29kYnllPC9TYXk+PC9SZXNwb25zZT4iKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBWb2ljZSBPVFAgU2VuZGVyOiBUbzogIi5jb25jYXQoVFdJTElPX0FQSV9UTykpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IFR3aW1sOiAiLmNvbmNhdChUV0lMSU9fQVBJX1RXSU1MKSk7CgogICAgdmFyIEFVVEhaID0gIkJhc2ljICIuY29uY2F0KEJhc2U2NC5lbmNvZGUoVFdJTElPX0FQSV9TSUQuY29uY2F0KCc6JykuY29uY2F0KFRXSUxJT19BUElfVE9LRU4pKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJUd2ltbCIsIFRXSUxJT19BUElfVFdJTUwpOwogICAgcGFyYW1zLmFkZCgiVG8iLCBUV0lMSU9fQVBJX1RPKTsKICAgIHJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKHBhcmFtcy50b1N0cmluZygpKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEpTT04gcmVzdWx0OiAiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogICAgaWYgKHJlc3VsdFsic3RhdHVzIl09PSJxdWV1ZWQiKSB7CiAgICAgICAgb3V0Y29tZSA9IHJlc3VsdFsic3RhdHVzIl07CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogc3RhdHVzID0gIi5jb25jYXQocmVzdWx0WyJzdGF0dXMiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IHN1YnJlc291cmNlX3VyaXMgPSAiLmNvbmNhdChyZXN1bHRbInN1YnJlc291cmNlX3VyaXMiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG91dGNvbWUgPSAiLmNvbmNhdChvdXRjb21lKSk7CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBWb2ljZSBPVFAgU2VuZGVyOiBzdGF0dXMgPSAiLmNvbmNhdChyZXN1bHRbInN0YXR1cyJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogbW9yZV9pbmZvID0gIi5jb25jYXQocmVzdWx0WyJtb3JlX2luZm8iXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG1lc3NhZ2UgPSAiLmNvbmNhdChyZXN1bHRbIm1lc3NhZ2UiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG91dGNvbWUgPSAiLmNvbmNhdChvdXRjb21lKSk7CiAgICB9Cn0gZWxzZSB7CiAgCW91dGNvbWUgPSAiZmFpbGVkIjsKICAJbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogTm8gdXNlciBvciBwaG9uZSBudW1iZXIgZm91bmQhIFVzZSAnSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSB0aGUgdXNlcidzIF9pZCBpbiBzaGFyZWQgc3RhdGUhJyIpOwogICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogb3V0Y29tZSA9ICIuY29uY2F0KG91dGNvbWUpKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e15a13ee-9168-40cf-934f-656a5f568a6a\",\"name\":\"hashdeviceProfile\",\"description\":\"null\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKLy88c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vd3d3Lm15ZXJzZGFpbHkub3JnL2pvc2VwaC9qYXZhc2NyaXB0L21kNS5qcyIgLz4KCmZ1bmN0aW9uIGhhc2hDb2RlKHIpe3ZhciBlLGg9MDtmb3IoZT0wO2U8ci5sZW5ndGg7ZSsrKWg9KGg8PDUpLWgrci5jaGFyQ29kZUF0KGUpLGh8PTA7cmV0dXJuIGg+Pj4wfQoKCnZhciBoYXNoTWUgPSBzaGFyZWRTdGF0ZS5nZXQoImZvcmdlUm9jay5kZXZpY2UucHJvZmlsZSIpOwp2YXIgaGFzaE1lID0gc2hhcmVkU3RhdGUucHV0KCJmb3JnZVJvY2suZGV2aWNlLnByb2ZpbGUiLCJkZWxldGVkIGluIHNjcmlwdCAtIGhhc2hkZXZpY2VQcm9maWxlIik7Ci8vdmFyIGhhc2hNZVN0ciA9IEpTT04uc3RyaW5naWZ5KGhhc2hNZSk7Ci8vbG9nZ2VyLmVycm9yKCJIYXNoTWVTdHI6ICIgKyBoYXNoTWVTdHIpOwoKc2hhcmVkU3RhdGUucHV0KCJkZXZpY2VIYXNoIixoYXNoQ29kZShlc2NhcGUoaGFzaE1lKSkudG9TdHJpbmcoKSk7CnNoYXJlZFN0YXRlLnB1dCgiZnJJbmRleGVkU3RyaW5nMSIsaGFzaENvZGUoZXNjYXBlKGhhc2hNZSkpLnRvU3RyaW5nKCkpOwoKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e49225eb-e7ad-4699-bf2a-d57689f9cd6e\",\"name\":\"Display States - imported (1)\",\"description\":\"Display sharedState and transientState.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICAgICAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICBzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAgICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgICAgICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAgICAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgICAgICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAgICAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2Uuc3R5bGUgPSBcInRleHQtYWxpZ246IGxlZnQ7IGlubGluZS1zaXplOiA0MzBweDsgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDtcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgICAgICIgIH1cbiIpLmNvbmNhdCgKICAgICAgIn0pIikKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIGlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBhbmNob3IKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAgLyoKICAgICAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICAgICAqIAogICAgICAqIEV4YW1wbGU6CiAgICAgICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICAgICAgdmFyIHYgPSByOwogICAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgICAgfSk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"c234ba0b-58a1-4cfd-9567-09edde980745\",\"name\":\"ForgeRock Internal: OAuth2 Access Token Modification Script\",\"description\":\"Internal token modification script\",\"script\":\"Ly8gU2NyaXB0IGlzIGludGVudGlvbmFsbHkgZW1wdHkK\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8bccfdd0-5556-4562-a1ca-6d725a449556\",\"name\":\"display country\",\"description\":\"null\",\"script\":\"dmFyIGZyID0gSmF2YUltcG9ydGVyKAogIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKTsKICAKb3V0Y29tZSA9ICJ0cnVlIjsKCnZhciBjb3VudHJ5ID0gInVua25vd24iOwppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJpcHN0YWNrIikpIHsKCWNvdW50cnkgPSBKU09OLnBhcnNlKHRyYW5zaWVudFN0YXRlLmdldCgiaXBzdGFjayIpKS5jb3VudHJ5X2NvZGU7Cn0KICAKd2l0aCAoZnIpIHsKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgdmFyIGNhbGxiYWNrID0gbmV3IFRleHRPdXRwdXRDYWxsYmFjayhUZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sICJDb3VudHJ5OiAiLmNvbmNhdChjb3VudHJ5KSk7CiAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChjYWxsYmFjaykuYnVpbGQoKTsKICB9IGVsc2UgewogICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d2a41d85-d33a-42d9-a7dd-50dfbc9fa7c0\",\"name\":\"Onfido-CheckApplicant\",\"description\":\"Check Applicant\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tBcHBsaWNhbnQ6IFN0YXJ0Iik7CgovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICoKICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIE9ORklETyBBUEkgVE9LRU4KICovCi8vdmFyIE9ORklET19BUElfVE9LRU4gPSAiYXBpX2xpdmUuU3RVZGZ4ZGlDRmIuWXJ6YmFkeEJfUjItcUc1bEZVYzNsV2c2SkFjM0NucS0iCnZhciBPTkZJRE9fQVBJX1RPS0VOID0gImFwaV9saXZlLkg1eXNSdXNBb21ZLm5iYmtpbW9XYzkxY0RaQVdKWmtKdDBUa3Fkam0xUmpyIjsKLyoKICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwoKdmFyIHJlcXVlc3RCb2R5SnNvbiA9IHsKICAgICJhcHBsaWNhbnRfaWQiOiBTdHJpbmcoc2hhcmVkU3RhdGUuZ2V0KCJvbmZpZG9BcHBsaWNhbnRJRCIpKSwKICAgICJyZXBvcnRfbmFtZXMiOiBbImRvY3VtZW50IiwgImZhY2lhbF9zaW1pbGFyaXR5X3Bob3RvIl0KfQovLyB2YXIgcmVxdWVzdEJvZHlKc29uID0gewovLyAgICAgImFwcGxpY2FudF9pZCI6IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0FwcGxpY2FudElEIikpLAovLyAgICAgInJlcG9ydF9uYW1lcyI6IFsiZG9jdW1lbnQiXQovLyB9Cgp2YXIgZmFpbHVyZSA9IHRydWUKCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0CikKCnZhciByZXF1ZXN0ID0gbmV3IGZyLlJlcXVlc3QoKQpyZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9hcGkub25maWRvLmNvbS92My9jaGVja3MiKQpyZXF1ZXN0LnNldE1ldGhvZCgiUE9TVCIpCnJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgiKQpyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pCnJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5SnNvbikpCgp2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCkKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tBcHBsaWNhbnQ6IEluaXRpYXRlIGNoZWNrcyByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCmlmIChyZXNwb25zZS5nZXRTdGF0dXMoKS5nZXRDb2RlKCkgPT09IDIwMCkgewogICAgdmFyIGlkID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkuaWQKICAgIGZhaWx1cmUgPSAhaWQKICAgIGlmICghZmFpbHVyZSkgc2hhcmVkU3RhdGUucHV0KCJvbmZpZG9BdXRoVG9rZW4iLCBpZCk7Cn0gZWxzZSB7CiAgICBmYWlsdXJlID0gdHJ1ZQp9CgpvdXRjb21lID0gZmFpbHVyZSA/ICJmYWxzZSIgOiAidHJ1ZSI7CmxvZ2dlci5lcnJvcigiT25maWRvLUNoZWNrQXBwbGljYW50OiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"91554b10-79a5-4aa8-aca1-59481a734c19\",\"name\":\"Twilio SMS OTP Sender\",\"description\":\"Twilio SMS OTP Sender\",\"script\":\"LyogVHdpbGlvIFNNUyBPVFAgU2VuZGVyCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFRoaXMgc2NyaXB0IHdpbGwgc2VuZCBhbiBTTVMgY29udGFpbmluZyB0aGUgT1RQIHRvIHRoZSBwaG9uZSBudW1iZXIgaW4gdGhlIHVzZXIncyBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBhbmQgSE9UUCBHZW5lcmF0b3Igbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHNlbnQKICogLSBmYWlsZWQKICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IHN0YXJ0Iik7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSAmJiBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLmhhc05leHQoKSkgewogICAgdmFyIEJhc2U2ND17X2tleVN0cjoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iLGVuY29kZTpmdW5jdGlvbihpbnB1dCl7dmFyIG91dHB1dD0iIjt2YXIgY2hyMSxjaHIyLGNocjMsZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PUJhc2U2NC5fdXRmOF9lbmNvZGUoaW5wdXQpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtjaHIxPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIyPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIzPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtlbmMxPWNocjE+PjI7ZW5jMj0oY2hyMSYzKTw8NHxjaHIyPj40O2VuYzM9KGNocjImMTUpPDwyfGNocjM+PjY7ZW5jND1jaHIzJjYzO2lmKGlzTmFOKGNocjIpKXtlbmMzPWVuYzQ9NjR9ZWxzZSBpZihpc05hTihjaHIzKSl7ZW5jND02NH1vdXRwdXQ9b3V0cHV0K3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMSkrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMyKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzMpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jNCl9cmV0dXJuIG91dHB1dH0sZGVjb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMzt2YXIgZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PWlucHV0LnJlcGxhY2UoL1teQS1aYS16MC05XCtcL1w9XS9nLCIiKTt3aGlsZShpPGlucHV0Lmxlbmd0aCl7ZW5jMT10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMj10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMz10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jND10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7Y2hyMT1lbmMxPDwyfGVuYzI+PjQ7Y2hyMj0oZW5jMiYxNSk8PDR8ZW5jMz4+MjtjaHIzPShlbmMzJjMpPDw2fGVuYzQ7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjEpO2lmKGVuYzMhPTY0KXtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMil9aWYoZW5jNCE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKX19b3V0cHV0PUJhc2U2NC5fdXRmOF9kZWNvZGUob3V0cHV0KTtyZXR1cm4gb3V0cHV0fSxfdXRmOF9lbmNvZGU6ZnVuY3Rpb24oc3RyaW5nKXtzdHJpbmc9c3RyaW5nLnJlcGxhY2UoL1xyXG4vZywiXG4iKTt2YXIgdXRmdGV4dD0iIjtmb3IodmFyIG49MDtuPHN0cmluZy5sZW5ndGg7bisrKXt2YXIgYz1zdHJpbmcuY2hhckNvZGVBdChuKTtpZihjPDEyOCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjKX1lbHNlIGlmKGM+MTI3JiZjPDIwNDgpe3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NnwxOTIpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfWVsc2V7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj4xMnwyMjQpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NiY2M3wxMjgpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfX1yZXR1cm4gdXRmdGV4dH0sX3V0ZjhfZGVjb2RlOmZ1bmN0aW9uKHV0ZnRleHQpe3ZhciBzdHJpbmc9IiI7dmFyIGk9MDt2YXIgYz1jMT1jMj0wO3doaWxlKGk8dXRmdGV4dC5sZW5ndGgpe2M9dXRmdGV4dC5jaGFyQ29kZUF0KGkpO2lmKGM8MTI4KXtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyk7aSsrfWVsc2UgaWYoYz4xOTEmJmM8MjI0KXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMzEpPDw2fGMyJjYzKTtpKz0yfWVsc2V7YzI9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMSk7YzM9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMik7c3RyaW5nKz1TdHJpbmcuZnJvbUNoYXJDb2RlKChjJjE1KTw8MTJ8KGMyJjYzKTw8NnxjMyY2Myk7aSs9M319cmV0dXJuIHN0cmluZ319OwoKICAgCS8qIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAgICAgKgogICAgICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIEFaVVJFIEFEIFNFVFRJTkdTCiAgICAgKi8KICAgIHZhciBUV0lMSU9fQVBJX1NJRCA9ICJBQzc1MDQxNWUzMTYzYTJlNTdiN2FlZWE3ZWVkODJkOTQ0IjsKICAgIHZhciBUV0lMSU9fQVBJX1RPS0VOID0gImNlMjgzMzU4MDhlMGJmY2RiNmI5YmE5MWMzYjhhZmMzIjsKICAgIHZhciBUV0lMSU9fQVBJX0ZST00gPSAiKzEzMTc2NDQzMTA3IjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwogIAogICAgLy8gVHdpbGlvIFNNUyBNZXNzYWdlIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgVFdJTElPX0FQSV9VUkkgPSAiaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyIuY29uY2F0KFRXSUxJT19BUElfU0lEKS5jb25jYXQoIi9NZXNzYWdlcy5qc29uIik7CQogICAgdmFyIFRXSUxJT19BUElfVE8gPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLm5leHQoKTsKICAgIHZhciBUV0lMSU9fQVBJX0JPRFkgPSAiT1RQIGZvciBhY2NvdW50ICIuY29uY2F0KHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSkuY29uY2F0KCI6ICIpLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogVG86ICIuY29uY2F0KFRXSUxJT19BUElfVE8pKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogTWVzc2FnZTogIi5jb25jYXQoVFdJTElPX0FQSV9CT0RZKSk7CgogICAgdmFyIEFVVEhaID0gIkJhc2ljICIuY29uY2F0KEJhc2U2NC5lbmNvZGUoVFdJTElPX0FQSV9TSUQuY29uY2F0KCc6JykuY29uY2F0KFRXSUxJT19BUElfVE9LRU4pKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJCb2R5IiwgVFdJTElPX0FQSV9CT0RZKTsKICAgIHBhcmFtcy5hZGQoIlRvIiwgVFdJTElPX0FQSV9UTyk7CiAgICByZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhwYXJhbXMudG9TdHJpbmcoKSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgIGlmIChyZXN1bHRbImVycm9yX2NvZGUiXSkgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogZXJyb3JfY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiZXJyb3JfY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IGVycm9yX21lc3NhZ2UgPSAiLmNvbmNhdChyZXN1bHRbImVycm9yX21lc3NhZ2UiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBvdXRjb21lID0gZmFpbGVkIik7CiAgICB9IGVsc2UgaWYgKHJlc3VsdFsiY29kZSJdKSB7CiAgICAgICAgb3V0Y29tZSA9ICJmYWlsZWQiOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBjb2RlID0gIi5jb25jYXQocmVzdWx0WyJjb2RlIl0pKTsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogbWVzc2FnZSA9ICIuY29uY2F0KHJlc3VsdFsibWVzc2FnZSJdKSk7CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAic2VudCI7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogb3V0Y29tZSA9IHNlbnQiKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJmYWlsZWQiOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogTm8gdXNlciBvciBwaG9uZSBudW1iZXIgZm91bmQhIFVzZSAnSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSB0aGUgdXNlcidzIF9pZCBpbiBzaGFyZWQgc3RhdGUhJyIpOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogb3V0Y29tZSA9IGZhaWxlZCIpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8e298710-b55e-4085-a464-88a375a4004b\",\"name\":\"Twitter Profile Normalization\",\"description\":\"Normalizes raw profile data from Twitter\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkX3N0ciksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgicGhvdG9VcmwiLCByYXdQcm9maWxlLnByb2ZpbGVfaW1hZ2VfdXJsKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnNjcmVlbl9uYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"aef262d0-7a42-4a34-9826-e7dbc2ea6eb9\",\"name\":\"IDP Router\",\"description\":\"Route users to their organization's IDP of type saml, oidc, local, or custom and apply the organization's theme, if specified\",\"script\":\"LyogSURQIFJvdXRlcgogKiAKICogUm91dGUgdXNlcnMgdG8gdGhlaXIgb3JnYW5pemF0aW9uJ3MgSURQIG9mIHR5cGUgc2FtbCwgb2lkYywgbG9jYWwsIAogKiBvciBjdXN0b20gYW5kIGFwcGx5IHRoZSBvcmdhbml6YXRpb24ncyB0aGVtZSwgaWYgc3BlY2lmaWVkLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSBzYW1sCiAqIC0gb2lkYwogKiAtIGxvY2FsCiAqIC0gY3VzdG9tCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJJRFAgUm91dGVyOiBTdGFydCIpOwogICAgb3V0Y29tZSA9ICJsb2NhbCI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAJdmFyIHJvdXRlZElEUCA9IHNoYXJlZFN0YXRlLmdldCgicm91dGVkSURQcyIpLmdldCgwKTsKICAJaWYgKHJvdXRlZElEUCkgewogICAgICAgIG91dGNvbWUgPSByb3V0ZWRJRFAuZ2V0KCJpZHBUeXBlIik7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSb3V0ZXI6IFJvdXRlZCBJRFA6ICIgKyByb3V0ZWRJRFApOwogICAgICAJc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsIHJvdXRlZElEUC5nZXQoImlkcE5hbWUiKSk7CiAgICAgICAgdmFyIG5vZGVDb25maWcgPSB7fTsKICAgICAgCS8vIGxvYWQgc2FtbENvbmZpZwogICAgICAJaWYgKHJvdXRlZElEUC5nZXQoInNhbWxDb25maWciKSkgewogICAgICAgICAgCW5vZGVDb25maWcgPSBKU09OLnBhcnNlKHJvdXRlZElEUC5nZXQoInNhbWxDb25maWciKSk7CiAgICAgICAgfQogICAgICAJLy8gcm91dGUgdG8gYSBjdXN0b20gam91cm5leQogICAgICAgIGlmIChyb3V0ZWRJRFAuZ2V0KCJpZHBKb3VybmV5IikpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSb3V0ZXI6IFJvdXRlIHRvIGN1c3RvbSBJRFAge30sIGpvdXJuZXk6IHt9Iiwgcm91dGVkSURQLmdldCgiaWRwTmFtZSIpLCByb3V0ZWRJRFAuZ2V0KCJpZHBKb3VybmV5IikpOwogICAgICAgICAgCW5vZGVDb25maWcudHJlZSA9IHJvdXRlZElEUC5nZXQoImlkcEpvdXJuZXkiKTsKICAgICAgICAgIAlvdXRjb21lID0gImN1c3RvbSI7CiAgICAgICAgfQogICAgICAJc2hhcmVkU3RhdGUucHV0KCJub2RlQ29uZmlnIiwgbm9kZUNvbmZpZyk7CiAgICAgIAkvLyBvbmx5IHNlbmQgY2FsbGJhY2sgaWYgdGhlIG9yZy9pZHAgcmVxdWlyZXMgYSBjdXN0b20gdGhlbWUKICAgICAgICBpZiAocm91dGVkSURQLmdldCgiaWRwVGhlbWUiKSAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrcm91dGVkSURQLmdldCgiaWRwVGhlbWUiKTsKICAgICAgICAgICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgICAgICAgICApCiAgICAgICAgICAJYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgIAkJCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIwIiwgIlBsZWFzZSB3YWl0IC4uLiIpCiAgICAJCSkud2l0aFN0YWdlKHN0YWdlKS5idWlsZCgpOwogIAkJfQogICAgfQogIAlsb2dnZXIubWVzc2FnZSgiSURQIFJvdXRlcjogRG9uZSBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"bae1d54a-e97d-4997-aa5d-c027f21af82c\",\"name\":\"Facebook Profile Normalization\",\"description\":\"Normalizes raw profile data from Facebook\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZS5kYXRhLnVybCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"ffd1898e-39a9-4085-a4a0-f69c6ac8b8bd\",\"name\":\"AT_Optin-passwordless\",\"description\":\"This script puts 'passwordless' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdwYXNzd29yZGxlc3MnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbInBhc3N3b3JkbGVzcyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"199405e4-050e-4f2a-87d1-d9125f74a8df\",\"name\":\"Reset Theme\",\"description\":\"Reset theme to what's preserved in shared state variable \\\"theme-id\\\" or to default theme.\",\"script\":\"LyogUmVzZXQgVGhlbWUKICogCiAqIFJlc2V0IHRoZW1lIHRvIHdoYXQncyBwcmVzZXJ2ZWQgaW4gc2hhcmVkIHN0YXRlIHZhcmlhYmxlICJ0aGVtZUlkIiBvciB0byBkZWZhdWx0IHRoZW1lLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkIQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAJLyogQmVnaW4gU2NyaXB0IENvbmZpZ3VyYXRpb24gKi8KICAJdmFyIGRlZmF1bHRUaGVtZSA9ICJFeHBhbnNlIjsKICAJLyogRW5kIFNjcmlwdCBDb25maWd1cmF0aW9uICovCiAgCQogIAlvdXRjb21lID0gInRydWUiOwogIAkKICAJdmFyIHRoZW1lID0gZGVmYXVsdFRoZW1lOwogIAlpZiAoc2hhcmVkU3RhdGUuZ2V0KCJ0aGVtZUlkIikgJiYgIiIrc2hhcmVkU3RhdGUuZ2V0KCJ0aGVtZUlkIikgIT09ICIiKSB7CiAgICAgIAl0aGVtZSA9IHNoYXJlZFN0YXRlLmdldCgidGhlbWVJZCIpOwogICAgfQoKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"616d3541-14d6-4a54-94dd-46a146ef2423\",\"name\":\"Check For Existing Session\",\"description\":\"Check For Existing Session\",\"script\":\"aWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICd1bmRlZmluZWQnKQp7CiAgb3V0Y29tZSA9ICJ0cnVlIjsKfQplbHNlCnsKICBvdXRjb21lID0gImZhbHNlIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"5b553f58-16bd-42b7-a782-4a981a66dbd4\",\"name\":\"Routed IDP Persist Decision\",\"description\":\"Branch based on the IDP setting.\",\"script\":\"LyogUm91dGVkIElEUCBQZXJzaXN0IERlY2lzaW9uCiAqIAogKiBCcmFuY2ggYmFzZWQgb24gdGhlIElEUCBzZXR0aW5nLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIC0gZmFsc2UKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAJbG9nZ2VyLm1lc3NhZ2UoIlJvdXRlZCBJRFAgUGVyc2lzdCBEZWNpc2lvbjogU3RhcnQiKTsKICAJb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCWlmIChyb3V0ZWRJRFApIHsKICAgICAgICBvdXRjb21lID0gIiIuY29uY2F0KHJvdXRlZElEUC5nZXQoImlkcFBlcnNpc3QiKSk7CiAgICB9CiAgCWxvZ2dlci5tZXNzYWdlKCJSb3V0ZWQgSURQIFBlcnNpc3QgRGVjaXNpb246IERvbmUgW291dGNvbWU9e31dIiwgb3V0Y29tZSk7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"c8ed3ae5-b8bc-4773-804b-6d2c61e9c337\",\"name\":\"AT_SecondFactorChoice_KL\",\"description\":\"- This script will read the ForgeRock Identity Cloud attribute AM attribute \\\"fr-attr-str3\\\" to see the user's\\n - MFA Opt-in choice. outcomes will be \\\"always\\\" \\\"Never\\\" \\\"new\\\" \\\"passwordless\\\"\\n - Healthcare demo: frUnindexedString2 = fr-attr-str2 = sms|fido|mail|push MFA type\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCB3aWxsIHJlYWQgdGhlIEZvcmdlUm9jayBJZGVudGl0eSBDbG91ZCBhdHRyaWJ1dGUgImZyVW5pbmRleGVkU3RyaW5nMyIgdG8gc2VlIHRoZSB1c2VyJ3MKICAtIE1GQSBPcHQtaW4gY2hvaWNlLiBvdXRjb21lcyB3aWxsIGJlICJhbHdheXMiICJOZXZlciIgIm5ldyIgInBhc3N3b3JkbGVzcyIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCgpsb2dnZXIuZXJyb3IoJ0FUX1NlY29uZEZhY3RvckNob2ljZSBzY3JpcHQ6IFNUQVJUJykKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IHRoaXM6ICIgKyBPYmplY3Qua2V5cyh0aGlzKSkKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSkKCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IHVzZXJuYW1lOiAiICsgdXNlcm5hbWUpCmxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlOiBNRkFDaG9pY2U6ICIgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKQoKb3V0Y29tZT0ibmEiCgovLyBFeGFtcGxlIGZvciB1c2VyLjAKdmFyIHZhbHVlID0gJ25ldmVyJwppZiAodXNlcm5hbWUgPT0gJ2QzMGY0MzM2LTAxYmUtNGUzZi04YjQ3LWUwNzhmNGIzNGZjYScpIHsKICBpZFJlcG9zaXRvcnkuc2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUsIFt2YWx1ZV0pCiAgCiAgbG9nZ2VyLmVycm9yKCdOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSkKfQogIAppZiAoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS50b0FycmF5KCkubGVuZ3RoKSB7CgogIGxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlICBpZGVudGl0eSBhdHRyaWJ1dGU6ICIgKyBhdHRyaWJ1dGUgKyAiIGlzIHByZXNlbnQiICkKICAKICB2YXIgY2hvaWNlID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS5pdGVyYXRvcigpLm5leHQoKQogIAogIGxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlICBpZGVudGl0eSBhdHRyaWJ1dGU6IGNob2ljZSBpczogIiArIGNob2ljZSApCgogIGlmKGNob2ljZSA9PSAiYWx3YXlzIil7CiAgICBvdXRjb21lID0gImFsd2F5cyIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gIm5ldmVyIikgewogICAgb3V0Y29tZSA9ICJuZXZlciIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gIm5ldyIpIHsKICAgIG91dGNvbWUgPSAibmV3IgoKICB9IGVsc2UgaWYgKGNob2ljZSA9PSAicGFzc3dvcmRsZXNzIil7CiAgICBvdXRjb21lID0gInBhc3N3b3JkbGVzcyIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gInNraXAiKSB7CiAgICBvdXRjb21lID0gInNraXAiCgogIH0gCgp9IGVsc2UgewogIG91dGNvbWUgPSAiZW1wdHkiCiAgbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2UgIG91dGNvbWUgaXMgbmV2ZXIgYmVjYXVzZSBhdHRyaWJ1dGUgZW1wdHkgIikKICAKfQoKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IG91dGNvbWU6ICIgKyBvdXRjb21lKQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"12bdbce4-268b-4b95-bfdf-640de9bddead\",\"name\":\"Record Changes And Preserve Old Email\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJSZWNvcmQgQ2hhbmdlcyBBbmQgUHJlc2VydmUgT2xkIEVtYWlsOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwppZiAoZ2V0UHJvZmlsZUF0dHJpYnV0ZSgiZ2l2ZW5OYW1lIikgIT0gZ2V0T2JqZWN0QXR0cmlidXRlKCJnaXZlbk5hbWUiKSkgewogIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgib2xkX2dpdmVuTmFtZSIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoImdpdmVuTmFtZSIpKTsKfQppZiAoZ2V0UHJvZmlsZUF0dHJpYnV0ZSgic24iKSAhPSBnZXRPYmplY3RBdHRyaWJ1dGUoInNuIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm9sZF9zbiIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoInNuIikpOwp9CmlmIChnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikgIT0gZ2V0T2JqZWN0QXR0cmlidXRlKCJtYWlsIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImZyVW5pbmRleGVkU3RyaW5nNSIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoIm1haWwiKSk7Cn0KaWYgKGdldFByb2ZpbGVBdHRyaWJ1dGUoInRlbGVwaG9uZU51bWJlciIpICE9IGdldE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm9sZF90ZWxlcGhvbmVOdW1iZXIiLCBnZXRQcm9maWxlQXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKSk7Cn0KbG9nZ2VyLmVycm9yKCJSZWNvcmQgQ2hhbmdlcyBBbmQgUHJlc2VydmUgT2xkIEVtYWlsOiBlbmQiKTsKCi8qCiAqIEdldCBwcm9maWxlIGF0dHJpYnV0ZQogKi8KZnVuY3Rpb24gZ2V0UHJvZmlsZUF0dHJpYnV0ZShuYW1lKSB7CiAgICByZXR1cm4gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCBuYW1lKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp9CgovKgogKiBHZXQgb2JqZWN0QXR0cmlidXRlIHZhbHVlCiAqLwpmdW5jdGlvbiBnZXRPYmplY3RBdHRyaWJ1dGUobmFtZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpICYmIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKSkgewogICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQobmFtZSkudG9TdHJpbmcoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9CgovKgogKiBQcm9wZXJseSBzZXQgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQobmFtZSwgdmFsdWUpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjoiK3ZhbHVlKyJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"030af5e5-ac77-4176-bafe-f4558f94818e\",\"name\":\"Twilio IVR: Choose Security PIN\",\"description\":\"Choose a 4-digit security PIN\",\"script\":\"LyogVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiUGxlYXNlIGNob29zZSB5b3VyIDQtZGlnaXQgc2VjdXJpdHkgUElOLiI7CgovKiBFbmQgQ29uZmlndXJhdGlvbgogKi8KCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0SW5wdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBpbnB1dCA9IG5ldyBUZXh0SW5wdXRDYWxsYmFjayhwcm9tcHQpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5zZW5kKGlucHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKICAgICAgCXZhciBhbnN3ZXIgPSBuZXcgU3RyaW5nKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VGV4dCgpKS5yZXBsYWNlKC9bXjAtOV0vZywgIiIpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBDaG9vc2UgU2VjdXJpdHkgUElOOiBjYWxsYmFja3MgcmVjZWl2ZWQiKTsKICAgIAlpZiAoYW5zd2VyLmxlbmd0aCA9PSA0KSB7CiAgICAgICAgICAJc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZEludGVnZXI1IiwgYW5zd2VyKTsKICAgICAgICAgIAlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTjogc2hhcmVkU3RhdGU6ICIuY29uY2F0KHNoYXJlZFN0YXRlKSk7CiAgICAgIAkJb3V0Y29tZSA9ICJ0cnVlIjsKICAgIAl9CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IENob29zZSBTZWN1cml0eSBQSU46IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCBuZXcgamF2YS5sYW5nLkludGVnZXIodmFsdWUpKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gbmV3IGphdmEubGFuZy5JbnRlZ2VyKHZhbHVlKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e155e57f-3c0c-46de-900d-36ea5a60e18d\",\"name\":\"AT_CheckOrgMembership\",\"description\":\"Scfript to find Org Membership\",\"script\":\"bG9nZ2VyLmVycm9yKCdBVF9DaGVja09yZ01lbWJlcnNoaXAgc2NyaXB0OiBTVEFSVCcpOwpsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcDogdGhpczogIiArIE9iamVjdC5rZXlzKHRoaXMpKTsKbG9nZ2VyLmVycm9yKCJBVF9DaGVja09yZ01lbWJlcnNoaXA6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSk7CgoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKTsKdmFyIGF0dHJpYnV0ZSA9ICJkZXNjcmlwdGlvbiI7CnZhciBhdHRyVmFsdWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpOwoKbG9nZ2VyLmVycm9yKCJBVF9DaGVja09yZ01lbWJlcnNoaXA6IHVzZXJuYW1lOiAiICsgdXNlcm5hbWUpOwpsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcDogRW50aXR5IFR5cGUgaXM6ICIgKyBhdHRyVmFsdWUpOwoKb3V0Y29tZSA9ICJlbXB0eSIKICAKaWYgKGF0dHJWYWx1ZSkgewogIGxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwICBpZGVudGl0eSBhdHRyaWJ1dGU6ICIgKyBhdHRyaWJ1dGUgKyAiIGlzIHByZXNlbnQiICk7ICAKICB2YXIgY2hvaWNlID0gYXR0clZhbHVlLml0ZXJhdG9yKCkubmV4dCgpOyAKICBsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcCAgaWRlbnRpdHkgYXR0cmlidXRlOiBjaG9pY2UgaXM6ICIgKyBjaG9pY2UgKTsKCiAgaWYoY2hvaWNlID09ICJzdHVkZW50Iil7CiAgICBvdXRjb21lID0gInN0dWRlbnQiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJlbXBsb3llZSIpIHsKICAgIG91dGNvbWUgPSAiZW1wbG95ZWUiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjdXN0b21lciIpIHsKICAgIG91dGNvbWUgPSAiY3VzdG9tZXIiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJwYXJ0bmVyIil7CiAgICBvdXRjb21lID0gInBhcnRuZXIiOwogIH0gZWxzZSB7CiAgb3V0Y29tZSA9ICJlbXB0eSI7CiAgfQp9IGVsc2UgewogIG91dGNvbWUgPSAiZW1wdHkiOwogIGxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwICBvdXRjb21lIGlzIG5ldmVyIGJlY2F1c2UgYXR0cmlidXRlIGVtcHR5ICIpOyAgCn0KCmxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwOiBvdXRjb21lOiAiICsgb3V0Y29tZSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"71b3c70b-920c-464b-a918-4c86eaaddccd\",\"name\":\"Dropdown\",\"description\":\"Render a dropdown\",\"script\":\"LyogRHJvcGRvd24KICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmVuZGVyIGEgZHJvcGRvd24gc2VsZWN0b3IKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICBvdXRjb21lID0gInRydWUiOwogIHZhciBjaG9pY2VzID0gWyIgIiwgIlJlZCBwaWxsIiwgIkJsdWUgcGlsbCIsICJTdGVhayIsICJSYWJiaXQgaG9sZSJdOwogIAogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5DaG9pY2VDYWxsYmFjawogICkKCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKFsKICAgICAgbmV3IGZyLkNob2ljZUNhbGxiYWNrKCJNYWtlIHlvdXIgY2hvaWNlIiwgY2hvaWNlcywgMCwgZmFsc2UpCiAgICBdKS5idWlsZCgpOwogIH0gZWxzZSB7CiAgICB2YXIgY2hvaWNlID0gcGFyc2VJbnQoY2FsbGJhY2tzLmdldCgwKS5nZXRTZWxlY3RlZEluZGV4ZXMoKVswXSk7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCJjaG9pY2UiLCBjaG9pY2VzW2Nob2ljZV0pOwogICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"98a87024-3d07-4c75-b1ea-43ff905e9def\",\"name\":\"ResetOTPProfileAttribute\",\"description\":\"Reset the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyogUmVzZXRPVFBQcm9maWxlQXR0cmlidXRlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJlc2V0IHRoZSBJRE0gcHJvZmlsZSBzaGFyZWQgc3RhdGUgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CglzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoImRlc2NyaXB0aW9uIiwgIiIpCn0KZWxzZSB7CglzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCB7ZGVzY3JpcHRpb246ICIifSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7e3d7067-d50f-4674-8c76-a3e13a810c33\",\"name\":\"Scripted Module - Server Side\",\"description\":\"Default global script for server side Scripted Authentication Module\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTUtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgp2YXIgU1RBUlRfVElNRSA9IDk7ICAvLyA5YW0KdmFyIEVORF9USU1FICAgPSAxNzsgLy8gNXBtCnZhciBsb25naXR1ZGUsIGxhdGl0dWRlOwp2YXIgbG9jYWxUaW1lOwoKbG9nZ2VyLm1lc3NhZ2UoIlN0YXJ0aW5nIHNjcmlwdGVkIGF1dGhlbnRpY2F0aW9uIik7CmxvZ2dlci5tZXNzYWdlKCJVc2VyOiAiICsgdXNlcm5hbWUpOwoKdmFyIHVzZXJQb3N0YWxBZGRyZXNzID0gZ2V0VXNlclBvc3RhbEFkZHJlc3MoKTsKbG9nZ2VyLm1lc3NhZ2UoIlVzZXIgYWRkcmVzczogIiArIHVzZXJQb3N0YWxBZGRyZXNzKTsKCmdldExvbmdpdHVkZUxhdGl0dWRlRnJvbVVzZXJQb3N0YWxBZGRyZXNzKCk7CmdldExvY2FsVGltZSgpOwoKbG9nZ2VyLm1lc3NhZ2UoIkN1cnJlbnQgdGltZSBhdCB0aGUgdXNlcnMgbG9jYXRpb246ICIgKyBsb2NhbFRpbWUuZ2V0SG91cnMoKSk7CmlmIChsb2NhbFRpbWUuZ2V0SG91cnMoKSA8IFNUQVJUX1RJTUUgfHwgbG9jYWxUaW1lLmdldEhvdXJzKCkgPiBFTkRfVElNRSkgewogICAgbG9nZ2VyLmVycm9yKCJMb2dpbiBmb3JiaWRkZW4gb3V0c2lkZSB3b3JrIGhvdXJzISIpOwogICAgYXV0aFN0YXRlID0gRkFJTEVEOwp9IGVsc2UgewogICAgbG9nZ2VyLm1lc3NhZ2UoIkF1dGhlbnRpY2F0aW9uIGFsbG93ZWQhIik7CiAgICBhdXRoU3RhdGUgPSBTVUNDRVNTOwp9CgpmdW5jdGlvbiBnZXRMb25naXR1ZGVMYXRpdHVkZUZyb21Vc2VyUG9zdGFsQWRkcmVzcygpIHsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRVcmkoImh0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9hZGRyZXNzPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXNlclBvc3RhbEFkZHJlc3MpKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwogIAkvL3RoZSBhYm92ZSBVUkkgaGFzIHRvIGJlIGV4dGVuZGVkIHdpdGggYW4gQVBJX0tFWSBpZiB1c2VkIGluIGEgZnJlcXVlbnQgbWFubmVyCiAgCS8vc2VlIGRvY3VtZW50YXRpb246IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL21hcHMvZG9jdW1lbnRhdGlvbi9nZW9jb2RpbmcvaW50cm8KCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICBsb2dSZXNwb25zZShyZXNwb25zZSk7CgogICAgdmFyIGdlb2NvZGUgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIHZhciBpOwogICAgZm9yIChpID0gMDsgaSA8IGdlb2NvZGUucmVzdWx0cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciByZXN1bHQgPSBnZW9jb2RlLnJlc3VsdHNbaV07CiAgICAgICAgbGF0aXR1ZGUgPSByZXN1bHQuZ2VvbWV0cnkubG9jYXRpb24ubGF0OwogICAgICAgIGxvbmdpdHVkZSA9IHJlc3VsdC5nZW9tZXRyeS5sb2NhdGlvbi5sbmc7CiAgICAgIAogICAJICAgIGxvZ2dlci5tZXNzYWdlKCJsYXRpdHVkZToiICsgbGF0aXR1ZGUgKyAiIGxvbmdpdHVkZToiICsgbG9uZ2l0dWRlKTsKICAgIH0KfQoKZnVuY3Rpb24gZ2V0TG9jYWxUaW1lKCkgewoKICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDA7CiAgICB2YXIgbG9jYXRpb24gPSAibG9jYXRpb249IiArIGxhdGl0dWRlICsgIiwiICsgbG9uZ2l0dWRlOwogICAgdmFyIHRpbWVzdGFtcCA9ICJ0aW1lc3RhbXA9IiArIG5vdzsKICAJICAKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3RpbWV6b25lL2pzb24/IiArIGxvY2F0aW9uICsgIiYiICsgdGltZXN0YW1wKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwogIAkvL3RoZSBhYm92ZSBVUkkgaGFzIHRvIGJlIGV4dGVuZGVkIHdpdGggYW4gQVBJX0tFWSBpZiB1c2VkIGluIGEgZnJlcXVlbnQgbWFubmVyCiAgCS8vc2VlIGRvY3VtZW50YXRpb246IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL21hcHMvZG9jdW1lbnRhdGlvbi90aW1lem9uZS9pbnRybwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgdGltZXpvbmUgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIHZhciBsb2NhbFRpbWVzdGFtcCA9IHBhcnNlSW50KG5vdykgKyBwYXJzZUludCh0aW1lem9uZS5kc3RPZmZzZXQpICsgcGFyc2VJbnQodGltZXpvbmUucmF3T2Zmc2V0KTsKICAgIGxvY2FsVGltZSA9IG5ldyBEYXRlKGxvY2FsVGltZXN0YW1wKjEwMDApOwp9CgpmdW5jdGlvbiBnZXRVc2VyUG9zdGFsQWRkcmVzcygpIHsKICAgIHZhciB1c2VyQWRkcmVzc1NldCA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJwb3N0YWxBZGRyZXNzIik7CiAgICBpZiAodXNlckFkZHJlc3NTZXQgPT0gbnVsbCB8fCB1c2VyQWRkcmVzc1NldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gYWRkcmVzcyBzcGVjaWZpZWQgZm9yIHVzZXI6ICIgKyB1c2VybmFtZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHVzZXJBZGRyZXNzU2V0Lml0ZXJhdG9yKCkubmV4dCgpCn0KCmZ1bmN0aW9uIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiVXNlciBSRVNUIENhbGwuIFN0YXR1czogIiArIHJlc3BvbnNlLmdldFN0YXR1cygpICsgIiwgQm9keTogIiArIHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKfQ==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_SERVER_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"9399ac8b-3a6e-423b-95a2-6e0fd07262b1\",\"name\":\"APIProtection: Get Key And Secret\",\"description\":\"APIProtection: Get Key And Secret\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IEdldCBLZXkgQW5kIFNlY3JldDogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgS0VZX0hFQURFUl9OQU1FID0gIngtYXBpLWtleSI7CnZhciBTRUNSRVRfSEVBREVSX05BTUUgPSAieC1hcGktc2VjcmV0IjsKdmFyIFVTRVJOQU1FX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLVVzZXJuYW1lIjsKdmFyIFBBU1NXT1JEX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLVBhc3N3b3JkIjsKLyoKICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwoKb3V0Y29tZSA9ICJmYWxzZSI7Cgp2YXIga2V5ID0gZ2V0SGVhZGVyKEtFWV9IRUFERVJfTkFNRSkgfHwgcmVhZFZhbHVlKEtFWV9IRUFERVJfTkFNRSkgfHwgbnVsbDsKdmFyIHNlY3JldCA9IGdldEhlYWRlcihTRUNSRVRfSEVBREVSX05BTUUpIHx8IHJlYWRUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUpIHx8IG51bGw7Cgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIikgfHwgbnVsbDsKdmFyIHBhc3N3b3JkID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpIHx8IG51bGw7CgppZiAoa2V5ICYmIHNlY3JldCkgewoJbG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IEdldCBLZXkgQW5kIFNlY3JldDoga2V5PSIuY29uY2F0KGtleSkpOwogIAogIAlzdG9yZVZhbHVlKEtFWV9IRUFERVJfTkFNRSwga2V5KTsKICAJc3RvcmVWYWx1ZSgidXNlcm5hbWUiLCB1c2VybmFtZSk7CiAgCXNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBrZXkpOwogIAkKICAJc3RvcmVUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUsIHNlY3JldCk7CiAgCXN0b3JlVHJhbnNpZW50VmFsdWUoInBhc3N3b3JkIiwgcGFzc3dvcmQpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoInBhc3N3b3JkIiwgc2VjcmV0KTsKICAKICAgIG91dGNvbWUgPSAidHJ1ZSI7Cn0KCmxvZ2dlci53YXJuaW5nKCJBUElQcm90ZWN0aW9uOiBHZXQgS2V5IEFuZCBTZWNyZXQ6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgovKgogKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgcmVxdWVzdGVkIGhlYWRlcgogKi8KZnVuY3Rpb24gZ2V0SGVhZGVyKGhlYWRlck5hbWUpIHsKICAJaWYgKHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKSAmJiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApKSB7CiAgICAJcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkudG9TdHJpbmcoKTsKICAgIH0KICAJcmV0dXJuIG51bGw7Cn0KCi8qCiAqIFN0b3JlIHZhbHVlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHN0b3JlVmFsdWUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgiQVBJUHJvdGVjdGlvbiIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0KCi8qCiAqIFJlYWQgdmFsdWUgZnJvbSBzdG9yYWdlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHJlYWRWYWx1ZShuYW1lKSB7CiAgCXZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIik7CiAgICBpZiAoc3RvcmFnZSkgewogICAgICAJaWYgKHN0b3JhZ2UuZ2V0KSB7CgkgICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKS5nZXQobmFtZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJcmV0dXJuIHN0b3JhZ2UubmFtZTsKICAgICAgICB9CiAgICB9CiAgCXJldHVybiBudWxsOwp9CgovKgogKiBTdG9yZSB0cmFuc2llbnQgdmFsdWUgZm9yIEFQSVByb3RlY3Rpb24gc2NyaXB0IHVzZQogKi8KZnVuY3Rpb24gc3RvcmVUcmFuc2llbnRWYWx1ZShuYW1lLCB2YWx1ZSkgewogICAgdmFyIHRyYW5zaWVudFN0b3JhZ2UgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKTsKICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAodHJhbnNpZW50U3RvcmFnZS5wdXQpIHsKCSAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXRyYW5zaWVudFN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHRyYW5zaWVudFN0YXRlLnB1dCgiQVBJUHJvdGVjdGlvbiIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0KCi8qCiAqIFJlYWQgdHJhbnNpZW50IHZhbHVlIGZyb20gc3RvcmFnZSBmb3IgQVBJUHJvdGVjdGlvbiBzY3JpcHQgdXNlCiAqLwpmdW5jdGlvbiByZWFkVHJhbnNpZW50VmFsdWUobmFtZSkgewogIAl2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgiQVBJUHJvdGVjdGlvbiIpOwogICAgaWYgKHRyYW5zaWVudFN0b3JhZ2UpIHsKICAgICAgCWlmICh0cmFuc2llbnRTdG9yYWdlLmdldCkgewoJICAgICAgICByZXR1cm4gdHJhbnNpZW50U3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiB0cmFuc2llbnRTdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogIAlyZXR1cm4gbnVsbDsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7f1c30ec-ea27-4bb1-bd0b-be5792c9a1a6\",\"name\":\"Twilio IVR: Unknown Caller Message\",\"description\":\"Unknown caller message\",\"script\":\"LyogVHdpbGlvIElWUjogVW52ZXJpZmllZCBDYWxsZXIgTWVzc2FnZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogCiAqIERlcGVuZGluZyBvbiB0aGUgYW1vdW50IG9mIGRhdGEgY29sbGVjdGVkIHRocm91Z2ggY2FsbGJhY2tzIGFuZCBob3cgbWFueSBvZiB0aGUgY2FsbFBhcmFtcwogKiB5b3UgYWN0aXZhdGUgYmVsb3csIHlvdSB3aWxsIG5lZWQgdG8gY2hhbmdlIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiBmcm9tIEpXVCB0byBDVFMgb3IKICogTWVtb3J5LgogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9ICJJIHNlZSB3ZSBkb24ndCBoYXZlIGEgcHJvZmlsZSBhc3NvY2lhdGVkIHdpdGggeW91ciBwaG9uZSBudW1iZXIhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKICAgIAlhY3Rpb24gPSBBY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogIAl9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"87497360-d89c-412a-a99e-c8a9bec465cc\",\"name\":\"ipstack\",\"description\":\"null\",\"script\":\"bG9nZ2VyLndhcm5pbmcoImlwc3RhY2s6IHN0YXJ0Iik7CgpvdXRjb21lID0gInVua25vd24iOwoKdmFyIGlwID0gZ2V0Q2xpZW50SVBBZGRyZXNzKCk7CmxvZ2dlci53YXJuaW5nKCJpcHN0YWNrOiBpcD0iLmNvbmNhdChpcCkpOwoKaWYgKGlwKSB7CgogIAkvLyBpcHN0YWNrIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSVBTVEFDS19BQ0NFU1NfS0VZID0gImVmYzJmOGQ5Nzk2YjlmZWZmNWYwMzM1OWQ2ZmJjY2M5IjsKICAgIHZhciBJUFNUQUNLX0FQSV9VUkkgPSAiaHR0cDovL2FwaS5pcHN0YWNrLmNvbS8iLmNvbmNhdChpcCkuY29uY2F0KCI/YWNjZXNzX2tleT0iKS5jb25jYXQoSVBTVEFDS19BQ0NFU1NfS0VZKTsJCgogICAgdmFyIHJlcXVlc3QgPSBuZXcgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QoKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgIHJlcXVlc3Quc2V0VXJpKElQU1RBQ0tfQVBJX1VSSSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgbG9nZ2VyLndhcm5pbmcoImlwc3RhY2s6IEpTT04gcmVzdWx0OiAiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogIAkvKgogICAgewogICAgICAgICJpcCI6ICI5OS43Mi4yOC4xODIiLAogICAgICAgICJ0eXBlIjogImlwdjQiLAogICAgICAgICJjb250aW5lbnRfY29kZSI6ICJOQSIsCiAgICAgICAgImNvbnRpbmVudF9uYW1lIjogIk5vcnRoIEFtZXJpY2EiLAogICAgICAgICJjb3VudHJ5X2NvZGUiOiAiVVMiLAogICAgICAgICJjb3VudHJ5X25hbWUiOiAiVW5pdGVkIFN0YXRlcyIsCiAgICAgICAgInJlZ2lvbl9jb2RlIjogIlRYIiwKICAgICAgICAicmVnaW9uX25hbWUiOiAiVGV4YXMiLAogICAgICAgICJjaXR5IjogIkdlb3JnZXRvd24iLAogICAgICAgICJ6aXAiOiAiNzg2MjYiLAogICAgICAgICJsYXRpdHVkZSI6IDMwLjU5MjUwMDY4NjY0NTUwOCwKICAgICAgICAibG9uZ2l0dWRlIjogLTk3LjY2NzEwNjYyODQxNzk3LAogICAgICAgICJsb2NhdGlvbiI6IHsKICAgICAgICAgICAgImdlb25hbWVfaWQiOiA0NjkzMzQyLAogICAgICAgICAgICAiY2FwaXRhbCI6ICJXYXNoaW5ndG9uIEQuQy4iLAogICAgICAgICAgICAibGFuZ3VhZ2VzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJjb2RlIjogImVuIiwKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJFbmdsaXNoIiwKICAgICAgICAgICAgICAgICAgICAibmF0aXZlIjogIkVuZ2xpc2giCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJjb3VudHJ5X2ZsYWciOiAiaHR0cDovL2Fzc2V0cy5pcHN0YWNrLmNvbS9mbGFncy91cy5zdmciLAogICAgICAgICAgICAiY291bnRyeV9mbGFnX2Vtb2ppIjogIvCfh7rwn4e4IiwKICAgICAgICAgICAgImNvdW50cnlfZmxhZ19lbW9qaV91bmljb2RlIjogIlUrMUYxRkEgVSsxRjFGOCIsCiAgICAgICAgICAgICJjYWxsaW5nX2NvZGUiOiAiMSIsCiAgICAgICAgICAgICJpc19ldSI6IGZhbHNlCiAgICAgICAgfQogICAgfQoJKi8KICAKICAJLy8gcHJlc2VydmUgcmVzdWx0IGluIHRyYW5zaWVudCBzdGF0ZQogIAl0cmFuc2llbnRTdGF0ZS5wdXQoImlwc3RhY2siLCBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCiAgICBzd2l0Y2gocmVzdWx0LmNvdW50cnlfY29kZSkgewogICAgICBjYXNlICJDQSI6CiAgICAgICAgb3V0Y29tZSA9IHJlc3VsdC5jb3VudHJ5X2NvZGU7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlVLIjoKICAgICAgICBvdXRjb21lID0gcmVzdWx0LmNvdW50cnlfY29kZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiVVMiOgogICAgICAgIG91dGNvbWUgPSByZXN1bHQuY291bnRyeV9jb2RlOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIG91dGNvbWUgPSAib3RoZXIiOwogICAgfQoKfSBlbHNlIHsKICAJbG9nZ2VyLmVycm9yKCJpcHN0YWNrOiBubyBjbGllbnQgaXAhIik7Cn0KCmxvZ2dlci53YXJuaW5nKCJpcHN0YWNrOiBmaW5pc2giKTsKCiAvKgogICogISEhIEFTU1VNRVMgSUQgQ0xPVUQgISEhCiAgKgogICogUmV0dXJucyB0aGUgY2xpZW50J3MgSVAgYWRkcmVzcwogICovCiBmdW5jdGlvbiBnZXRDbGllbnRJUEFkZHJlc3MoKSB7CiAgICByZXR1cm4gcmVxdWVzdEhlYWRlcnMuZ2V0KCJ4LWZvcndhcmRlZC1mb3IiKS5nZXQoMCkuc3BsaXQoJywnKVswXTsKIH0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"04664029-3867-4192-829b-d749088cbdbe\",\"name\":\"AT_SetSocialFacebook\",\"description\":\"Set the Social Identity to Facebook\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiB1c2UKICogTW9kaWZpZWQgYnkgU3RlcGhlbiBQYXluZQogKiBBVF9TZXRTb2NpYWxGYWNlYm9vaywgU2NyaXB0IHRvIHNldCB0aGUgc29jaWFsIHByb3ZpZGVyIHR5cGUgdG8gZmFjZW9vawoqLwpzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgImZhY2Vib29rIik7CgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"92edf2c7-0bab-412c-a0da-82ad4f04505b\",\"name\":\"Collect Extra Fields\",\"description\":\"null\",\"script\":\"LyogQ29sbGVjdCBFeHRyYSBGaWVsZHMKICogCiAqIENvbGxlY3QgZXh0cmEgZmllbGRzIG5vdCBwYXJ0IG9mIHRoZSB1c2VyIHByb2ZpbGUuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIG91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLk5hbWVDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygnbW9kYWxpdHknKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygnand0VG9rZW4nKQogICAgICAgICkuYnVpbGQoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAJdmFyIG1vZGFsaXR5ID0gY2FsbGJhY2tzLmdldCgwKS5nZXROYW1lKCk7CiAgICAgIAl2YXIgand0VG9rZW4gPSBjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKTsKICAgICAgCW5vZGVTdGF0ZS5wdXRTaGFyZWQoJ21vZGFsaXR5JywgbW9kYWxpdHkpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgnand0VG9rZW4nLCBqd3RUb2tlbik7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"484e6246-dbc6-4288-97e6-54e55431402e\",\"name\":\"Apple Profile Normalization\",\"description\":\"Normalizes raw profile data from Apple\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEtMjAyMiBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICoKICogSW4gc29tZSBjb21tb24gZGVmYXVsdCBjb25maWd1cmF0aW9ucywgdGhlIGZvbGxvd2luZyBrZXlzIGFyZSByZXF1aXJlZCB0byBiZSBub3QgZW1wdHk6CiAqIHVzZXJuYW1lLCBnaXZlbk5hbWUsIGZhbWlseU5hbWUsIGVtYWlsLgogKgogKiBGcm9tIFJGQzQ1MTc6IEEgdmFsdWUgb2YgdGhlIERpcmVjdG9yeSBTdHJpbmcgc3ludGF4IGlzIGEgc3RyaW5nIG9mIG9uZSBvciBtb3JlCiAqIGFyYml0cmFyeSBjaGFyYWN0ZXJzIGZyb20gdGhlIFVuaXZlcnNhbCBDaGFyYWN0ZXIgU2V0IChVQ1MpLgogKiBBIHplcm8tbGVuZ3RoIGNoYXJhY3RlciBzdHJpbmcgaXMgbm90IHBlcm1pdHRlZC4KICovCgppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKU3RyaW5nIGVtYWlsID0gImNoYW5nZUBtZS5jb20iClN0cmluZyBzdWJqZWN0SWQgPSByYXdQcm9maWxlLnN1YgpTdHJpbmcgZmlyc3ROYW1lID0gIiAiClN0cmluZyBsYXN0TmFtZSA9ICIgIgpTdHJpbmcgdXNlcm5hbWUgPSBzdWJqZWN0SWQKU3RyaW5nIG5hbWUKCmlmIChyYXdQcm9maWxlLmlzRGVmaW5lZCgiZW1haWwiKSAmJiByYXdQcm9maWxlLmVtYWlsLmlzTm90TnVsbCgpKXsgLy8gVXNlciBjYW4gZWxlY3QgdG8gbm90IHNoYXJlIHRoZWlyIGVtYWlsCiAgICBlbWFpbCA9IHJhd1Byb2ZpbGUuZW1haWwuYXNTdHJpbmcoKQogICAgdXNlcm5hbWUgPSBlbWFpbAp9CmlmIChyYXdQcm9maWxlLmlzRGVmaW5lZCgibmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5pc05vdE51bGwoKSkgewogICAgaWYgKHJhd1Byb2ZpbGUubmFtZS5pc0RlZmluZWQoImZpcnN0TmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5maXJzdE5hbWUuaXNOb3ROdWxsKCkpIHsKICAgICAgICBmaXJzdE5hbWUgPSByYXdQcm9maWxlLm5hbWUuZmlyc3ROYW1lLmFzU3RyaW5nKCkKICAgIH0KICAgIGlmIChyYXdQcm9maWxlLm5hbWUuaXNEZWZpbmVkKCJsYXN0TmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5sYXN0TmFtZS5pc05vdE51bGwoKSkgewogICAgICAgIGxhc3ROYW1lID0gcmF3UHJvZmlsZS5uYW1lLmxhc3ROYW1lLmFzU3RyaW5nKCkKICAgIH0KfQoKbmFtZSA9IChmaXJzdE5hbWU/LnRyaW0oKSA/IGZpcnN0TmFtZSA6ICIiKSArIChsYXN0TmFtZT8udHJpbSgpID8gKChmaXJzdE5hbWU/LnRyaW0oKSA/ICIgIiA6ICIiKSArIGxhc3ROYW1lKSA6ICIiKQpuYW1lID0gICghbmFtZT8udHJpbSgpKSA/ICIgIiA6IG5hbWUKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCBzdWJqZWN0SWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIG5hbWUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIGVtYWlsKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgZmlyc3ROYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIGxhc3ROYW1lKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCB1c2VybmFtZSkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"13cd3c60-a04b-4455-b028-fbfd01ed88b1\",\"name\":\"AAD Passthru ROPC\",\"description\":\"Azure AD pass through authentication using Resource Owner Password Credential flow\",\"script\":\"LyogQUFEIFBhc3N0aHJ1IFJPUEMKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQXp1cmUgQUQgcGFzcyB0aHJvdWdoIGF1dGhlbnRpY2F0aW9uIHVzaW5nIFJlc291cmNlIE93bmVyIFBhc3N3b3JkIENyZWRlbnRpYWwgZmxvdwogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIFBsYXRmb3JtIFVzZXJuYW1lIGFuZCBQbGF0Zm9ybSBQYXNzd29yZCBjb2xsZWN0b3Igbm9kZXMKICogYmVmb3JlIGl0IGNhbiBvcGVyYXRlLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIFZhbGlkCiAqIC0gSW52YWxpZAogKiAtIEV4cGlyZWQKICogLSBEaXNhYmxlZAogKiAtIEVycm9yCiAqLwpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFJPUEM6IHN0YXJ0Iik7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpICYmIHRyYW5zaWVudFN0YXRlLmdldCgicGFzc3dvcmQiKSkgewogIAkvKgogICAgICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqCiAgICAgKiBBQURfVEVOQU5UX0lEIGlzIHlvdXIgdGVuYW50IElEOiBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9henVyZS9hY3RpdmUtZGlyZWN0b3J5L2Z1bmRhbWVudGFscy9hY3RpdmUtZGlyZWN0b3J5LWhvdy10by1maW5kLXRlbmFudAogICAgICogQUFEX0NMSUVOVF9JRCBpcyB5b3VyIHJlZ2lzdGVyZWQgYXBwIElEOiBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9henVyZS9hY3RpdmUtZGlyZWN0b3J5L2RldmVsb3AvcXVpY2tzdGFydC1yZWdpc3Rlci1hcHAKICAgICAqLwogICAgdmFyIEFBRF9URU5BTlRfSUQgPSAiNzExZmZhOWMtNTk3Mi00NzEzLWFjZTMtNjg4Yzk3MzI2MTRhIjsKICAgIHZhciBBQURfQ0xJRU5UX0lEID0gIjUxZjEzMGVjLWQyOWQtNDQxOS1hNDkyLTAwMTFkMDljMWExNiI7CiAgICAvKgogICAgICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAgICAgKi8KICAJCiAgICAvLyBBenVyZSBBRCBST1BDIENvbmZpZ3VyYXRpb24KICAgIHZhciBBQURfU0NPUEUgPSAicHJvZmlsZSI7CiAgCXZhciBBQURfUkVTT1VSQ0UgPSAiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tLyIKICAgIHZhciBBQURfT0FVVEgyX1RPS0VOX1VSSSA9ICJodHRwczovL2xvZ2luLndpbmRvd3MubmV0LyIuY29uY2F0KEFBRF9URU5BTlRfSUQpLmNvbmNhdCgiL29hdXRoMi90b2tlbiIpOwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnUE9TVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoQUFEX09BVVRIMl9UT0tFTl9VUkkpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICB2YXIgcGFyYW1zID0gcmVxdWVzdC5nZXRGb3JtKCk7CiAgICBwYXJhbXMuYWRkKCJyZXNvdXJjZSIsIEFBRF9SRVNPVVJDRSk7CiAgICBwYXJhbXMuYWRkKCJjbGllbnRfaWQiLCBBQURfQ0xJRU5UX0lEKTsKICAgIHBhcmFtcy5hZGQoImdyYW50X3R5cGUiLCAicGFzc3dvcmQiKTsKICAgIHBhcmFtcy5hZGQoInNjb3BlIiwgQUFEX1NDT1BFKTsKICAgIHBhcmFtcy5hZGQoInVzZXJuYW1lIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKTsKICAgIHBhcmFtcy5hZGQoInBhc3N3b3JkIiwgdHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpKTsKICAgIHJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKHBhcmFtcy50b1N0cmluZygpKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAvL2xvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCiAgCWlmIChyZXNwb25zZS5nZXRTdGF0dXMoKS5nZXRDb2RlKCkgPT09IDIwMCkgewogICAgICAJb3V0Y29tZSA9ICJWYWxpZCIKICAgICAgICB0cmFuc2llbnRTdGF0ZS5wdXQoImFhZEFjY2Vzc1Rva2VuIiwgcmVzdWx0LmFjY2Vzc190b2tlbik7CiAgICB9IGVsc2UgewogICAgICAgIC8qIE91dGNvbWVzOgogICAgICAgICAqIC0gVmFsaWQKICAgICAgICAgKiAtIEludmFsaWQKICAgICAgICAgKiAtIEV4cGlyZWQKICAgICAgICAgKiAtIERpc2FibGVkCiAgICAgICAgICogLSBFcnJvcgogICAgICAgICAqCiAgICAgICAgICogRXhwZWN0ZWQgRXJyb3IgQ29kZXM6CiAgICAgICAgICogNTAxMjYgLSBFcnJvciB2YWxpZGF0aW5nIGNyZWRlbnRpYWxzIGR1ZSB0byBpbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkLgogICAgICAgICAqIDUwMDU1IC0gVGhlIHBhc3N3b3JkIGlzIGV4cGlyZWQuCiAgICAgICAgICogNTAwNTcgLSBUaGUgdXNlciBhY2NvdW50IGlzIGRpc2FibGVkLgogICAgICAgICAqIDUwMTk2IC0gVGhlIHNlcnZlciB0ZXJtaW5hdGVkIGFuIG9wZXJhdGlvbiBiZWNhdXNlIGl0IGVuY291bnRlcmVkIGEgY2xpZW50IHJlcXVlc3QgbG9vcC4gUGxlYXNlIGNvbnRhY3QgeW91ciBhcHAgdmVuZG9yLgogICAgICAgICAqLwogICAgICAgIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAxMjYpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiSW52YWxpZCI7CiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAwNTUpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRXhwaXJlZCI7CiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAwNTcpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRGlzYWJsZWQiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRXJyb3IiOwogICAgICAgIH0KICAgICAgICBsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFJPUEM6IGVycm9yID0gIi5jb25jYXQocmVzdWx0LmVycm9yKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBST1BDOiBlcnJvcl9kZXNjcmlwdGlvbiA9ICIuY29uY2F0KHJlc3VsdC5lcnJvcl9kZXNjcmlwdGlvbikpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogZXJyb3JfY29kZXMgPSAiLmNvbmNhdChyZXN1bHQuZXJyb3JfY29kZXMpKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJFcnJvciI7CiAgCWxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogTm8gdXNlciBvciBwYXNzd29yZCBmb3VuZCBpbiBzaGFyZWQgc3RhdGUhIFVzZSB1c2VybmFtZSBhbmQgcGFzc3dvcmQgY29sbGVjdG9yIG5vZGVzIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSBzaGFyZWQgYW5kIHRyYW5zaWVudCBzdGF0ZXMhJyIpOwp9CmxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"157298c0-7d31-4059-a95b-eeb08473b7e5\",\"name\":\"Device Id (Match) - Client Side\",\"description\":\"Default global script for client side Device Id (Match) Authentication Module\",\"script\":\"dmFyIGZvbnREZXRlY3RvciA9IChmdW5jdGlvbiAoKSB7CiAgICAvKioKICAgICAqIEphdmFTY3JpcHQgY29kZSB0byBkZXRlY3QgYXZhaWxhYmxlIGF2YWlsYWJpbGl0eSBvZiBhCiAgICAgKiBwYXJ0aWN1bGFyIGZvbnQgaW4gYSBicm93c2VyIHVzaW5nIEphdmFTY3JpcHQgYW5kIENTUy4KICAgICAqCiAgICAgKiBBdXRob3IgOiBMYWxpdCBQYXRlbAogICAgICogV2Vic2l0ZTogaHR0cDovL3d3dy5sYWxpdC5vcmcvbGFiL2phdmFzY3JpcHQtY3NzLWZvbnQtZGV0ZWN0LwogICAgICogTGljZW5zZTogQXBhY2hlIFNvZnR3YXJlIExpY2Vuc2UgMi4wCiAgICAgKiAgICAgICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqIFZlcnNpb246IDAuMTUgKDIxIFNlcCAyMDA5KQogICAgICogICAgICAgICAgQ2hhbmdlZCBjb21wYXJpc2lvbiBmb250IHRvIGRlZmF1bHQgZnJvbSBzYW5zLWRlZmF1bHQtZGVmYXVsdCwKICAgICAqICAgICAgICAgIGFzIGluIEZGMy4wIGZvbnQgb2YgY2hpbGQgZWxlbWVudCBkaWRuJ3QgZmFsbGJhY2sKICAgICAqICAgICAgICAgIHRvIHBhcmVudCBlbGVtZW50IGlmIHRoZSBmb250IGlzIG1pc3NpbmcuCiAgICAgKiBWZXJzaW9uOiAwLjIgKDA0IE1hciAyMDEyKQogICAgICogICAgICAgICAgQ29tcGFyaW5nIGZvbnQgYWdhaW5zdCBhbGwgdGhlIDMgZ2VuZXJpYyBmb250IGZhbWlsaWVzIGllLAogICAgICogICAgICAgICAgJ21vbm9zcGFjZScsICdzYW5zLXNlcmlmJyBhbmQgJ3NhbnMnLiBJZiBpdCBkb2Vzbid0IG1hdGNoIGFsbCAzCiAgICAgKiAgICAgICAgICB0aGVuIHRoYXQgZm9udCBpcyAxMDAlIG5vdCBhdmFpbGFibGUgaW4gdGhlIHN5c3RlbQogICAgICogVmVyc2lvbjogMC4zICgyNCBNYXIgMjAxMikKICAgICAqICAgICAgICAgIFJlcGxhY2VkIHNhbnMgd2l0aCBzZXJpZiBpbiB0aGUgbGlzdCBvZiBiYXNlRm9udHMKICAgICAqLwogICAgLyoKICAgICAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMgRm9yZ2VSb2NrIEFTLgogICAgICovCiAgICB2YXIgZGV0ZWN0b3IgPSB7fSwgYmFzZUZvbnRzLCB0ZXN0U3RyaW5nLCB0ZXN0U2l6ZSwgaCwgcywgZGVmYXVsdFdpZHRoID0ge30sIGRlZmF1bHRIZWlnaHQgPSB7fSwgaW5kZXg7CgogICAgLy8gYSBmb250IHdpbGwgYmUgY29tcGFyZWQgYWdhaW5zdCBhbGwgdGhlIHRocmVlIGRlZmF1bHQgZm9udHMuCiAgICAvLyBhbmQgaWYgaXQgZG9lc24ndCBtYXRjaCBhbGwgMyB0aGVuIHRoYXQgZm9udCBpcyBub3QgYXZhaWxhYmxlLgogICAgYmFzZUZvbnRzID0gWydtb25vc3BhY2UnLCAnc2Fucy1zZXJpZicsICdzZXJpZiddOwoKICAgIC8vd2UgdXNlIG0gb3IgdyBiZWNhdXNlIHRoZXNlIHR3byBjaGFyYWN0ZXJzIHRha2UgdXAgdGhlIG1heGltdW0gd2lkdGguCiAgICAvLyBBbmQgd2UgdXNlIGEgTExpIHNvIHRoYXQgdGhlIHNhbWUgbWF0Y2hpbmcgZm9udHMgY2FuIGdldCBzZXBhcmF0ZWQKICAgIHRlc3RTdHJpbmcgPSAibW1tbW1tbW1tbWxsaSI7CgogICAgLy93ZSB0ZXN0IHVzaW5nIDcycHggZm9udCBzaXplLCB3ZSBtYXkgdXNlIGFueSBzaXplLiBJIGd1ZXNzIGxhcmdlciB0aGUgYmV0dGVyLgogICAgdGVzdFNpemUgPSAnNzJweCc7CgogICAgaCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CgogICAgLy8gY3JlYXRlIGEgU1BBTiBpbiB0aGUgZG9jdW1lbnQgdG8gZ2V0IHRoZSB3aWR0aCBvZiB0aGUgdGV4dCB3ZSB1c2UgdG8gdGVzdAogICAgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgIHMuc3R5bGUuZm9udFNpemUgPSB0ZXN0U2l6ZTsKICAgIHMuaW5uZXJIVE1MID0gdGVzdFN0cmluZzsKICAgIGZvciAoaW5kZXggaW4gYmFzZUZvbnRzKSB7CiAgICAgICAgLy9nZXQgdGhlIGRlZmF1bHQgd2lkdGggZm9yIHRoZSB0aHJlZSBiYXNlIGZvbnRzCiAgICAgICAgcy5zdHlsZS5mb250RmFtaWx5ID0gYmFzZUZvbnRzW2luZGV4XTsKICAgICAgICBoLmFwcGVuZENoaWxkKHMpOwogICAgICAgIGRlZmF1bHRXaWR0aFtiYXNlRm9udHNbaW5kZXhdXSA9IHMub2Zmc2V0V2lkdGg7IC8vd2lkdGggZm9yIHRoZSBkZWZhdWx0IGZvbnQKICAgICAgICBkZWZhdWx0SGVpZ2h0W2Jhc2VGb250c1tpbmRleF1dID0gcy5vZmZzZXRIZWlnaHQ7IC8vaGVpZ2h0IGZvciB0aGUgZGVmdWFsdCBmb250CiAgICAgICAgaC5yZW1vdmVDaGlsZChzKTsKICAgIH0KCiAgICBkZXRlY3Rvci5kZXRlY3QgPSBmdW5jdGlvbihmb250KSB7CiAgICAgICAgdmFyIGRldGVjdGVkID0gZmFsc2UsIGluZGV4LCBtYXRjaGVkOwogICAgICAgIGZvciAoaW5kZXggaW4gYmFzZUZvbnRzKSB7CiAgICAgICAgICAgIHMuc3R5bGUuZm9udEZhbWlseSA9IGZvbnQgKyAnLCcgKyBiYXNlRm9udHNbaW5kZXhdOyAvLyBuYW1lIG9mIHRoZSBmb250IGFsb25nIHdpdGggdGhlIGJhc2UgZm9udCBmb3IgZmFsbGJhY2suCiAgICAgICAgICAgIGguYXBwZW5kQ2hpbGQocyk7CiAgICAgICAgICAgIG1hdGNoZWQgPSAocy5vZmZzZXRXaWR0aCAhPT0gZGVmYXVsdFdpZHRoW2Jhc2VGb250c1tpbmRleF1dIHx8IHMub2Zmc2V0SGVpZ2h0ICE9PSBkZWZhdWx0SGVpZ2h0W2Jhc2VGb250c1tpbmRleF1dKTsKICAgICAgICAgICAgaC5yZW1vdmVDaGlsZChzKTsKICAgICAgICAgICAgZGV0ZWN0ZWQgPSBkZXRlY3RlZCB8fCBtYXRjaGVkOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZGV0ZWN0ZWQ7CiAgICB9OwoKICAgIHJldHVybiBkZXRlY3RvcjsKfSgpKTsKLyoKICogRE8gTk9UIEFMVEVSIE9SIFJFTU9WRSBDT1BZUklHSFQgTk9USUNFUyBPUiBUSElTIEhFQURFUi4KICoKICogQ29weXJpZ2h0IChjKSAyMDA5IFN1biBNaWNyb3N5c3RlbXMgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIHRlcm1zCiAqIG9mIHRoZSBDb21tb24gRGV2ZWxvcG1lbnQgYW5kIERpc3RyaWJ1dGlvbiBMaWNlbnNlCiAqICh0aGUgTGljZW5zZSkuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluCiAqIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICoKICogWW91IGNhbiBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqIGh0dHBzOi8vb3BlbnNzby5kZXYuamF2YS5uZXQvcHVibGljL0NEREx2MS4wLmh0bWwgb3IKICogb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQKICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nCiAqIHBlcm1pc3Npb24gYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBXaGVuIGRpc3RyaWJ1dGluZyBDb3ZlcmVkIENvZGUsIGluY2x1ZGUgdGhpcyBDRERMCiAqIEhlYWRlciBOb3RpY2UgaW4gZWFjaCBmaWxlIGFuZCBpbmNsdWRlIHRoZSBMaWNlbnNlIGZpbGUKICogYXQgb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQuCiAqIElmIGFwcGxpY2FibGUsIGFkZCB0aGUgZm9sbG93aW5nIGJlbG93IHRoZSBDRERMIEhlYWRlciwKICogd2l0aCB0aGUgZmllbGRzIGVuY2xvc2VkIGJ5IGJyYWNrZXRzIFtdIHJlcGxhY2VkIGJ5CiAqIHlvdXIgb3duIGlkZW50aWZ5aW5nIGluZm9ybWF0aW9uOgogKiAiUG9ydGlvbnMgQ29weXJpZ2h0ZWQgW3llYXJdIFtuYW1lIG9mIGNvcHlyaWdodCBvd25lcl0iCiAqCiAqLwovKgogKiBQb3J0aW9ucyBDb3B5cmlnaHRlZCAyMDEzIFN5bnRlZ3JpdHkuCiAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMtMjAxNCBGb3JnZVJvY2sgQVMuCiAqLwoKdmFyIGNvbGxlY3RTY3JlZW5JbmZvID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzY3JlZW5JbmZvID0ge307CiAgICAgICAgaWYgKHNjcmVlbikgewogICAgICAgICAgICBpZiAoc2NyZWVuLndpZHRoKSB7CiAgICAgICAgICAgICAgICBzY3JlZW5JbmZvLnNjcmVlbldpZHRoID0gc2NyZWVuLndpZHRoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2NyZWVuLmhlaWdodCkgewogICAgICAgICAgICAgICAgc2NyZWVuSW5mby5zY3JlZW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2NyZWVuLnBpeGVsRGVwdGgpIHsKICAgICAgICAgICAgICAgIHNjcmVlbkluZm8uc2NyZWVuQ29sb3VyRGVwdGggPSBzY3JlZW4ucGl4ZWxEZXB0aDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiQ2Fubm90IGNvbGxlY3Qgc2NyZWVuIGluZm9ybWF0aW9uLiBzY3JlZW4gaXMgbm90IGRlZmluZWQuIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzY3JlZW5JbmZvOwogICAgfSwKICAgIGNvbGxlY3RUaW1lem9uZUluZm8gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHRpbWV6b25lSW5mbyA9ICB7fSwgb2Zmc2V0ID0gbmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpOwoKICAgICAgICBpZiAob2Zmc2V0KSB7CiAgICAgICAgICAgIHRpbWV6b25lSW5mby50aW1lem9uZSA9IG9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIkNhbm5vdCBjb2xsZWN0IHRpbWV6b25lIGluZm9ybWF0aW9uLiB0aW1lem9uZSBpcyBub3QgZGVmaW5lZC4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aW1lem9uZUluZm87CiAgICB9LAogICAgY29sbGVjdEJyb3dzZXJQbHVnaW5zSW5mbyA9IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgaWYgKG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IucGx1Z2lucykgewogICAgICAgICAgICB2YXIgcGx1Z2luc0luZm8gPSB7fSwgaSwgcGx1Z2lucyA9IG5hdmlnYXRvci5wbHVnaW5zOwogICAgICAgICAgICBwbHVnaW5zSW5mby5pbnN0YWxsZWRQbHVnaW5zID0gIiI7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGx1Z2lucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgcGx1Z2luc0luZm8uaW5zdGFsbGVkUGx1Z2lucyA9IHBsdWdpbnNJbmZvLmluc3RhbGxlZFBsdWdpbnMgKyBwbHVnaW5zW2ldLmZpbGVuYW1lICsgIjsiOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcGx1Z2luc0luZm87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJDYW5ub3QgY29sbGVjdCBicm93c2VyIHBsdWdpbiBpbmZvcm1hdGlvbi4gbmF2aWdhdG9yLnBsdWdpbnMgaXMgbm90IGRlZmluZWQuIik7CiAgICAgICAgICAgIHJldHVybiB7fTsKICAgICAgICB9CgogICAgfSwKLy8gR2V0dGluZyBnZW9sb2NhdGlvbiB0YWtlcyBzb21lIHRpbWUgYW5kIGlzIGRvbmUgYXN5bmNocm9ub3VzbHksIGhlbmNlIG5lZWQgYSBjYWxsYmFjayB3aGljaCBpcyBjYWxsZWQgb25jZSBnZW9sb2NhdGlvbiBpcyByZXRyaWV2ZWQuCiAgICBjb2xsZWN0R2VvbG9jYXRpb25JbmZvID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgdmFyIGdlb2xvY2F0aW9uSW5mbyA9IHt9LAogICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2sgPSBmdW5jdGlvbihwb3NpdGlvbikgewogICAgICAgICAgICAgICAgZ2VvbG9jYXRpb25JbmZvLmxvbmdpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGU7CiAgICAgICAgICAgICAgICBnZW9sb2NhdGlvbkluZm8ubGF0aXR1ZGUgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7CiAgICAgICAgICAgICAgICBjYWxsYmFjayhnZW9sb2NhdGlvbkluZm8pOwogICAgICAgICAgICB9LCBlcnJvckNhbGxiYWNrID0gZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiQ2Fubm90IGNvbGxlY3QgZ2VvbG9jYXRpb24gaW5mb3JtYXRpb24uICIgKyBlcnJvci5jb2RlICsgIjogIiArIGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgY2FsbGJhY2soZ2VvbG9jYXRpb25JbmZvKTsKICAgICAgICAgICAgfTsKICAgICAgICBpZiAobmF2aWdhdG9yICYmIG5hdmlnYXRvci5nZW9sb2NhdGlvbikgewogICAgICAgICAgICAvLyBOQjogSWYgdXNlciBjaG9vc2VzICdOb3Qgbm93JyBvbiBGaXJlZm94IG5laXRoZXIgY2FsbGJhY2sgZ2V0cyBjYWxsZWQKICAgICAgICAgICAgLy8gICAgIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY3NTUzMwogICAgICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjayk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJDYW5ub3QgY29sbGVjdCBnZW9sb2NhdGlvbiBpbmZvcm1hdGlvbi4gbmF2aWdhdG9yLmdlb2xvY2F0aW9uIGlzIG5vdCBkZWZpbmVkLiIpOwogICAgICAgICAgICBjYWxsYmFjayhnZW9sb2NhdGlvbkluZm8pOwogICAgICAgIH0KICAgIH0sCiAgICBjb2xsZWN0QnJvd3NlckZvbnRzSW5mbyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZm9udHNJbmZvID0ge30sIGksIGZvbnRzTGlzdCA9IFsiY3Vyc2l2ZSIsIm1vbm9zcGFjZSIsInNlcmlmIiwic2Fucy1zZXJpZiIsImZhbnRhc3kiLCJkZWZhdWx0IiwiQXJpYWwiLCJBcmlhbCBCbGFjayIsCiAgICAgICAgICAgICJBcmlhbCBOYXJyb3ciLCJBcmlhbCBSb3VuZGVkIE1UIEJvbGQiLCJCb29rbWFuIE9sZCBTdHlsZSIsIkJyYWRsZXkgSGFuZCBJVEMiLCJDZW50dXJ5IiwiQ2VudHVyeSBHb3RoaWMiLAogICAgICAgICAgICAiQ29taWMgU2FucyBNUyIsIkNvdXJpZXIiLCJDb3VyaWVyIE5ldyIsIkdlb3JnaWEiLCJHZW50aXVtIiwiSW1wYWN0IiwiS2luZyIsIkx1Y2lkYSBDb25zb2xlIiwiTGFsaXQiLAogICAgICAgICAgICAiTW9kZW5hIiwiTW9ub3R5cGUgQ29yc2l2YSIsIlBhcHlydXMiLCJUYWhvbWEiLCJUZVgiLCJUaW1lcyIsIlRpbWVzIE5ldyBSb21hbiIsIlRyZWJ1Y2hldCBNUyIsIlZlcmRhbmEiLAogICAgICAgICAgICAiVmVyb25hIl07CiAgICAgICAgZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzID0gIiI7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBmb250c0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGZvbnREZXRlY3Rvci5kZXRlY3QoZm9udHNMaXN0W2ldKSkgewogICAgICAgICAgICAgICAgZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzID0gZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzICsgZm9udHNMaXN0W2ldICsgIjsiOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmb250c0luZm87CiAgICB9LAogICAgZGV2aWNlUHJpbnQgPSB7fTsKCmRldmljZVByaW50LnNjcmVlbiA9IGNvbGxlY3RTY3JlZW5JbmZvKCk7CmRldmljZVByaW50LnRpbWV6b25lID0gY29sbGVjdFRpbWV6b25lSW5mbygpOwpkZXZpY2VQcmludC5wbHVnaW5zID0gY29sbGVjdEJyb3dzZXJQbHVnaW5zSW5mbygpOwpkZXZpY2VQcmludC5mb250cyA9IGNvbGxlY3RCcm93c2VyRm9udHNJbmZvKCk7CgppZiAobmF2aWdhdG9yLnVzZXJBZ2VudCkgewogICAgZGV2aWNlUHJpbnQudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsKfQppZiAobmF2aWdhdG9yLmFwcE5hbWUpIHsKICAgIGRldmljZVByaW50LmFwcE5hbWUgPSBuYXZpZ2F0b3IuYXBwTmFtZTsKfQppZiAobmF2aWdhdG9yLmFwcENvZGVOYW1lKSB7CiAgICBkZXZpY2VQcmludC5hcHBDb2RlTmFtZSA9IG5hdmlnYXRvci5hcHBDb2RlTmFtZTsKfQppZiAobmF2aWdhdG9yLmFwcFZlcnNpb24pIHsKICAgIGRldmljZVByaW50LmFwcFZlcnNpb24gPSBuYXZpZ2F0b3IuYXBwVmVyc2lvbjsKfQppZiAobmF2aWdhdG9yLmFwcE1pbm9yVmVyc2lvbikgewogICAgZGV2aWNlUHJpbnQuYXBwTWlub3JWZXJzaW9uID0gbmF2aWdhdG9yLmFwcE1pbm9yVmVyc2lvbjsKfQppZiAobmF2aWdhdG9yLmJ1aWxkSUQpIHsKICAgIGRldmljZVByaW50LmJ1aWxkSUQgPSBuYXZpZ2F0b3IuYnVpbGRJRDsKfQppZiAobmF2aWdhdG9yLnBsYXRmb3JtKSB7CiAgICBkZXZpY2VQcmludC5wbGF0Zm9ybSA9IG5hdmlnYXRvci5wbGF0Zm9ybTsKfQppZiAobmF2aWdhdG9yLmNwdUNsYXNzKSB7CiAgICBkZXZpY2VQcmludC5jcHVDbGFzcyA9IG5hdmlnYXRvci5jcHVDbGFzczsKfQppZiAobmF2aWdhdG9yLm9zY3B1KSB7CiAgICBkZXZpY2VQcmludC5vc2NwdSA9IG5hdmlnYXRvci5vc2NwdTsKfQppZiAobmF2aWdhdG9yLnByb2R1Y3QpIHsKICAgIGRldmljZVByaW50LnByb2R1Y3QgPSBuYXZpZ2F0b3IucHJvZHVjdDsKfQppZiAobmF2aWdhdG9yLnByb2R1Y3RTdWIpIHsKICAgIGRldmljZVByaW50LnByb2R1Y3RTdWIgPSBuYXZpZ2F0b3IucHJvZHVjdFN1YjsKfQppZiAobmF2aWdhdG9yLnZlbmRvcikgewogICAgZGV2aWNlUHJpbnQudmVuZG9yID0gbmF2aWdhdG9yLnZlbmRvcjsKfQppZiAobmF2aWdhdG9yLnZlbmRvclN1YikgewogICAgZGV2aWNlUHJpbnQudmVuZG9yU3ViID0gbmF2aWdhdG9yLnZlbmRvclN1YjsKfQppZiAobmF2aWdhdG9yLmxhbmd1YWdlKSB7CiAgICBkZXZpY2VQcmludC5sYW5ndWFnZSA9IG5hdmlnYXRvci5sYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLnVzZXJMYW5ndWFnZSkgewogICAgZGV2aWNlUHJpbnQudXNlckxhbmd1YWdlID0gbmF2aWdhdG9yLnVzZXJMYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLmJyb3dzZXJMYW5ndWFnZSkgewogICAgZGV2aWNlUHJpbnQuYnJvd3Nlckxhbmd1YWdlID0gbmF2aWdhdG9yLmJyb3dzZXJMYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLnN5c3RlbUxhbmd1YWdlKSB7CiAgICBkZXZpY2VQcmludC5zeXN0ZW1MYW5ndWFnZSA9IG5hdmlnYXRvci5zeXN0ZW1MYW5ndWFnZTsKfQoKLy8gQXR0ZW1wdCB0byBjb2xsZWN0IGdlby1sb2NhdGlvbiBpbmZvcm1hdGlvbiBhbmQgcmV0dXJuIHRoaXMgd2l0aCB0aGUgZGF0YSBjb2xsZWN0ZWQgc28gZmFyLgovLyBPdGhlcndpc2UsIGlmIGdlby1sb2NhdGlvbiBmYWlscyBvciB0YWtlcyBsb25nZXIgdGhhbiAzMCBzZWNvbmRzLCBhdXRvLXN1Ym1pdCB0aGUgZGF0YSBjb2xsZWN0ZWQgc28gZmFyLgphdXRvU3VibWl0RGVsYXkgPSAzMDAwMDsKb3V0cHV0LnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoZGV2aWNlUHJpbnQpOwpjb2xsZWN0R2VvbG9jYXRpb25JbmZvKGZ1bmN0aW9uKGdlb2xvY2F0aW9uSW5mbykgewogICAgZGV2aWNlUHJpbnQuZ2VvbG9jYXRpb24gPSBnZW9sb2NhdGlvbkluZm87CiAgICBvdXRwdXQudmFsdWUgPSBKU09OLnN0cmluZ2lmeShkZXZpY2VQcmludCk7CiAgICBzdWJtaXQoKTsKfSk7\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_CLIENT_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3b2f6836-184c-4ee9-8a1d-557cb01837a5\",\"name\":\"FrodoTestScript3\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"169150da-0bd1-4866-8095-eae0bbc269e4\",\"name\":\"Collect Message Node Config\",\"description\":\"Collect all the configuration items required for the Message Node to function properly.\",\"script\":\"LyogQ29sbGVjdCBNZXNzYWdlIE5vZGUgQ29uZmlnCiAqIAogKiBDb2xsZWN0IGFsbCB0aGUgY29uZmlndXJhdGlvbiBpdGVtcyByZXF1aXJlZCBmb3IgdGhlIE1lc3NhZ2UgTm9kZSB0byBmdW5jdGlvbiBwcm9wZXJseS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAJdmFyIGNvbmZpZyA9IHsKICAgICAgICAibWVzc2FnZSI6IHsiZW4iOiAiSSBiZWxpZXZlIEkgY2FuIGZseSEifSwKICAgICAgICAibWVzc2FnZVllcyI6IHsiZW4iOiAiR2xvcmlvdXMhIn0sCiAgICAgICAgIm1lc3NhZ2VObyI6IHsiZW4iOiAiSW5jb25jZWl2YWJsZSEifQogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXS5lbik7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZSIsIGNvbmZpZy5tZXNzYWdlLmVuKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZVllcyIsIGNvbmZpZy5tZXNzYWdlWWVzLmVuKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZU5vIiwgY29uZmlnLm1lc3NhZ2VOby5lbiksCiAgICAgICAgICAJbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpOwogICAgfQogICAgZWxzZSB7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgwKS5nZXRQcm9tcHQoKV0uZW4gPSBjYWxsYmFja3MuZ2V0KDApLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDEpLmdldFByb21wdCgpXS5lbiA9IGNhbGxiYWNrcy5nZXQoMSkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMikuZ2V0UHJvbXB0KCldLmVuID0gY2FsbGJhY2tzLmdldCgyKS5nZXROYW1lKCk7CiAgICAgIAlub2RlU3RhdGUucHV0U2hhcmVkKCJub2RlQ29uZmlnIiwgY29uZmlnKTsKICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"403cf226-6051-4368-8b72-9ba14f9a5140\",\"name\":\"VKontakte Profile Normalization\",\"description\":\"Normalizes raw profile data from VKontakte\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGhvdG9fNTApLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269},{\"_id\":\"f2107949-22f8-46c4-865d-ae1d1110a9cb\",\"name\":\"Set OATH Theme\",\"description\":\"Detect and preserve currently active theme before setting the new theme.\",\"script\":\"LyogU2V0IE9BVEggVGhlbWUKICogCiAqIERldGVjdCBhbmQgcHJlc2VydmUgY3VycmVudGx5IGFjdGl2ZSB0aGVtZSBiZWZvcmUgc2V0dGluZyB0aGUgbmV3IHRoZW1lLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCQogIAl2YXIgdGhlbWUgPSAiRXhwYW5zZV9PQVRIIjsKCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIGRpc2NvdmVyIGFjdGl2ZSB0aGVtZSBmcm9tIFVJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjayBhbmQgc2V0IG5ldyB0aGVtZQogIAllbHNlIGlmIChjYWxsYmFja3Muc2l6ZSgpID09PSAyKSB7CiAgICAgICAgLy8gZGlkIHdlIGdldCB0aGUgaWQgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWU/CiAgICAgICAgaWYgKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSAhPT0gInRoZW1lLWlkLSIrYW5jaG9yKSB7CiAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgY2FsbGJhY2tzLmdldCgwKS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gc2V0IG5ldyB0aGVtZQogICAgCXZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAJbmV3IGZyLlBvbGxpbmdXYWl0Q2FsbGJhY2soIjAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0KICAJZWxzZSB7CiAgICAgICAgLy8gY29udGludWUKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"3981c0d3-0e3a-4c1d-be6b-5442e8acd3a1\",\"name\":\"Store Profile In Session\",\"description\":\"Store the profile information in objectAttributes in session properties.\",\"script\":\"LyogU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uCiAqIAogKiBTdG9yZSB0aGUgcHJvZmlsZSBpbmZvcm1hdGlvbiBpbiBvYmplY3RBdHRyaWJ1dGVzIGluIHNlc3Npb24gcHJvcGVydGllcy4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IGpha2UuZmVhc2VsQGZvcmdlcm9jay5jb20sIHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAlsb2dnZXIubWVzc2FnZSgiU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uOiBzdGFydCIpOwogIAlvdXRjb21lID0gInRydWUiOwogICAgdmFyIGdvVG8gPSBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbi5nb1RvOwogICAgbXlHb3RvID0gZ29UbyhvdXRjb21lKTsKICAJCiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCWlmIChyb3V0ZWRJRFAuZ2V0KCJfaWQiKSkgewogICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoIm9yZyIsIHJvdXRlZElEUC5nZXQoIm5hbWUiKSk7CiAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgiaWRwIiwgcm91dGVkSURQLmdldCgiaWRwTmFtZSIpKTsKICAgICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoInNhYXMiLCAidHJ1ZSIpOwogICAgfQogIAllbHNlIHsKICAgICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoImlkcCIsICJsb2NhbCIpOwogICAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgic2FhcyIsICJmYWxzZSIpOwogICAgfQogIAlteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJ1c2VyTmFtZSIsIHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSk7CiAgCiAgCXZhciBwcm9maWxlQXR0cnMgPSBbImdpdmVuTmFtZSIsInNuIiwibWFpbCJdOwogIAkKICAJdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKICAJaWYgKHVzZXJpZCkgewogICAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgicHJvZmlsZVR5cGUiLCAicGVyc2lzdGVudCIpOwogICAgICAJcHJvZmlsZUF0dHJzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KGtleSwgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsIGtleSkuaXRlcmF0b3IoKS5uZXh0KCkpOwogICAgICAgIH0pOwogICAgfQogICAgZWxzZSB7CiAgICAgIAlteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJwcm9maWxlVHlwZSIsICJ0cmFuc2llbnQiKTsKICAgIH0KCiAgCXZhciBpbmNsdWRlID0gWyJnaXZlbk5hbWUiLCJzbiIsIm1haWwiLCJyb2xlcyJdOwogIAogICAgdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgCXZhciBlbnRyaWVzID0gbnVsbDsKICAJaWYgKGF0dHJzKSB7CiAgICAgIAllbnRyaWVzID0gYXR0cnMuZW50cnlTZXQoKS50b0FycmF5KCk7CiAgICAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICAgICAgCWlmIChpbmNsdWRlLmluZGV4T2YoIiIrZW50cnkuZ2V0S2V5KCkpID4gLTEpIHsKICAgICAgICAgICAgICAgIG15R290by5wdXRTZXNzaW9uUHJvcGVydHkoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgYXR0cnMgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAJaWYgKGF0dHJzKSB7CiAgICAgIAllbnRyaWVzID0gYXR0cnMuZW50cnlTZXQoKS50b0FycmF5KCk7CiAgICAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICAgICAgCWlmIChpbmNsdWRlLmluZGV4T2YoIiIrZW50cnkuZ2V0S2V5KCkpID4gLTEpIHsKICAgICAgICAgICAgICAgIG15R290by5wdXRTZXNzaW9uUHJvcGVydHkoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogIAlsb2dnZXIubWVzc2FnZSgiU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uOiBkb25lIFtvdXRjb21lPXt9XSIsIG91dGNvbWUpOwogICAgYWN0aW9uID0gbXlHb3RvLmJ1aWxkKCk7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"164fe425-01e7-4b0b-9f60-fb41f6bf362b\",\"name\":\"FRAAS-7955 Display States\",\"description\":\"FRAAS-7955 Display sharedState and transientState.\",\"script\":\"LyogZGVidWcKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRGlzcGxheSBzaGFyZWRTdGF0ZSBhbmQgdHJhbnNpZW50U3RhdGUuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCnZhciBvdXRwdXQgPSB0cnVlOwoKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIGhhbGlnbiA9ICJsZWZ0IjsKdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICI8cD48Yj5TaGFyZWQgU3RhdGU8L2I+Ojxici8+IikuY29uY2F0KAogIAlzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+VHJhbnNpZW50IFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAJdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikKdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLnN0eWxlID0gXCJ0ZXh0LWFsaWduOiBsZWZ0OyBpbmxpbmUtc2l6ZTogNDMwcHg7IG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7XCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIn0pIikKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopCmlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGFuY2hvcgogICAgICAgICksCiAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygidHJ1ZSIpLmJ1aWxkKCk7Cn0KCiAvKgogICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAqIAogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"7fb962a5-9f20-41d3-a077-b424a29c1198\",\"name\":\"IPv4 CIDR Rules Engine\",\"description\":\"Evaluate IPv4 CIDR access rules from \\\"esv-ipv4-cidr-access-rules\\\".\",\"script\":\"LyogSVB2NCBDSURSIFJ1bGVzIEVuZ2luZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tLCBqdXN0aW4uY2hpbkBmb3JnZXJvY2suY29tCiAqIAogKiBFdmFsdWF0ZSBJUHY0IENJRFIgYWNjZXNzIHJ1bGVzIGZyb20gImVzdi1pcHY0LWNpZHItYWNjZXNzLXJ1bGVzIi4gCiAqIEFjY2VzcyBydWxlcyBtdXN0IGhhdmUgdGhlIGZvbGxvd2luZyBmb3JtYXQ6CiAqIHsKICogICAiYWxsb3ciOiBbCiAqICAgICAiMTQwLjExOC4wLjAvMTYiLAogKiAgICAgIjExMC4zNS4wLjAvMTYiLAogKiAgICAgIjEzMS4yNi4wLjAvMTYiLAogKiAgICAgIjkyLjYxLjIxLjE1My8zMiIKICogICBdCiAqIH0KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gYWxsb3cKICogLSBkZW55CiAqLwooZnVuY3Rpb24gKCkgewogIG91dGNvbWUgPSAiZGVueSI7CiAgCiAgdmFyIHJ1bGVzID0gSlNPTi5wYXJzZShzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5pcHY0LmNpZHIuYWNjZXNzLnJ1bGVzIikpOwogIHZhciBhbGxvdyA9IHJ1bGVzWydhbGxvdyddOwoKICAvKgogICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKGhlYWRlck5hbWUpIHsKICAgIHJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApOwogIH0KCiAgLyoKICAgKiBSZXR1cm5zIHRoZSBjbGllbnQncyBJUCBhZGRyZXNzCiAgICovCiAgZnVuY3Rpb24gZ2V0Q2xpZW50SVBBZGRyZXNzKCkgewogICAgcmV0dXJuIGdldEhlYWRlcigieC1mb3J3YXJkZWQtZm9yIikuc3BsaXQoJywnKVswXTsKICB9CgogIGZ1bmN0aW9uIElQbnVtYmVyKElQYWRkcmVzcykgewogICAgdmFyIGlwID0gSVBhZGRyZXNzLm1hdGNoKC9eKFxkKylcLihcZCspXC4oXGQrKVwuKFxkKykkLyk7CiAgICBpZiAoaXApIHsKICAgICAgcmV0dXJuICgraXBbMV0gPDwgMjQpICsgKCtpcFsyXSA8PCAxNikgKyAoK2lwWzNdIDw8IDgpICsgK2lwWzRdOwogICAgfQogICAgLy8gZWxzZSAuLi4gPwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBJUG1hc2sobWFza1NpemUpIHsKICAgIHJldHVybiAtMSA8PCAoMzIgLSBtYXNrU2l6ZSk7CiAgfQoKICBmdW5jdGlvbiBpc0FsbG93ZWQoaXApIHsKICAgIHZhciBhbGxvd2VkID0gZmFsc2U7CiAgICBhbGxvdy5mb3JFYWNoKChjaWRyKSA9PiB7CiAgICAgIGlmICgKICAgICAgICAoSVBudW1iZXIoaXApICYgSVBtYXNrKGNpZHIuc3BsaXQoJy8nKVsxXSkpID09CiAgICAgICAgSVBudW1iZXIoY2lkci5zcGxpdCgnLycpWzBdKQogICAgICApIHsKICAgICAgICBhbGxvd2VkID0gdHJ1ZTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gYWxsb3dlZDsKICB9CiAgCiAgaWYgKGlzQWxsb3dlZChnZXRDbGllbnRJUEFkZHJlc3MoKSkpIHsKICAgIG91dGNvbWUgPSAiYWxsb3ciOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"37bf200a-158f-4a45-8ee5-81516e4593f8\",\"name\":\"Display Session Info\",\"description\":\"Display session info.\",\"script\":\"LyogRGlzcGxheSBTZXNzaW9uIEluZm8KICogCiAqIERpc3BsYXkgU2Vzc2lvbiBJbmZvLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwoKICAgIHZhciBjaG9pY2VzID0gW107CiAgCXZhciBkZWZhdWx0Q2hvaWNlID0gMDsKICAKICAJdmFyIGluY2x1ZGUgPSBbIm9yZyIsImlkcCIsInNhYXMiLCJwcm9maWxlVHlwZSIsImdpdmVuTmFtZSIsInNuIiwibWFpbCIsInJvbGVzIiwidXNlck5hbWUiLCJVc2VySWQiLCJMb2NhbGUiLCJhdXRoSW5zdGFudCIsIkF1dGhMZXZlbCIsIkhvc3QiLCJTZXJ2aWNlIl07CiAgICB2YXIgbWVzc2FnZSA9ICIiOwogICAgaWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIAltZXNzYWdlID0gIjxoND5TZXNzaW9uIEluZm88L2g0PjxwIHN0eWxlPVwiZm9udC1mYW1pbHk6Y291cmllcjtcIj4iOwogICAgICAJaW5jbHVkZS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIAltZXNzYWdlICs9ICI8Yj4iICsga2V5ICsgIjwvYj46ICIgKyBleGlzdGluZ1Nlc3Npb24uZ2V0KGtleSkgKyAiPGJyLz4iOwogICAgICAgIH0pOwogICAgIAltZXNzYWdlICs9ICI8L3A+PHAgc3R5bGU9XCJmb250LXNpemU6NzAlO2ZvbnQtZmFtaWx5OmNvdXJpZXI7XCI+IgogICAgICAJdmFyIGVudHJpZXMgPSBleGlzdGluZ1Nlc3Npb24ua2V5U2V0KCkudG9BcnJheSgpOwogICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAJaWYgKGluY2x1ZGUuaW5kZXhPZigiIitrZXkpPT09LTEpIHsKICAgICAgICAgICAgCW1lc3NhZ2UgKz0gIjxiPiIgKyBrZXkgKyAiPC9iPjogIiArIGV4aXN0aW5nU2Vzc2lvbi5nZXQoa2V5KSArICI8YnIvPiI7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAJbWVzc2FnZSArPSAiPC9wPiIKICAgICAgCWNob2ljZXMucHVzaCgiR290byBTQU1MIEFwcCIpOwogICAgICAJY2hvaWNlcy5wdXNoKCJHb3RvIE9JREMgQXBwIik7CiAgICAgIAlpZiAoIiIrZXhpc3RpbmdTZXNzaW9uLmdldCgicHJvZmlsZVR5cGUiKSA9PT0gInBlcnNpc3RlbnQiKSB7CiAgICAgIAkJY2hvaWNlcy5wdXNoKCJHb3RvIFByb2ZpbGUgUGFnZSIpOwogICAgICAgIH0KICAgICAgCWNob2ljZXMucHVzaCgiTG9nb3V0Iik7CiAgICB9IGVsc2UgewogICAgICAJbWVzc2FnZSA9ICI8aDQ+Tm8gU2Vzc2lvbiE8L2g0PjxwPiIKICAgICAgCWNob2ljZXMucHVzaCgiTG9naW4iKTsKICAgIH0KICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAgICAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICAgICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICAgICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5zdHlsZSA9IFwidGV4dC1hbGlnbjogbGVmdDsgaW5saW5lLXNpemU6IDQzMHB4OyBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkO1wiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAgICAgIiAgfVxuIikuY29uY2F0KAogICAgICAifSkiKQogIAogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLkNvbmZpcm1hdGlvbkNhbGxiYWNrCiAgICApCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KSwKICAgICAgICAgICAgbmV3IGZyLkNvbmZpcm1hdGlvbkNhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuQ29uZmlybWF0aW9uQ2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBjaG9pY2VzLAogICAgICAgICAgICAgICAgZGVmYXVsdENob2ljZQogICAgICAgICAgICApCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgb3V0Y29tZSA9IGNob2ljZXNbY2FsbGJhY2tzLmdldCgyKS5nZXRTZWxlY3RlZEluZGV4KCldOwogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTsKCi8qCkxvY2FsZTogZW5fVVMKYXV0aEluc3RhbnQ6IDIwMjEtMDktMjVUMTc6Mjg6MzhaCk9yZ2FuaXphdGlvbjogbz1hbHBoYSxvdT1zZXJ2aWNlcyxvdT1hbS1jb25maWcKbWFpbDogdm9sa2VyQHNjaGV1YmVyLm5hbWUKUHJpbmNpcGFsczogdm9sa2VyQHNjaGV1YmVyLm5hbWUKVXNlclByb2ZpbGU6IElnbm9yZQpDaGFyU2V0OiBVVEYtOApGdWxsTG9naW5VUkw6IC9hbS9VSS9Mb2dpbj9jb2RlPTQlMkYwQVg0WGZXamlFZmJyZklzdHNGVUtvYWliUENRbVRidVBvbkxmdWhwWWhqZmotTjVRRWU5dTJQNU9zOXdOYWRHYVBzUVZCQSZzY29wZT1lbWFpbCtwcm9maWxlK2h0dHBzJTNBJTJGJTJGd3d3Lmdvb2dsZWFwaXMuY29tJTJGYXV0aCUyRnVzZXJpbmZvLmVtYWlsK2h0dHBzJTNBJTJGJTJGd3d3Lmdvb2dsZWFwaXMuY29tJTJGYXV0aCUyRnVzZXJpbmZvLnByb2ZpbGUrb3BlbmlkJnJlYWxtPSUyRmFscGhhJnN0YXRlPWZ5a3BydGZtZWNscmd3c3ptb212cXhubGlycmVoY3MmaGQ9c2NoZXViZXIubmFtZSZwcm9tcHQ9bm9uZSZhdXRodXNlcj0yCmNsaWVudFR5cGU6IGdlbmVyaWNIVE1MCmdvdG86IC9hbS9YVUkvP3JlYWxtPS9hbHBoYSZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9U2Vzc2lvbkluZm8mRm9yY2VBdXRoPXRydWUjLwpBTUN0eElkOiBkMzE4ODkzOC1kMDdlLTQxMzQtOTVkYi1mMWNjOTdmYzZjNDAtNTAzMjc1CmxvZ2luVVJMOiAvYW0vVUkvTG9naW4Kc246IFNjaGV1YmVyCmFtbGJjb29raWU6IDAxCkhvc3ROYW1lOiA5OS43Mi4yOC4xODIKVXNlclRva2VuOiB2b2xrZXJAc2NoZXViZXIubmFtZQpnaXZlbk5hbWU6IFZvbGtlcgpzdWNjZXNzVVJMOiAvYW0vWFVJLz9yZWFsbT0vYWxwaGEmYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPVNlc3Npb25JbmZvJkZvcmNlQXV0aD10cnVlIy8KU2VydmljZTogUm91dGVyCkhvc3Q6IDk5LjcyLjI4LjE4MgpBdXRoTGV2ZWw6IDAKaWRwOiBnb29nbGUKVXNlcklkOiB2b2xrZXJAc2NoZXViZXIubmFtZQpzdW4uYW0uVW5pdmVyc2FsSWRlbnRpZmllcjogaWQ9dm9sa2VyQHNjaGV1YmVyLm5hbWUsb3U9dXNlcixvPWFscGhhLG91PXNlcnZpY2VzLG91PWFtLWNvbmZpZwpPaWRjU2lkOiBBQ3VUUUlPYmowdGFqUFloTE9qTWxXYzJ1ck0KUHJpbmNpcGFsOiBpZD12b2xrZXJAc2NoZXViZXIubmFtZSxvdT11c2VyLG89YWxwaGEsb3U9c2VydmljZXMsb3U9YW0tY29uZmlnCiAqLw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"988c10fa-98da-4bf7-8ac9-a558d2fef1fd\",\"name\":\"IDP Integrity Check\",\"description\":\"Protection from malicious IDPs. Only allow white-listed email domains (usernames are email addresses).\",\"script\":\"LyogSURQIEludGVncml0eSBDaGVjawogKiAKICogUHJvdGVjdGlvbiBmcm9tIG1hbGljaW91cyBJRFBzLiBPbmx5IGFsbG93IHdoaXRlLWxpc3RlZCBlbWFpbCBkb21haW5zICh1c2VybmFtZXMgYXJlIGVtYWlsIGFkZHJlc3NlcykuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCByZXF1aXJlIGNvZmlndXJhdGlvbi4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCXZhciB2YWxpZERvbWFpbnMgPSBbXTsKICAJaWYgKHJvdXRlZElEUCkgewogICAgICAJdmFsaWREb21haW5zID0gcm91dGVkSURQLmdldCgiaWRwRG9tYWlucyIpOwogICAgfQogIAkKICAJdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpOwogIAl2YXIgZG9tYWluID0gdXNlcm5hbWUuc3Vic3RyKHVzZXJuYW1lLmxhc3RJbmRleE9mKCJAIikrMSk7CiAgCWlmICh2YWxpZERvbWFpbnMuaW5kZXhPZihkb21haW4pID4gLTEpIHsKICAgICAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"89eff37a-2e1e-47c2-8d62-5f7417fbb6b4\",\"name\":\"OTP Invalid\",\"description\":\"Return TextOutputCallback indicating the provided OTP was invalid.\",\"script\":\"LyogT1RQIEludmFsaWQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmV0dXJuIFRleHRPdXRwdXRDYWxsYmFjayBpbmRpY2F0aW5nIHRoZSBwcm92aWRlZCBPVFAgd2FzIGludmFsaWQuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAiSU5WQUxJRCIKICAgICAgICApCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"d2cf4f18-651a-4a3c-9b04-ee4fc896d0c3\",\"name\":\"ST_healthcare-idc-social-transformation\",\"description\":\"Social Identity Provider Profile Transformation for ForgeRock OIDC Providers\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2suIE5vdCBmb3IgcHJvZHVjdGlvbiB1c2UuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICovCi8qIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdCBmb3IgSGVhbHRoY2FyZSBJRCBDbG91ZCAqLwppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKbG9nZ2VyLmVycm9yKCJTVF9oZWFsdGhjYXJlLWlkYy1zb2NpYWwtdHJhbnNmb3JtYXRpb24gSGVhbHRoY2FyZSBJRCBDbG91ZCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdDogU3RhcnQiKTsKCmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uIFByb2ZpbGUgVHJhbnNmb3JtYXRpb24gc2NyaXB0OiBTdGFydCIpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbnk6IGdpdmVuTmFtZSAiICsgcmF3UHJvZmlsZS5naXZlbk5hbWUpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogc246ICIgK3Jhd1Byb2ZpbGUuZmFtaWx5TmFtZSk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBpZDogIiArcmF3UHJvZmlsZS5pZCk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBtYWlsOiAiICsgcmF3UHJvZmlsZS5lbWFpbCk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBjbjogIiArIHJhd1Byb2ZpbGUuZGlzcGxheU5hbWUpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogdXNlck5hbWU6ICIgKyByYXdQcm9maWxlLnVzZXJuYW1lKTsKbG9nZ2VyLmVycm9yKCJTVF9oZWFsdGhjYXJlLWlkYy1zb2NpYWwtdHJhbnNmb3JtYXRpb246IGlkOiAiICsgcmF3UHJvZmlsZS5pZC5hc1N0cmluZygpKTsKLy9sb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogaXBsYW5ldC1hbS11c2VyLWFsaWFzLWxpc3Q6ICIgKyBzZWxlY3RlZElkcCArICctJyArIHJhd1Byb2ZpbGUuaWQuYXNTdHJpbmcoKSApOwovL2xvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBzZWxlY3RlZElkcDogIiArIHNlbGVjdGVkSWRwKTsKaWYgKHJhd1Byb2ZpbGUuZmhpclVzZXIuaXNOb3ROdWxsKCkpIGxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBmaGlyVXNlcjogIiArIHJhd1Byb2ZpbGUuZmhpclVzZXIpOwppZiAocmF3UHJvZmlsZS5JQUwuaXNOb3ROdWxsKCkpIGxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW86IElBTDogIiArIHJhd1Byb2ZpbGUuSUFMKTsKCgoKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJJQUwiLCByYXdQcm9maWxlLklBTCksICAKICAgICAgICBmaWVsZCgidGVsZXBob25lTnVtYmVyIiwgcmF3UHJvZmlsZS5waG9uZV9udW1iZXIpLAogICAgICAgIGZpZWxkKCJmaGlyVXNlciIsIHJhd1Byb2ZpbGUuZmhpclVzZXIpLAogICAgICAgIGZpZWxkKCJ1c2VyVHlwZSIsIHJhd1Byb2ZpbGUudXNlclR5cGUpLAogICAgICAgICkKKQ==\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"743351b3-001a-4ec8-b3ac-a674ddb8de22\",\"name\":\"UOP Enrich Session\",\"description\":\"Enrich user session with UOP class ID.\",\"script\":\"LyogVU9QIEVucmljaCBTZXNzaW9uCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFkZCBjdXJyZW50IGNsYXNzIElEIHRvIHVzZXIgc2Vzc2lvbi4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSBpdCBpcyBiZWluZyBjYWxsZWQuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwpsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBzdGFydCIpOwpvdXRjb21lID0gImZhbHNlIjsKCmlmIChzaGFyZWRTdGF0ZS5nZXQoInVvcEN1cnJlbnRDbGFzc0lEIikpIHsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgICBsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBnb2luZyB0byBlbnJpY2ggc2Vzc2lvbiB3aXRoIGNsYXNzIGlkOiAiLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoInVvcEN1cnJlbnRDbGFzc0lEIikpKTsKICAKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaQogICAgKTsKCiAgICB3aXRoIChmcikgewogICAgICAgIGxvZ2dlci53YXJuaW5nKCJVT1AgRW5yaWNoIFNlc3Npb246IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CiAgICAgICAgYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkucHV0U2Vzc2lvblByb3BlcnR5KCJVT1BDbGFzc0lEIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1b3BDdXJyZW50Q2xhc3NJRCIpKS5idWlsZCgpOwogICAgfQogIAp9IGVsc2UgewogICAgbG9nZ2VyLmVycm9yKCJVT1AgRW5yaWNoIFNlc3Npb246IG5vIGNsYXNzZXMhIik7CiAgICBsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"dedbc9f6-7fc9-4332-a330-55f7aeb95e78\",\"name\":\"FRAAS-7955 Shared State Only\",\"description\":\"FRAAS-7955 Shared State Only\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC1zaGFyZWQiKTsKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXNoYXJlZCIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC1zaGFyZWRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"c827d2b4-3608-4693-868e-bbcf86bd87c7\",\"name\":\"Scripted Module - Client Side\",\"description\":\"Default global script for client side Scripted Authentication Module\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTYtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCi8qIERlZmF1bHQgQXV0aGVudGljYXRpb24gY2xpZW50IHNpZGUgc2NyaXB0IHRvIHVzZSBhcyBhIHRlbXBsYXRlIGZvciBuZXcgc2NyaXB0cyAqLw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_CLIENT_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"e0ba741b-c952-4062-9899-0b1c19237ee4\",\"name\":\"FRAAS-7955 Workaround\",\"description\":\"FRAAS-7955 Workaround: Copy sharedState to transientState\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CmlmIChhdHRycykgewogIAlzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsIGF0dHJzLmdldCgiZ2l2ZW5OYW1lIikuY29uY2F0KCItd29ya2Fyb3VuZCIpKTsKICAJc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsIGF0dHJzLmdldCgic24iKS5jb25jYXQoIi13b3JrYXJvdW5kIikpOwogIAlzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCBhdHRycy5nZXQoIm1haWwiKS5jb25jYXQoIi13b3JrYXJvdW5kIikpOwp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHRyYW5zaWVudCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIHZhciB0cmFuc2llbnRTdG9yYWdlID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAodHJhbnNpZW50U3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHRyYW5zaWVudFN0b3JhZ2UucHV0KSB7CiAgICAgICAgICAgIHRyYW5zaWVudFN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICB0cmFuc2llbnRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"1c0c73e8-2be1-41ce-b042-3c39694346b5\",\"name\":\"Twilio IVR: Verify Unknown Caller\",\"description\":\"Verify unknown caller by account number\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgdmVyaWZpY2F0aW9uIHByb21wdAp2YXIgcHJvbXB0ID0gIlRvIGxvb2t1cCB5b3VyIGFjY291bnQsIHBsZWFzZSBlbnRlciBvciBzYXkgeW91ciBhY2NvdW50IG51bWJlci4iOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dElucHV0Q2FsbGJhY2sKKTsKICAKd2l0aCAoZnIpIHsKICAJaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgaW5wdXQgPSBuZXcgVGV4dElucHV0Q2FsbGJhY2socHJvbXB0KTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChpbnB1dCkuYnVpbGQoKTsKICAJfSAKICAJZWxzZSB7CiAgICAgIAl2YXIgYW5zd2VyID0gbmV3IFN0cmluZyhjYWxsYmFja3MuZ2V0KDApLmdldFRleHQoKSkucmVwbGFjZSgvW14wLTldL2csICIiKTsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyOiBjYWxsYmFja3MgcmVjZWl2ZWQ6IGFuc3dlcj0iLmNvbmNhdChhbnN3ZXIpKTsKICAgICAgCXNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkSW50ZWdlcjUiLCBhbnN3ZXIpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBWZXJpZnkgVW5rbm93biBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHN0b3JhZ2UucHV0KSB7CgkgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"0c189425-e5ea-4062-ae2e-53ea14320bf4\",\"name\":\"Onfido-CheckStatus\",\"description\":\"Check Status\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tTdGF0dXM6IFN0YXJ0Iik7CgovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICoKICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIE9ORklETyBBUEkgVE9LRU4KICovCi8vdmFyIE9ORklET19BUElfVE9LRU4gPSAiYXBpX2xpdmUuU3RVZGZ4ZGlDRmIuWXJ6YmFkeEJfUjItcUc1bEZVYzNsV2c2SkFjM0NucS0iCnZhciBPTkZJRE9fQVBJX1RPS0VOID0gImFwaV9saXZlLkg1eXNSdXNBb21ZLm5iYmtpbW9XYzkxY0RaQVdKWmtKdDBUa3Fkam0xUmpyIjsKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdAopCgp2YXIgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCkKcmVxdWVzdC5zZXRVcmkoImh0dHBzOi8vYXBpLm9uZmlkby5jb20vdjMvY2hlY2tzP2FwcGxpY2FudF9pZD0iICsgU3RyaW5nKHNoYXJlZFN0YXRlLmdldCgib25maWRvQXBwbGljYW50SUQiKSkpOwpyZXF1ZXN0LnNldE1ldGhvZCgiR0VUIikKcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgIlRva2VuIHRva2VuPSIgKyBPTkZJRE9fQVBJX1RPS0VOKQp2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCkKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tTdGF0dXM6IHN0YXR1cyBjaGVjayByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCm91dGNvbWUgPSAicGVuZGluZyI7CgppZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkuZ2V0Q29kZSgpID09PSAyMDApIHsKICAgIHZhciBqc29uID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBpZiAoanNvbi5jaGVja3MubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChqc29uLmNoZWNrc1swXS5zdGF0dXMgPT0gImNvbXBsZXRlIikgewogICAgICAgICAgICBvdXRjb21lID0ganNvbi5jaGVja3NbMF0ucmVzdWx0OwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGpzb24uY2hlY2tzWzBdLnJlcG9ydF9pZHMubGVuZ3RoOyBpKyspIHsKCiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCkKICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0VXJpKCJodHRwczovL2FwaS5vbmZpZG8uY29tL3YzL3JlcG9ydHMvIiArIFN0cmluZyhqc29uLmNoZWNrc1swXS5yZXBvcnRfaWRzW2ldKSk7CiAgICAgICAgICAgICAgICByZXF1ZXN0LnNldE1ldGhvZCgiR0VUIikKICAgICAgICAgICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQXV0aG9yaXphdGlvbiIsICJUb2tlbiB0b2tlbj0iICsgT05GSURPX0FQSV9UT0tFTikKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpCiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIk9uZmlkby1DaGVja1N0YXR1czogZ2V0IHJlcG9ydCByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgICAgICAgICBpZiAocmVwb3J0Lm5hbWUgPT0gImRvY3VtZW50IikgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXBvcnQucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiZmlyc3RfbmFtZSIpKSBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsIHRpdGxlQ2FzZShyZXBvcnQucHJvcGVydGllcy5maXJzdF9uYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcG9ydC5wcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KCJsYXN0X25hbWUiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsIHRpdGxlQ2FzZShyZXBvcnQucHJvcGVydGllcy5sYXN0X25hbWUpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkoImRhdGVfb2ZfYmlydGgiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmcyIiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmRhdGVfb2ZfYmlydGgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzEiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJwb3N0YWxBZGRyZXNzIiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uYWRkcmVzc19saW5lXzEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzMiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJjaXR5IiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uYWRkcmVzc19saW5lXzMpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzUiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzdGF0ZVByb3ZpbmNlIiwgcmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5hZGRyZXNzX2xpbmVfNSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uaGFzT3duUHJvcGVydHkoImFkZHJlc3NfbGluZV80IikpIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgicG9zdGFsQ29kZSIsIGZvcm1hdE9uZmlkb1ppcENvZGUocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5hZGRyZXNzX2xpbmVfNCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXBvcnQucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiaXNzdWluZ19jb3VudHJ5IikpIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiY291bnRyeSIsIHJlcG9ydC5wcm9wZXJ0aWVzLmlzc3VpbmdfY291bnRyeSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0gZWxzZSBvdXRjb21lID0gImVycm9yIjsKCnNoYXJlZFN0YXRlLnB1dCgib25GaWRvT3V0Y29tZSIsIG91dGNvbWUpOwpsb2dnZXIuZXJyb3IoIk9uZmlkby1DaGVja1N0YXR1czogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTsKCi8qCiAqIE91dHB1dCBzdHIgaW4gdGl0bGUgY2FzZQogKiAKICogZS5nLjogJ0FMTCBVUFBFUkNBU0UgQU5EIGFsbCBsb3dlcmNhc2UnID0gJ0FsbCBVcHBlcmNhc2UgQW5kIEFsbCBMb3dlcmNhc2UnCiAqLwpmdW5jdGlvbiB0aXRsZUNhc2UoaW5wdXQpIHsKICAgIHZhciBzdHIgPSBpbnB1dC50b1N0cmluZygpOwogICAgdmFyIHNwbGl0U3RyID0gc3RyLnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXRTdHIubGVuZ3RoOyBpKyspIHsKICAgICAgICBzcGxpdFN0cltpXSA9IHNwbGl0U3RyW2ldLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3BsaXRTdHJbaV0uc2xpY2UoMSkKICAgIH0KICAgIHJldHVybiBzcGxpdFN0ci5qb2luKCcgJyk7IAp9CgovKgogKiBGb3JtYXQgWklQIGNvZGUgZnJvbSBPbmZpZG8gaWRlbnRpdHkgcHJvb2Zpbmcgb3V0cHV0CiAqIAogKiBlLmcuOiA3ODYyNjAwMDAgPSA3ODYyNgogKiAgICAgICA3ODYyNjEyMzQgPSA3ODYyNi0xMjM0CiAqLwpmdW5jdGlvbiBmb3JtYXRPbmZpZG9aaXBDb2RlKHN0cikgewogIGlmIChzdHIuc3Vic3RyaW5nKDUpID09ICIwMDAwIikgewogICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCw1KQogIH0KICBlbHNlIHsKICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsNSkgKyAiLSIgKyBzdHIuc3Vic3RyaW5nKDUpOwogIH0KfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0},{\"_id\":\"8508a00e-ad45-4310-b3c7-c6871b6a41a9\",\"name\":\"Browser Language Decision\",\"description\":\"Browser Language Decision\",\"script\":\"LyogQnJvd3NlciBMYW5ndWFnZSBEZWNpc2lvbgogKiAKICogRGV0ZWN0IHRoZSBicm93c2VyIGxhbmd1YWdlIGluIHRoZSByZXF1ZXN0IGFuZCBicmFuY2ggb3V0IHRvIGl0cyBuYW1lZCBleGl0IChlLmcuOiAiZGUiIG9yICJlbiIgb3IgImZyIikgCiAqIGlmIGl0IGlzIHBhcnQgb2YgdGhlIHN1cHBvcnRlZExhbmd1YWdlcyBhcnJheSwgb3RoZXJ3aXNlIHRha2UgdGhlICJvdGhlciIgZXhpdC4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gb3RoZXIKICogLSA8YWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgc3VwcG9ydGVkTGFuZ3VhZ2VzIGFycmF5PgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAkvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogIAkvKiBCZWdpbiBTY3JpcHQgQ29uZmlndXJhdGlvbiAqLwogIAkKICAJLy8gYWRkIGFsbCB0aGUgbGFuZ3VhZ2UgY29kZXMgeW91IHdhbnQgdG8gc3VwcG9ydAogIAl2YXIgc3VwcG9ydGVkTGFuZ3VhZ2VzID0gWyJkZSIsImVuIiwiZnIiXTsKICAJCiAgCS8qIEVuZCBTY3JpcHQgQ29uZmlndXJhdGlvbiAgICovCiAgCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgCiAgCW91dGNvbWUgPSBnZXRCcm93c2VyTGFuZ3VhZ2UoKTsKICAJCiAgICAvKgogICAgICogUmV0dXJucyB0aGUgc3VwcG9ydGVkIGJyb3dzZXIgbGFuZ3VhZ2Ugb3IgIm90aGVyIgogICAgICovCiAgICBmdW5jdGlvbiBnZXRCcm93c2VyTGFuZ3VhZ2UoKSB7CiAgICAgIAl2YXIgbGFuZ3VhZ2VIZWFkZXIgPSBnZXRIZWFkZXIoImFjY2VwdC1sYW5ndWFnZSIpOwogICAgICAJdmFyIGxhbmd1YWdlID0gbGFuZ3VhZ2VIZWFkZXIuc3BsaXQoJzsnKVswXS5zcGxpdCgnLCcpWzBdLnNwbGl0KCctJylbMF07CiAgICAgIAlpZiAoc3VwcG9ydGVkTGFuZ3VhZ2VzLmluZGV4T2YobGFuZ3VhZ2UpIDwgMCkgewogICAgICAgICAgCXJldHVybiAib3RoZXIiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGFuZ3VhZ2U7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkrIiI7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":185,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.580Z",
        "time": 83,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 83
        }
      },
      {
        "_id": "99d259eb57c25d01ede5cf21815c8741",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 593,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Authentication Tree Decision Node Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Authentication%20Tree%20Decision%20Node%20Script%22"
        },
        "response": {
          "bodySize": 734,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 734,
            "text": "{\"result\":[{\"_id\":\"01e1a3c0-038b-4c16-956a-6c9d89328cff\",\"name\":\"Authentication Tree Decision Node Script\",\"description\":\"Default global script for a scripted decision node\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "734"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.671Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "34e5e6ef63aa85a907030486a0a2e1b1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Read custom IDM attributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Read%20custom%20IDM%20attributes%22"
        },
        "response": {
          "bodySize": 1586,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1586,
            "text": "{\"result\":[{\"_id\":\"5511f576-6cbd-4f4d-8d80-40f294da98a5\",\"name\":\"Read custom IDM attributes\",\"description\":\"Read custom IDM attributes and put in shared state.\",\"script\":\"LyogUmVhZCBjdXN0b20gSURNIGF0dHJpYnV0ZXMKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmVhZCBjdXN0b20gSURNIGF0dHJpYnV0ZXMgYW5kIHB1dCBpbiBzaGFyZWQgc3RhdGUKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGVycm9yCiAqLwooZnVuY3Rpb24gKCkgewogIHRyeSB7CiAgCW91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgYXR0cmlidXRlID0gJ2ZyLWlkbS1jdXN0b20tYXR0cnMnOwogICAgdmFyIHVzZXJuYW1lID0gbm9kZVN0YXRlLmdldCgnX2lkJykuYXNTdHJpbmcoKTsKICAgIHZhciBjdXN0b21BdHRycyA9IEpTT04ucGFyc2UoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS5pdGVyYXRvcigpLm5leHQoKSk7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdjdXN0b21fZGVwYXJ0bWVudCcsIGN1c3RvbUF0dHJzWydjdXN0b21fZGVwYXJ0bWVudCddKTsKICAgIG5vZGVTdGF0ZS5wdXRTaGFyZWQoJ2N1c3RvbScsIGN1c3RvbUF0dHJzKTsKICB9IGNhdGNoIChlcnJvcikgewogIAlvdXRjb21lID0gJ2Vycm9yJzsKICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdmFsaWRhdGluZyBPVFAgZnJvbSBVUkw6ICcgKyBlcnJvcik7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdlcnJvcicsIGVycm9yLm1lc3NhZ2UpOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1586"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.712Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "3aaa0745fd9f1c229c13f99e0a9cfb07",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Populate UserName as User+Company\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Populate%20UserName%20as%20User%2BCompany%22"
        },
        "response": {
          "bodySize": 1072,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1072,
            "text": "{\"result\":[{\"_id\":\"2dc3997b-a3f9-42c6-b00a-f89faf59b538\",\"name\":\"Populate UserName as User+Company\",\"description\":\"This script creates username as prior userName+CompanyName\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJmclVuaW5kZXhlZFN0cmluZzEiKQpjb21wYW55ID0gb2JqZWN0QXR0cmlidXRlcy5nZXQoImZySW5kZXhlZFN0cmluZzQiKQp2YXIgcmVzdWx0ID0gdXNlck5hbWUuY29uY2F0KGNvbXBhbnkpLnRvTG93ZXJDYXNlKCk7Cgpsb2dnZXIuZXJyb3IoInJlc3VsdCA9ICIgKyByZXN1bHQpOwoKLy9vYmplY3RBdHRyaWJ1dGVzLnB1dCgidXNlck5hbWUiLCByZXN1bHQpCm9iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIscmVzdWx0KQpzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIixyZXN1bHQpCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3RBdHRyaWJ1dGVzKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1072"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.755Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "36cf1b4232865b8ec590209687e762ee",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 593,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Alpha endUserUIClient OIDC Claims Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Alpha%20endUserUIClient%20OIDC%20Claims%20Script%22"
        },
        "response": {
          "bodySize": 41534,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 41534,
            "text": "{\"result\":[{\"_id\":\"e1db8a0a-0329-4962-a5bf-ecffaca376ae\",\"name\":\"Alpha endUserUIClient OIDC Claims Script\",\"description\":\"Used by endUserUIClient\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.799Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "5bc330e461a976c48928c31c793a5f6c",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 608,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Impersonate: Extract Actors And Become Impersonator\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Impersonate%3A%20Extract%20Actors%20And%20Become%20Impersonator%22"
        },
        "response": {
          "bodySize": 3043,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3043,
            "text": "{\"result\":[{\"_id\":\"d6f3befb-c73a-437e-b02a-66d9b4c93f8b\",\"name\":\"Impersonate: Extract Actors And Become Impersonator\",\"description\":\"Extract impersonatee and impersonator from headers and become impersonator.\",\"script\":\"LyogSW1wZXJzb25hdGU6IEV4dHJhY3QgQWN0b3JzIEFuZCBCZWNvbWUgSW1wZXJzb25hdG9yCiAqCiAqIEV4dHJhY3QgaW1wZXJzb25hdGVlIGFuZCBpbXBlcnNvbmF0b3IgZnJvbSBoZWFkZXJzIGFuZCBiZWNvbWUgaW1wZXJzb25hdGVlLgogKgogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwoKKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogRXh0cmFjdCBBY3RvcnM6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gImZhbHNlIjsKCiAgICAvKgogICAgICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwogICAgdmFyIElNUEVSU09OQVRFRV9IRUFERVJfTkFNRSA9ICJYLUltcGVyc29uYXRlZSI7CiAgICB2YXIgSU1QRVJTT05BVE9SX0hFQURFUl9OQU1FID0gIlgtSW1wZXJzb25hdG9yIjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwoKICAgIHZhciBpbXBlcnNvbmF0ZWUgPSBnZXRIZWFkZXIoSU1QRVJTT05BVEVFX0hFQURFUl9OQU1FKTsKICAgIHZhciBpbXBlcnNvbmF0b3IgPSBnZXRIZWFkZXIoSU1QRVJTT05BVE9SX0hFQURFUl9OQU1FKTsKICAgIGlmIChpbXBlcnNvbmF0ZWUgJiYgaW1wZXJzb25hdG9yKSB7CiAgICAgICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoImltcGVyc29uYXRlZSIsIGltcGVyc29uYXRlZSk7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJpbXBlcnNvbmF0b3IiLCBpbXBlcnNvbmF0b3IpOwogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBpbXBlcnNvbmF0b3IpOwogICAgICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBpbXBlcnNvbmF0b3IpOwogICAgfQoKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogRXh0cmFjdCBBY3RvcnM6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKSAmJiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApKSB7CiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qCiAgICAgKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgICAgICB9CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3043"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.841Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "48e450f1eae1084d9d04c569398d3285",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 570,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"CopyOTPToObjectAttributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22CopyOTPToObjectAttributes%22"
        },
        "response": {
          "bodySize": 1380,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1380,
            "text": "{\"result\":[{\"_id\":\"5561a45f-bf00-4ec5-bab4-f069bac9a38b\",\"name\":\"CopyOTPToObjectAttributes\",\"description\":\"Copy an OTP generated by the \\\"HOTP Generator\\\" node to the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyogQ29weU9UUFRvT2JqZWN0QXR0cmlidXRlcwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDb3B5IGFuIE9UUCBnZW5lcmF0ZWQgYnkgdGhlICJIT1RQIEdlbmVyYXRvciIgbm9kZSB0byB0aGUgSURNIHByb2ZpbGUgCiAqIHNoYXJlZCBzdGF0ZSBzbyBpdCBjYW4gYmUgcGF0Y2hlZCB0byB0aGUgdXNlciBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwppZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKCXNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dCgiZGVzY3JpcHRpb24iLCBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKQp9CmVsc2UgewoJc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwge2Rlc2NyaXB0aW9uOiBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpfSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1380"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.880Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "49cce7e952c225d2be71865e220f88cb",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"shared State Printer\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22shared%20State%20Printer%22"
        },
        "response": {
          "bodySize": 945,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 945,
            "text": "{\"result\":[{\"_id\":\"b6fce769-cf21-4963-a8dc-7c5370a4d15b\",\"name\":\"shared State Printer\",\"description\":\"null\",\"script\":\"dmFyIGZyID0gSmF2YUltcG9ydGVyKAogIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKTsKb3V0Y29tZSA9ICJ0cnVlIjsKd2l0aCAoZnIpIHsKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgdmFyIGNhbGxiYWNrID0gbmV3IFRleHRPdXRwdXRDYWxsYmFjayhUZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sICJzaGFyZWRTdGF0ZTogIi5jb25jYXQoc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkpOwogICAgYWN0aW9uID0gQWN0aW9uLnNlbmQoY2FsbGJhY2spLmJ1aWxkKCk7CiAgfSBlbHNlIHsKICAgIGFjdGlvbiA9IEFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "945"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.922Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "253aa63b5dd36ea908bac9c71bbb380a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Return OTP\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Return%20OTP%22"
        },
        "response": {
          "bodySize": 1386,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1386,
            "text": "{\"result\":[{\"_id\":\"d3405f9c-d338-4dc2-b00d-7aacf77b731d\",\"name\":\"Return OTP\",\"description\":\"Return the generated OTP using a TextOutputCallback\",\"script\":\"LyogUmV0dXJuIE9UUAogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBSZXR1cm4gdGhlIGdlbmVyYXRlZCBPVFAgdXNpbmcgYSBUZXh0T3V0cHV0Q2FsbGJhY2suCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBub2RlU3RhdGUuZ2V0KCJvbmVUaW1lUGFzc3dvcmQiKS5hc1N0cmluZygpCiAgICAgICAgKQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1386"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:26.965Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "e482fd1f278f436dbe677382a0413eef",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 553,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Launcher\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Launcher%22"
        },
        "response": {
          "bodySize": 9576,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 9576,
            "text": "{\"result\":[{\"_id\":\"3b81d8e6-55f3-4937-bbbb-d62233cc6a0f\",\"name\":\"Launcher\",\"description\":\"Display launch panel with journeys.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPHA+QXV0aGVudGljYXRpb24vUmVnaXN0cmF0aW9uL01GQTwvcD4gXAogICAgICAgICAgICAgICAgICAgPHVsIHN0eWxlPVwidGV4dC1hbGlnbjpsZWZ0O1wiPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1JvdXRlclwiPklEUCBEaXNjb3Zlcnk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9BQS1SZWdpc3RyYXRpb25cIj5SZWdpc3RyYXRpb248L2E+ICg8YSBocmVmPVwiIy9zZXJ2aWNlL1JlZ2lzdHJhdGlvblwiPmNsYXNzaWM8L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvQUEtTG9naW5cIj5BdXRoZW50aWNhdGlvbjwvYT4gKDxhIGhyZWY9XCIjL3NlcnZpY2UvTG9naW5cIj5jbGFzc2ljPC9hPik8L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1Bhc3N3b3JkQnJlYWNoRGV0ZWN0aW9uXCI+UGFzc3dvcmQgQnJlYWNoIERldGVjdGlvbjwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiIy9zZXJ2aWNlL1dlYkF1dGhOXCI+RmlkbzwvYT4gKDxhIGhyZWY9XCIjL3NlcnZpY2UvV2ViQXV0aE5SZWdpc3RyYXRpb25cIj5SZWdpc3RyYXRpb248L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvUHVzaFwiPlB1c2g8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9SZXNldFBhc3N3b3JkXCI+Rm9yZ290IFBhc3N3b3JkPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvRm9yZ290dGVuVXNlcm5hbWVcIj5Gb3Jnb3QgVXNlcm5hbWU8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cImh0dHBzOi8vaWRjLnNjaGV1YmVyLmlvL2xvZ2luP2F1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1BenVyZVwiPkF6dXJlIChTUC1pbml0KTwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiaHR0cHM6Ly9pZGMuc2NoZXViZXIuaW8vbG9naW4/YXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUFERlNPSURDXCI+QURGUyAoT0lEQyk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgPC91bD4gXAogICAgICAgICAgICAgICAgICAgPHA+QXBwbGljYXRpb25zPC9wPiBcCiAgICAgICAgICAgICAgICAgICA8dWwgc3R5bGU9XCJ0ZXh0LWFsaWduOmxlZnQ7XCI+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaWcvc3R1ZGlvL1wiPklkZW50aXR5IEdhdGV3YXkgRGV2ZWxvcGVyIFN0dWRpbzwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2dyYWZhbmFcIj5HcmFmYW5hPC9hPiAoPGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9wcm9tZXRoZXVzXCI+UHJvbWV0aGV1czwvYT4pPC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9leHBhbnNlXCI+VGhlIEV4cGFuc2UgRmFuIFBhZ2U8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+SWRlbnRpdHkgR2F0ZXdheSBcCiAgICAJCQkJCTx1bD4gXAogICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5TYW1wbGUgQXBwIDxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaWctc2FtcGxlLWFwcC9sb2dpblwiPlJlcGxheTwvYT4gKDxhIGhyZWY9XCJodHRwczovL2lkYy5zY2hldWJlci5pby9sb2dpbj9hdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9UmVzZXRSZXBsYXlDcmVkZW50aWFscyZGb3JjZUF1dGg9dHJ1ZVwiPnJlc2V0PC9hPil8PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9pZy1tYW51YWwtYXBwL2xvZ2luXCI+TWFudWFsPC9hPiAoPGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9pZy1tYW51YWwtYXBwL2xvZ291dFwiPmxvZ291dDwvYT4pPGJyPkNyZWRlbnRpYWxzOiA8Y29kZT5kZW1vPC9jb2RlPi88Y29kZT5DaDRuZzMxdDwvY29kZT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPkF1dGhaOiA8YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2Zvcmdlcm9jay9hcHAxL1wiPmFwcDE8L2E+IChwdWIpfDxhIGhyZWY9XCJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vZm9yZ2Vyb2NrL2FwcDIvXCI+YXBwMjwvYT4gKHNzbyl8PGEgaHJlZj1cImh0dHBzOi8vaWcubXl0ZXN0cnVuLmNvbS9mb3JnZXJvY2svYXBwMy9cIj5hcHAzPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9pZy5teXRlc3RydW4uY29tL2Zvcmdlcm9jay9wYXkvXCI+cGF5PC9hPiAodHgpPGJyPlBvbGljeSBTZXQ6IDxjb2RlPmFwcHM8L2NvZGU+PC9saT4gXAoJCQkJCQk8L3VsPiBcCiAgCQkJCQkgPC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+V2ViIEFnZW50IFwKICAgIAkJCQkJPHVsPiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPkF1dGhaOiA8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMS9cIj5hcHAxPC9hPiAocHViKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMi9cIj5hcHAyPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vYXBwMy9cIj5hcHAzPC9hPiAoc3NvKXw8YSBocmVmPVwiaHR0cHM6Ly9hcHBzLm15dGVzdHJ1bi5jb20vcGF5L1wiPnBheTwvYT4gKHR4KTxicj5Qb2xpY3kgU2V0OiA8Y29kZT5hcHBzPC9jb2RlPjwvbGk+IFwKCQkJCQkJPC91bD4gXAogIAkJCQkJIDwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IFwKICAgICAgICAgICAgICAgICAgIDxwPkR5bmFtaWMgQnJhbmRpbmcgKFRoZW1lcyk8L3A+IFwKICAgICAgICAgICAgICAgICAgIDx1bCBzdHlsZT1cInRleHQtYWxpZ246bGVmdDtcIj4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9UaGVtZUJ5TGFuZ3VhZ2VcIj5DaGFuZ2UgdGhlbWUgYmFzZWQgb24gdXNlcnMgbGFuZ3VhZ2U8L2E+ICg8YSBocmVmPVwiIy9zZXJ2aWNlL1RoZW1lQnlMYW5ndWFnZU11bHRpXCI+bXVsdGk8L2E+KTwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvVGhlbWVCeVByb2ZpbGVEYXRhXCI+Q2hhbmdlIHRoZW1lIHRvIGV4cG9zZSBhIG5ldyBmZWF0dXJlIChlYXJseSBhZG9wdGVycyk8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9Sb3V0ZXJcIj5DaGFuZ2UgYnJhbmQgYmFzZWQgb24gdXNlcnMgbWVtYmVyc2hpcCBvZiBhbiBvcmdhbml6YXRpb248L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiMvc2VydmljZS9UaGVtZUJ5UHJlZmVyZW5jZVwiPkNoYW5nZSBMb29rIGFuZCBmZWVsIGJhc2VkIG9uIHVzZXIgYWNjZXNzaWJpbGl0eSBwcm9wZXJ0aWVzPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjL3NlcnZpY2UvVGhlbWVkTUZBTG9naW5cIj5DaGFuZ2UgbG9vayBhbmQgZmVlbCBiYXNlZCBzdGVwIHVwIEF1dGhlbnRpY2F0aW9uPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IFwKICAgICAgICAgICAgICAgICAgIDxwPlNlbGVjdCBUaGVtZTwvcD4gXAogICAgICAgICAgICAgICAgICAgPHVsIHN0eWxlPVwidGV4dC1hbGlnbjpsZWZ0O1wiPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiP3RoZW1lSWQ9RXhwYW5zZSMvc2VydmljZS9MYXVuY2hlclwiPkV4cGFuc2U8L2E+PC9saT4gXAogICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1GT1JHIy9zZXJ2aWNlL0xhdW5jaGVyXCI+Rk9SRzwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiP3JlYWxtPS9hbHBoYSZ0aGVtZUlkPUhpZ2hsYW5kZXIjL3NlcnZpY2UvTGF1bmNoZXJcIj5IaWdobGFuZGVyPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9Um9icm95Iy9zZXJ2aWNlL0xhdW5jaGVyXCI+Um9icm95PC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9WmFyZG96Iy9zZXJ2aWNlL0xhdW5jaGVyXCI+WmFyZG96PC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCI/cmVhbG09L2FscGhhJnRoZW1lSWQ9d29vbG1hcmsjL3NlcnZpY2UvTGF1bmNoZXJcIj53b29sbWFyazwvYT48L2xpPiBcCiAgICAgICAgICAgICAgICAgICAgIDxsaT5PdGhlcjogPGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1BUyMvc2VydmljZS9MYXVuY2hlclwiPkFTPC9hPiwgPGEgaHJlZj1cIj9yZWFsbT0vYWxwaGEmdGhlbWVJZD1GWCMvc2VydmljZS9MYXVuY2hlclwiPkZYPC9hPjwvbGk+IFwKICAgICAgICAgICAgICAgICAgIDwvdWw+IjsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAgICAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICAgICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICAgICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5zdHlsZSA9IFwidGV4dC1hbGlnbjogbGVmdDsgaW5saW5lLXNpemU6IDQzMHB4OyBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkO1wiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAgICAgIiAgfVxuIikuY29uY2F0KAogICAgICAifSkiKQogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIGFuY2hvcgogICAgICAgICAgICApLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCkKICAgIH0KICAgIGVsc2UgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.003Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "91ace92f5115d94b26cb380ff635ab0f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 618,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Alpha endUserUIClient OAuth2 Access Token Modification Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Alpha%20endUserUIClient%20OAuth2%20Access%20Token%20Modification%20Script%22"
        },
        "response": {
          "bodySize": 940,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 940,
            "text": "{\"result\":[{\"_id\":\"e232cff3-2460-47cd-80b2-36c86c0d0f06\",\"name\":\"Alpha endUserUIClient OAuth2 Access Token Modification Script\",\"description\":\"Used by endUserUIClient\",\"script\":\"KGZ1bmN0aW9uICgpIHsKICBpZiAoc2NvcGVzLmNvbnRhaW5zKCdmcjphdXRvYWNjZXNzOionKSkgewogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICBjb20uc3VuLmlkZW50aXR5LmlkbS5JZFR5cGUKICAgICk7CiAgICB2YXIgZ3JvdXBzID0gW107CiAgICBpZGVudGl0eS5nZXRNZW1iZXJzaGlwcyhmci5JZFR5cGUuR1JPVVApLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkgewogICAgICBncm91cHMucHVzaChncm91cC5nZXRBdHRyaWJ1dGUoJ2NuJykudG9BcnJheSgpWzBdKTsKICAgIH0pOwogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ2dyb3VwcycsIGdyb3Vwcyk7CiAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "940"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.043Z",
        "time": 42,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 42
        }
      },
      {
        "_id": "a8164adca1e0bf44ebac017fc5d0f3eb",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FrodoTestScript2\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FrodoTestScript2%22"
        },
        "response": {
          "bodySize": 1106,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1106,
            "text": "{\"result\":[{\"_id\":\"b7259916-71ed-4675-8c5a-de86a80e4aed\",\"name\":\"FrodoTestScript2\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1106"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.091Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "1b753a98974453ac7ed3788e5e3938e3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 590,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display Username (frUnindexedString1)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20Username%20%28frUnindexedString1%29%22"
        },
        "response": {
          "bodySize": 3011,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3011,
            "text": "{\"result\":[{\"_id\":\"051624d8-ce33-4e49-a4e5-e3ba7e7a9b22\",\"name\":\"Display Username (frUnindexedString1)\",\"description\":\"Display Username (frUnindexedString1)\",\"script\":\"LyoKICogQmVnaW4gY29uZmlndXJhdGlvbgogKgogKiBNb2RpZnkgdGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgdG8gYWRhcHQgdG8geW91ciBuZWVkcwogKi8KCi8vIFNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheS4gWW91IG1heSB1c2UgSFRNTCBmb3IgZm9ybWF0dGluZy4gQXZvaWQgbGluZSBicmVha3MhIFVzZSA8YnI+IGluc3RlYWQuCnZhciBtZXNzYWdlID0gIjxoNT4iLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoImZyVW5pbmRleGVkU3RyaW5nMSIpKS5jb25jYXQoIjwvaDU+IikKCi8vIENob29zZSB0aGUgaG9yaXpvbnRhbCBhbGlnbm1lbnQgb2YgeW91ciBtZXNzYWdlLiBVc2UgbGVmdCwgY2VudGVyLCByaWdodC4KdmFyIGhhbGlnbiA9ICJsZWZ0IjsKLyoKICogRW5kIGNvbmZpZ3VyYXRpb24KICovCgp2YXIgYW5jaG9yID0gImFuY2hvci0iLmNvbmNhdChnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4JykpOwp2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICIgIH1cbiIpLmNvbmNhdCgKICAifSkiKQp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgKSwKICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3011"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.132Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "8fed64e04407bbd842030f4d52b6a67e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 576,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Yahoo Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Yahoo%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1637,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1637,
            "text": "{\"result\":[{\"_id\":\"424da748-82cc-4b54-be6f-82bd64d82a74\",\"name\":\"Yahoo Profile Normalization\",\"description\":\"Normalizes raw profile data from Yahoo\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImxvY2FsZSIsIHJhd1Byb2ZpbGUubG9jYWxlKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1637"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.172Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "691b80bd27542e88e8f141f161b19591",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 608,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Send Registration Information Via SMS\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Send%20Registration%20Information%20Via%20SMS%22"
        },
        "response": {
          "bodySize": 7487,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7487,
            "text": "{\"result\":[{\"_id\":\"3fff65f0-b3fe-40c5-8e82-b6d2e39a14e5\",\"name\":\"Twilio IVR: Send Registration Information Via SMS\",\"description\":\"Send registration information via SMS\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IHN0YXJ0Iik7CgppZiAoZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKSkgewogICAgdmFyIEJhc2U2ND17X2tleVN0cjoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iLGVuY29kZTpmdW5jdGlvbihpbnB1dCl7dmFyIG91dHB1dD0iIjt2YXIgY2hyMSxjaHIyLGNocjMsZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PUJhc2U2NC5fdXRmOF9lbmNvZGUoaW5wdXQpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtjaHIxPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIyPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIzPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtlbmMxPWNocjE+PjI7ZW5jMj0oY2hyMSYzKTw8NHxjaHIyPj40O2VuYzM9KGNocjImMTUpPDwyfGNocjM+PjY7ZW5jND1jaHIzJjYzO2lmKGlzTmFOKGNocjIpKXtlbmMzPWVuYzQ9NjR9ZWxzZSBpZihpc05hTihjaHIzKSl7ZW5jND02NH1vdXRwdXQ9b3V0cHV0K3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMSkrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMyKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzMpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jNCl9cmV0dXJuIG91dHB1dH0sZGVjb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMzt2YXIgZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PWlucHV0LnJlcGxhY2UoL1teQS1aYS16MC05XCtcL1w9XS9nLCIiKTt3aGlsZShpPGlucHV0Lmxlbmd0aCl7ZW5jMT10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMj10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMz10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jND10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7Y2hyMT1lbmMxPDwyfGVuYzI+PjQ7Y2hyMj0oZW5jMiYxNSk8PDR8ZW5jMz4+MjtjaHIzPShlbmMzJjMpPDw2fGVuYzQ7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjEpO2lmKGVuYzMhPTY0KXtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMil9aWYoZW5jNCE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKX19b3V0cHV0PUJhc2U2NC5fdXRmOF9kZWNvZGUob3V0cHV0KTtyZXR1cm4gb3V0cHV0fSxfdXRmOF9lbmNvZGU6ZnVuY3Rpb24oc3RyaW5nKXtzdHJpbmc9c3RyaW5nLnJlcGxhY2UoL1xyXG4vZywiXG4iKTt2YXIgdXRmdGV4dD0iIjtmb3IodmFyIG49MDtuPHN0cmluZy5sZW5ndGg7bisrKXt2YXIgYz1zdHJpbmcuY2hhckNvZGVBdChuKTtpZihjPDEyOCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjKX1lbHNlIGlmKGM+MTI3JiZjPDIwNDgpe3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NnwxOTIpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfWVsc2V7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj4xMnwyMjQpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NiY2M3wxMjgpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfX1yZXR1cm4gdXRmdGV4dH0sX3V0ZjhfZGVjb2RlOmZ1bmN0aW9uKHV0ZnRleHQpe3ZhciBzdHJpbmc9IiI7dmFyIGk9MDt2YXIgYz1jMT1jMj0wO3doaWxlKGk8dXRmdGV4dC5sZW5ndGgpe2M9dXRmdGV4dC5jaGFyQ29kZUF0KGkpO2lmKGM8MTI4KXtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyk7aSsrfWVsc2UgaWYoYz4xOTEmJmM8MjI0KXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMzEpPDw2fGMyJjYzKTtpKz0yfWVsc2V7YzI9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMSk7YzM9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMik7c3RyaW5nKz1TdHJpbmcuZnJvbUNoYXJDb2RlKChjJjE1KTw8MTJ8KGMyJjYzKTw8NnxjMyY2Myk7aSs9M319cmV0dXJuIHN0cmluZ319OwoKICAgIC8vIFR3aWxpbyBTTVMgTWVzc2FnZSBBUEkgQ29uZmlndXJhdGlvbgogICAgdmFyIFRXSUxJT19BUElfU0lEID0gIkFDNTQ5Zjc0ZTUxNWY3MzExMDk3M2RiNDMxZmMxYjE0NzQiOwogICAgdmFyIFRXSUxJT19BUElfVE9LRU4gPSAiOTM4OGZmMDdmMjVkZGQ3MzBjMzI3MDdjM2Q3OWY5NDIiOwogICAgdmFyIFRXSUxJT19BUElfRlJPTSA9ICIrMTkxNjMxODM0MzgiOwogIAogICAgdmFyIFRXSUxJT19BUElfVVJJID0gImh0dHBzOi8vYXBpLnR3aWxpby5jb20vMjAxMC0wNC0wMS9BY2NvdW50cy8iLmNvbmNhdChUV0lMSU9fQVBJX1NJRCkuY29uY2F0KCIvTWVzc2FnZXMuanNvbiIpOwkKICAgIHZhciBUV0lMSU9fQVBJX1RPID0gZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKTsKICAgIHZhciBUV0lMSU9fQVBJX0JPRFkgPSAiUmVnaXN0ZXIgeW91ciBhY2NvdW50IHdpdGggRm9yZ2VSb2NrIElkZW50aXR5IENsb3VkOiAiLmNvbmNhdCgiaHR0cHM6Ly9pZGMuc2NoZXViZXIuaW8vbG9naW4vP3JlYWxtPS9hbHBoYSMvc2VydmljZS9SZWdpc3RyYXRpb24iKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IFRvOiAiLmNvbmNhdChUV0lMSU9fQVBJX1RPKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBNZXNzYWdlOiAiLmNvbmNhdChUV0lMSU9fQVBJX0JPRFkpKTsKCiAgICB2YXIgQVVUSFogPSAiQmFzaWMgIi5jb25jYXQoQmFzZTY0LmVuY29kZShUV0lMSU9fQVBJX1NJRC5jb25jYXQoJzonKS5jb25jYXQoVFdJTElPX0FQSV9UT0tFTikpKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJCb2R5IiwgVFdJTElPX0FQSV9CT0RZKTsKICAgIHBhcmFtcy5hZGQoIlRvIiwgVFdJTElPX0FQSV9UTyk7CiAgICByZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhwYXJhbXMudG9TdHJpbmcoKSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgIGlmIChyZXN1bHRbImVycm9yX2NvZGUiXSkgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IGVycm9yX2NvZGUgPSAiLmNvbmNhdChyZXN1bHRbImVycm9yX2NvZGUiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogZXJyb3JfbWVzc2FnZSA9ICIuY29uY2F0KHJlc3VsdFsiZXJyb3JfbWVzc2FnZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBvdXRjb21lID0gZmFpbGVkIik7CiAgICB9IGVsc2UgaWYgKHJlc3VsdFsiY29kZSJdKSB7CiAgICAgICAgb3V0Y29tZSA9ICJmYWlsZWQiOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gSVZSOiBTZW5kIFJlZ2lzdHJhdGlvbiBJbmZvcm1hdGlvbiBWaWEgU01TOiBtZXNzYWdlID0gIi5jb25jYXQocmVzdWx0WyJtZXNzYWdlIl0pKTsKICAgIH0gZWxzZSB7CiAgICAgICAgb3V0Y29tZSA9ICJzZW50IjsKICAgICAgICBsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogb3V0Y29tZSA9IHNlbnQiKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJmYWlsZWQiOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBJVlI6IFNlbmQgUmVnaXN0cmF0aW9uIEluZm9ybWF0aW9uIFZpYSBTTVM6IE5vIHBob25lIG51bWJlciBmb3VuZCBpbiBzaGFyZWRTdGF0ZS5vYmplY3RBdHRyaWJ1dGVzLnRlbGVwaG9uZU51bWJlciEnIik7CiAgCWxvZ2dlci5lcnJvcigiVHdpbGlvIElWUjogU2VuZCBSZWdpc3RyYXRpb24gSW5mb3JtYXRpb24gVmlhIFNNUzogb3V0Y29tZSA9IGZhaWxlZCIpOwp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICByZXR1cm4gc3RvcmFnZS5uYW1lOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7487"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.214Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "8487539a9104e73271031b93004355ad",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 588,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Greet Verified Caller\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Greet%20Verified%20Caller%22"
        },
        "response": {
          "bodySize": 2047,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2047,
            "text": "{\"result\":[{\"_id\":\"be6f1f2c-30ee-41fb-9e1e-8da72267fad3\",\"name\":\"Twilio IVR: Greet Verified Caller\",\"description\":\"Greet verified caller\",\"script\":\"LyogVHdpbGlvIElWUjogR3JlZXQgVmVyaWZpZWQgQ2FsbGVyCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEZvciBJRCBDbG91ZCB1c2UgIl9pZCIsIGZvciBjbGFzc2ljIGRlcGxveW1lbnRzIHVzZSAidXNlcm5hbWUiCnZhciB1c2VyaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCgovLyBDb25maWd1cmUgaG93IHlvdSB3b3VsZCBsaWtlIHRvIGFkZHJlc3MgdGhlIHZlcmlmaWVkIGNhbGxlci4gVGhlIGRlZmF1bHQgaXMgdGhlIGZ1bGwgbmFtZS4KdmFyIG5hbWUgPSBbaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKSwgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJzbiIpLml0ZXJhdG9yKCkubmV4dCgpXS5qb2luKCIgIik7CgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9IFsiSGVsbG8iLCBuYW1lLCAiISBIb3cgY2FuIEkgaGVscCB5b3UgdG9kYXk/Il0uam9pbigiICIpOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIG91dHB1dCA9IG5ldyBUZXh0T3V0cHV0Q2FsbGJhY2soVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLCBtZXNzYWdlKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChvdXRwdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2047"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.252Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "69c7671c9debf48cf64ce9ef60df862f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 592,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Unverified Caller Message\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Unverified%20Caller%20Message%22"
        },
        "response": {
          "bodySize": 1607,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1607,
            "text": "{\"result\":[{\"_id\":\"4f1273be-9c52-4879-bbe9-9a47068aeed9\",\"name\":\"Twilio IVR: Unverified Caller Message\",\"description\":\"Unverified caller message\",\"script\":\"LyogVHdpbGlvIElWUjogVW52ZXJpZmllZCBDYWxsZXIgTWVzc2FnZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogCiAqIERlcGVuZGluZyBvbiB0aGUgYW1vdW50IG9mIGRhdGEgY29sbGVjdGVkIHRocm91Z2ggY2FsbGJhY2tzIGFuZCBob3cgbWFueSBvZiB0aGUgY2FsbFBhcmFtcwogKiB5b3UgYWN0aXZhdGUgYmVsb3csIHlvdSB3aWxsIG5lZWQgdG8gY2hhbmdlIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiBmcm9tIEpXVCB0byBDVFMgb3IKICogTWVtb3J5LgogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9ICJUaGF0IGRvZXNuJ3QgbWF0Y2ggb3VyIHJlY29yZHMuIExldCB1cyB0cnkgdGhpcyBhbm90aGVyIHdheS4iOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIG91dHB1dCA9IG5ldyBUZXh0T3V0cHV0Q2FsbGJhY2soVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLCBtZXNzYWdlKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChvdXRwdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1607"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:28 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.292Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "3ce9d3978655d9745169089b1b987db1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 575,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"CopySAMLDataToObjectAttributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22CopySAMLDataToObjectAttributes%22"
        },
        "response": {
          "bodySize": 2421,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2421,
            "text": "{\"result\":[{\"_id\":\"8e03eb43-ed5d-4c12-9e15-2051cc9be578\",\"name\":\"CopySAMLDataToObjectAttributes\",\"description\":\"Copy SAML Data To ObjectAttributes\",\"script\":\"LyogQ29weVNBTUxEYXRhVG9PYmplY3RBdHRyaWJ1dGVzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIENvcHkgU0FNTCBEYXRhIFRvIE9iamVjdEF0dHJpYnV0ZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CmlmIChzaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAJc2hhcmVkU3RhdGUucmVtb3ZlKCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICB9CiAgICB2YXIgdXNlck5hbWU9bnVsbCxnaXZlbk5hbWU9bnVsbCxzbj1udWxsLG1haWw9bnVsbCx0ZWxlcGhvbmVOdW1iZXI9bnVsbCxyb2xlcz1udWxsOwoKICAgIHRyeSB7IHVzZXJOYW1lPXNoYXJlZFN0YXRlLmdldCgidXNlckluZm8iKS5nZXQoInVzZXJOYW1lcyIpLmdldCgidWlkIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyBnaXZlbk5hbWU9c2hhcmVkU3RhdGUuZ2V0KCJ1c2VySW5mbyIpLmdldCgiYXR0cmlidXRlcyIpLmdldCgiZ2l2ZW5OYW1lIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyBzbj1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJzbiIpLmdldCgwKS50b1N0cmluZygpOyB9IGNhdGNoIChlKSB7fQogICAgdHJ5IHsgbWFpbD1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJtYWlsIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyB0ZWxlcGhvbmVOdW1iZXI9c2hhcmVkU3RhdGUuZ2V0KCJ1c2VySW5mbyIpLmdldCgiYXR0cmlidXRlcyIpLmdldCgidGVsZXBob25lTnVtYmVyIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICAvL3RyeSB7IHJvbGVzPXNoYXJlZFN0YXRlLmdldCgidXNlckluZm8iKS5nZXQoImF0dHJpYnV0ZXMiKS5nZXQoInJvbGVzIikuZ2V0KDApLnRvU3RyaW5nKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICB0cnkgeyByb2xlcz1zaGFyZWRTdGF0ZS5nZXQoInVzZXJJbmZvIikuZ2V0KCJhdHRyaWJ1dGVzIikuZ2V0KCJyb2xlcyIpLnRvQXJyYXkoKS5qb2luKCJ8Iik7IH0gY2F0Y2ggKGUpIHt9CgogICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgeyJ1c2VyTmFtZSI6dXNlck5hbWUsImdpdmVuTmFtZSI6Z2l2ZW5OYW1lLCJzbiI6c24sIm1haWwiOm1haWwsInRlbGVwaG9uZU51bWJlciI6dGVsZXBob25lTnVtYmVyLCJyb2xlcyI6cm9sZXN9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2421"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.330Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "4cd74350a95512b9cd53238ae32b78be",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Google Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Google%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1523,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1523,
            "text": "{\"result\":[{\"_id\":\"58d29080-4563-480b-89bb-1e7719776a21\",\"name\":\"Google Profile Normalization\",\"description\":\"Normalizes raw profile data from Google\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImxvY2FsZSIsIHJhd1Byb2ZpbGUubG9jYWxlKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1523"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.370Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "5d517c6bb1500295709cc1cd5449702d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Hash State Variables\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Hash%20State%20Variables%22"
        },
        "response": {
          "bodySize": 8845,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 8845,
            "text": "{\"result\":[{\"_id\":\"a2c639ac-7ccd-4906-bb31-f6e69632c93b\",\"name\":\"Hash State Variables\",\"description\":\"Hash State Variables\",\"script\":\"LyogSGFzaCBTdGF0ZSBWYXJpYWJsZXMKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBTZWUgY29weXJpZ2h0IG5vdGljZXMsIGNvbmRpdGlvbnMsIGFuZCBkaXNjbGFpbWVycyBhdCB0aGUgYm90dG9tIG9mIHRoaXMgc2NyaXB0LgogKiAKICogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJIYXNoIFN0YXRlIFZhcmlhYmxlczogc3RhcnQiKTsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgCiAgICAvKiBCZWdpbiBDb25maWd1cmF0aW9uICovCiAgCQogIAkvLyBoYXNoaW5nIGFsZ29yaXRobSAoTUQyLCBNRDUsIFNIQS0xLCBTSEEtMjI0LCBTSEEtMjU2LCBTSEEtMzg0LCBTSEEtNTEyLzIyNCwgU0hBLTUxMi8yNTYsIFNIQTMtMjI0LCBTSEEzLTI1NiwgU0hBMy0zODQsIFNIQTMtNTEyKQogIAl2YXIgYWxnb3JpdGhtID0gIlNIQS0yMjQiOwogIAogIAkvLyBzYWx0CiAgCXZhciBzYWx0ID0gInN1cGVyc2VjcmV0IjsKICAKICAJLy8gTGlzdCBvZiBhdHRyaWJ1dGVzIChJRE0gbmFtZXNwYWNlKSB5b3Ugd291bGQgbGlrZSB0byBoYXNoLgogIAl2YXIga2V5cyA9IFsKICAgICAgICAJInVzZXJOYW1lIiwKICAgICAgICAJInRlbGVwaG9uZU51bWJlciIKICAgICAgCV0KCiAgICAvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwogIAkKICAgIC8vIEhhc2ggdmFsdWVzIGluIHNoYXJlZCBzdGF0ZQogICAgdmFyIHZhbHVlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHZhbHVlcykgewogICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAJdmFyIHZhbHVlID0gdmFsdWVzLmdldChrZXkpOwogICAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJIYXNoIFN0YXRlIFZhcmlhYmxlczogaGFzaCAiK2tleSsiIGluIHNoYXJlZCBzdGF0ZSIpOwogICAgICAgICAgICAgIAkvL3ZhciBoYXNoID0gZ2VuZXJhdGVIYXNoQjY0KHZhbHVlLCBhbGdvcml0aG0pOwogICAgICAgICAgICAgIAl2YXIgaGFzaCA9IGdlbmVyYXRlU2FsdGVkSGFzaEI2NDIodmFsdWUsIGFsZ29yaXRobSwgc2FsdCk7CiAgICAgICAgICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoa2V5LCBoYXNoKTsKICAgICAgICAgICAgICAJLy8gQWxzbyBoYXNoIHVzZXJuYW1lIGlmIHVzZXJOYW1lIGlzIGluIGtleXMKICAgICAgICAgICAgICAJaWYgKGtleSA9PT0gInVzZXJOYW1lIiAmJiBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIikgJiYgdmFsdWUgPT09IHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKS50b1N0cmluZygpKSB7CiAgICAgICAgICAgICAgICAJbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBoYXNoIHVzZXJuYW1lIGluIHNoYXJlZCBzdGF0ZSIpOwogICAgICAgICAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ1c2VybmFtZSIsIGhhc2gpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0KICAJCiAgCS8vIEhhc2ggdmFsdWVzIGluIHRyYW5zaWVudCBzdGF0ZQogICAgdmFsdWVzID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAodmFsdWVzKSB7CiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIAl2YXIgdmFsdWUgPSB2YWx1ZXMuZ2V0KGtleSk7CiAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBoYXNoICIra2V5KyIgaW4gdHJhbnNpZW50IHN0YXRlIik7CiAgICAgICAgICAgICAgCS8vdmFyIGhhc2ggPSBnZW5lcmF0ZUhhc2hCNjQodmFsdWUsIGFsZ29yaXRobSk7CiAgICAgICAgICAgICAgCXZhciBoYXNoID0gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0Mih2YWx1ZSwgYWxnb3JpdGhtLCBzYWx0KTsKICAgICAgICAgICAgICAgIHNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZShrZXksIGhhc2gpOwogICAgICAgICAgICAgIAkvLyBBbHNvIGhhc2ggdXNlcm5hbWUgaWYgdXNlck5hbWUgaXMgaW4ga2V5cwogICAgICAgICAgICAgIAlpZiAoa2V5ID09PSAidXNlck5hbWUiICYmIHRyYW5zaWVudFN0YXRlLmdldCgidXNlcm5hbWUiKSAmJiB2YWx1ZSA9PT0gdHJhbnNpZW50U3RhdGUuZ2V0KCJ1c2VybmFtZSIpLnRvU3RyaW5nKCkpIHsKICAgICAgICAgICAgICAgIAlsb2dnZXIubWVzc2FnZSgiSGFzaCBTdGF0ZSBWYXJpYWJsZXM6IGhhc2ggdXNlcm5hbWUgaW4gdHJhbnNpZW50IHN0YXRlIik7CiAgICAgICAgICAgICAgICAgIAl0cmFuc2llbnRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgaGFzaCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIkhhc2ggU3RhdGUgVmFyaWFibGVzOiBlbmQiKTsKCiAgICAvKgogICAgICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgIAl2YXIgb2JqZWN0ID0gewogICAgICAgICAgICAgIAluYW1lOiB2YWx1ZQogICAgICAgICAgICB9OwogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3QpOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICogU3RvcmUgYXR0cmlidXRlcyBpbiB0cmFuc2llbnQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgICAgICB2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0cmFuc2llbnRTdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgICAJdmFyIG9iamVjdCA9IHsKICAgICAgICAgICAgICAJbmFtZTogdmFsdWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJhbnNpZW50U3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0KTsKICAgICAgICB9CiAgICB9CiAgCQogICAgLyoKICAgICAqIEhhc2ggYSBzdHJpbmcgdXNpbmcgYW55IG9mIHRoZXNlIGFsZ29yaXRobXM6CiAgICAgKiAtIE1EMgogICAgICogLSBNRDUKICAgICAqIC0gU0hBLTEKICAgICAqIC0gU0hBLTIyNAogICAgICogLSBTSEEtMjU2CiAgICAgKiAtIFNIQS0zODQKICAgICAqIC0gU0hBLTUxMi8yMjQKICAgICAqIC0gU0hBLTUxMi8yNTYKICAgICAqIC0gU0hBMy0yMjQKICAgICAqIC0gU0hBMy0yNTYKICAgICAqIC0gU0hBMy0zODQKICAgICAqIC0gU0hBMy01MTIKICAgICAqLwogIAlmdW5jdGlvbiBnZW5lcmF0ZUhhc2hIZXgodmFsdWUsIGFsZykgewogICAgICAJdmFyIG1kID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKGFsZyk7CiAgICAgIAlyZXR1cm4gdG9IZXhTdHJpbmcobWQuZGlnZXN0KG5ldyBqYXZhLmxhbmcuU3RyaW5nKHZhbHVlKS5nZXRCeXRlcygpKSk7CiAgICB9CiAgCiAgCWZ1bmN0aW9uIGdlbmVyYXRlSGFzaEI2NCh2YWx1ZSwgYWxnKSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCXJldHVybiBvcmcuZm9yZ2Vyb2NrLnV0aWwuZW5jb2RlLkJhc2U2NC5lbmNvZGUobWQuZGlnZXN0KG5ldyBqYXZhLmxhbmcuU3RyaW5nKHZhbHVlKS5nZXRCeXRlcygpKSk7CiAgICB9CiAgCiAgICAvKgogICAgICogU2FsdCBhbmQgaGFzaCBhIHN0cmluZyB1c2luZyBhbnkgb2YgdGhlc2UgYWxnb3JpdGhtczoKICAgICAqIC0gTUQyCiAgICAgKiAtIE1ENQogICAgICogLSBTSEEtMQogICAgICogLSBTSEEtMjI0CiAgICAgKiAtIFNIQS0yNTYKICAgICAqIC0gU0hBLTM4NAogICAgICogLSBTSEEtNTEyLzIyNAogICAgICogLSBTSEEtNTEyLzI1NgogICAgICogLSBTSEEzLTIyNAogICAgICogLSBTSEEzLTI1NgogICAgICogLSBTSEEzLTM4NAogICAgICogLSBTSEEzLTUxMgogICAgICovCiAgCWZ1bmN0aW9uIGdlbmVyYXRlU2FsdGVkSGFzaEhleCh2YWx1ZSwgYWxnLCBzYWx0KSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCW1kLnVwZGF0ZShuZXcgamF2YS5sYW5nLlN0cmluZyhzYWx0KS5nZXRCeXRlcygpKTsKICAgICAgCXJldHVybiB0b0hleFN0cmluZyhtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAJZnVuY3Rpb24gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0KHZhbHVlLCBhbGcsIHNhbHQpIHsKICAgICAgCXZhciBtZCA9IGphdmEuc2VjdXJpdHkuTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZShhbGcpOwogICAgICAJbWQudXBkYXRlKG5ldyBqYXZhLmxhbmcuU3RyaW5nKHNhbHQpLmdldEJ5dGVzKCkpOwogICAgICAJcmV0dXJuIG9yZy5mb3JnZXJvY2sudXRpbC5lbmNvZGUuQmFzZTY0LmVuY29kZShtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAJZnVuY3Rpb24gZ2VuZXJhdGVTYWx0ZWRIYXNoQjY0Mih2YWx1ZSwgYWxnLCBzYWx0KSB7CiAgICAgIAl2YXIgbWQgPSBqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZ2V0SW5zdGFuY2UoYWxnKTsKICAgICAgCW1kLnVwZGF0ZShuZXcgamF2YS5sYW5nLlN0cmluZyhzYWx0KS5nZXRCeXRlcygpKTsKICAgICAgCXJldHVybiBvcmcuZm9yZ2Vyb2NrLnV0aWwuZW5jb2RlLkJhc2U2NC5lbmNvZGUoY29uY2F0Qnl0ZUFycmF5cyhtZC5kaWdlc3QobmV3IGphdmEubGFuZy5TdHJpbmcodmFsdWUpLmdldEJ5dGVzKCkpLG5ldyBqYXZhLmxhbmcuU3RyaW5nKHNhbHQpLmdldEJ5dGVzKCkpKTsKICAgIH0KICAKICAgIGZ1bmN0aW9uIHRvSGV4U3RyaW5nKGJ5dGVBcnJheSkgewogICAgICAgIHZhciBzID0gJyc7CiAgICAgICAgYnl0ZUFycmF5LmZvckVhY2goZnVuY3Rpb24oYnl0ZSkgewogICAgICAgICAgCXMgKz0gKCcwJyArIChieXRlICYgMHhGRikudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CiAgCiAgICBmdW5jdGlvbiBjb25jYXRCeXRlQXJyYXlzKGJ5dGVBcnJheTEsIGJ5dGVBcnJheTIpIHsKICAgICAgCXZhciBsZW5ndGggPSBieXRlQXJyYXkxLmxlbmd0aCArIGJ5dGVBcnJheTIubGVuZ3RoOwogICAgICAJdmFyIGJ5dGVzID0gW107CiAgICAgICAgYnl0ZUFycmF5MS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGUpIHsKICAgICAgICAgIAlieXRlcy5wdXNoKGJ5dGUpOwogICAgICAgIH0pOwogICAgICAgIGJ5dGVBcnJheTIuZm9yRWFjaChmdW5jdGlvbihieXRlKSB7CiAgICAgICAgICAJYnl0ZXMucHVzaChieXRlKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gYnl0ZXM7CiAgICB9Cn0oKSk7Ci8qCiAqIEJhc2U2NCBlbmNvZGUgLyBkZWNvZGUKICogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvLwogKiAKICogRXhhbXBsZToKICogQmFzZTY0LmVuY29kZSgnc29tZSBzdHJpbmcnKQogKiBCYXNlNjQuZGVjb2RlKCdzb21lIGVuY29kZWQgc3RyaW5nJykKICov\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.408Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "3c8b50a391b7e6250cc82d71ffe1d35f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Record MFA\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Record%20MFA%22"
        },
        "response": {
          "bodySize": 1232,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1232,
            "text": "{\"result\":[{\"_id\":\"a873fcd8-8f17-4675-9dd6-54ab1c11e2df\",\"name\":\"Record MFA\",\"description\":\"Record that MFA has been performed for this journey and no longer needs to be performed. This allows journeys and inner journeys to check that flag before performing MFA multiple times.\",\"script\":\"LyogTUZBIFN0YXR1cwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBSZWNvcmQgdGhhdCBNRkEgaGFzIGJlZW4gcGVyZm9ybWVkIGZvciB0aGlzIGpvdXJuZXkgYW5kIG5vIGxvbmdlciBuZWVkcyAKICogdG8gYmUgcGVyZm9ybWVkLiBUaGlzIGFsbG93cyBqb3VybmV5cyBhbmQgaW5uZXIgam91cm5leXMgdG8gY2hlY2sgdGhhdCAKICogZmxhZyBiZWZvcmUgcGVyZm9ybWluZyBNRkEgbXVsdGlwbGUgdGltZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnNoYXJlZFN0YXRlLnB1dCgibWZhUGVyZm9ybWVkIiwgInRydWUiKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1232"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.449Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "bd5c7386409decadd7e4e8b71d8053bc",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Create Unique Username\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Create%20Unique%20Username%22"
        },
        "response": {
          "bodySize": 2376,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2376,
            "text": "{\"result\":[{\"_id\":\"8a1f6286-4cc2-4e4a-947b-c458de68e93e\",\"name\":\"Create Unique Username\",\"description\":\"Combine company and username.\",\"script\":\"LyogQ3JlYXRlIFVuaXF1ZSBVc2VybmFtZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDb21iaW5lIGNvbXBhbnkgYW5kIHVzZXJuYW1lLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBub2RlU3RhdGUuZ2V0KCJjb21wYW55IikuYXNTdHJpbmcoKSArICIuIiArIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiZnJVbmluZGV4ZWRTdHJpbmcxIikpOwoKICAgIC8qCiAgICAgKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUpIHsKICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoKICAgICAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICAgICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgICAgICAgaWYgKHN0b3JhZ2UucHV0KSB7CiAgICAgICAgICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgICAgIH0KICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2376"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.490Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "ff3b7ac11d8b74e3dd2eeef4844c107b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Populate Company as Smokin\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Populate%20Company%20as%20Smokin%22"
        },
        "response": {
          "bodySize": 958,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 958,
            "text": "{\"result\":[{\"_id\":\"f8809ec4-e894-420d-a6e5-83295717d97d\",\"name\":\"Populate Company as Smokin\",\"description\":\"Places 'customer' in the 'entityType' attribute\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJ1c2VyTmFtZSIpCnZhciByZXN1bHQgPSAiU21va2luLUl0IjsKCmxvZ2dlci5lcnJvcigicmVzdWx0ID0gIiArIHJlc3VsdCk7CgovL29iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIsIHJlc3VsdCkKb2JqZWN0QXR0cmlidXRlcy5wdXQoImZySW5kZXhlZFN0cmluZzQiLHJlc3VsdCkKc2hhcmVkU3RhdGUucHV0KCJmckluZGV4ZWRTdHJpbmc0IixyZXN1bHQpCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBvYmplY3RBdHRyaWJ1dGVzKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "958"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.531Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "f1df9542cb3b09caca77aa12ebde785c",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Write HTML Meta Tags\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Write%20HTML%20Meta%20Tags%22"
        },
        "response": {
          "bodySize": 1841,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1841,
            "text": "{\"result\":[{\"_id\":\"df10fa07-d2a2-4003-99f1-a1114f57b46a\",\"name\":\"Write HTML Meta Tags\",\"description\":\"Write HTML Meta Tags\",\"script\":\"LyogV3JpdGUgSFRNTCBNZXRhIFRhZ3MKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd3JpdGVzIG1ldGEgdGFncyB0byB0aGUgaGVhZGVyLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICkKCiAgZnVuY3Rpb24gY3JlYXRlU2NyaXB0KCkgewogICAgcmV0dXJuIFN0cmluZygiXG5cCiAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcblwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVxuXAogICAgKS5mb3JFYWNoKFxuXAogICAgICBmdW5jdGlvbiAoZSkge1xuXAogICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOyBcblwKICAgICAgICBtZXRhLm5hbWUgPSBcImF1dGhvclwiOyBcblwKICAgICAgICBtZXRhLmNvbnRlbnQgPSBcIkpvaG4gRG9lXCI7IFxuXAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobWV0YSk7IFxuXAogICAgICB9XG5cCiAgICApIik7CiAgfQoKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soY3JlYXRlU2NyaXB0KCkpCiAgICAgICkuYnVpbGQoKQogIH0gZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1841"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.571Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "5e9aaa7940499ae88cb8e5c5b2d83090",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FrodoTestScript4\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FrodoTestScript4%22"
        },
        "response": {
          "bodySize": 1106,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1106,
            "text": "{\"result\":[{\"_id\":\"10643e95-873a-4ec0-b713-a7f56760d179\",\"name\":\"FrodoTestScript4\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1106"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.612Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "2d39d5eb8b7dcea4d003564d773a70f3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Verify Known Caller\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Verify%20Known%20Caller%22"
        },
        "response": {
          "bodySize": 2997,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2997,
            "text": "{\"result\":[{\"_id\":\"aa2dabff-f5c4-4dc5-b4ac-5909e88a3a8f\",\"name\":\"Twilio IVR: Verify Known Caller\",\"description\":\"Verify known caller by first name\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IEtub3duIENhbGxlcgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IEtub3duIENhbGxlcjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gRm9yIElEIENsb3VkIHVzZSAiX2lkIiwgZm9yIGNsYXNzaWMgZGVwbG95bWVudHMgdXNlICJ1c2VybmFtZSIKdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKCi8vIFJldHJpZXZlIHRoZSBrbm93biBjYWxsZXIncyBmaXJzdCBuYW1lCnZhciBmaXJzdE5hbWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgImdpdmVuTmFtZSIpLml0ZXJhdG9yKCkubmV4dCgpLnJlcGxhY2VBbGwoIlteYS16QS1aIF0iLCAiIikudG9Mb3dlckNhc2UoKTsKCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIkkgc2VlIHdlIGhhdmUgYSBwcm9maWxlIGFzc29jaWF0ZWQgd2l0aCB5b3VyIHBob25lIG51bWJlciEiOwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiVG8gdmVyaWZ5IEkgaGF2ZSB0aGUgcmlnaHQgYWNjb3VudCwgcGxlYXNlIHNheSB5b3VyIGZpcnN0IG5hbWUuIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0SW5wdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJdmFyIGlucHV0ID0gbmV3IFRleHRJbnB1dENhbGxiYWNrKHByb21wdCk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0LCBpbnB1dCkuYnVpbGQoKTsKICAJfSAKICAJZWxzZSB7CiAgICAgIAl2YXIgYW5zd2VyID0gY2FsbGJhY2tzLmdldCgxKS5nZXRUZXh0KCkucmVwbGFjZUFsbCgiW15hLXpBLVogXSIsICIiKS50b0xvd2VyQ2FzZSgpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBWZXJpZnkgS25vd24gQ2FsbGVyOiBjYWxsYmFja3MgcmVjZWl2ZWQ6IGFuc3dlcj0iLmNvbmNhdChhbnN3ZXIpLmNvbmNhdCgiIFtmaXJzdE5hbWU9IikuY29uY2F0KGZpcnN0TmFtZSkuY29uY2F0KCJdIikpOwogICAgCWlmIChhbnN3ZXIgPT0gZmlyc3ROYW1lKSB7CiAgICAgIAkJb3V0Y29tZSA9ICJ0cnVlIjsKICAgIAl9CiAgICAgIAllbHNlIGlmIChhbnN3ZXIubGVuZ3RoID09IDApIHsKICAgICAgICAgIAlvdXRjb21lID0gIm5vIGlucHV0IjsKICAgICAgICB9CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFZlcmlmeSBLbm93biBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2997"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.653Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "d03f9e8a49c3663717f6f44885052a82",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 575,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Okta Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Okta%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1554,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1554,
            "text": "{\"result\":[{\"_id\":\"6325cf19-a49b-471e-8d26-7e4df76df0e2\",\"name\":\"Okta Profile Normalization\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci53YXJuaW5nKCJPa3RhIHJhd1Byb2ZpbGU6ICIrcmF3UHJvZmlsZSkKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZS5kYXRhLnVybCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5wcmVmZXJyZWRfdXNlcm5hbWUpKSk=\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1554"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.692Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "afc41c780e83cc62849c3869e7ef5a1a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 602,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"GitHub Profile Normalization - imported (1)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22GitHub%20Profile%20Normalization%20-%20imported%20%281%29%22"
        },
        "response": {
          "bodySize": 1555,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1555,
            "text": "{\"result\":[{\"_id\":\"23143919-6b78-40c3-b25e-beca19b229e0\",\"name\":\"GitHub Profile Normalization - imported (1)\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci53YXJuaW5nKCJHaXRIdWIgcmF3UHJvZmlsZTogIityYXdQcm9maWxlKQoKcmV0dXJuIGpzb24ob2JqZWN0KAogICAgICAgIGZpZWxkKCJpZCIsIHJhd1Byb2ZpbGUuaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIHJhd1Byb2ZpbGUuZmlyc3RfbmFtZSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmxhc3RfbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5waWN0dXJlLmRhdGEudXJsKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLmVtYWlsKSkp\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1555"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.730Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "65ed6dc43f368c735b1a0551b4cc17da",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 575,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Alpha OIDC Claims Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Alpha%20OIDC%20Claims%20Script%22"
        },
        "response": {
          "bodySize": 41537,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 41537,
            "text": "{\"result\":[{\"_id\":\"cf3515f0-8278-4ee3-a530-1bad7424c416\",\"name\":\"Alpha OIDC Claims Script\",\"description\":\"Default alpha realm script for OIDC claims\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.768Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "5382c0e0a5e721e40147650a96113d77",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 585,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Remove Button - imported (1)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Remove%20Button%20-%20imported%20%281%29%22"
        },
        "response": {
          "bodySize": 1694,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1694,
            "text": "{\"result\":[{\"_id\":\"3814d347-a2f2-4be9-a810-ab41a1e374bd\",\"name\":\"Remove Button - imported (1)\",\"description\":\"Hide buttons on the journey page.\",\"script\":\"LyogUmVtb3ZlIEJ1dHRvbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBIaWRlIGJ1dHRvbnMgb24gdGhlIGpvdXJuZXkgcGFnZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2J1dHRvbicpKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnfSkiCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICB2YXIgbWVzc2FnZSA9ICIgIgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIG1lc3NhZ2UKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1694"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.808Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "60315e24f99439c8e4989ee6eb506111",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 590,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Device Id (Match) - Server Side\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Device%20Id%20%28Match%29%20-%20Server%20Side%22"
        },
        "response": {
          "bodySize": 40277,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 40277,
            "text": "{\"result\":[{\"_id\":\"703dab1a-1921-4981-98dd-b8e5349d8548\",\"name\":\"Device Id (Match) - Server Side\",\"description\":\"Default global script for server side Device Id (Match) Authentication Module\",\"script\":\"LyoKICogRE8gTk9UIEFMVEVSIE9SIFJFTU9WRSBDT1BZUklHSFQgTk9USUNFUyBPUiBUSElTIEhFQURFUi4KICoKICogQ29weXJpZ2h0IChjKSAyMDA5IFN1biBNaWNyb3N5c3RlbXMgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIHRlcm1zCiAqIG9mIHRoZSBDb21tb24gRGV2ZWxvcG1lbnQgYW5kIERpc3RyaWJ1dGlvbiBMaWNlbnNlCiAqICh0aGUgTGljZW5zZSkuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluCiAqIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICoKICogWW91IGNhbiBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqIGh0dHBzOi8vb3BlbnNzby5kZXYuamF2YS5uZXQvcHVibGljL0NEREx2MS4wLmh0bWwgb3IKICogb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQKICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nCiAqIHBlcm1pc3Npb24gYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBXaGVuIGRpc3RyaWJ1dGluZyBDb3ZlcmVkIENvZGUsIGluY2x1ZGUgdGhpcyBDRERMCiAqIEhlYWRlciBOb3RpY2UgaW4gZWFjaCBmaWxlIGFuZCBpbmNsdWRlIHRoZSBMaWNlbnNlIGZpbGUKICogYXQgb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQuCiAqIElmIGFwcGxpY2FibGUsIGFkZCB0aGUgZm9sbG93aW5nIGJlbG93IHRoZSBDRERMIEhlYWRlciwKICogd2l0aCB0aGUgZmllbGRzIGVuY2xvc2VkIGJ5IGJyYWNrZXRzIFtdIHJlcGxhY2VkIGJ5CiAqIHlvdXIgb3duIGlkZW50aWZ5aW5nIGluZm9ybWF0aW9uOgogKiAiUG9ydGlvbnMgQ29weXJpZ2h0ZWQgW3llYXJdIFtuYW1lIG9mIGNvcHlyaWdodCBvd25lcl0iCiAqCiAqLwovKgogKiBQb3J0aW9ucyBDb3B5cmlnaHRlZCAyMDEzIFN5bnRlZ3JpdHkuCiAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMtMjAxOCBGb3JnZVJvY2sgQVMuCiAqLwoKdmFyIFNjYWxhckNvbXBhcmF0b3IgPSB7fSwgU2NyZWVuQ29tcGFyYXRvciA9IHt9LCBNdWx0aVZhbHVlQ29tcGFyYXRvciA9IHt9LCBVc2VyQWdlbnRDb21wYXJhdG9yID0ge30sIEdlb2xvY2F0aW9uQ29tcGFyYXRvciA9IHt9OwoKdmFyIGNvbmZpZyA9IHsKICAgIHByb2ZpbGVFeHBpcmF0aW9uOiAzMCwgICAgICAgICAgICAgIC8vaW4gZGF5cwogICAgbWF4UHJvZmlsZXNBbGxvd2VkOiA1LAogICAgbWF4UGVuYWx0eVBvaW50czogMCwKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBzY3JlZW46IHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIGNvbXBhcmF0b3I6IFNjcmVlbkNvbXBhcmF0b3IsCiAgICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDUwCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHBsdWdpbnM6IHsKICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2luczogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogTXVsdGlWYWx1ZUNvbXBhcmF0b3IsCiAgICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4UGVyY2VudGFnZURpZmZlcmVuY2U6IDEwLAogICAgICAgICAgICAgICAgICAgIG1heERpZmZlcmVuY2VzOiA1LAogICAgICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDEwMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmb250czogewogICAgICAgICAgICBpbnN0YWxsZWRGb250czogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogTXVsdGlWYWx1ZUNvbXBhcmF0b3IsCiAgICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4UGVyY2VudGFnZURpZmZlcmVuY2U6IDEwLAogICAgICAgICAgICAgICAgICAgIG1heERpZmZlcmVuY2VzOiA1LAogICAgICAgICAgICAgICAgICAgIHBlbmFsdHlQb2ludHM6IDEwMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0aW1lem9uZTogewogICAgICAgICAgICB0aW1lem9uZTogewogICAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgY29tcGFyYXRvcjogU2NhbGFyQ29tcGFyYXRvciwKICAgICAgICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgICAgICAgICBwZW5hbHR5UG9pbnRzOiAxMDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdXNlckFnZW50OiB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBjb21wYXJhdG9yOiBVc2VyQWdlbnRDb21wYXJhdG9yLAogICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICBpZ25vcmVWZXJzaW9uOiB0cnVlLAogICAgICAgICAgICAgICAgcGVuYWx0eVBvaW50czogMTAwCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGdlb2xvY2F0aW9uOiB7CiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgICAgY29tcGFyYXRvcjogR2VvbG9jYXRpb25Db21wYXJhdG9yLAogICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICBhbGxvd2VkUmFuZ2U6IDEwMCwJCQkvL2luIG1pbGVzCiAgICAgICAgICAgICAgICBwZW5hbHR5UG9pbnRzOiAxMDAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTsKCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLy8KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICBDb21wYXJhdG9yIGZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLwovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vCgp2YXIgYWxsLCBhbnksIGNhbGN1bGF0ZURpc3RhbmNlLCBjYWxjdWxhdGVJbnRlcnNlY3Rpb24sIGNhbGN1bGF0ZVBlcmNlbnRhZ2UsIG51bGxPclVuZGVmaW5lZCwgc3BsaXRBbmRUcmltLAogICAgdW5kZWZpbmVkTG9jYXRpb247CgovLyBDb21wYXJpc29uUmVzdWx0CgovKioKICogQ29uc3RydWN0cyBhbiBpbnN0YW5jZSBvZiBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gcGVuYWx0eSBwb2ludHMuCiAqCiAqIEBwYXJhbSBwZW5hbHR5UG9pbnRzIChOdW1iZXIpIFRoZSBwZW5hbHR5IHBvaW50cyBmb3IgdGhlIGNvbXBhcmlzb24gKGRlZmF1bHRzIHRvIDApLgogKiBAcGFyYW0gYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSAoYm9vbGVhbikgV2hldGhlciB0aGUgY3VycmVudCB2YWx1ZSBjb250YWlucyBtb3JlIGluZm9ybWF0aW9uCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGFuIHRoZSBzdG9yZWQgdmFsdWUgKGRlZmF1bHRzIHRvIGZhbHNlKS4KICovCmZ1bmN0aW9uIENvbXBhcmlzb25SZXN1bHQoKSB7CgogICAgdmFyIHBlbmFsdHlQb2ludHMgPSAwLAogICAgICAgIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPSBmYWxzZTsKCiAgICBpZiAoYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBwZW5hbHR5UG9pbnRzID0gYXJndW1lbnRzWzBdOwogICAgICAgIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPSBhcmd1bWVudHNbMV07CiAgICB9CgogICAgaWYgKGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkICYmIGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKHR5cGVvZihhcmd1bWVudHNbMF0pID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSA9IGFyZ3VtZW50c1swXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwZW5hbHR5UG9pbnRzID0gYXJndW1lbnRzWzBdOwogICAgICAgIH0KICAgIH0KCiAgICB0aGlzLnBlbmFsdHlQb2ludHMgPSBwZW5hbHR5UG9pbnRzOwogICAgdGhpcy5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZTsKCn0KCkNvbXBhcmlzb25SZXN1bHQuWkVST19QRU5BTFRZX1BPSU5UUyA9IG5ldyBDb21wYXJpc29uUmVzdWx0KDApOwoKLyoqCiAqIFN0YXRpYyBtZXRob2QgZm9yIGZ1bmN0aW9uYWwgcHJvZ3JhbW1pbmcuCiAqCiAqIEByZXR1cm4gYm9vbGVhbiB0cnVlIGlmIGNvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKCkuCiAqLwpDb21wYXJpc29uUmVzdWx0LmlzU3VjY2Vzc2Z1bCA9ICBmdW5jdGlvbihjb21wYXJpc29uUmVzdWx0KSB7CiAgICByZXR1cm4gY29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKTsKfTsKCgovKioKICogU3RhdGljIG1ldGhvZCBmb3IgZnVuY3Rpb25hbCBwcm9ncmFtbWluZy4KICoKICogQHJldHVybiBib29sZWFuIHRydWUgaWYgY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlLgogKi8KQ29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gIGZ1bmN0aW9uKGNvbXBhcmlzb25SZXN1bHQpIHsKICAgIHJldHVybiBjb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWU7Cn07CgovKioKICogQ29tcGFyaXNvbiBmdW5jdGlvbiB0aGF0IGNhbiBiZSBwcm92aWRlZCBhcyBhbiBhcmd1bWVudCB0byBhcnJheS5zb3J0CiAqLwpDb21wYXJpc29uUmVzdWx0LmNvbXBhcmUgPSBmdW5jdGlvbihmaXJzdCwgc2Vjb25kKSB7CiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGZpcnN0KSAmJiBudWxsT3JVbmRlZmluZWQoc2Vjb25kKSkgewogICAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmIChudWxsT3JVbmRlZmluZWQoZmlyc3QpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmIChudWxsT3JVbmRlZmluZWQoc2Vjb25kKSkgewogICAgICAgIHJldHVybiAxOwogICAgfSBlbHNlIHsKICAgICAgICBpZiAoZmlyc3QucGVuYWx0eVBvaW50cyAhPT0gc2Vjb25kLnBlbmFsdHlQb2ludHMpIHsKICAgICAgICAgICAgcmV0dXJuIGZpcnN0LnBlbmFsdHlQb2ludHMgLSBzZWNvbmQucGVuYWx0eVBvaW50czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gKGZpcnN0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPyAxIDogMCkgLSAoc2Vjb25kLmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUgPyAxIDogMCk7CiAgICAgICAgfQogICAgfQp9OwoKLyoqCiAqIEFtYWxnYW1hdGVzIHRoZSBnaXZlbiBDb21wYXJpc29uUmVzdWx0IGludG8gdGhpcyBDb21wYXJpc29uUmVzdWx0LgogKgogKiBAcGFyYW0gY29tcGFyaXNvblJlc3VsdCBUaGUgQ29tcGFyaXNvblJlc3VsdCB0byBpbmNsdWRlLgogKi8KQ29tcGFyaXNvblJlc3VsdC5wcm90b3R5cGUuYWRkQ29tcGFyaXNvblJlc3VsdCA9IGZ1bmN0aW9uKGNvbXBhcmlzb25SZXN1bHQpIHsKICAgIHRoaXMucGVuYWx0eVBvaW50cyArPSBjb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHM7CiAgICBpZiAoY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlKSB7CiAgICAgICAgdGhpcy5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlID0gY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlOwogICAgfQp9OwoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiBubyBwZW5hbHR5IHBvaW50cyBoYXZlIGJlZW4gYXNzaWduZWQgZm9yIHRoZSBjb21wYXJpc29uLgogKgogKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBpZiB0aGUgY29tcGFyaXNvbiB3YXMgc3VjY2Vzc2Z1bC4KICovCkNvbXBhcmlzb25SZXN1bHQucHJvdG90eXBlLmlzU3VjY2Vzc2Z1bCA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG51bGxPclVuZGVmaW5lZCh0aGlzLnBlbmFsdHlQb2ludHMpIHx8IHRoaXMucGVuYWx0eVBvaW50cyA9PT0gMDsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gc2ltcGxlIG9iamVjdHMgKFN0cmluZ3xOdW1iZXIpIGFuZCBpZiB0aGV5IGFyZSBlcXVhbCB0aGVuIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggemVybwogKiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZCwgb3RoZXJ3aXNlIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggdGhlIGdpdmVuIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZC4KICoKICogQHBhcmFtIGN1cnJlbnRWYWx1ZSAoU3RyaW5nfE51bWJlcikgVGhlIGN1cnJlbnQgdmFsdWUuCiAqIEBwYXJhbSBzdG9yZWRWYWx1ZSAoU3RyaW5nfE51bWJlcikgVGhlIHN0b3JlZCB2YWx1ZS4KICogQHBhcmFtIGNvbmZpZzogewogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KICogICAgICAgIH0KICogQHJldHVybiBDb21wYXJpc29uUmVzdWx0LgogKi8KU2NhbGFyQ29tcGFyYXRvci5jb21wYXJlID0gZnVuY3Rpb24gKGN1cnJlbnRWYWx1ZSwgc3RvcmVkVmFsdWUsIGNvbmZpZykgewogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlN0cmluZ0NvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU3RyaW5nQ29tcGFyYXRvci5jb21wYXJlOnN0b3JlZFZhbHVlOiAiICsgSlNPTi5zdHJpbmdpZnkoc3RvcmVkVmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU3RyaW5nQ29tcGFyYXRvci5jb21wYXJlOmNvbmZpZzogIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykpOwogICAgfQogICAgaWYgKGNvbmZpZy5wZW5hbHR5UG9pbnRzID09PSAwKSB7CiAgICAgICAgcmV0dXJuIENvbXBhcmlzb25SZXN1bHQuWkVST19QRU5BTFRZX1BPSU5UUzsKICAgIH0KCiAgICBpZiAoIW51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkpIHsKICAgICAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkgfHwgY3VycmVudFZhbHVlICE9PSBzdG9yZWRWYWx1ZSkgewogICAgICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQoY29uZmlnLnBlbmFsdHlQb2ludHMpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoIW51bGxPclVuZGVmaW5lZChjdXJyZW50VmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KHRydWUpOwogICAgfQoKICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7Cn07CgovKioKICogQ29tcGFyZXMgdHdvIHNjcmVlbnMgYW5kIGlmIHRoZXkgYXJlIGVxdWFsIHRoZW4gcmV0dXJucyBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB6ZXJvIHBlbmFsdHkgcG9pbnRzIGFzc2lnbmVkLAogKiBvdGhlcndpc2UgcmV0dXJucyBhIENvbXBhcmlzb25SZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHBlbmFsdHkgcG9pbnRzIGFzc2lnbmVkLgogKgogKiBAcGFyYW0gY3VycmVudFZhbHVlOiB7CiAqICAgICAgICAgICAgInNjcmVlbldpZHRoIjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiB3aWR0aC4KICogICAgICAgICAgICAic2NyZWVuSGVpZ2h0IjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiBoZWlnaHQuCiAqICAgICAgICAgICAgInNjcmVlbkNvbG91ckRlcHRoIjogKE51bWJlcikgVGhlIGN1cnJlbnQgY2xpZW50IHNjcmVlbiBjb2xvdXIgZGVwdGguCiAqICAgICAgICB9CiAqIEBwYXJhbSBzdG9yZWRWYWx1ZTogewogKiAgICAgICAgICAgICJzY3JlZW5XaWR0aCI6IChOdW1iZXIpIFRoZSBzdG9yZWQgY2xpZW50IHNjcmVlbiB3aWR0aC4KICogICAgICAgICAgICAic2NyZWVuSGVpZ2h0IjogKE51bWJlcikgVGhlIHN0b3JlZCBjbGllbnQgc2NyZWVuIGhlaWdodC4KICogICAgICAgICAgICAic2NyZWVuQ29sb3VyRGVwdGgiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGNsaWVudCBzY3JlZW4gY29sb3VyIGRlcHRoLgogKiAgICAgICAgfQogKiBAcGFyYW0gY29uZmlnOiB7CiAqICAgICAgICAgICAgInBlbmFsdHlQb2ludHMiOiAoTnVtYmVyKSBUaGUgbnVtYmVyIG9mIHBlbmFsdHkgcG9pbnRzLgogKiAgICAgICAgfQogKiBAcmV0dXJuIENvbXBhcmlzb25SZXN1bHQKICovClNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZSA9IGZ1bmN0aW9uIChjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBjb25maWcpIHsKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJTY3JlZW5Db21wYXJhdG9yLmNvbXBhcmU6Y3VycmVudFZhbHVlOiAiICsgSlNPTi5zdHJpbmdpZnkoY3VycmVudFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZTpzdG9yZWRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KHN0b3JlZFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlNjcmVlbkNvbXBhcmF0b3IuY29tcGFyZTpjb25maWc6ICIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpKTsKICAgIH0KCiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkpIHsKICAgICAgICBjdXJyZW50VmFsdWUgPSB7c2NyZWVuV2lkdGg6IG51bGwsIHNjcmVlbkhlaWdodDogbnVsbCwgc2NyZWVuQ29sb3VyRGVwdGg6IG51bGx9OwogICAgfQogICAgaWYgKG51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkpIHsKICAgICAgICBzdG9yZWRWYWx1ZSA9IHtzY3JlZW5XaWR0aDogbnVsbCwgc2NyZWVuSGVpZ2h0OiBudWxsLCBzY3JlZW5Db2xvdXJEZXB0aDogbnVsbH07CiAgICB9CgogICAgdmFyIGNvbXBhcmlzb25SZXN1bHRzID0gWwogICAgICAgIFNjYWxhckNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUuc2NyZWVuV2lkdGgsIHN0b3JlZFZhbHVlLnNjcmVlbldpZHRoLCBjb25maWcpLAogICAgICAgIFNjYWxhckNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUuc2NyZWVuSGVpZ2h0LCBzdG9yZWRWYWx1ZS5zY3JlZW5IZWlnaHQsIGNvbmZpZyksCiAgICAgICAgU2NhbGFyQ29tcGFyYXRvci5jb21wYXJlKGN1cnJlbnRWYWx1ZS5zY3JlZW5Db2xvdXJEZXB0aCwgc3RvcmVkVmFsdWUuc2NyZWVuQ29sb3VyRGVwdGgsIGNvbmZpZyldOwoKICAgIGlmIChhbGwoY29tcGFyaXNvblJlc3VsdHMsIENvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKSkgewogICAgICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdChhbnkoY29tcGFyaXNvblJlc3VsdHMsIENvbXBhcmlzb25SZXN1bHQuYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZSkpOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQoY29uZmlnLnBlbmFsdHlQb2ludHMpOwogICAgfQp9OwoKLyoqCiAqIFNwbGl0cyBib3RoIHZhbHVlcyB1c2luZyBkZWxpbWl0ZXIsIHRyaW1zIGV2ZXJ5IHZhbHVlIGFuZCBjb21wYXJlcyBjb2xsZWN0aW9ucyBvZiB2YWx1ZXMuCiAqIFJldHVybnMgemVyby1yZXN1bHQgZm9yIHNhbWUgbXVsdGktdmFsdWUgYXR0cmlidXRlcy4KICoKICogSWYgY29sbGVjdGlvbnMgYXJlIG5vdCBzYW1lIGNoZWNrcyBpZiBudW1iZXIgb2YgZGlmZmVyZW5jZXMgaXMgbGVzcyBvciBlcXVhbCBtYXhEaWZmZXJlbmNlcyBvcgogKiBwZXJjZW50YWdlIG9mIGRpZmZlcmVuY2UgaXMgbGVzcyBvciBlcXVhbCBtYXhQZXJjZW50YWdlRGlmZmVyZW5jZS4KICoKICogSWYgeWVzIHRoZW4gcmV0dXJucyB6ZXJvLXJlc3VsdCB3aXRoIGFkZGl0aW9uYWwgaW5mbywgZWxzZSByZXR1cm5zIHBlbmFsdHlQb2ludHMtcmVzdWx0LgogKgogKiBAcGFyYW0gY3VycmVudFZhbHVlOiAoU3RyaW5nKSBUaGUgY3VycmVudCB2YWx1ZS4KICogQHBhcmFtIHN0b3JlZFZhbHVlOiAoU3RyaW5nKSBUaGUgc3RvcmVkIHZhbHVlLgogKiBAcGFyYW0gY29uZmlnOiB7CiAqICAgICAgICAgICAgIm1heFBlcmNlbnRhZ2VEaWZmZXJlbmNlIjogKE51bWJlcikgVGhlIG1heCBkaWZmZXJlbmNlIHBlcmNlbnRhZ2UgaW4gdGhlIHZhbHVlcywKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUgdGhlIHBlbmFsdHkgaXMgYXNzaWduZWQuCiAqICAgICAgICAgICAgIm1heERpZmZlcmVuY2VzIjogKE51bWJlcikgVGhlIG1heCBudW1iZXIgb2YgZGlmZmVyZW5jZXMgaW4gdGhlIHZhbHVlcywKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUgdGhlIHBlbmFsdHkgcG9pbnRzIGFyZSBhc3NpZ25lZC4KICogICAgICAgICAgICAicGVuYWx0eVBvaW50cyI6IChOdW1iZXIpIFRoZSBudW1iZXIgb2YgcGVuYWx0eSBwb2ludHMuCiAgKiAgICAgICAgfQogKiBAcmV0dXJuIENvbXBhcmlzb25SZXN1bHQKICovCk11bHRpVmFsdWVDb21wYXJhdG9yLmNvbXBhcmUgPSBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKSB7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiTXVsdGlWYWx1ZUNvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiTXVsdGlWYWx1ZUNvbXBhcmF0b3IuY29tcGFyZTpzdG9yZWRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KHN0b3JlZFZhbHVlKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIk11bHRpVmFsdWVDb21wYXJhdG9yLmNvbXBhcmU6Y29uZmlnOiAiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7CiAgICB9CgogICAgdmFyIGRlbGltaXRlciA9ICI7IiwKICAgICAgICBjdXJyZW50VmFsdWVzID0gc3BsaXRBbmRUcmltKGN1cnJlbnRWYWx1ZSwgZGVsaW1pdGVyKSwKICAgICAgICBzdG9yZWRWYWx1ZXMgPSBzcGxpdEFuZFRyaW0oc3RvcmVkVmFsdWUsIGRlbGltaXRlciksCiAgICAgICAgbWF4TnVtYmVyT2ZFbGVtZW50cyA9IE1hdGgubWF4KGN1cnJlbnRWYWx1ZXMubGVuZ3RoLCBzdG9yZWRWYWx1ZXMubGVuZ3RoKSwKICAgICAgICBudW1iZXJPZlRoZVNhbWVFbGVtZW50cyA9IGNhbGN1bGF0ZUludGVyc2VjdGlvbihjdXJyZW50VmFsdWVzLCBzdG9yZWRWYWx1ZXMpLmxlbmd0aCwKICAgICAgICBudW1iZXJPZkRpZmZlcmVuY2VzID0gbWF4TnVtYmVyT2ZFbGVtZW50cyAtIG51bWJlck9mVGhlU2FtZUVsZW1lbnRzLAogICAgICAgIHBlcmNlbnRhZ2VPZkRpZmZlcmVuY2VzID0gY2FsY3VsYXRlUGVyY2VudGFnZShudW1iZXJPZkRpZmZlcmVuY2VzLCBtYXhOdW1iZXJPZkVsZW1lbnRzKTsKCiAgICBpZiAobnVsbE9yVW5kZWZpbmVkKHN0b3JlZFZhbHVlKSAmJiAhbnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkpIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9CgogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UobnVtYmVyT2ZUaGVTYW1lRWxlbWVudHMgKyAiIG9mICIgKyBtYXhOdW1iZXJPZkVsZW1lbnRzICsgIiBhcmUgc2FtZSIpOwogICAgfQoKICAgIGlmIChtYXhOdW1iZXJPZkVsZW1lbnRzID09PSAwKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBubyBhdHRyaWJ1dGVzIGZvdW5kIGluIGJvdGggcHJvZmlsZXMiKTsKICAgICAgICByZXR1cm4gQ29tcGFyaXNvblJlc3VsdC5aRVJPX1BFTkFMVFlfUE9JTlRTOwogICAgfQoKICAgIGlmIChudW1iZXJPZlRoZVNhbWVFbGVtZW50cyA9PT0gbWF4TnVtYmVyT2ZFbGVtZW50cykgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJJZ25vcmVkIGJlY2F1c2UgYWxsIGF0dHJpYnV0ZXMgYXJlIHNhbWUiKTsKICAgICAgICByZXR1cm4gQ29tcGFyaXNvblJlc3VsdC5aRVJPX1BFTkFMVFlfUE9JTlRTOwogICAgfQoKICAgIGlmIChudW1iZXJPZkRpZmZlcmVuY2VzID4gY29uZmlnLm1heERpZmZlcmVuY2VzKSB7CiAgICAgICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJXb3VsZCBiZSBpZ25vcmVkIGlmIG5vdCBtb3JlIHRoYW4gIiArIGNvbmZpZy5tYXhEaWZmZXJlbmNlcyArICIgZGlmZmVyZW5jZXMiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KCiAgICBpZiAocGVyY2VudGFnZU9mRGlmZmVyZW5jZXMgPiBjb25maWcubWF4UGVyY2VudGFnZURpZmZlcmVuY2UpIHsKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UocGVyY2VudGFnZU9mRGlmZmVyZW5jZXMgKyAiIHBlcmNlbnRzIGFyZSBkaWZmZXJlbnQiKTsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIldvdWxkIGJlIGlnbm9yZWQgaWYgbm90IG1vcmUgdGhhbiAiICsgY29uZmlnLm1heFBlcmNlbnRhZ2VEaWZmZXJlbmNlICsgIiBwZXJjZW50Iik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdChjb25maWcucGVuYWx0eVBvaW50cyk7CiAgICB9CgogICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBudW1iZXIgb2YgZGlmZmVyZW5jZXMoIiArIG51bWJlck9mRGlmZmVyZW5jZXMgKyAiKSBub3QgbW9yZSB0aGFuICIKICAgICAgICAgICAgKyBjb25maWcubWF4RGlmZmVyZW5jZXMpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKHBlcmNlbnRhZ2VPZkRpZmZlcmVuY2VzICsgIiBwZXJjZW50cyBhcmUgZGlmZmVyZW50Iik7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklnbm9yZWQgYmVjYXVzZSBub3QgbW9yZSB0aGFuICIgKyBjb25maWcubWF4UGVyY2VudGFnZURpZmZlcmVuY2UgKyAiIHBlcmNlbnQiKTsKICAgIH0KICAgIHJldHVybiBuZXcgQ29tcGFyaXNvblJlc3VsdCh0cnVlKTsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gVXNlciBBZ2VudCBTdHJpbmdzIGFuZCBpZiB0aGV5IGFyZSBlcXVhbCB0aGVuIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggemVybyBwZW5hbHR5CiAqIHBvaW50cyBhc3NpZ25lZCwgb3RoZXJ3aXNlIHJldHVybnMgYSBDb21wYXJpc29uUmVzdWx0IHdpdGggdGhlIGdpdmVuIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cyBhc3NpZ25lZC4KICoKICogQHBhcmFtIGN1cnJlbnRWYWx1ZSAoU3RyaW5nKSBUaGUgY3VycmVudCB2YWx1ZS4KICogQHBhcmFtIHN0b3JlZFZhbHVlIChTdHJpbmcpIFRoZSBzdG9yZWQgdmFsdWUuCiAqIEBwYXJhbSBjb25maWc6IHsKICogICAgICAgICAgICAiaWdub3JlVmVyc2lvbiI6IChib29sZWFuKSBJZiB0aGUgdmVyc2lvbiBudW1iZXJzIGluIHRoZSBVc2VyIEFnZW50IFN0cmluZ3Mgc2hvdWxkIGJlIGlnbm9yZQogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIHRoZSBjb21wYXJpc29uLgogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KICogICAgICAgIH0KICogQHJldHVybiBBIENvbXBhcmlzb25SZXN1bHQuCiAqLwpVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmUgPSBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKSB7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiVXNlckFnZW50Q29tcGFyYXRvci5jb21wYXJlOmN1cnJlbnRWYWx1ZTogIiArIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmU6c3RvcmVkVmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShzdG9yZWRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyQWdlbnRDb21wYXJhdG9yLmNvbXBhcmU6Y29uZmlnOiAiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7CiAgICB9CgogICAgaWYgKGNvbmZpZy5pZ25vcmVWZXJzaW9uKSB7CiAgICAgICAgLy8gcmVtb3ZlIHZlcnNpb24gbnVtYmVyCiAgICAgICAgY3VycmVudFZhbHVlID0gbnVsbE9yVW5kZWZpbmVkKGN1cnJlbnRWYWx1ZSkgPyBudWxsIDogY3VycmVudFZhbHVlLnJlcGxhY2UoL1tcZFwuXSsvZywgIiIpLnRyaW0oKTsKICAgICAgICBzdG9yZWRWYWx1ZSA9IG51bGxPclVuZGVmaW5lZChzdG9yZWRWYWx1ZSkgPyBudWxsIDogc3RvcmVkVmFsdWUucmVwbGFjZSgvW1xkXC5dKy9nLCAiIikudHJpbSgpOwogICAgfQoKICAgIHJldHVybiBTY2FsYXJDb21wYXJhdG9yLmNvbXBhcmUoY3VycmVudFZhbHVlLCBzdG9yZWRWYWx1ZSwgY29uZmlnKTsKfTsKCi8qKgogKiBDb21wYXJlcyB0d28gbG9jYXRpb25zLCB0YWtpbmcgaW50byBhY2NvdW50IGEgZGVncmVlIG9mIGRpZmZlcmVuY2UuCiAqCiAqIEBwYXJhbSBjdXJyZW50VmFsdWU6IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgY3VycmVudCBsYXRpdHVkZS4KICogICAgICAgICAgICAibG9uZ2l0dWRlIjogKE51bWJlcikgVGhlIGN1cnJlbnQgbG9uZ2l0dWRlLgogKiAgICAgICAgfQogKiBAcGFyYW0gc3RvcmVkVmFsdWU6IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGxhdGl0dWRlLgogKiAgICAgICAgICAgICJsb25naXR1ZGUiOiAoTnVtYmVyKSBUaGUgc3RvcmVkIGxvbmdpdHVkZS4KICogICAgICAgIH0KICogQHBhcmFtIGNvbmZpZzogewogKiAgICAgICAgICAgICJhbGxvd2VkUmFuZ2UiOiAoTnVtYmVyKSBUaGUgbWF4IGRpZmZlcmVuY2UgYWxsb3dlZCBpbiB0aGUgdHdvIGxvY2F0aW9ucywgYmVmb3JlIHRoZSBwZW5hbHR5IGlzIGFzc2lnbmVkLgogKiAgICAgICAgICAgICJwZW5hbHR5UG9pbnRzIjogKE51bWJlcikgVGhlIG51bWJlciBvZiBwZW5hbHR5IHBvaW50cy4KKiAgICAgICAgIH0KICogQHJldHVybiBDb21wYXJpc29uUmVzdWx0CiAqLwpHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZSA9IGZ1bmN0aW9uIChjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBjb25maWcpIHsKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZTpjdXJyZW50VmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShjdXJyZW50VmFsdWUpKTsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiR2VvbG9jYXRpb25Db21wYXJhdG9yLmNvbXBhcmU6c3RvcmVkVmFsdWU6ICIgKyBKU09OLnN0cmluZ2lmeShzdG9yZWRWYWx1ZSkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJHZW9sb2NhdGlvbkNvbXBhcmF0b3IuY29tcGFyZTpjb25maWc6ICIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpKTsKICAgIH0KCiAgICAvLyBDaGVjayBmb3IgdW5kZWZpbmVkIHN0b3JlZCBvciBjdXJyZW50IGxvY2F0aW9ucwoKICAgIGlmICh1bmRlZmluZWRMb2NhdGlvbihjdXJyZW50VmFsdWUpICYmIHVuZGVmaW5lZExvY2F0aW9uKHN0b3JlZFZhbHVlKSkgewogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7CiAgICB9CiAgICBpZiAodW5kZWZpbmVkTG9jYXRpb24oY3VycmVudFZhbHVlKSAmJiAhdW5kZWZpbmVkTG9jYXRpb24oc3RvcmVkVmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KICAgIGlmICghdW5kZWZpbmVkTG9jYXRpb24oY3VycmVudFZhbHVlKSAmJiB1bmRlZmluZWRMb2NhdGlvbihzdG9yZWRWYWx1ZSkpIHsKICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9CgogICAgLy8gQm90aCBsb2NhdGlvbnMgZGVmaW5lZCwgdGhlcmVmb3JlIHBlcmZvcm0gY29tcGFyaXNvbgoKICAgIHZhciBkaXN0YW5jZSA9IGNhbGN1bGF0ZURpc3RhbmNlKGN1cnJlbnRWYWx1ZSwgc3RvcmVkVmFsdWUpOwoKICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJEaXN0YW5jZSBiZXR3ZWVuICgiICsgY3VycmVudFZhbHVlLmxhdGl0dWRlICsgIiwiICsgY3VycmVudFZhbHVlLmxvbmdpdHVkZSArICIpIGFuZCAoIiArCiAgICAgICAgICAgIHN0b3JlZFZhbHVlLmxhdGl0dWRlICsgIiwiICsgc3RvcmVkVmFsdWUubG9uZ2l0dWRlICsgIikgaXMgIiArIGRpc3RhbmNlICsgIiBtaWxlcyIpOwogICAgfQoKICAgIGlmIChwYXJzZUZsb2F0KGRpc3RhbmNlLnRvUHJlY2lzaW9uKDUpKSA9PT0gMCkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJMb2NhdGlvbiBpcyB0aGUgc2FtZSIpOwogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LlpFUk9fUEVOQUxUWV9QT0lOVFM7CiAgICB9CgogICAgaWYgKGRpc3RhbmNlIDw9IGNvbmZpZy5hbGxvd2VkUmFuZ2UpIHsKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIlRvbGVyYXRlZCBiZWNhdXNlIGRpc3RhbmNlIG5vdCBtb3JlIHRoZW4gIiArIGNvbmZpZy5hbGxvd2VkUmFuZ2UpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IENvbXBhcmlzb25SZXN1bHQodHJ1ZSk7CiAgICB9IGVsc2UgewogICAgICAgIGlmIChsb2dnZXIubWVzc2FnZUVuYWJsZWQoKSkgewogICAgICAgICAgICBsb2dnZXIubWVzc2FnZSgiV291bGQgYmUgaWdub3JlZCBpZiBkaXN0YW5jZSBub3QgbW9yZSB0aGVuICIgKyBjb25maWcuYWxsb3dlZFJhbmdlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBDb21wYXJpc29uUmVzdWx0KGNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgIH0KfTsKCgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vCi8vICAgICAgICAgICAgICAgICAgICBEZXZpY2UgUHJpbnQgTG9naWMgLSBETyBOT1QgTU9ESUZZICAgICAgICAgICAgICAgICAgICAgLy8KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vLwoKLy8gVXRpbGl0eSBmdW5jdGlvbnMKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgZXZhbHVhdGluZyBmdW5jdGlvbiBmIG9uIGVhY2ggZWxlbWVudCBvZiB0aGUgQXJyYXkgYSByZXR1cm5zIHRydWUuCiAqCiAqIEBwYXJhbSBhOiAoQXJyYXkpIFRoZSBhcnJheSBvZiBlbGVtZW50cyB0byBldmFsdWF0ZQogKiBAcGFyYW0gZjogKEZ1bmN0aW9uKSBBIHNpbmdsZSBhcmd1bWVudCBmdW5jdGlvbiBmb3IgbWFwcGluZyBlbGVtZW50cyBvZiB0aGUgYXJyYXkgdG8gYm9vbGVhbi4KICogQHJldHVybiBib29sZWFuLgogKi8KYWxsID0gZnVuY3Rpb24oYSwgZikgewogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChmKGFbaV0pID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHRydWU7Cn07CgovKioKICogUmV0dXJucyB0cnVlIGlmIGV2YWx1YXRpbmcgZnVuY3Rpb24gZiBvbiBhbnkgZWxlbWVudCBvZiB0aGUgQXJyYXkgYSByZXR1cm5zIHRydWUuCiAqCiAqIEBwYXJhbSBhOiAoQXJyYXkpIFRoZSBhcnJheSBvZiBlbGVtZW50cyB0byBldmFsdWF0ZQogKiBAcGFyYW0gZjogKEZ1bmN0aW9uKSBBIHNpbmdsZSBhcmd1bWVudCBmdW5jdGlvbiBmb3IgbWFwcGluZyBlbGVtZW50cyBvZiB0aGUgYXJyYXkgdG8gYm9vbGVhbi4KICogQHJldHVybiBib29sZWFuLgogKi8KYW55ID0gZnVuY3Rpb24oYSwgZikgewogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChmKGFbaV0pID09PSB0cnVlKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBmYWxzZTsKfTsKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIGxvY2F0aW9uIGlzIG51bGwgb3IgaGFzIHVuZGVmaW5lZCBsb25naXR1ZGUgb3IgbGF0aXR1ZGUgdmFsdWVzLgogKgogKiBAcGFyYW0gbG9jYXRpb246IHsKICogICAgICAgICAgICAibGF0aXR1ZGUiOiAoTnVtYmVyKSBUaGUgbGF0aXR1ZGUuCiAqICAgICAgICAgICAgImxvbmdpdHVkZSI6IChOdW1iZXIpIFRoZSBsb25naXR1ZGUuCiAqICAgICAgICB9CiAqIEByZXR1cm4gYm9vbGVhbgogKi8KdW5kZWZpbmVkTG9jYXRpb24gPSBmdW5jdGlvbihsb2NhdGlvbikgewogICAgcmV0dXJuIG51bGxPclVuZGVmaW5lZChsb2NhdGlvbikgfHwgbnVsbE9yVW5kZWZpbmVkKGxvY2F0aW9uLmxhdGl0dWRlKSB8fCBudWxsT3JVbmRlZmluZWQobG9jYXRpb24ubG9uZ2l0dWRlKTsKfTsKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHZhbHVlIGlzIG51bGwgb3IgdW5kZWZpbmVkLgogKgogKiBAcGFyYW0gdmFsdWU6IGEgdmFsdWUgb2YgYW55IHR5cGUKICogQHJldHVybiBib29sZWFuCiAqLwpudWxsT3JVbmRlZmluZWQgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQ7Cn07CgovKioKICogQ2FsY3VsYXRlcyB0aGUgZGlzdGFuY2VzIGJldHdlZW4gdGhlIHR3byBsb2NhdGlvbnMuCiAqCiAqIEBwYXJhbSBmaXJzdDogewogKiAgICAgICAgICAgICJsYXRpdHVkZSI6IChOdW1iZXIpIFRoZSBmaXJzdCBsYXRpdHVkZS4KICogICAgICAgICAgICAibG9uZ2l0dWRlIjogKE51bWJlcikgVGhlIGZpcnN0IGxvbmdpdHVkZS4KICogICAgICAgIH0KICogQHBhcmFtIHNlY29uZDogewogKiAgICAgICAgICAgICJsYXRpdHVkZSI6IChOdW1iZXIpIFRoZSBzZWNvbmQgbGF0aXR1ZGUuCiAqICAgICAgICAgICAgImxvbmdpdHVkZSI6IChOdW1iZXIpIFRoZSBzZWNvbmQgbG9uZ2l0dWRlLgogKiAgICAgICAgfQogKiBAcmV0dXJuIE51bWJlciBUaGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgdHdvIGxvY2F0aW9ucy4KICovCmNhbGN1bGF0ZURpc3RhbmNlID0gZnVuY3Rpb24oZmlyc3QsIHNlY29uZCkgewogICAgdmFyIGZhY3RvciA9IChNYXRoLlBJIC8gMTgwKSwKICAgICAgICB0aGV0YSwKICAgICAgICBkaXN0OwogICAgZnVuY3Rpb24gZGVncmVlc1RvUmFkaWFucyhkZWdyZWVzKSB7CiAgICAgICAgcmV0dXJuIGRlZ3JlZXMgKiBmYWN0b3I7CiAgICB9CiAgICBmdW5jdGlvbiByYWRpYW5zVG9EZWdyZWVzKHJhZGlhbnMpIHsKICAgICAgICByZXR1cm4gcmFkaWFucyAvIGZhY3RvcjsKICAgIH0KICAgIHRoZXRhID0gZmlyc3QubG9uZ2l0dWRlIC0gc2Vjb25kLmxvbmdpdHVkZTsKICAgIGRpc3QgPSBNYXRoLnNpbihkZWdyZWVzVG9SYWRpYW5zKGZpcnN0LmxhdGl0dWRlKSkgKiBNYXRoLnNpbihkZWdyZWVzVG9SYWRpYW5zKHNlY29uZC5sYXRpdHVkZSkpCiAgICAgICAgKyBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKGZpcnN0LmxhdGl0dWRlKSkgKiBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKHNlY29uZC5sYXRpdHVkZSkpCiAgICAgICAgKiBNYXRoLmNvcyhkZWdyZWVzVG9SYWRpYW5zKHRoZXRhKSk7CiAgICBkaXN0ID0gTWF0aC5hY29zKGRpc3QpOwogICAgZGlzdCA9IHJhZGlhbnNUb0RlZ3JlZXMoZGlzdCk7CiAgICBkaXN0ID0gZGlzdCAqIDYwICogMS4xNTE1OwogICAgcmV0dXJuIGRpc3Q7Cn07CgovKioKICogQ29udmVydHMgYSBTdHJpbmcgaG9sZGluZyBhIGRlbGltaXRlZCBzZXF1ZW5jZSBvZiB2YWx1ZXMgaW50byBhbiBhcnJheS4KICoKICogQHBhcmFtIHRleHQgKFN0cmluZykgVGhlIFN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBhIGRlbGltaXRlZCBzZXF1ZW5jZSBvZiB2YWx1ZXMuCiAqIEBwYXJhbSBkZWxpbWl0ZXIgKFN0cmluZykgVGhlIGNoYXJhY3RlciBkZWxpbWl0aW5nIHZhbHVlcyB3aXRoaW4gdGhlIHRleHQgU3RyaW5nLgogKiBAcmV0dXJuIChBcnJheSkgVGhlIGNvbW1hIHNlcGFyYXRlZCB2YWx1ZXMuCiAqLwpzcGxpdEFuZFRyaW0gPSBmdW5jdGlvbih0ZXh0LCBkZWxpbWl0ZXIpIHsKCiAgICB2YXIgcmVzdWx0cyA9IFtdLAogICAgICAgIGksCiAgICAgICAgdmFsdWVzLAogICAgICAgIHZhbHVlOwogICAgaWYgKHRleHQgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgIH0KCiAgICB2YWx1ZXMgPSB0ZXh0LnNwbGl0KGRlbGltaXRlcik7CiAgICBmb3IgKGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV0udHJpbSgpOwogICAgICAgIGlmICh2YWx1ZSAhPT0gIiIpIHsKICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdHM7Cn07CgovKioKICogQ29udmVydHMgdmFsdWUgdG8gYSBwZXJjZW50YWdlIG9mIHJhbmdlLgogKgogKiBAcGFyYW0gdmFsdWUgKE51bWJlcikgVGhlIGFjdHVhbCBudW1iZXIgdG8gYmUgY29udmVydGVkIHRvIGEgcGVyY2VudGFnZS4KICogQHBhcmFtIHJhbmdlIChOdW1iZXIpIFRoZSB0b3RhbCBudW1iZXIgb2YgdmFsdWVzIChpLmUuIHJlcHJlc2VudHMgMTAwJSkuCiAqIEByZXR1cm4gKE51bWJlcikgVGhlIHBlcmNlbnRhZ2UuCiAqLwpjYWxjdWxhdGVQZXJjZW50YWdlID0gZnVuY3Rpb24odmFsdWUsIHJhbmdlKSB7CiAgICBpZiAocmFuZ2UgPT09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiBwYXJzZUZsb2F0KCh2YWx1ZSAvIHJhbmdlKS50b1ByZWNpc2lvbigyKSkgKiAxMDA7Cn07CgovKioKICogQ3JlYXRlcyBhIG5ldyBhcnJheSBjb250YWluaW5nIG9ubHkgdGhvc2UgZWxlbWVudHMgZm91bmQgaW4gYm90aCBhcnJheXMgcmVjZWl2ZWQgYXMgYXJndW1lbnRzLgogKgogKiBAcGFyYW0gZmlyc3QgKEFycmF5KSBUaGUgZmlyc3QgYXJyYXkuCiAqIEBwYXJhbSBzZWNvbmQgKEFycmF5KSBUaGUgc2Vjb25kIGFycmF5LgogKiBAcmV0dXJuIChBcnJheSkgVGhlIGVsZW1lbnRzIHRoYXQgZm91bmQgaW4gZmlyc3QgYW5kIHNlY29uZC4KICovCmNhbGN1bGF0ZUludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGZpcnN0LCBzZWNvbmQpIHsKICAgIHJldHVybiBmaXJzdC5maWx0ZXIoZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgIHJldHVybiBzZWNvbmQuaW5kZXhPZihlbGVtZW50KSAhPT0gLTE7CiAgICB9KTsKfTsKCmZ1bmN0aW9uIGdldFZhbHVlKG9iaiwgYXR0cmlidXRlUGF0aCkgewogICAgdmFyIHZhbHVlID0gb2JqLAogICAgICAgIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgYXR0cmlidXRlUGF0aC5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICB2YWx1ZSA9IHZhbHVlW2F0dHJpYnV0ZVBhdGhbaV1dOwogICAgfQogICAgcmV0dXJuIHZhbHVlOwp9CgoKZnVuY3Rpb24gaXNMZWFmTm9kZShhdHRyaWJ1dGVDb25maWcpIHsKICAgIHJldHVybiBhdHRyaWJ1dGVDb25maWcuY29tcGFyYXRvciAhPT0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBnZXRBdHRyaWJ1dGVQYXRocyhhdHRyaWJ1dGVDb25maWcsIGF0dHJpYnV0ZVBhdGgpIHsKCiAgICB2YXIgYXR0cmlidXRlUGF0aHMgPSBbXSwKICAgICAgICBhdHRyaWJ1dGVOYW1lLAogICAgICAgIGF0dHJQYXRocywKICAgICAgICBhdHRyUGF0aCwKICAgICAgICBpOwoKICAgIGZvciAoYXR0cmlidXRlTmFtZSBpbiBhdHRyaWJ1dGVDb25maWcpIHsKICAgICAgICBpZiAoYXR0cmlidXRlQ29uZmlnLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKSB7CgogICAgICAgICAgICBpZiAoaXNMZWFmTm9kZShhdHRyaWJ1dGVDb25maWdbYXR0cmlidXRlTmFtZV0pKSB7CiAgICAgICAgICAgICAgICBhdHRyUGF0aCA9IGF0dHJpYnV0ZVBhdGguc2xpY2UoKTsKICAgICAgICAgICAgICAgIGF0dHJQYXRoLnB1c2goYXR0cmlidXRlTmFtZSk7CiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVQYXRocy5wdXNoKGF0dHJQYXRoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGF0dHJQYXRoID0gYXR0cmlidXRlUGF0aC5zbGljZSgpOwogICAgICAgICAgICAgICAgYXR0clBhdGgucHVzaChhdHRyaWJ1dGVOYW1lKTsKICAgICAgICAgICAgICAgIGF0dHJQYXRocyA9IGdldEF0dHJpYnV0ZVBhdGhzKGF0dHJpYnV0ZUNvbmZpZ1thdHRyaWJ1dGVOYW1lXSwgYXR0clBhdGgpOwogICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGF0dHJQYXRocy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVBhdGhzLnB1c2goYXR0clBhdGhzW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYXR0cmlidXRlUGF0aHM7Cn0KCmZ1bmN0aW9uIGdldERldmljZVByaW50QXR0cmlidXRlUGF0aHMoYXR0cmlidXRlQ29uZmlnKSB7CiAgICByZXR1cm4gZ2V0QXR0cmlidXRlUGF0aHMoYXR0cmlidXRlQ29uZmlnLCBbXSk7Cn0KCmZ1bmN0aW9uIGhhc1JlcXVpcmVkQXR0cmlidXRlcyhkZXZpY2VQcmludCwgYXR0cmlidXRlQ29uZmlnKSB7CgogICAgdmFyIGF0dHJpYnV0ZVBhdGhzID0gZ2V0RGV2aWNlUHJpbnRBdHRyaWJ1dGVQYXRocyhhdHRyaWJ1dGVDb25maWcpLAogICAgICAgIGksCiAgICAgICAgYXR0clZhbHVlLAogICAgICAgIGF0dHJDb25maWc7CgogICAgZm9yIChpID0gMDsgaSA8IGF0dHJpYnV0ZVBhdGhzLmxlbmd0aDsgaSsrKSB7CgogICAgICAgIGF0dHJWYWx1ZSA9IGdldFZhbHVlKGRldmljZVByaW50LCBhdHRyaWJ1dGVQYXRoc1tpXSk7CiAgICAgICAgYXR0ckNvbmZpZyA9IGdldFZhbHVlKGF0dHJpYnV0ZUNvbmZpZywgYXR0cmlidXRlUGF0aHNbaV0pOwoKICAgICAgICBpZiAoYXR0ckNvbmZpZy5yZXF1aXJlZCAmJiBhdHRyVmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBsb2dnZXIud2FybmluZygiRGV2aWNlIFByaW50IHByb2ZpbGUgbWlzc2luZyByZXF1aXJlZCBhdHRyaWJ1dGUsICIgKyBhdHRyaWJ1dGVQYXRoc1tpXSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgbG9nZ2VyLm1lc3NhZ2UoImRldmljZSBwcmludCBoYXMgcmVxdWlyZWQgYXR0cmlidXRlcyIpOwogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIGNvbXBhcmVEZXZpY2VQcmludFByb2ZpbGVzKGF0dHJpYnV0ZUNvbmZpZywgZGV2aWNlUHJpbnQsIGRldmljZVByaW50UHJvZmlsZXMsIG1heFBlbmFsdHlQb2ludHMpIHsKCiAgICB2YXIgYXR0cmlidXRlUGF0aHMgPSBnZXREZXZpY2VQcmludEF0dHJpYnV0ZVBhdGhzKGF0dHJpYnV0ZUNvbmZpZyksCiAgICAgICAgZGFvID0gc2hhcmVkU3RhdGUuZ2V0KCdfRGV2aWNlSWREYW8nKSwKICAgICAgICByZXN1bHRzLAogICAgICAgIGosCiAgICAgICAgYWdncmVnYXRlZENvbXBhcmlzb25SZXN1bHQsCiAgICAgICAgaSwKICAgICAgICBjdXJyZW50VmFsdWUsCiAgICAgICAgc3RvcmVkVmFsdWUsCiAgICAgICAgYXR0ckNvbmZpZywKICAgICAgICBjb21wYXJpc29uUmVzdWx0LAogICAgICAgIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdCwKICAgICAgICBzZWxlY3RlZFByb2ZpbGUsCiAgICAgICAgY3VyRGV2aWNlUHJpbnRQcm9maWxlLAogICAgICAgIHZhbHM7CgogICAgcmVzdWx0cyA9IFtdOwogICAgZm9yIChqID0gMDsgaiA8IGRldmljZVByaW50UHJvZmlsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjdXJEZXZpY2VQcmludFByb2ZpbGUgPSBKU09OLnBhcnNlKG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuanNvbihkZXZpY2VQcmludFByb2ZpbGVzW2pdKSk7CiAgICAgICAgYWdncmVnYXRlZENvbXBhcmlzb25SZXN1bHQgPSBuZXcgQ29tcGFyaXNvblJlc3VsdCgpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdHRyaWJ1dGVQYXRocy5sZW5ndGg7IGkrKykgewoKICAgICAgICAgICAgY3VycmVudFZhbHVlID0gZ2V0VmFsdWUoZGV2aWNlUHJpbnQsIGF0dHJpYnV0ZVBhdGhzW2ldKTsKICAgICAgICAgICAgc3RvcmVkVmFsdWUgPSBnZXRWYWx1ZShjdXJEZXZpY2VQcmludFByb2ZpbGUuZGV2aWNlUHJpbnQsIGF0dHJpYnV0ZVBhdGhzW2ldKTsKICAgICAgICAgICAgYXR0ckNvbmZpZyA9IGdldFZhbHVlKGF0dHJpYnV0ZUNvbmZpZywgYXR0cmlidXRlUGF0aHNbaV0pOwoKICAgICAgICAgICAgaWYgKHN0b3JlZFZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBjb21wYXJpc29uUmVzdWx0ID0gbmV3IENvbXBhcmlzb25SZXN1bHQoYXR0ckNvbmZpZy5wZW5hbHR5UG9pbnRzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbXBhcmlzb25SZXN1bHQgPSBhdHRyQ29uZmlnLmNvbXBhcmF0b3IuY29tcGFyZShjdXJyZW50VmFsdWUsIHN0b3JlZFZhbHVlLCBhdHRyQ29uZmlnLmFyZ3MpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJDb21wYXJpbmcgYXR0cmlidXRlIHBhdGg6ICIgKyBhdHRyaWJ1dGVQYXRoc1tpXQogICAgICAgICAgICAgICAgICAgICsgIiwgQ29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IiArIGNvbXBhcmlzb25SZXN1bHQuaXNTdWNjZXNzZnVsKCkgKyAiLCBwZW5hbHR5UG9pbnRzPSIKICAgICAgICAgICAgICAgICAgICArIGNvbXBhcmlzb25SZXN1bHQucGVuYWx0eVBvaW50cyArICIsIGFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWU9IgogICAgICAgICAgICAgICAgICAgICsgY29tcGFyaXNvblJlc3VsdC5hZGRpdGlvbmFsSW5mb0luQ3VycmVudFZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5hZGRDb21wYXJpc29uUmVzdWx0KGNvbXBhcmlzb25SZXN1bHQpOwogICAgICAgIH0KICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkFnZ3JlZ2F0ZWQgY29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IgogICAgICAgICAgICAgICAgKyBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKSArICIsIHBlbmFsdHlQb2ludHM9IgogICAgICAgICAgICAgICAgKyBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdC5wZW5hbHR5UG9pbnRzICsgIiwgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZT0iCiAgICAgICAgICAgICAgICArIGFnZ3JlZ2F0ZWRDb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0cy5wdXNoKHsKICAgICAgICAgICAga2V5OiBhZ2dyZWdhdGVkQ29tcGFyaXNvblJlc3VsdCwKICAgICAgICAgICAgdmFsdWU6IGRldmljZVByaW50UHJvZmlsZXNbal0KICAgICAgICB9KTsKICAgIH0KCiAgICBpZiAocmVzdWx0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXN1bHRzLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAgIHJldHVybiBDb21wYXJpc29uUmVzdWx0LmNvbXBhcmUoYS5rZXksIGIua2V5KTsKICAgIH0pOwogICAgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0ID0gcmVzdWx0c1swXS5rZXk7CiAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICBsb2dnZXIubWVzc2FnZSgiU2VsZWN0ZWQgY29tcGFyaXNvbiByZXN1bHQ6IHN1Y2Nlc3NmdWw9IiArIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdC5pc1N1Y2Nlc3NmdWwoKQogICAgICAgICAgICArICIsIHBlbmFsdHlQb2ludHM9IiArIHNlbGVjdGVkQ29tcGFyaXNvblJlc3VsdC5wZW5hbHR5UG9pbnRzICsgIiwgYWRkaXRpb25hbEluZm9JbkN1cnJlbnRWYWx1ZT0iCiAgICAgICAgICAgICsgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LmFkZGl0aW9uYWxJbmZvSW5DdXJyZW50VmFsdWUpOwogICAgfQoKICAgIHNlbGVjdGVkUHJvZmlsZSA9IG51bGw7CiAgICBpZiAoc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHMgPD0gbWF4UGVuYWx0eVBvaW50cykgewogICAgICAgIHNlbGVjdGVkUHJvZmlsZSA9IHJlc3VsdHNbMF0udmFsdWU7CiAgICAgICAgaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJTZWxlY3RlZCBwcm9maWxlOiAiICsgc2VsZWN0ZWRQcm9maWxlICsKICAgICAgICAgICAgICAgICIgd2l0aCAiICsgc2VsZWN0ZWRDb21wYXJpc29uUmVzdWx0LnBlbmFsdHlQb2ludHMgKyAiIHBlbmFsdHkgcG9pbnRzIik7CiAgICAgICAgfQogICAgfQoKICAgIGlmIChzZWxlY3RlZFByb2ZpbGUgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyogdXBkYXRlIHByb2ZpbGUgKi8KICAgIHNlbGVjdGVkUHJvZmlsZS5wdXQoInNlbGVjdGlvbkNvdW50ZXIiLAogICAgICAgIGphdmEubGFuZy5JbnRlZ2VyLnZhbHVlT2YocGFyc2VJbnQoc2VsZWN0ZWRQcm9maWxlLmdldCgic2VsZWN0aW9uQ291bnRlciIpLCAxMCkgKyAxKSk7CiAgICBzZWxlY3RlZFByb2ZpbGUucHV0KCJsYXN0U2VsZWN0ZWREYXRlIiwgamF2YS5sYW5nLkxvbmcudmFsdWVPZihuZXcgRGF0ZSgpLmdldFRpbWUoKSkpOwogICAgc2VsZWN0ZWRQcm9maWxlLnB1dCgiZGV2aWNlUHJpbnQiLCBkZXZpY2VQcmludCk7CgogICAgdmFscyA9IFtdOwogICAgZm9yIChpID0gMDsgaSA8IGRldmljZVByaW50UHJvZmlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YWxzLnB1c2gob3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uKGRldmljZVByaW50UHJvZmlsZXNbaV0pKTsKICAgIH0KCiAgICBkYW8uc2F2ZURldmljZVByb2ZpbGVzKHVzZXJuYW1lLCByZWFsbSwgdmFscyk7CgogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIG1hdGNoRGV2aWNlUHJpbnQoKSB7CgogICAgaWYgKCF1c2VybmFtZSkgewogICAgICAgIGxvZ2dlci5lcnJvcigiVXNlcm5hbWUgbm90IHNldC4gQ2Fubm90IGNvbXBhcmUgdXNlcidzIGRldmljZSBwcmludCBwcm9maWxlcy4iKTsKICAgICAgICBhdXRoU3RhdGUgPSBGQUlMRUQ7CiAgICB9IGVsc2UgewoKICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoImNsaWVudCBkZXZpY2VQcmludDogIiArIGNsaWVudFNjcmlwdE91dHB1dERhdGEpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGdldFByb2ZpbGVzID0gZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzRXhwaXJlZFByb2ZpbGUoZGV2aWNlUHJpbnRQcm9maWxlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cGlyYXRpb25EYXRlID0gbmV3IERhdGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFNlbGVjdGVkRGF0ZTsKICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uRGF0ZS5zZXREYXRlKGV4cGlyYXRpb25EYXRlLmdldERhdGUoKSAtIGNvbmZpZy5wcm9maWxlRXhwaXJhdGlvbik7CgogICAgICAgICAgICAgICAgICAgIGxhc3RTZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkZXZpY2VQcmludFByb2ZpbGUubGFzdFNlbGVjdGVkRGF0ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXN0U2VsZWN0ZWREYXRlIDwgZXhwaXJhdGlvbkRhdGU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Tm90RXhwaXJlZFByb2ZpbGVzKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAgICBkYW8gPSBzaGFyZWRTdGF0ZS5nZXQoJ19EZXZpY2VJZERhbycpLAogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGVzLAogICAgICAgICAgICAgICAgICAgICAgICBpdGVyOwoKICAgICAgICAgICAgICAgICAgICBwcm9maWxlcyA9IGRhby5nZXREZXZpY2VQcm9maWxlcyh1c2VybmFtZSwgcmVhbG0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlciA9IHByb2ZpbGVzLml0ZXJhdG9yKCk7CgogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUgPSBpdGVyLm5leHQoKS5nZXRPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNFeHBpcmVkUHJvZmlsZShwcm9maWxlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwcm9maWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLm1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoInN0b3JlZCBub24tZXhwaXJlZCBwcm9maWxlczogIiArIHJlc3VsdHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Tm90RXhwaXJlZFByb2ZpbGVzKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRldmljZVByaW50ID0gSlNPTi5wYXJzZShjbGllbnRTY3JpcHRPdXRwdXREYXRhKSwKICAgICAgICAgICAgZGV2aWNlUHJpbnRQcm9maWxlcyA9IGdldFByb2ZpbGVzKCk7CgogICAgICAgIGlmICghaGFzUmVxdWlyZWRBdHRyaWJ1dGVzKGRldmljZVByaW50LCBjb25maWcuYXR0cmlidXRlcykpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoImRldmljZVByaW50Lmhhc1JlcXVpcmVkQXR0cmlidXRlczogZmFsc2UiKTsKICAgICAgICAgICAgLy8gV2lsbCBmYWlsIHRoaXMgbW9kdWxlIGJ1dCBmYWxsLXRocm91Z2ggdG8gbmV4dCBtb2R1bGUuIFdoaWNoIHNob3VsZCBiZSBPVFAuCiAgICAgICAgICAgIGF1dGhTdGF0ZSA9IEZBSUxFRDsKICAgICAgICB9IGVsc2UgaWYgKGNvbXBhcmVEZXZpY2VQcmludFByb2ZpbGVzKGNvbmZpZy5hdHRyaWJ1dGVzLCBkZXZpY2VQcmludCwgZGV2aWNlUHJpbnRQcm9maWxlcywgY29uZmlnLm1heFBlbmFsdHlQb2ludHMpKSB7CiAgICAgICAgICAgIGxvZ2dlci5tZXNzYWdlKCJkZXZpY2VQcmludC5oYXNWYWxpZFByb2ZpbGU6IHRydWUiKTsKICAgICAgICAgICAgYXV0aFN0YXRlID0gU1VDQ0VTUzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2dnZXIubWVzc2FnZSgiZGV2aWNlUHJpbnQuaGFzVmFsaWRQcm9maWxlOiBmYWxzZSIpOwogICAgICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoJ2RldmljZVByaW50UHJvZmlsZScsIEpTT04uc3RyaW5naWZ5KGRldmljZVByaW50KSk7CiAgICAgICAgICAgIC8vIFdpbGwgZmFpbCB0aGlzIG1vZHVsZSBidXQgZmFsbC10aHJvdWdoIHRvIG5leHQgbW9kdWxlLiBXaGljaCBzaG91bGQgYmUgT1RQLgogICAgICAgICAgICBhdXRoU3RhdGUgPSBGQUlMRUQ7CiAgICAgICAgfQogICAgfQp9CgptYXRjaERldmljZVByaW50KCk7\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_SERVER_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.846Z",
        "time": 44,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 44
        }
      },
      {
        "_id": "e5cb46a295a19dee8475fc0096b32728",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Copy to transientState\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Copy%20to%20transientState%22"
        },
        "response": {
          "bodySize": 873,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 873,
            "text": "{\"result\":[{\"_id\":\"452d73ee-c6f3-4f4e-9dae-e75bb3886cbd\",\"name\":\"Copy to transientState\",\"description\":\"Copy sharedState to transientState\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkKfQppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKQp9CmlmIChzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpKSB7Cgl0cmFuc2llbnRTdGF0ZS5wdXQoIl9pZCIsIHNoYXJlZFN0YXRlLmdldCgiX2lkIikpCn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "873"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.895Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "528d8c0c709e13fdba334c9c6a84a810",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 587,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Normalized Profile to Managed User\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Normalized%20Profile%20to%20Managed%20User%22"
        },
        "response": {
          "bodySize": 3125,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3125,
            "text": "{\"result\":[{\"_id\":\"58c824ae-84ed-4724-82cd-db128fc3f6c\",\"name\":\"Normalized Profile to Managed User\",\"description\":\"Converts a normalized social profile into a managed user\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgbWFuYWdlZFVzZXIgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlck5hbWUiLCBub3JtYWxpemVkUHJvZmlsZS51c2VybmFtZSkpKQoKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQoKLy8gaWYgdGhlIGdpdmVuTmFtZSBhbmQgZmFtaWx5TmFtZSBpcyBudWxsIG9yIGVtcHR5Ci8vIHRoZW4gYWRkIGEgYm9vbGVhbiBmbGFnIHRvIHRoZSBzaGFyZWQgc3RhdGUgdG8gaW5kaWNhdGUgbmFtZXMgYXJlIG5vdCBwcmVzZW50Ci8vIHRoaXMgY291bGQgYmUgdXNlZCBlbHNld2hlcmUKLy8gZm9yIGVnLiB0aGlzIGNvdWxkIGJlIHVzZWQgaW4gYSBzY3JpcHRlZCBkZWNpc2lvbiBub2RlIHRvIGJ5LXBhc3MgcGF0Y2hpbmcKLy8gdGhlIHVzZXIgb2JqZWN0IHdpdGggYmxhbmsgdmFsdWVzIHdoZW4gZ2l2ZW5OYW1lICBhbmQgZmFtaWx5TmFtZSBpcyBub3QgcHJlc2VudApib29sZWFuIG5vR2l2ZW5OYW1lID0gbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmFzU3RyaW5nKCk/LnRyaW0oKSkKYm9vbGVhbiBub0ZhbWlseU5hbWUgPSBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZS5hc1N0cmluZygpPy50cmltKCkpCnNoYXJlZFN0YXRlLnB1dCgibmFtZUVtcHR5T3JOdWxsIiwgbm9HaXZlbk5hbWUgJiYgbm9GYW1pbHlOYW1lKQoKcmV0dXJuIG1hbmFnZWRVc2VyCg==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3125"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.932Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "0148f899dd2069fa745eec81d06fe4b1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 576,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Populate Customer as Type\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Populate%20Customer%20as%20Type%22"
        },
        "response": {
          "bodySize": 1377,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1377,
            "text": "{\"result\":[{\"_id\":\"238bd3c1-6396-470b-8411-b175a292dfeb\",\"name\":\"Populate Customer as Type\",\"description\":\"Places 'customer' in the 'entityType' attribute\",\"script\":\"bG9nZ2VyLmVycm9yKCdQb3BUeXBlQXNDdXN0b21lcjogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJ1c2VyTmFtZSIpOwp2YXIgaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIl9pZCIpOwpsb2dnZXIuZXJyb3IoJ1VzZXJOYW1lJyArIHVzZXJuYW1lICsgJyBfaWQ6ICcgKyBpZCk7CnZhciBteVR5cGUgPSAiY3VzdG9tZXIiOwoKc2V0T2JqZWN0QXR0cmlidXRlKCJkZXNjcmlwdGlvbiIsIG15VHlwZSk7CnNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIseyJ1c2VyTmFtZSI6dXNlcm5hbWUsImRlc2NyaXB0aW9uIjpteVR5cGV9KTsKbG9nZ2VyLmVycm9yKCdNeSBUeXBlID0gJyArIG15VHlwZSk7CgpmdW5jdGlvbiBzZXRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgICB9Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1377"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:27.973Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "9f6444bf5b25d56d6dc05c989e7c7b9d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Suspend Authentication\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Suspend%20Authentication%22"
        },
        "response": {
          "bodySize": 3773,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3773,
            "text": "{\"result\":[{\"_id\":\"36185679-b74f-479c-b1aa-6f6e852cca11\",\"name\":\"Suspend Authentication\",\"description\":\"Suspend authentication\",\"script\":\"LyogU3VzcGVuZCBBdXRoZW50aWNhdGlvbgogKiAKICogU3VzcGVuZCBBdXRoZW50aWNhdGlvbi4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKCiAgICB2YXIgYW5jaG9yID0gImFuY2hvci0iLmNvbmNhdChnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4JykpOwogICAgdmFyIGhhbGlnbiA9ICJsZWZ0IjsKICAgIHZhciBtZXNzYWdlID0gIjxoND5DdXJyZW50IFN0YXRlIFZhbHVlczwvaDQ+Ii5jb25jYXQoCiAgICAgICAgIjxwPjxiPlNoYXJlZCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5UcmFuc2llbnQgU3RhdGU8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHRyYW5zaWVudFN0YXRlLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpLmNvbmNhdCgKICAgICAgICAiPHA+PGI+UmVxdWVzdCBIZWFkZXJzPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICByZXF1ZXN0SGVhZGVycy50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKQogICAgdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICAgICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgICAgICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICAgICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgICAgICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuY2xhc3NOYW1lID0gXCJcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLnN0eWxlID0gXCJ0ZXh0LWFsaWduOiBsZWZ0OyBpbmxpbmUtc2l6ZTogNDMwcHg7IG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7XCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICAgICAiICB9XG4iKS5jb25jYXQoCiAgICAgICJ9KSIpCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgICAgICkuYnVpbGQoKQogICAgfQogICAgZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgIC8qCiAgICAgICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAgICAgKiAKICAgICAgKiBFeGFtcGxlOgogICAgICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICAgICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAgICAgKi8KICAgIGZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICAgIHZhciB2ID0gcjsKICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgICAgIH0pOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3773"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.012Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "945e3364d6ed180bc93576ef2f0f323d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Set Email Verified\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Set%20Email%20Verified%22"
        },
        "response": {
          "bodySize": 1454,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1454,
            "text": "{\"result\":[{\"_id\":\"7b88752e-5529-459c-a970-1fb78ff0d87f\",\"name\":\"Set Email Verified\",\"description\":\"Set eMail attribute to Verified\",\"script\":\"LyoKICogVXBkYXRlIHRoZSBlbWFpbCB2ZXJpZmllZCBhdHRyaWJ1dGUgZnJVbmluZGV4ZWRTdHJpbmc1CiAqLwoKbG9nZ2VyLmVycm9yKCdTZXQgRW1haWwgVmVyaWZpZWQ6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgidXNlck5hbWUiKTsKLy92YXIgaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIl9pZCIpOwpsb2dnZXIuZXJyb3IoJ1NldCBFbWFpbCBWZXJpZmllZDogdXNlck5hbWUgJyArIHVzZXJuYW1lKTsKCgoKc2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiLCAidmVyaWZpZWQiKTsKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIix7InVzZXJOYW1lIjp1c2VybmFtZSwiZnJVbmluZGV4ZWRTdHJpbmc1IjoidmVyaWZpZWQifSk7CgpmdW5jdGlvbiBzZXRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewogICAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgICB9Cn0Kb3V0Y29tZSA9ICJ0cnVlIjsKbG9nZ2VyLmVycm9yKCdTZXQgRW1haWwgVmVyaWZpZWQ6IEVORCcp\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1454"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.053Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "adc0a429afbd10a292c48e998df81ce7",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Inspect Username\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Inspect%20Username%22"
        },
        "response": {
          "bodySize": 1760,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1760,
            "text": "{\"result\":[{\"_id\":\"23e88721-ea4a-4da2-bfba-33d82fd0317d\",\"name\":\"Inspect Username\",\"description\":\"Reads the shared state \\\"_id\\\" attribute. Fetches the userName (uid0 object from the users. Saves the userName to shared state. (in both userName and username). Then returns outcome if the username starts with \\\"anon-\\\" outcome = anonymous. Otherwise outcome = known.\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKCnZhciB0aGVfaWQgPSAgc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKTsKCnZhciB1c2VyTmFtZSA9IHNpbmdsZVZhbHVlKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodGhlX2lkLCAidWlkIikpOwoKCgpzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgdXNlck5hbWUpOwpzaGFyZWRTdGF0ZS5wdXQoInVzZXJOYW1lIiwgdXNlck5hbWUpOwoKCi8vdXNlck5hbWUubGFzdEluZGV4T2YoImFub24tIiwwKSBjaGVja3MgaWYgdXNlcm5hbWUgc3RhcnRzIHdpdGggYW5vbi0uICAKLy9IYXZpbmcgaXNzdWVzIHNwZWNpZmljYWxseSB3aXRoICJzdGFydHNXaXRoIiBmdW5jdGlvbgppZih1c2VyTmFtZS5sYXN0SW5kZXhPZigiYW5vbi0iLDApPT09MCkKICAgewogICAgIG91dGNvbWUgPSAiYW5vbnltb3VzIjsKICAgICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJUeXBlIiwgImFub255bW91cyIpOwogICB9CmVsc2UKICAgewogICBvdXRjb21lID0gImtub3duIjsKICAgICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJUeXBlIiwgImtub3duIik7CiAgIH0KCgoKZnVuY3Rpb24gc2luZ2xlVmFsdWUoeCkKewoJaWYoeC5zaXplKCk+MCkKICAgIHsKICAgIAlyZXR1cm4geC5pdGVyYXRvcigpLm5leHQoKTsKICAgIH0KICAgIAogIHJldHVybiAiIjsKICAKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1760"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.093Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "af93d401ef5c6fa2d3d69d74a02ae1e1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFAMethod_sms\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFAMethod_sms%22"
        },
        "response": {
          "bodySize": 1421,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1421,
            "text": "{\"result\":[{\"_id\":\"e3f46912-22de-40ac-a3c7-7c3ce9142643\",\"name\":\"AT_MFAMethod_sms\",\"description\":\"This script puts 'sms' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3NtczogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKQpsb2dnZXIuZXJyb3IoJ0FUX01GQU1ldGhvZF9zbXM6IF9pZCAnICsgdXNlcm5hbWUpOwp2YXIgYXR0cmlidXRlID0gImZyLWF0dHItc3RyMiIKCmlkUmVwb3NpdG9yeS5zZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSwgWyJzbXMiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfc21zOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1421"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.134Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "2fbfcc1fb044570838e27a36bcb7d8b0",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 572,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Sanitize objectAttributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Sanitize%20objectAttributes%22"
        },
        "response": {
          "bodySize": 2627,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2627,
            "text": "{\"result\":[{\"_id\":\"a064f7b7-29c5-480b-ac09-d3d122829278\",\"name\":\"Sanitize objectAttributes\",\"description\":\"Sanitize objectAttributes\",\"script\":\"LyoKewogICAgInVzZXJOYW1lIjogInNob2xtZXMiLAogICAgImdpdmVuTmFtZSI6ICJTaGVybG9jayIsCiAgICAic24iOiAiSG9sbWVzIiwKICAgICJtYWlsIjogImluZm85MThAMDYxNTJhbGVydHMuc2VjdXJpdHkub3JnIiwKICAgICJ0ZWxlcGhvbmVOdW1iZXIiOiAsCiAgICAicG9zdGFsQWRkcmVzcyI6ICIyMjFCIEJha2VyIFN0cmVldCIsCiAgICAiY2l0eSI6ICJMb25kb24iLAogICAgInN0YXRlUHJvdmluY2UiOiAsCiAgICAicG9zdGFsQ29kZSI6ICJOVzEiLAogICAgImNvdW50cnkiOiAiVW5pdGVkIFN0YXRlcyIsCiAgICAicHJlZmVyZW5jZXMiOiB7CiAgICAgICAgIm1hcmtldGluZyI6IGZhbHNlLAogICAgICAgICJ1cGRhdGVzIjogdHJ1ZQogICAgfQp9CiovCmxvZ2dlci5lcnJvcigiU2FuaXRpemUgb2JqZWN0QXR0cmlidXRlczogc3RhcnQiKTsKb3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CmlmIChhdHRycykgewogIHZhciBrZXlzID0gWwogICAgInVzZXJOYW1lIiwKICAgICJnaXZlbk5hbWUiLAogICAgInNuIiwKICAgICJtYWlsIiwKICAgICJ0ZWxlcGhvbmVOdW1iZXIiLAogICAgInBvc3RhbEFkZHJlc3MiLAogICAgImNpdHkiLAogICAgInN0YXRlUHJvdmluY2UiLAogICAgInBvc3RhbENvZGUiLAogICAgImNvdW50cnkiLAogICAgImZySW5kZXhlZFN0cmluZzIiCiAgXQogIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBpZiAoYXR0cnMuZ2V0KGtleSkgJiYgYXR0cnMuZ2V0KGtleSkudG9TdHJpbmcoKSA9PSAiIikgewogICAgICBsb2dnZXIuZXJyb3IoIlNhbml0aXplIG9iamVjdEF0dHJpYnV0ZXM6IHJlbW92ZSAiLmNvbmNhdChrZXkpKTsKICAgICAgYXR0cnMucmVtb3ZlKGtleSk7CiAgICB9CiAgfSkKfQppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJwYXNzd29yZCIpLnRvU3RyaW5nKCkgIT09ICIiKSB7CiAgbG9nZ2VyLmVycm9yKCJTYW5pdGl6ZSBvYmplY3RBdHRyaWJ1dGVzOiBwcmVzZXJ2ZSBwYXNzd29yZCBpbiBzaGFyZWQgc3RhdGUiKTsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoInBhc3N3b3JkIiwgdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJwYXNzd29yZCIpLnRvU3RyaW5nKCkpOwp9CmxvZ2dlci5lcnJvcigiU2FuaXRpemUgb2JqZWN0QXR0cmlidXRlczogZW5kIik7CgovKgogKiBQcm9wZXJseSBzZXQgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQobmFtZSwgdmFsdWUpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjoiK3ZhbHVlKyJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2627"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.176Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "5389bc82accc019431bb76165028adb6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Has Email Changed\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Has%20Email%20Changed%22"
        },
        "response": {
          "bodySize": 1082,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1082,
            "text": "{\"result\":[{\"_id\":\"d3102a25-056d-4e34-973b-577ced8cc9b7\",\"name\":\"Has Email Changed\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJIYXMgRW1haWwgQ2hhbmdlZDogc3RhcnQiKTsKb3V0Y29tZSA9ICJ1bmNoYW5nZWQiOwppZiAoZ2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiKSkgewogIG91dGNvbWUgPSAiY2hhbmdlZCI7Cn0KbG9nZ2VyLmVycm9yKCJIYXMgRW1haWwgQ2hhbmdlZDogZW5kIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIEdldCBvYmplY3RBdHRyaWJ1dGUgdmFsdWUKICovCmZ1bmN0aW9uIGdldE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKS50b1N0cmluZygpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1082"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.216Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "a1a476f7f90af798330625d10b5e75d8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 560,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Remove Button\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Remove%20Button%22"
        },
        "response": {
          "bodySize": 1670,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1670,
            "text": "{\"result\":[{\"_id\":\"9535446c-0ff6-4a76-8576-616599119d64\",\"name\":\"Remove Button\",\"description\":\"Remove button from page.\",\"script\":\"LyogUmVtb3ZlIEJ1dHRvbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBIaWRlIGJ1dHRvbnMgb24gdGhlIGpvdXJuZXkgcGFnZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2J1dHRvbicpKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnfSkiCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICB2YXIgbWVzc2FnZSA9ICIgIgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgICAgIG1lc3NhZ2UKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1670"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.256Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "92a7bd7f1355ae753e4e937db47d63cd",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 592,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"OAuth2 Access Token Modification Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22OAuth2%20Access%20Token%20Modification%20Script%22"
        },
        "response": {
          "bodySize": 10184,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 10184,
            "text": "{\"result\":[{\"_id\":\"d22f9a0c-426a-4466-b95e-d0f125b0d5fa\",\"name\":\"OAuth2 Access Token Modification Script\",\"description\":\"Default global script for OAuth2 Access Token Modification\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTktMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCBsZXRzIHlvdSBtb2RpZnkgaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIGFuIE9BdXRoMiBhY2Nlc3MgdG9rZW4KICogd2l0aCBtZXRob2RzIHByb3ZpZGVkIGJ5IHRoZSBBY2Nlc3NUb2tlbiAoMSkgaW50ZXJmYWNlLgogKiBUaGUgY2hhbmdlcyBtYWRlIHRvIE9BdXRoMiBhY2Nlc3MgdG9rZW5zIHdpbGwgZGlyZWN0bHkgaW1wYWN0IHRoZSBzaXplIG9mIHRoZSBDVFMgdG9rZW5zLAogKiBhbmQsIHNpbWlsYXJseSwgdGhlIHNpemUgb2YgdGhlIEpXVHMgaWYgY2xpZW50LWJhc2VkIE9BdXRoMiB0b2tlbnMgYXJlIHV0aWxpemVkLgogKiBXaGVuIGFkZGluZy91cGRhdGluZyBmaWVsZHMgbWFrZSBzdXJlIHRoYXQgdGhlIHRva2VuIHNpemUgcmVtYWlucyB3aXRoaW4gY2xpZW50L3VzZXItYWdlbnQgbGltaXRzLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogYWNjZXNzVG9rZW4gLSBBY2Nlc3NUb2tlbiAoMSkuCiAqICAgICAgICAgICAgICAgVGhlIGFjY2VzcyB0b2tlbiB0byBiZSB1cGRhdGVkLgogKiAgICAgICAgICAgICAgIE11dGFibGUgb2JqZWN0LCBhbGwgY2hhbmdlcyB0byB0aGUgYWNjZXNzIHRva2VuIHdpbGwgYmUgcmVmbGVjdGVkLgogKiBzY29wZXMgLSBTZXQ8U3RyaW5nPiAoNikuCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICogcmVxdWVzdFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgY29udGFpbnMgYSBtYXAgb2YgcmVxdWVzdCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVcmkgLSBUaGUgcmVxdWVzdCBVUkkuCiAqICAgICAgICAgICAgICAgICAgICAgcmVhbG0gLSBUaGUgcmVhbG0gdGhhdCB0aGUgcmVxdWVzdCByZWxhdGVzIHRvLgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQYXJhbXMgLSBBIG1hcCBvZiB0aGUgcmVxdWVzdCBwYXJhbXMgYW5kL29yIHBvc3RlZCBkYXRhLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFYWNoIHZhbHVlIGlzIGEgbGlzdCBvZiBvbmUgb3IgbW9yZSBwcm9wZXJ0aWVzLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQbGVhc2Ugbm90ZSB0aGF0IHRoZXNlIHNob3VsZCBiZSBoYW5kbGVkIGluIGFjY29yZGFuY2Ugd2l0aCBPV0FTUCBiZXN0IHByYWN0aWNlczoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS92dWxuZXJhYmlsaXRpZXMvVW5zYWZlX3VzZV9vZl9SZWZsZWN0aW9uLgogKiBjbGllbnRQcm9wZXJ0aWVzIC0gVW5tb2RpZmlhYmxlIE1hcCAoNSkuCiAqICAgICAgICAgICAgICAgICAgICBQcmVzZW50IGlmIHRoZSBjbGllbnQgc3BlY2lmaWVkIGluIHRoZSByZXF1ZXN0IHdhcyBpZGVudGlmaWVkLCBjb250YWlucyBhIG1hcCBvZiBjbGllbnQgcHJvcGVydGllczoKICogICAgICAgICAgICAgICAgICAgIGNsaWVudElkIC0gVGhlIGNsaWVudCdzIFVSSSBmb3IgdGhlIHJlcXVlc3QgbG9jYWxlLgogKiAgICAgICAgICAgICAgICAgICAgYWxsb3dlZEdyYW50VHlwZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIGdyYW50IHR5cGVzIChvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLkdyYW50VHlwZSkgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkUmVzcG9uc2VUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgcmVzcG9uc2UgdHlwZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU2NvcGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCBzY29wZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzIC0gQSBtYXAgb2YgdGhlIGN1c3RvbSBwcm9wZXJ0aWVzIG9mIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdHMgb3IgbWFwcyB3aWxsIGJlIGluY2x1ZGVkIGFzIHN1Yi1tYXBzOyBmb3IgZXhhbXBsZToKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21NYXBbS2V5MV09VmFsdWUxIHdpbGwgYmUgcmV0dXJuZWQgYXMgY3VzdG9tTWFwIC0+IEtleTEgLT4gVmFsdWUxLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvIGFkZCBjdXN0b20gcHJvcGVydGllcyB0byBhIGNsaWVudCwgdXBkYXRlIHRoZSBDdXN0b20gUHJvcGVydGllcyBmaWVsZAogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIEFNIENvbnNvbGUgPiBSZWFsbSBOYW1lID4gQXBwbGljYXRpb25zID4gT0F1dGggMi4wID4gQ2xpZW50cyA+IENsaWVudCBJRCA+IEFkdmFuY2VkLgogKiBpZGVudGl0eSAtIEFNSWRlbnRpdHkgKDMpLgogKiAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyLgogKiBzZXNzaW9uIC0gU1NPVG9rZW4gKDQpLgogKiAgICAgICAgICAgUHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QuCiAqIHNjcmlwdE5hbWUgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgc2NyaXB0LgogKiBsb2dnZXIgLSBBbHdheXMgcHJlc2VudCwgdGhlICJPQXV0aDJQcm92aWRlciIgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiAgICAgICAgICBDb3JyZXNwb25kaW5nIGxvZyBmaWxlcyB3aWxsIGJlIHByZWZpeGVkIHdpdGg6IHNjcmlwdHMuT0FVVEgyX0FDQ0VTU19UT0tFTl9NT0RJRklDQVRJT04uCiAqIGh0dHBDbGllbnQgLSBIVFRQIENsaWVudCAoOCkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIEhUVFAgQ2xpZW50IGluc3RhbmNlOgogKiAgICAgICAgICAgICAgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvc2NyaXB0aW5nLWd1aWRlL3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50Lmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtaHR0cC1jbGllbnQuCiAqCiAqIFJldHVybiAtIG5vIHZhbHVlIGlzIGV4cGVjdGVkLCBjaGFuZ2VzIHNoYWxsIGJlIG1hZGUgdG8gdGhlIGFjY2Vzc1Rva2VuIHBhcmFtZXRlciBkaXJlY3RseS4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgQWNjZXNzVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvQWNjZXNzVG9rZW4uaHRtbC4KICogKDMpIEFNSWRlbnRpdHkgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9zdW4vaWRlbnRpdHkvaWRtL0FNSWRlbnRpdHkuaHRtbC4KICogKDQpIFNTT1Rva2VuIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vaXBsYW5ldC9zc28vU1NPVG9rZW4uaHRtbC4KICogKDUpIE1hcCAtIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvSGFzaE1hcC5odG1sLAogKiAgICAgICAgICAgb3IgaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqICg2KSBTZXQgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hTZXQuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKi8KCi8qIEVYQU1QTEUKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QsCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlc3BvbnNlCiAgICApOwoKICAgIC8vIEFsd2F5cyBpbmNsdWRlcyB0aGlzIGZpZWxkIGluIHRoZSB0b2tlbi4KICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkKCdrZXkxJywgJ3ZhbHVlMScpOwoKICAgIC8vIFJlY2VpdmVzIGFuZCBhZGRzIHRvIHRoZSBhY2Nlc3MgdG9rZW4gYWRkaXRpb25hbCB2YWx1ZXMgYnkgcGVyZm9ybWluZyBhIFJFU1QgY2FsbCB0byBhbiBleHRlcm5hbCBzZXJ2aWNlLgogICAgLy8gV0FSTklORzogQmVsb3csIHlvdSB3aWxsIGZpbmQgYSByZWZlcmVuY2UgdG8gYSB0aGlyZC1wYXJ0eSBzaXRlLCB3aGljaCBpcyBwcm92aWRlZCBvbmx5IGFzIGFuIGV4YW1wbGUuCiAgICB2YXIgdXJpID0gJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cyc7CgogICAgdHJ5IHsKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmckphdmEuUmVxdWVzdCgpOwoKICAgICAgICAvLyBZb3UgY2FuIGNoYWluIG1ldGhvZHMgdGhhdCByZXR1cm4gdGhlIHJlcXVlc3Qgb2JqZWN0LgogICAgICAgIHJlcXVlc3Quc2V0VXJpKHVyaSkKICAgICAgICAgICAgLnNldE1ldGhvZCgnUE9TVCcpCiAgICAgICAgICAgIC5zZXRFbnRpdHkoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgdXBkYXRlZEZpZWxkczogewogICAgICAgICAgICAgICAgICAgIGtleTI6ICd2YWx1ZTInLAogICAgICAgICAgICAgICAgICAgIGtleTM6ICd2YWx1ZTMnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgLy8gWW91IGNhbiBjYWxsIGEgbWV0aG9kIHdoZW4gY2hhaW5pbmcgaXMgbm90IHBvc3NpYmxlLgogICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnKTsKCiAgICAgICAgLy8gU2VuZHMgdGhlIHJlcXVlc3QgYW5kIHJlY2VpdmVzIHRoZSByZXNwb25zZS4KICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0T3JUaHJvdygpOwoKICAgICAgICAvLyBDaGVja3MgaWYgdGhlIHJlc3BvbnNlIHN0YXR1cyBpcyBhcyBleHBlY3RlZC4KICAgICAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkgPT09IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5TdGF0dXMuQ1JFQVRFRCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CgogICAgICAgICAgICAvLyBTZXQgbXVsdGlwbGUgdG9rZW4gZmllbGRzIGF0IG9uY2UuCiAgICAgICAgICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkcyhyZXN1bHQudXBkYXRlZEZpZWxkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdVbmFibGUgdG8gb2J0YWluIGFjY2VzcyB0b2tlbiBtb2RpZmljYXRpb25zLiBTdGF0dXM6ICcgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICcuIENvbnRlbnQ6ICcgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5lcnJvcignVGhlIHJlcXVlc3QgcHJvY2Vzc2luZyB3YXMgaW50ZXJydXB0ZWQuICcgKyBlKTsKCiAgICAgICAgLy8gVGhlIGFjY2VzcyB0b2tlbiByZXF1ZXN0IGZhaWxzIHdpdGggdGhlIEhUVFAgNTAwIGVycm9yIGluIHRoaXMgY2FzZS4KICAgICAgICB0aHJvdyAoJ1VuYWJsZSB0byBvYnRhaW4gcmVzcG9uc2UgZnJvbTogJyArIHVyaSk7CiAgICB9CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgaWRlbnRpdHkgYXR0cmlidXRlIHZhbHVlcyB0byB0aGUgYWNjZXNzIHRva2VuLgogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ21haWwnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ21haWwnKSk7CiAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgncGhvbmUnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ3RlbGVwaG9uZU51bWJlcicpLnRvQXJyYXkoKVswXSk7CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgdGhlIHNlc3Npb24gcHJvcGVydHkgdmFsdWVzLgogICAgLy8gTk9URTogc2Vzc2lvbiBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igbm9uLWludGVyYWN0aXZlIGF1dGhvcml6YXRpb24gZ3JhbnRzLgogICAgaWYgKHNlc3Npb24pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgnaXBBZGRyZXNzJywgc2Vzc2lvbi5nZXRQcm9wZXJ0eSgnSG9zdCcpKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignVW5hYmxlIHRvIHJldHJpZXZlIHNlc3Npb24gcHJvcGVydHkgdmFsdWUuICcgKyBlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gUmVtb3ZlcyBhIG5hdGl2ZSBmaWVsZCBmcm9tIHRoZSB0b2tlbiBlbnRyeSwgdGhhdCB3YXMgc2V0IGJ5IEFNLgogICAgLy8gV0FSTklORzogcmVtb3ZpbmcgbmF0aXZlIGZpZWxkcyBmcm9tIHRoZSB0b2tlbiBtYXkgcmVzdWx0IGluIGxvc3Mgb2YgZnVuY3Rpb25hbGl0eS4KICAgIC8vIGFjY2Vzc1Rva2VuLnJlbW92ZVRva2VuTmFtZSgpCgogICAgLy8gTm8gcmV0dXJuIHZhbHVlIGlzIGV4cGVjdGVkLiBMZXQgaXQgYmUgdW5kZWZpbmVkLgp9KCkpOwoqLw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:29 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.295Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "d1584b7005696118d208a40689b91632",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Config Provider\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Config%20Provider%22"
        },
        "response": {
          "bodySize": 4516,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4516,
            "text": "{\"result\":[{\"_id\":\"5e854779-6ec1-4c39-aeba-0477e0986646\",\"name\":\"Config Provider\",\"description\":\"Default global script for Config Provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyoqCiAqIFRoZSBmb2xsb3dpbmcgc2NyaXB0IGlzIGEgc2ltcGxpZmllZCB0ZW1wbGF0ZSBmb3IgdW5kZXJzdGFuZGluZyBob3cgdG8gYnVpbGQKICogdXAgYSBjb25maWcgTWFwIG9iamVjdCB3aXRoIGN1c3RvbSB2YWx1ZXMuIFRoZSBDb25maWcgUHJvdmlkZXIgTm9kZSB3aWxsIHRoZW4KICogcHJvdmlkZSB0aGlzIGNvbmZpZyBNYXAgdG8gdGhlIGRlc2lyZWQgbm9kZSB0eXBlLiBJdCBpcyBpbXBvcnRhbnQgdGhhdCB0aGUgTWFwCiAqIHlvdSBidWlsZCBoZXJlIGlzIG5hbWVkICdjb25maWcnLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICoKICogbm9kZVN0YXRlIC0gTm9kZSBTdGF0ZSAoMSkKICogICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGlzIHJlcHJlc2VudHMgdGhlIGN1cnJlbnQgdmFsdWVzIHN0b3JlZCBpbiB0aGUgbm9kZSBzdGF0ZS4KICoKICogaWRSZXBvc2l0b3J5IC0gUHJvZmlsZSBEYXRhICgyKQogKiAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGEgcmVwb3NpdG9yeSB0byByZXRyaWV2ZSB1c2VyIGluZm9ybWF0aW9uLgogKgogKiBzZWNyZXRzIC0gQ3JlZGVudGlhbHMgYW5kIFNlY3JldHMgKDMpCiAqICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgYW4gaW50ZXJmYWNlIHRvIGFjY2VzcyB0aGUgU2VjcmV0cyBBUEkgZnJvbSBhIHNjcmlwdGluZyBjb250ZXh0LgogKgogKiByZXF1ZXN0SGVhZGVycyAoNCkgLSBNYXAgKDUpCiAqICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgYW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyBmb3IgYWNjZXNzaW5nIGhlYWRlcnMgaW4gdGhlIGxvZ2luIHJlcXVlc3QuCiAqCiAqIGxvZ2dlciAtIERlYnVnIExvZ2dpbmcgKDYpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGVidWcgbG9nZ2VyIGluc3RhbmNlLgogKgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDcpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgSFRUUCBjbGllbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBtYWtlIGV4dGVybmFsIEhUVFAgcmVxdWVzdHMuCiAqCiAqIHJlYWxtIC0gU3RyaW5nIChwcmltaXRpdmUpLgogKiAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIG5hbWUgb2YgdGhlIHJlYWxtIHRoZSB1c2VyIGlzIGF1dGhlbnRpY2F0aW5nIHRvLgogKgogKiBleGlzdGluZ1Nlc3Npb24gLSBNYXA8U3RyaW5nLCBTdHJpbmc+ICg1KQogKiAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4gVGhlIHJldHVybmVkIG1hcCBmcm9tCiAqICAgICAgICAgIFNTT1Rva2VuLmdldFByb3BlcnRpZXMoKSAoOCkKICoKICogcmVxdWVzdFBhcmFtZXRlcnMgLSBNYXAgKDUpCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGF1dGhlbnRpY2F0aW9uIHJlcXVlc3QgcGFyYW1ldGVycy4KICoKICoKICogT3V0cHV0czoKICoKICogY29uZmlnIC0gTWFwICg1KQogKiAgICAgICAgICAgRGVmaW5lIGFuZCBmaWxsIGEgTWFwIG9iamVjdCBuYW1lZCAnY29uZmlnJyB3aXRoIGN1c3RvbSB2YWx1ZXMsIHRoaXMgd2lsbCBkZWZpbmUgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZQogKiAgICAgICAgICAgYXNzb2NpYXRlZCBub2RlIHNlbGVjdGVkIGluIHRoZSBDb25maWdQcm92aWRlck5vZGUuCiAqCiAqIFJlZmVyZW5jZToKICogKDEpIE5vZGUgU3RhdGUgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvaWRjbG91ZC1hbS9sYXRlc3QvYXV0aGVudGljYXRpb24tZ3VpZGUvc2NyaXB0aW5nLWFwaS1ub2RlLmh0bWwjc2NyaXB0aW5nLWFwaS1ub2RlLW5vZGVTdGF0ZQogKiAoMikgUHJvZmlsZSBEYXRhIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcuMS9hdXRoZW50aWNhdGlvbi1ndWlkZS9zY3JpcHRpbmctYXBpLW5vZGUuaHRtbCNzY3JpcHRpbmctYXBpLW5vZGUtaWQtcmVwbwogKiAoMykgQ3JlZGVudGlhbHMgYW5kIFNlY3JldHMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy4xL2F1dGhlbnRpY2F0aW9uLWd1aWRlL3NjcmlwdGluZy1hcGktbm9kZS5odG1sI3NjcmlwdGluZy1hcGktYXV0aG4tc2VjcmV0cwogKiAoNCkgUmVxdWVzdCBIZWFkZXJzIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXV0aGVudGljYXRpb24tZ3VpZGUvc2NyaXB0aW5nLWFwaS1ub2RlLmh0bWwjc2NyaXB0aW5nLWFwaS1ub2RlLXJlcXVlc3RIZWFkZXJzLgogKiAoNSkgTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9NYXAuaHRtbAogKiAoNikgRGVidWcgTG9nZ2luZyAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICg3KSBIVFRQIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKiAoOCkgU1NPVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9pcGxhbmV0L3Nzby9TU09Ub2tlbi5odG1sLgogKi8KCmNvbmZpZyA9IG5vZGVTdGF0ZS5nZXQoJ25vZGVDb25maWcnKS5hc01hcCgpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"CONFIG_PROVIDER_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4516"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.333Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "38e95f4122bcd1449e91fe168d9dff21",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFAMethod_fido\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFAMethod_fido%22"
        },
        "response": {
          "bodySize": 1431,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1431,
            "text": "{\"result\":[{\"_id\":\"aed630f7-2101-4423-a2bc-9494b67c2728\",\"name\":\"AT_MFAMethod_fido\",\"description\":\"This script puts 'fido' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX2ZpZG86IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfZmlkbzogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbImZpZG8iXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfZmlkbzogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1431"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.372Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "24c6dc33b7621c60657866e83ee52b01",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 582,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Transient State Only\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Transient%20State%20Only%22"
        },
        "response": {
          "bodySize": 1507,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1507,
            "text": "{\"result\":[{\"_id\":\"073a64d4-37c9-486d-8c59-6583494644b9\",\"name\":\"FRAAS-7955 Transient State Only\",\"description\":\"FRAAS-7955 Transient State Only\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC10cmFuc2llbnQiKTsKc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXRyYW5zaWVudCIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC10cmFuc2llbnRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gdHJhbnNpZW50IHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgdmFyIHRyYW5zaWVudFN0b3JhZ2UgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAodHJhbnNpZW50U3RvcmFnZS5wdXQpIHsKICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICB0cmFuc2llbnRTdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgIHRyYW5zaWVudFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1507"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.412Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "6fea9efe57505847c7a1c6d45d2d64a3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Show Object Values\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Show%20Object%20Values%22"
        },
        "response": {
          "bodySize": 3619,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3619,
            "text": "{\"result\":[{\"_id\":\"fbc563cb-eced-4e1b-9cd4-022680347668\",\"name\":\"FRAAS-7955 Show Object Values\",\"description\":\"FRAAS-7955 Show Object Values\",\"script\":\"dmFyIG91dGNvbWUgPSB0cnVlOwoKLy8gUmVxdWlyZXMgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBhdXRoIG5vZGUgdG8gcmV0cmlldmUgcmVhbCB1c2VyIElEIGZyb20gSURNCnZhciB1c2VyaWQgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpOwoKLy8gUmV0cmlldmUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZXMKdmFyIHVzZXJOYW1lID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJ1aWQiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp2YXIgZmlyc3ROYW1lID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp2YXIgbGFzdE5hbWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgInNuIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKTsKdmFyIGVtYWlsID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsICJtYWlsIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKTsKCnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjxoND5PYmplY3QgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICI8cD48Yj5Vc2VybmFtZTwvYj46ICIpLmNvbmNhdCh1c2VyTmFtZSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPkZpcnN0IE5hbWU8L2I+OiAiKS5jb25jYXQoZmlyc3ROYW1lKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+TGFzdCBOYW1lPC9iPjogIikuY29uY2F0KGxhc3ROYW1lKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+RW1haWw8L2I+OiAiKS5jb25jYXQoZW1haWwpLmNvbmNhdCgiPC9wPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3619"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.452Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "37f79a9c01fe85d6ad48f1447d88bc04",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 572,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Set Company To Smokin\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Set%20Company%20To%20Smokin%22"
        },
        "response": {
          "bodySize": 927,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 927,
            "text": "{\"result\":[{\"_id\":\"653d0d28-7888-4741-902f-a142637f2d05\",\"name\":\"Set Company To Smokin\",\"description\":\"Set company in node state\",\"script\":\"LyogU2V0IENvbXBhbnkgVG8gU21va2luCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFNldCBjb21wYW55IHRvIFNtb2tpbiBpbiBub2RlIHN0YXRlCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogICAgbm9kZVN0YXRlLnB1dFNoYXJlZCgiY29tcGFueSIsICJTbW9raW4iKTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "927"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.491Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "35b02f2b91787124db79c24575aaf949",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Welcome Message\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Welcome%20Message%22"
        },
        "response": {
          "bodySize": 1755,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1755,
            "text": "{\"result\":[{\"_id\":\"53c50dbd-5331-4739-bea1-4c5e9bf553f2\",\"name\":\"Twilio IVR: Welcome Message\",\"description\":\"Welcome message\",\"script\":\"LyogVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIlRoYW5rIHlvdSBmb3IgY2FsbGluZyBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogV2VsY29tZSBNZXNzYWdlOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1755"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.530Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "8716a3e0e51959f30355056e09d288e3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 560,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_Optin-Always\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_Optin-Always%22"
        },
        "response": {
          "bodySize": 1423,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1423,
            "text": "{\"result\":[{\"_id\":\"92741813-dac1-4910-ae07-ceac92a048c1\",\"name\":\"AT_Optin-Always\",\"description\":\"This script puts 'always' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdhbHdheXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbImFsd2F5cyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1423"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.567Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c896d9e1d12bcb7e3a5d3d01a7c0dbbc",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 609,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Social Identity Provider Profile Transformation Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Social%20Identity%20Provider%20Profile%20Transformation%20Script%22"
        },
        "response": {
          "bodySize": 1011,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1011,
            "text": "{\"result\":[{\"_id\":\"1d475815-72cb-42eb-aafd-4026989d28a7\",\"name\":\"Social Identity Provider Profile Transformation Script\",\"description\":\"Default global script for Social Identity Provider Profile Transformation\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyogRGVmYXVsdCBTb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgUHJvZmlsZSBUcmFuc2Zvcm1hdGlvbiBzY3JpcHQgdG8gdXNlIGFzIGEgdGVtcGxhdGUgZm9yIG5ldyBzY3JpcHRzICov\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1011"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.607Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "cb2bd91daa972c726142999b013af53b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 600,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Normalized idddataweb Profile to Managed User\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Normalized%20idddataweb%20Profile%20to%20Managed%20User%22"
        },
        "response": {
          "bodySize": 2636,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2636,
            "text": "{\"result\":[{\"_id\":\"809330cf-874c-4d57-a8f1-5882c6dd855b\",\"name\":\"Normalized idddataweb Profile to Managed User\",\"description\":\"Converts a normalized social profile for iddataweb into a Managed user\",\"script\":\"LyogTm9ybWFsaXplZCBpZGRkYXRhd2ViIFByb2ZpbGUgdG8gTWFuYWdlZCBVc2VyCiAqIENvcHlyaWdodCAyMDIyIEZvcmdlUm9jayBBUy4gQWxsIFJpZ2h0cyBSZXNlcnZlZAogKgogKiBVc2Ugb2YgdGhpcyBjb2RlIHJlcXVpcmVzIGEgY29tbWVyY2lhbCBzb2Z0d2FyZSBsaWNlbnNlIHdpdGggRm9yZ2VSb2NrIEFTLgogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLiBOb3QgZm9yIHByb2R1Y3Rpb24gdXNlLgogKiBNb2RpZmllZCBieSBTdGVwaGVuIFBheW5lLCAyMDIxLU1hci0zMAogKi8KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKaW1wb3J0IG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUKbG9nZ2VyLmVycm9yKCJOb3JtYWxpemVkX1Byb2ZpbGVfSUREYXRhV2ViOiBTdGFydCAiICsgbm9ybWFsaXplZFByb2ZpbGUpOwoKSnNvblZhbHVlIG1hbmFnZWRVc2VyID0ganNvbihvYmplY3QoCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmdpdmVuTmFtZSksCiAgICAgICAgZmllbGQoInNuIiwgbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZSksCiAgICAgICAgZmllbGQoInVzZXJOYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUudXNlcm5hbWUpKSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQppZiAobm9ybWFsaXplZFByb2ZpbGUuRE9CLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoImZySW5kZXhlZFN0cmluZzIiLCBub3JtYWxpemVkUHJvZmlsZS5ET0IpCgpyZXR1cm4gbWFuYWdlZFVzZXIK\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2636"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.647Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "d6305c53d776e4fa46e677aeac853c49",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 560,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IDP Re-Lookup\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IDP%20Re-Lookup%22"
        },
        "response": {
          "bodySize": 8461,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 8461,
            "text": "{\"result\":[{\"_id\":\"ab917dad-6fdb-46c2-8c8c-42f094ebeea1\",\"name\":\"IDP Re-Lookup\",\"description\":\"Perform IDP re-lookup based on the Organization ID from the initial lookup. Set users' external IDP in shared state for further processing.\",\"script\":\"LyogSURQIFJlLUxvb2t1cAogKiAKICogUGVyZm9ybSBJRFAgcmUtbG9va3VwIGJhc2VkIG9uIHRoZSBPcmdhbml6YXRpb24gSUQgZnJvbSB0aGUgaW5pdGlhbCBsb29rdXAuIAogKiBTZXQgdXNlcnMnIGV4dGVybmFsIElEUCBpbiBzaGFyZWQgc3RhdGUgZm9yIGZ1cnRoZXIgcHJvY2Vzc2luZy4KICogCiAqIFRoaXMgc2NyaXB0IHJlcXVpcmVzIHBhcmFtZXRyaXphdGlvbi4gTWFrZSBzdXJlIHlvdSBjYXJlZnVsbHkgcmV2aWV3IHRoZSBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIFJlLUxvb2t1cDogc3RhcnQiKTsKICAJb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAJdmFyIG9yZ0lkID0gcmVmZXJlci5zZWFyY2hQYXJhbS5vOwogIAlzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgcmVmZXJlci5zZWFyY2hQYXJhbS51KTsKCiAgCS8qIEJlZ2luIENvbmZpZ3VyYXRpb24gKi8KICAKICAgIC8vIGxvbmctbGl2ZWQgdG9rZW4sIGV4cGlyZXM6IEZyaWRheSwgSmFudWFyeSAxNiwgMjAzMiA5OjQ1OjE0IFBNIEdNVC0wNjowMAogICAgdmFyIElETV9BUElfVE9LRU4gPSAiZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKSVV6STFOaUo5LmV5SnpkV0lpT2lKbE1XRTFZelU1T0MwNE1HVXlMVFJoWkdNdFlqTTBOUzB6TVdRd01tVXlPVGhqTkdJaUxDSmpkSE1pT2lKUFFWVlVTREpmUjFKQlRsUmZVMFZVSWl3aVlYVjBhRjlzWlhabGJDSTZNQ3dpWVhWa2FYUlVjbUZqYTJsdVowbGtJam9pTkdZek1Ea3hZVGt0WmpVME5pMDBNRGRpTFRrek5qTXRNMlJpWkdKaVpqWXpNRGMwTFRNMU56Y3dPU0lzSW5OMVltNWhiV1VpT2lKbE1XRTFZelU1T0MwNE1HVXlMVFJoWkdNdFlqTTBOUzB6TVdRd01tVXlPVGhqTkdJaUxDSnBjM01pT2lKb2RIUndjem92TDI5d1pXNWhiUzEyYjJ4clpYSXRaR1YyTG1admNtZGxZbXh2WTJ0ekxtTnZiVG8wTkRNdllXMHZiMkYxZEdneUwyRnNjR2hoSWl3aWRHOXJaVzVPWVcxbElqb2lZV05qWlhOelgzUnZhMlZ1SWl3aWRHOXJaVzVmZEhsd1pTSTZJa0psWVhKbGNpSXNJbUYxZEdoSGNtRnVkRWxrSWpvaUxVSXhRbFJVTTNGcU5pMDRaa2QzYTJkNmJ6Z3pOemxTUmpWSkxqQTROa05KZFRGeU9VTkNObFJPY0VJd1YzUTVPRkV5TlRKWWN5SXNJbUYxWkNJNklqWTVaREExWXpFeExXVTRabVV0TkdGbE5TMWhOMk01TFRJeU5USmhOR1E0TldSbU5DSXNJbTVpWmlJNk1UWTBNalUyTXpreE5Dd2laM0poYm5SZmRIbHdaU0k2SW5CaGMzTjNiM0prSWl3aWMyTnZjR1VpT2xzaVpuSTZhV1J0T2lvaVhTd2lZWFYwYUY5MGFXMWxJam94TmpReU5UWXpPVEUwTENKeVpXRnNiU0k2SWk5aGJIQm9ZU0lzSW1WNGNDSTZNVGsxTnpreU16a3hOQ3dpYVdGMElqb3hOalF5TlRZek9URTBMQ0psZUhCcGNtVnpYMmx1SWpvek1UVXpOakF3TURBc0ltcDBhU0k2SWkxQ01VSlVWRE54YWpZdE9HWkhkMnRuZW04NE16YzVVa1kxU1M1Q1NIRlpOVnAzYzBsR05WcE1iRXR2Y0dOdlVsVkdWSE5MVWpBaUxDSnRZWGxmWVdOMElqcDdJbU5zYVdWdWRGOXBaQ0k2V3lJMk9XUXdOV014TVMxbE9HWmxMVFJoWlRVdFlUZGpPUzB5TWpVeVlUUmtPRFZrWmpRaVhYMTkuZjJObXdIVnRla0g5M2pPNy1qTTZta0ZSY3V2RU4zV3pjS3NILVJBUG5sYyI7CgogICAgLy8gSURNIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSURNX0FQSV9VUkkgPSByZWZlcmVyLm9yaWdpbiArICIvb3BlbmlkbS9tYW5hZ2VkL2FscGhhX29yZ2FuaXphdGlvbi8iKyBvcmdJZCArICI/X2ZpZWxkcz1uYW1lLGRlc2NyaXB0aW9uLGlkcE5hbWUsaWRwVHlwZSxpZHBEb21haW5zLGlkcEpvdXJuZXksaWRwVGhlbWUsaWRwUGVyc2lzdCI7CgogIAkvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnR0VUJyk7CiAgICByZXF1ZXN0LnNldFVyaShJRE1fQVBJX1VSSSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiQmVhcmVyICIgKyBJRE1fQVBJX1RPS0VOKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIFJlLUxvb2t1cDogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCQogIAlpZiAocmVzdWx0KSB7CiAgCQlvdXRjb21lID0gInRydWUiOwogICAgICAgIHZhciByb3V0ZWRJRFBzID0gW3Jlc3VsdF07CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJyb3V0ZWRJRFBzIiwgcm91dGVkSURQcyk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSZS1Mb29rdXA6IEZvdW5kIElEUCIpOwogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSZS1Mb29rdXA6IGVuZCBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.685Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "edf9e88ab9f0d37cfef8cabce82b3b72",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 576,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Itsme Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Itsme%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1621,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1621,
            "text": "{\"result\":[{\"_id\":\"3d97c436-42c0-4dd0-a571-ea6f34f752b3\",\"name\":\"Itsme Profile Normalization\",\"description\":\"Normalizes raw profile data from Itsme\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKaW1wb3J0IG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUKCkpzb25WYWx1ZSBtYW5hZ2VkVXNlciA9IGpzb24ob2JqZWN0KAogICAgICAgIGZpZWxkKCJpZCIsIHJhd1Byb2ZpbGUuc3ViKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmdpdmVuX25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5mYW1pbHlfbmFtZSksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQpyZXR1cm4gbWFuYWdlZFVzZXI=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1621"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.725Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "eab59e8fb83c1cfa45cb551d9e3335e0",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Verify Security PIN\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Verify%20Security%20PIN%22"
        },
        "response": {
          "bodySize": 2463,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2463,
            "text": "{\"result\":[{\"_id\":\"c9fa3899-c3ce-4833-af83-64d709202600\",\"name\":\"Twilio IVR: Verify Security PIN\",\"description\":\"Verify security PIN\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gRm9yIElEIENsb3VkIHVzZSAiX2lkIiwgZm9yIGNsYXNzaWMgZGVwbG95bWVudHMgdXNlICJ1c2VybmFtZSIKdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKCi8vIFJldHJpZXZlIHRoZSBpZGVudGlmaWVkIGNhbGxlcidzIFBJTiAoaW4gSURNOiBmclVuaW5kZXhlZEludGVnZXI1LCBpbiBBTTogZnItYXR0ci1pbnQ1KQp2YXIgc2VjdXJpdHlQSU4gPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJpZCwgImZyLWF0dHItaW50NSIpLml0ZXJhdG9yKCkubmV4dCgpOwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiVG8gdmVyaWZ5IEkgaGF2ZSB0aGUgcmlnaHQgYWNjb3VudCwgcGxlYXNlIGVudGVyIHlvdXIgNC1kaWdpdCBzZWN1cml0eSBQSU4uIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRJbnB1dENhbGxiYWNrCik7CiAgCndpdGggKGZyKSB7CiAgCWlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAJdmFyIGlucHV0ID0gbmV3IFRleHRJbnB1dENhbGxiYWNrKHByb21wdCk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQoaW5wdXQpLmJ1aWxkKCk7CiAgCX0gCiAgCWVsc2UgewogICAgICAJdmFyIGFuc3dlciA9IG5ldyBTdHJpbmcoY2FsbGJhY2tzLmdldCgwKS5nZXRUZXh0KCkpLnJlcGxhY2UoL1teMC05XS9nLCAiIik7CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFZlcmlmeSBTZWN1cml0eSBQSU46IGNhbGxiYWNrcyByZWNlaXZlZCIpOwogICAgCWlmIChhbnN3ZXIgPT0gc2VjdXJpdHlQSU4pIHsKICAgICAgCQlvdXRjb21lID0gInRydWUiOwogICAgCX0KCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFNlY3VyaXR5IFBJTjogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogIAl9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2463"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.764Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "2b460ae3927dba37c8299a52ddc7616a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 601,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"MobileOTP: Validate OTP In Profile Attribute\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22MobileOTP%3A%20Validate%20OTP%20In%20Profile%20Attribute%22"
        },
        "response": {
          "bodySize": 3598,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3598,
            "text": "{\"result\":[{\"_id\":\"ce6fbbcf-5d9a-471b-bcc1-448758a6374a\",\"name\":\"MobileOTP: Validate OTP In Profile Attribute\",\"description\":\"Validate OTP in profile attribute\",\"script\":\"LyoKICogVmFsaWRhdGUgT1RQIGluIHVzZXIgcHJvZmlsZSBhdHRyaWJ1dGUgYWdhaW5zdCBPVFAgaW4gc2hhcmVkIHN0YXRlCiAqLwpvdXRjb21lID0gImZhbHNlIjsKdmFyIE9UUF9MRU5HVEggPSA4OwoKaWYgKHNoYXJlZFN0YXRlLmdldCgibW9iaWxlT1RQIikpIHsKICAJdmFyIHByb2ZpbGVPVFAgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCAiZnItYXR0ci1pbnQ1Iik7Cn0KCmZ1bmN0aW9uIGNoZWNrUGFzc3dvcmQocHJvZmlsZU9UUCwgcGFzc3dvcmQpIHsKCXZhciBvbmVUaW1lUGFzc3dvcmQgPSBwcm9maWxlT1RQLnN1YnN0cmluZygwLDcpOwoJdmFyIHBhc3N3b3JkVGltZXN0YW1wID0gTnVtYmVyKHByb2ZpbGVPVFAuc3Vic3RyaW5nKDgpKTsKCgl2YXIgcGFzc3dvcmRNYXRjaGVzID0gb25lVGltZVBhc3N3b3JkCiAgICAgICAgJiYgKG9uZVRpbWVQYXNzd29yZCA9PSBwYXNzd29yZCkKICAgICAgICAmJiBwYXNzd29yZFRpbWVzdGFtcCAhPSBudWxsCiAgICAgICAgJiYgaXNXaXRoaW5FeHBpcnlUaW1lKHBhc3N3b3JkVGltZXN0YW1wKTsKCXJldHVybiBwYXNzd29yZE1hdGNoZXM7Cn0KCmZ1bmN0aW9uIGlzV2l0aGluRXhwaXJ5VGltZShwYXNzd29yZFRpbWVzdGFtcCkgewogICAgICAgIEluc3RhbnQgcHJldmlvdXMgPSBJbnN0YW50Lm9mRXBvY2hTZWNvbmQocGFzc3dvcmRUaW1lc3RhbXApOwogICAgICAgIER1cmF0aW9uIHBhc3N3b3JkRXhwaXJ5ID0gRHVyYXRpb24ub2ZNaW51dGVzKGNvbmZpZy5wYXNzd29yZEV4cGlyeVRpbWUoKSk7CiAgICAgICAgSW5zdGFudCBub3cgPSBUaW1lLmdldENsb2NrKCkuaW5zdGFudCgpOwogICAgICAgIGxvZ2dlci5kZWJ1ZygicHJldmlvdXMge30gXG4gcGFzc3dvcmRFeHBpcnkge30gXG4gbm93IHt9IiwgcHJldmlvdXMsIHBhc3N3b3JkRXhwaXJ5LCBub3cpOwogICAgICAgIGJvb2xlYW4gd2l0aGluRXhwaXJ5VGltZSA9IER1cmF0aW9uLmJldHdlZW4ocHJldmlvdXMucGx1cyhwYXNzd29yZEV4cGlyeSksIG5vdykuaXNOZWdhdGl2ZSgpOwogICAgICAgIGxvZ2dlci5kZWJ1Zygid2l0aGluRXhwaXJ5VGltZSB7fSIsIHdpdGhpbkV4cGlyeVRpbWUpOwogICAgICAgIHJldHVybiB3aXRoaW5FeHBpcnlUaW1lOwp9CgovKgogICAgcHJpdmF0ZSBBY3Rpb24gY2hlY2tQYXNzd29yZChUcmVlQ29udGV4dCBjb250ZXh0LCBTdHJpbmcgcGFzc3dvcmQpIHsKICAgICAgICBKc29uVmFsdWUgb25lVGltZVBhc3N3b3JkID0gY29udGV4dC5nZXRTdGF0ZShPTkVfVElNRV9QQVNTV09SRCk7CiAgICAgICAgSnNvblZhbHVlIHBhc3N3b3JkVGltZXN0YW1wID0gY29udGV4dC5nZXRTdGF0ZShPTkVfVElNRV9QQVNTV09SRF9USU1FU1RBTVApOwoKICAgICAgICBib29sZWFuIHBhc3N3b3JkTWF0Y2hlcyA9IG9uZVRpbWVQYXNzd29yZCAhPSBudWxsICYmIG9uZVRpbWVQYXNzd29yZC5pc1N0cmluZygpCiAgICAgICAgICAgICAgICAmJiBvbmVUaW1lUGFzc3dvcmQuYXNTdHJpbmcoKS5lcXVhbHMocGFzc3dvcmQpCiAgICAgICAgICAgICAgICAmJiBwYXNzd29yZFRpbWVzdGFtcCAhPSBudWxsICYmIHBhc3N3b3JkVGltZXN0YW1wLmlzTnVtYmVyKCkKICAgICAgICAgICAgICAgICYmIGlzV2l0aGluRXhwaXJ5VGltZShwYXNzd29yZFRpbWVzdGFtcC5hc0xvbmcoKSk7CiAgICAgICAgbG9nZ2VyLmRlYnVnKCJwYXNzd29yZE1hdGNoZXMge30iLCBwYXNzd29yZE1hdGNoZXMpOwogICAgICAgIHJldHVybiBnb1RvKHBhc3N3b3JkTWF0Y2hlcykuYnVpbGQoKTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaXNXaXRoaW5FeHBpcnlUaW1lKGxvbmcgcGFzc3dvcmRUaW1lc3RhbXApIHsKICAgICAgICBJbnN0YW50IHByZXZpb3VzID0gSW5zdGFudC5vZkVwb2NoU2Vjb25kKHBhc3N3b3JkVGltZXN0YW1wKTsKICAgICAgICBEdXJhdGlvbiBwYXNzd29yZEV4cGlyeSA9IER1cmF0aW9uLm9mTWludXRlcyhjb25maWcucGFzc3dvcmRFeHBpcnlUaW1lKCkpOwogICAgICAgIEluc3RhbnQgbm93ID0gVGltZS5nZXRDbG9jaygpLmluc3RhbnQoKTsKICAgICAgICBsb2dnZXIuZGVidWcoInByZXZpb3VzIHt9IFxuIHBhc3N3b3JkRXhwaXJ5IHt9IFxuIG5vdyB7fSIsIHByZXZpb3VzLCBwYXNzd29yZEV4cGlyeSwgbm93KTsKICAgICAgICBib29sZWFuIHdpdGhpbkV4cGlyeVRpbWUgPSBEdXJhdGlvbi5iZXR3ZWVuKHByZXZpb3VzLnBsdXMocGFzc3dvcmRFeHBpcnkpLCBub3cpLmlzTmVnYXRpdmUoKTsKICAgICAgICBsb2dnZXIuZGVidWcoIndpdGhpbkV4cGlyeVRpbWUge30iLCB3aXRoaW5FeHBpcnlUaW1lKTsKICAgICAgICByZXR1cm4gd2l0aGluRXhwaXJ5VGltZTsKICAgIH0KICAgICov\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3598"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.805Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "3acfa49aad64845266957f8099bd40b4",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display Username\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20Username%22"
        },
        "response": {
          "bodySize": 3220,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3220,
            "text": "{\"result\":[{\"_id\":\"fe5e303b-9ed7-4853-84fe-0ae43e2254d5\",\"name\":\"Display Username\",\"description\":\"Display the username in an HTML dialog.\",\"script\":\"LyogRGlzcGxheSBVc2VybmFtZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBEaXNwbGF5IHRoZSB1c2VybmFtZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICB0cnkgewogICAgdmFyIG91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgdXNlcm5hbWUgPSBub2RlU3RhdGUuZ2V0KCd1c2VybmFtZScpLmFzU3RyaW5nKCk7CgogICAgLy8gU3BlY2lmeSB0aGUgbWVzc2FnZSB5b3Ugd2FudCB0byBkaXNwbGF5LiBZb3UgbWF5IHVzZSBIVE1MIGZvciBmb3JtYXR0aW5nLiBBdm9pZCBsaW5lIGJyZWFrcyEgVXNlIDxicj4gaW5zdGVhZC4KICAgIHZhciBtZXNzYWdlID0gJzxoNT4nK3VzZXJuYW1lKyc8L2g1Pic7CgogICAgdmFyIGFuY2hvciA9ICdhbmNob3ItJytnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIFwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4gXAogICAgICBmdW5jdGlvbiAoZSkge1xuIFwKICAgICAgICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gXAogICAgICAgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIrYW5jaG9yKyInKSB7XG4gXAogICAgICAgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIittZXNzYWdlKyInO1xuIFwKICAgICAgICB9XG4gXAogICAgICB9KSI7CiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgICAgICkuYnVpbGQoKQogICAgfQogICAgZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGxvZ2dlci5lcnJvcignRXJyb3I6ICcgKyBlcnJvcik7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCdlcnJvcicsIGVycm9yLm1lc3NhZ2UpOwogIH0KCiAgIC8qCiAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAqIAogICAgKiBFeGFtcGxlOgogICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgKi8KICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgIH0pOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3220"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.846Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "10732d7830b2d424397b8a17b4a086ca",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 588,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect Inner Tree Evaluator Config\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20Inner%20Tree%20Evaluator%20Config%22"
        },
        "response": {
          "bodySize": 2807,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2807,
            "text": "{\"result\":[{\"_id\":\"d70df7a8-6390-409d-b821-166272a9a9c8\",\"name\":\"Collect Inner Tree Evaluator Config\",\"description\":\"Collect all the configuration items required for the Inner Tree Evaluator to function properly.\",\"script\":\"LyogQ29sbGVjdCBJbm5lciBUcmVlIEV2YWx1YXRvciBDb25maWcKICogCiAqIENvbGxlY3QgYWxsIHRoZSBjb25maWd1cmF0aW9uIGl0ZW1zIHJlcXVpcmVkIGZvciB0aGUgSW5uZXIgVHJlZSBFdmFsdWF0b3IgdG8gZnVuY3Rpb24gcHJvcGVybHkuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciBjb25maWcgPSB7CiAgICAgICAgInRyZWUiOiAiTG9naW4iLAogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXSk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygidHJlZSIsIGNvbmZpZy50cmVlKSwKICAgICAgICAgIAluZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDApLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMCkuZ2V0TmFtZSgpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgibm9kZUNvbmZpZyIsIGNvbmZpZyk7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2807"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.885Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "afa15dc27a4267006563eb6adc5fc01a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 550,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"debug\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22debug%22"
        },
        "response": {
          "bodySize": 3295,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3295,
            "text": "{\"result\":[{\"_id\":\"3cb43516-ae69-433a-8787-501d45db14e9\",\"name\":\"debug\",\"description\":\"Display sharedState, transientState, and headers.\",\"script\":\"LyogZGVidWcKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRGlzcGxheSBzaGFyZWRTdGF0ZSwgdHJhbnNpZW50U3RhdGUsIGFuZCBoZWFkZXJzLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwp2YXIgb3V0cHV0ID0gdHJ1ZTsKCnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjxwPjxiPlNoYXJlZCBTdGF0ZTwvYj46PGJyLz4iLmNvbmNhdCgKICAJc2hhcmVkU3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgCXRyYW5zaWVudFN0YXRlLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpLmNvbmNhdCgKICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogIAlyZXF1ZXN0SGVhZGVycy50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKQp2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICJmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuY2xhc3NOYW1lID0gXCJ0ZXh0LWxlZnRcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmlubmVySFRNTCA9ICciKS5jb25jYXQobWVzc2FnZSkuY29uY2F0KCInO1xuIikuY29uY2F0KAogICIgIH1cbiIpLmNvbmNhdCgKICAifSkiKQp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKG1lc3NhZ2UubGVuZ3RoICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgIGZyLlRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwKICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgKSwKICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3295"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.921Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "535f8e22f5692a97e227fd7128253462",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Embed Cookie Consent\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Embed%20Cookie%20Consent%22"
        },
        "response": {
          "bodySize": 2385,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2385,
            "text": "{\"result\":[{\"_id\":\"eea1e530-8cf4-4875-af75-11396e6a8859\",\"name\":\"Embed Cookie Consent\",\"description\":\"Embed cookie consent JavaScript snippet.\",\"script\":\"LyogRW1iZWQgQ29va2llIENvbnNlbnQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRW1iZWQgYSBPbmVUcnVzdCBjb29raWUgY29uc2VudCBKYXZhU2NyaXB0IGluIGEgbG9naW4vcmVnaXN0cmF0aW9uIGpvdXJuZXkuCiAqIAogKiBUaGlzIHNjcmlwdCBuZWVkcyB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgbm90IHdvcmsgcHJvcGVybHkgYXMgaXMuIEl0CiAqIHJlcXVpcmVzIGEgdmFsaWQgT25lVHJ1c3QgS2V5LgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCgovKgogKiBCRUdJTiBTQ1JJUFQgQ09ORklHVVJBVElPTgogKgogKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gT05FVFJVU1QgS0VZCiAqLwp2YXIgT05FVFJVU1RfS0VZID0gIjhhODRlOGNiLWUzZmEtNGQ3YS1iMWFmLTIwMTc5Y2FkZGFiYiI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCnZhciBzY3JpcHQgPSAnJy5jb25jYXQoCiAgCSd2YXIganMxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7XG4nKS5jb25jYXQoCgknanMxLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjtcbicpLmNvbmNhdCgKICAJJ2pzMS5jaGFyc2V0ID0gIlVURi04IjtcbicpLmNvbmNhdCgKCSdqczEuc3JjID0gImh0dHBzOi8vY2RuLmNvb2tpZWxhdy5vcmcvc2NyaXB0dGVtcGxhdGVzL290U0RLU3R1Yi5qcyI7XG4nKS5jb25jYXQoCgknanMxLnNldEF0dHJpYnV0ZSgiZGF0YS1kb21haW4tc2NyaXB0IiwgIicpLmNvbmNhdChPTkVUUlVTVF9LRVkpLmNvbmNhdCgnIik7XG4nKS5jb25jYXQoCgknZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChqczEpO1xuJykuY29uY2F0KAogIAkndmFyIGpzMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO1xuJykuY29uY2F0KAoJJ2pzMi50eXBlID0gInRleHQvamF2YXNjcmlwdCI7XG4nKS5jb25jYXQoCiAgCSdqczIuaW5uZXJIVE1MID0gImZ1bmN0aW9uIE9wdGFub25XcmFwcGVyKCkgeyB9IjtcbicpLmNvbmNhdCgKCSdkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGpzMik7XG4nKQoKdmFyIG91dHB1dCA9IHRydWU7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0cHV0KS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2385"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.959Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "a37455e9b0e2a570b843ddd3746bc8d1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 601,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"MobileOTP: Extract Username, Password, OTP\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22MobileOTP%3A%20Extract%20Username%2C%20Password%2C%20OTP%22"
        },
        "response": {
          "bodySize": 1904,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1904,
            "text": "{\"result\":[{\"_id\":\"57807349-630f-496a-bccb-ea1011b8e945\",\"name\":\"MobileOTP: Extract Username, Password, OTP\",\"description\":\"Extract username, password, and OTP from request headers and put them in shared state for validation.\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIk1vYmlsZU9UUDogRXh0cmFjdCBVc2VybmFtZSwgUGFzc3dvcmQsIE9UUDogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgVVNFUk5BTUVfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tVXNlcm5hbWUiOwp2YXIgUEFTU1dPUkRfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tUGFzc3dvcmQiOwp2YXIgT1RQX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLU1vYmlsZU9UUCI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCm91dGNvbWUgPSAiZmFsc2UiOwoKdmFyIHVzZXJuYW1lID0gZ2V0SGVhZGVyKFVTRVJOQU1FX0hFQURFUl9OQU1FKSB8fCBudWxsOwp2YXIgcGFzc3dvcmQgPSBnZXRIZWFkZXIoUEFTU1dPUkRfSEVBREVSX05BTUUpIHx8IG51bGw7CnZhciBtb2JpbGVPVFAgPSBnZXRIZWFkZXIoT1RQX0hFQURFUl9OQU1FKSB8fCBudWxsOwoKaWYgKHVzZXJuYW1lICYmIHBhc3N3b3JkICYmIG1vYmlsZU9UUCkgewogIAlzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgdXNlcm5hbWUpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoInBhc3N3b3JkIiwgcGFzc3dvcmQpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoIm1vYmlsZU9UUCIsIG1vYmlsZU9UUCk7CiAgICBvdXRjb21lID0gInRydWUiOwp9Cgpsb2dnZXIud2FybmluZygiTW9iaWxlT1RQOiBFeHRyYWN0IFVzZXJuYW1lLCBQYXNzd29yZCwgT1RQOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwoKLyoKICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIHJlcXVlc3RlZCBoZWFkZXIKICovCmZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgCWlmIChyZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgJiYgcmVxdWVzdEhlYWRlcnMuZ2V0KGhlYWRlck5hbWUpLmdldCgwKSkgewogICAgCXJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICB9CiAgCXJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1904"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:28.998Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "de69040be08ea514ae515fab391eaffa",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Phone Validator - Line Type\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Phone%20Validator%20-%20Line%20Type%22"
        },
        "response": {
          "bodySize": 4349,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4349,
            "text": "{\"result\":[{\"_id\":\"b63981d8-cb73-4e47-8749-e58654dcaa31\",\"name\":\"Phone Validator - Line Type\",\"description\":\"This script uses phonevalidator.com to determine the type of phone number stored in the user profile.\",\"script\":\"LyogUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFRoaXMgc2NyaXB0IHVzZXMgcGhvbmV2YWxpZGF0b3IuY29tIHRvIGRldGVybWluZSB0aGUgdHlwZSBvZiBwaG9uZSBudW1iZXIgc3RvcmVkIGluIHRoZSB1c2VyIHByb2ZpbGUuCiAqIEdldCB5b3VyIG93biBBUEkgS2V5IGF0IGh0dHBzOi8vd3d3LnBob25ldmFsaWRhdG9yLmNvbQogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIENFTEwgUEhPTkUKICogLSBMQU5ETElORQogKiAtIFZPSVAKICogLSBUT0xMLUZSRUUKICogLSBVTktOT1dOCiAqIC0gZmFpbGVkCiAqLwpsb2dnZXIud2FybmluZygiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBzdGFydCIpOwoKaWYgKGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIikgfHwgKHNoYXJlZFN0YXRlLmdldCgiX2lkIikgJiYgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAidGVsZXBob25lTnVtYmVyIikuaXRlcmF0b3IoKS5oYXNOZXh0KCkpKSB7CgogICAgLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqCiAgCSAqIFBob25lIFZhbGlkYXRvciAtIExpbmUgVHlwZSBBUEkgQ29uZmlndXJhdGlvbgogIAkgKiBHZXQgeW91ciBvd24gQVBJIEtleSBhdCBodHRwczovL3d3dy5waG9uZXZhbGlkYXRvci5jb20KICAgICAqLwogICAgdmFyIFBWX0FQSV9LRVkgPSAiODQ5ZDU2NGEtNTk0ZC00YmRlLWI2OTEtYWZlNWRkYWRkNTQ3IjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwoKICAJdmFyIFBWX0FQSV9UWVBFID0gImJhc2ljIjsKICAgIHZhciBQVl9BUElfUEhPTkUgPSBnZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoInRlbGVwaG9uZU51bWJlciIpIHx8IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkubmV4dCgpOwogICAgdmFyIFBWX0FQSV9VUkkgPSAiaHR0cHM6Ly93d3cucGhvbmV2YWxpZGF0b3IuY29tL2FwaS92Mi9waG9uZXNlYXJjaD9hcGlrZXk9Ii5jb25jYXQoUFZfQVBJX0tFWSkuY29uY2F0KCImcGhvbmU9IikuY29uY2F0KFBWX0FQSV9QSE9ORSkuY29uY2F0KCImdHlwZT0iKS5jb25jYXQoUFZfQVBJX1RZUEUpOwkKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoUFZfQVBJX1VSSSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwoKICAgIGlmIChyZXN1bHRbIlN0YXR1c0NvZGUiXT09IjIwMCIpIHsKICAgICAgICBvdXRjb21lID0gcmVzdWx0WyJQaG9uZUJhc2ljIl1bIkxpbmVUeXBlIl07CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgIH0KICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBTdGF0dXNDb2RlID0gIi5jb25jYXQocmVzdWx0WyJTdGF0dXNDb2RlIl0pKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBTdGF0dXNNZXNzYWdlID0gIi5jb25jYXQocmVzdWx0WyJTdGF0dXNNZXNzYWdlIl0pKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBvdXRjb21lID0gIi5jb25jYXQob3V0Y29tZSkpOwp9IGVsc2UgewogIAlvdXRjb21lID0gImZhaWxlZCI7CiAgCWxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBObyB1c2VyIG9yIHBob25lIG51bWJlciBmb3VuZCEgVXNlICdJZGVudGlmeSBFeGlzdGluZyBVc2VyIG5vZGUgYmVmb3JlIHRoaXMgc2NyaXB0IHRvIHBvcHVsYXRlIHRoZSB1c2VyJ3MgX2lkIGluIHNoYXJlZCBzdGF0ZSBvciBwdXQgYSB2YWxpZCBjZWxsIHBob25lIG51bWJlciBpbnRvIHNoYXJlZFN0YXRlLm9iamVjdEF0dHJpYnV0ZXMudGVsZXBob25lTnVtYmVyISciKTsKICAgIGxvZ2dlci5lcnJvcigiUGhvbmUgVmFsaWRhdG9yIC0gTGluZSBUeXBlOiBvdXRjb21lID0gIi5jb25jYXQob3V0Y29tZSkpOwp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgICByZXR1cm4gc3RvcmFnZS5uYW1lOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4349"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.038Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "b90b0662b33900fe214dfcaf5c5ccd8d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFAMethod_push\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFAMethod_push%22"
        },
        "response": {
          "bodySize": 1431,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1431,
            "text": "{\"result\":[{\"_id\":\"df559f35-82b2-4091-9b2a-6329f9c40b95\",\"name\":\"AT_MFAMethod_push\",\"description\":\"This script puts 'push' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdwdXNoJyBpbnRvIHRoZSBhdHRyaWJ1dGUgZnJVbmluZGV4ZWRTdHJpbmcyCiAgLSBIZWFsdGhjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMiA9IGZyLWF0dHItc3RyMiA9IHNtc3xmaWRvfG1haWx8cHVzaCAgTUZBIHR5cGUKICAtIEhlYWx0Y2FyZSBkZW1vOiBmclVuaW5kZXhlZFN0cmluZzMgPSBmci1hdHRyLXN0cjMgPSBNRkEgT3B0LWluID0gYWx3YXlzfG5ld3xuZXZlcnxwYXNzd29yZGxlc3MKICovCgpsb2dnZXIuZXJyb3IoJ0FUX01GQU1ldGhvZF9wdXNoOiBTVEFSVCcpCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3B1c2g6IF9pZCAnICsgdXNlcm5hbWUpOwp2YXIgYXR0cmlidXRlID0gImZyLWF0dHItc3RyMiIKCmlkUmVwb3NpdG9yeS5zZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSwgWyJwdXNoIl0pOwoKCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX3B1c2g6IE5ldyB2YWx1ZSBmb3IgJyArIGF0dHJpYnV0ZSArICc6ICcgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKTsKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1431"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.076Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "ca3c1925b573439e7dade808af882922",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 588,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Parse Call Parameters\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Parse%20Call%20Parameters%22"
        },
        "response": {
          "bodySize": 4540,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4540,
            "text": "{\"result\":[{\"_id\":\"7dce8f07-d9fe-4752-94b9-ff99dfd0433b\",\"name\":\"Twilio IVR: Parse Call Parameters\",\"description\":\"Parse parameters of the incoming call.\",\"script\":\"LyogVHdpbGlvIElWUiBJbnRlZ3JhdGlvbgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwoKbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFBhcnNlIENhbGwgUGFyYW1ldGVyczogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBUd2lsaW8gSVZSIENvbmZpZ3VyYXRpb24gUGFyYW1ldGVycwogKgogKiBUaGVzZSBhcmUgdXNlZCB0byBwcm90ZWN0IHRoaXMgam91cm5leSBzbyBpdCBpcyBvbmx5IGJlaW5nIGV4ZWN1dGVkIGJ5IHlvdXIgVHdpbGlvIGFjY291bnQuCiAqLwp2YXIgVFdJTElPX0FDQ09VTlRfU0lEID0gIkFDNzUwNDE1ZTMxNjNhMmU1N2I3YWVlYTdlZWQ4MmQ5NDQiOwp2YXIgVFdJTElPX1BIT05FX05VTUJFUiA9ICIrMTMxNzY0NDMxMDciOwoKLy8ga2VlcCB0aGUgcGFyYW1zIHRvIGEgbWluaW11bSB0byBtaW5pbWl6ZSBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIHNpemUKdmFyIGNhbGxQYXJhbXMgPSB7CiAgLy8iQ2FsbFNpZCIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJDYWxsU2lkIikuZ2V0KDApKSwKICAiQWNjb3VudFNpZCIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJBY2NvdW50U2lkIikuZ2V0KDApKSwKICAiRnJvbSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJGcm9tIikuZ2V0KDApKSwKICAiVG8iIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG8iKS5nZXQoMCkpLAogIC8vIkNhbGxTdGF0dXMiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiQ2FsbFN0YXR1cyIpLmdldCgwKSksCiAgLy8iQXBpVmVyc2lvbiIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJBcGlWZXJzaW9uIikuZ2V0KDApKSwKICAvLyJEaXJlY3Rpb24iIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRGlyZWN0aW9uIikuZ2V0KDApKSwKICAvLyJGb3J3YXJkZWRGcm9tIiA6IGRlY29kZVVSSUNvbXBvbmVudChyZXF1ZXN0UGFyYW1ldGVycy5nZXQoIkZvcndhcmRlZEZyb20iKS5nZXQoMCkpLAogIC8vIkNhbGxlck5hbWUiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiQ2FsbGVyTmFtZUNhbGxlck5hbWUiKS5nZXQoMCkpLAogIC8vIlBhcmVudENhbGxTaWQiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiUGFyZW50Q2FsbFNpZCIpLmdldCgwKSksCiAgLy8iRnJvbUNpdHkiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbUNpdHkiKS5nZXQoMCkpLAogIC8vIkZyb21TdGF0ZSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJGcm9tU3RhdGUiKS5nZXQoMCkpLAogIC8vIkZyb21aaXAiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbVppcCIpLmdldCgwKSksCiAgLy8iRnJvbUNvdW50cnkiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiRnJvbUNvdW50cnkiKS5nZXQoMCkpLAogIC8vIlRvQ2l0eSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJUb0NpdHkiKS5nZXQoMCkpLAogIC8vIlRvU3RhdGUiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG9TdGF0ZSIpLmdldCgwKSksCiAgLy8iVG9aaXAiIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgiVG9aaXAiKS5nZXQoMCkpLAogIC8vIlRvQ291bnRyeSIgOiBkZWNvZGVVUklDb21wb25lbnQocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJUb0NvdW50cnkiKS5nZXQoMCkpLAp9OwoKLyogRW5kIFR3aWxpbyBJVlIgQ29uZmlndXJhdGlvbiBQYXJhbWV0ZXJzIAogKi8KCmlmIChjYWxsUGFyYW1zLkFjY291bnRTaWQgPT0gVFdJTElPX0FDQ09VTlRfU0lEICYmCiAgICBjYWxsUGFyYW1zLlRvID09IFRXSUxJT19QSE9ORV9OVU1CRVIpIAp7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgICBzaGFyZWRTdGF0ZS5wdXQoIlR3aWxpb0lWUkNhbGxQYXJhbXMiLCBjYWxsUGFyYW1zKTsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIiwgY2FsbFBhcmFtcy5Gcm9tKTsKfQoKbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IFBhcnNlIENhbGwgUGFyYW1ldGVyczogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4540"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.115Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "f296607cce42ab13997d1394e1fabcec",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"HIBP Password Breach Analysis\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22HIBP%20Password%20Breach%20Analysis%22"
        },
        "response": {
          "bodySize": 4028,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4028,
            "text": "{\"result\":[{\"_id\":\"790045fa-a325-4e3e-96f8-d4a91b32e9de\",\"name\":\"HIBP Password Breach Analysis\",\"description\":\"Use Have I Been Pwned Password to check if password has been breached.\",\"script\":\"LyogSElCUCBQYXNzd29yZCBCcmVhY2ggQW5hbHlzaXMKICoKICogQXV0aG9yczogam9uLmtuaWdodEBmb3JnZXJvY2suY29tLCB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVXNlIEhhdmUgSSBCZWVuIFB3bmVkIFBhc3N3b3JkIHRvIGNoZWNrIGlmIHBhc3N3b3JkIGhhcyBiZWVuIGJyZWFjaGVkLgogKiBDYWxscyBISUJQIEFQSSB0byByZXRyaWV2ZSB0aGUgY291bnQgb2YgbWF0Y2hpbmcgcGFzc3dvcmRzIGluIGJyZWFjaGVkIAogKiBwYXNzd29yZCBkYXRhYmFzZQogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIFBhc3N3b3JkIG9yIFBsYXRmb3JtIFBhc3N3b3JkIGNvbGxlY3RvciBub2RlcyBiZWZvcmUKICogaXQgY2FuIG9wZXJhdGUuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gY2xlYXIKICogICBUaGUgbnVtYmVyIG9mIGJyZWFjaGVzIGZvciBwYXNzd29yZCB3YXMgZWl0aGVyIHplcm8gb3IgbGVzcyB0aGFuIHRoZSAKICogICB2YWx1ZSBvZiBUSFJFU0hPTEQKICogLSBicmVhY2hlZCAKICogICBUaGUgbnVtYmVyIG9mIGluY2lkZW50cyBvZiB0aGUgcGFzc3dvcmQgaW4gdGhlIGJyZWFjaGVkIHBhc3N3b3JkIAogKiAgIGRhdGFiYXNlIGV4Y2VlZHMgVEhSRVNIT0xECiAqIC0gZmFpbGVkCiAqICAgVGhlIEFQSSBjYWxsIHdhcyByZWplY3RlZC4KICovCihmdW5jdGlvbiAoKSB7CiAgICB2YXIgVVNFUl9BR0VOVD0iRm9yZ2VSb2NrIjsKICAJLy8gUGxlYXNlIHJlcGxhY2Ugd2l0aCB5b3VyIEhJQlAga2V5CiAgICB2YXIgSElCUF9BUElfS0VZPSIxMWJlNWQ4NjgxMmE0OTNkOWNiYmVjOGM3MmQ2NWZjOCI7CiAgICB2YXIgVEhSRVNIT0xEPTA7CgogICAgZnVuY3Rpb24gdG9IZXhTdHJpbmcoYnl0ZUFycmF5KSB7CiAgICAgICAgdmFyIHMgPSAnJzsKICAgICAgICBieXRlQXJyYXkuZm9yRWFjaChmdW5jdGlvbihieXRlKSB7CiAgICAgICAgICAgIHMgKz0gKCcwJyArIChieXRlICYgMHhGRikudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CgogICAgb3V0Y29tZSA9ICJmYWlsZWQiOwoKICAgIHZhciBtZCA9IGphdmEuc2VjdXJpdHkuTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZSgnU0hBLTEnKTsKICAJdmFyIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwovLyAgCXZhciBwYXNzd29yZCA9IG5ldyBqYXZhLmxhbmcuU3RyaW5nKCIiKTsKLy8gIAlpZiAobm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKSkgewovLyAgICAgIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwovLyAgICB9CiAgICB2YXIgYnl0ZUFycmF5ID0gcGFzc3dvcmQuZ2V0Qnl0ZXMoIlVURi04Iik7CiAgICBtZC51cGRhdGUoYnl0ZUFycmF5KTsKICAgIHZhciBkaWdlc3QgPSBtZC5kaWdlc3QoKTsKICAgIHZhciBoZXggPSBTdHJpbmcodG9IZXhTdHJpbmcoZGlnZXN0KSkudG9VcHBlckNhc2UoKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoJ2h0dHBzOi8vYXBpLnB3bmVkcGFzc3dvcmRzLmNvbS9yYW5nZS8nICsgaGV4LnN1YnN0cmluZygwLDUpKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQWNjZXB0IiwiKi8qIik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsImFwcGxpY2F0aW9uL2pzb24iKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiVXNlci1BZ2VudCIsIFVTRVJfQUdFTlQpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJoaWJwLWFwaS1rZXkiLCBISUJQX0FQSV9LRVkpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKCiAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkuZ2V0Q29kZSgpID09PSAyMDApIHsKICAgICAgICB2YXIgbWF4ID0gMDsKICAgICAgICBvdXRjb21lID0gImNsZWFyIjsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCk7CiAgICAgICAgdmFyIGxpbmVzID0gcmVzdWx0LnNwbGl0KCdcbicpOwogICAgICAgIGZvciAoaT0wOyBpPGxpbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwcmVmaXggPSBsaW5lc1tpXS5zcGxpdCgnOicpWzBdOwogICAgICAgICAgICBpZiAoU3RyaW5nKGhleC5zdWJzdHJpbmcoMCw1KSArIHByZWZpeCkgPT0gaGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBsaW5lc1tpXS5zcGxpdCgnOicpWzFdOwogICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4KSBtYXggPSBjb3VudDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWF4ID4gVEhSRVNIT0xEKSBvdXRjb21lID0gImJyZWFjaGVkIjsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoImhpYnBfcGFzc3dvcmRfY291bnQiLCBtYXgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4028"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.153Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "8201bcf50f7a9572b154bf9c2bb9d6fa",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Store Old Name\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Store%20Old%20Name%22"
        },
        "response": {
          "bodySize": 907,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 907,
            "text": "{\"result\":[{\"_id\":\"b2277f93-01e0-45c7-b23c-7fab2d5b49b4\",\"name\":\"Store Old Name\",\"description\":\"null\",\"script\":\"b2JqZWN0QXR0cmlidXRlcyA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpCgp1c2VyTmFtZSA9IG9iamVjdEF0dHJpYnV0ZXMuZ2V0KCJ1c2VyTmFtZSIpCnZhciByZXN1bHQgPSB1c2VyTmFtZTsKCmxvZ2dlci5lcnJvcigicmVzdWx0ID0gIiArIHJlc3VsdCk7CgovL29iamVjdEF0dHJpYnV0ZXMucHV0KCJ1c2VyTmFtZSIsIHJlc3VsdCkKb2JqZWN0QXR0cmlidXRlcy5wdXQoImZyVW5pbmRleGVkU3RyaW5nMSIscmVzdWx0KQpzaGFyZWRTdGF0ZS5wdXQoImZyVW5pbmRleGVkU3RyaW5nMSIscmVzdWx0KQoKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0QXR0cmlidXRlcyk7CgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "907"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.193Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "3b88c042795c1b6363a3c10fd4c3bcf8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 556,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"OTP Valid\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22OTP%20Valid%22"
        },
        "response": {
          "bodySize": 1362,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1362,
            "text": "{\"result\":[{\"_id\":\"5dbd53c6-67ff-4a43-84c3-90c5cf5da35a\",\"name\":\"OTP Valid\",\"description\":\"Return TextOutputCallback indicating the provided OTP was valid.\",\"script\":\"LyogT1RQIFZhbGlkCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJldHVybiBUZXh0T3V0cHV0Q2FsbGJhY2sgaW5kaWNhdGluZyB0aGUgcHJvdmlkZWQgT1RQIHdhcyB2YWxpZC4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopCmlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICJWQUxJRCIKICAgICAgICApCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1362"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.231Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "7452cd9cbdc9669c7892f34f277afd9f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 558,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display ESV\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20ESV%22"
        },
        "response": {
          "bodySize": 2975,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2975,
            "text": "{\"result\":[{\"_id\":\"b1fd9b38-fc54-46c6-9199-3d0de0abfaee\",\"name\":\"Display ESV\",\"description\":\"Display the value of an ESV\",\"script\":\"LyoKICogQmVnaW4gY29uZmlndXJhdGlvbgogKgogKiBNb2RpZnkgdGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgdG8gYWRhcHQgdG8geW91ciBuZWVkcwogKi8KCi8vIFNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheS4gWW91IG1heSB1c2UgSFRNTCBmb3IgZm9ybWF0dGluZy4gQXZvaWQgbGluZSBicmVha3MhIFVzZSA8YnI+IGluc3RlYWQuCnZhciBtZXNzYWdlID0gIjxoNT4iLmNvbmNhdChzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5hZG1pbi50b2tlbiIpKS5jb25jYXQoIjwvaDU+IikKCi8vIENob29zZSB0aGUgaG9yaXpvbnRhbCBhbGlnbm1lbnQgb2YgeW91ciBtZXNzYWdlLiBVc2UgbGVmdCwgY2VudGVyLCByaWdodC4KdmFyIGhhbGlnbiA9ICJsZWZ0IjsKLyoKICogRW5kIGNvbmZpZ3VyYXRpb24KICovCgp2YXIgb3V0cHV0ID0gdHJ1ZTsKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIn0pIikKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopCmlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGFuY2hvcgogICAgICAgICksCiAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygidHJ1ZSIpLmJ1aWxkKCk7Cn0KCiAvKgogICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAqIAogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2975"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.269Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "32a817b8ed234fd92cecdb914f4b58d5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFAMethod_mail\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFAMethod_mail%22"
        },
        "response": {
          "bodySize": 1431,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1431,
            "text": "{\"result\":[{\"_id\":\"f995b849-02c0-4b30-b8eb-e8dba1dd3454\",\"name\":\"AT_MFAMethod_mail\",\"description\":\"This script puts 'mail' into the attribute frUnindexedString2\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX21haWw6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfbWFpbDogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm1haWwiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2RfbWFpbDogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1431"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:30 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.307Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c5caa7291edc554233da2cdc3b03a448",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 579,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"LinkedIn Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22LinkedIn%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1575,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1575,
            "text": "{\"result\":[{\"_id\":\"8862ca8f-7770-4af5-a888-ac0df0947f36\",\"name\":\"LinkedIn Profile Normalization\",\"description\":\"Normalizes raw profile data from LinkedIn\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5maXJzdE5hbWUubG9jYWxpemVkLmdldCgwKSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmxhc3ROYW1lLmxvY2FsaXplZC5nZXQoMCkpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucHJvZmlsZVBpY3R1cmUuZGlzcGxheUltYWdlKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVsZW1lbnRzLmdldCgwKS5nZXQoImhhbmRsZX4iKS5lbWFpbEFkZHJlc3MpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZWxlbWVudHMuZ2V0KDApLmdldCgiaGFuZGxlfiIpLmVtYWlsQWRkcmVzcykpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1575"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.346Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "e81a7568b2f332dd73d17af7613483cf",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 581,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Salesforce Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Salesforce%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1655,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1655,
            "text": "{\"result\":[{\"_id\":\"312e951f-70c5-49d2-a9ae-93aef909d5df\",\"name\":\"Salesforce Profile Normalization\",\"description\":\"Normalizes raw profile data from Salesforce\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJfaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImdpdmVuTmFtZSIsIHJhd1Byb2ZpbGUuZ2l2ZW5fbmFtZSksCiAgICAgICAgZmllbGQoImZhbWlseU5hbWUiLCByYXdQcm9maWxlLmZhbWlseV9uYW1lKSwKICAgICAgICBmaWVsZCgicGhvdG9VcmwiLCByYXdQcm9maWxlLnBpY3R1cmUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJsb2NhbGUiLCByYXdQcm9maWxlLnpvbmVJbmZvKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1655"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.384Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "ace49dcc7cc8ada7e5e70040bfceaf34",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 589,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_DebugSharedState - imported (1)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_DebugSharedState%20-%20imported%20%281%29%22"
        },
        "response": {
          "bodySize": 1535,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1535,
            "text": "{\"result\":[{\"_id\":\"0cf351ab-e656-4c39-833b-88195f7fc738\",\"name\":\"AT_DebugSharedState - imported (1)\",\"description\":\"Debug Shared State to callbacks.\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIFNjcmlwdCB0byBkaXNwbGF5IHNoYXJlZFN0YXRlIGluIEludGVsbGlnZW50IEFjY2VzcyBKb3VybmV5IGZvciBkZWJ1Z2dpbmcKICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwpvdXRjb21lID0gInRydWUiOwp3aXRoIChmcikgewogIGlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICB2YXIgY2FsbGJhY2sgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgInNoYXJlZFN0YXRlOiAiLmNvbmNhdChzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIlxudHJhbnNpZW50U3RhdGU6ICIpLmNvbmNhdCh0cmFuc2llbnRTdGF0ZS50b1N0cmluZygpKSk7CiAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChjYWxsYmFjaykuYnVpbGQoKTsKICB9IGVsc2UgewogICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1535"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.424Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "ae423ecd23d677eb45d9af3c064159b1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Set Theme from URL\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Set%20Theme%20from%20URL%22"
        },
        "response": {
          "bodySize": 4071,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4071,
            "text": "{\"result\":[{\"_id\":\"1550ad56-df9f-4dad-9803-6c3a2545d8f4\",\"name\":\"Set Theme from URL\",\"description\":\"Detect and preserve currently active theme before setting new theme from query param in the request URL.\",\"script\":\"LyogU2V0IFRoZW1lIGZyb20gVVJMCiAqIAogKiBEZXRlY3QgYW5kIHByZXNlcnZlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWUgYmVmb3JlIHNldHRpbmcgbmV3IHRoZW1lIGZyb20gcXVlcnkgcGFyYW0gaW4gdGhlIHJlcXVlc3QgVVJMLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCQogIAl2YXIgdGhlbWUgPSAiIjsKICAJaWYgKHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgidGhlbWVJZCIpKSB7CiAgICAgIAl0aGVtZSA9IHJlcXVlc3RQYXJhbWV0ZXJzLmdldCgidGhlbWVJZCIpLmdldCgwKTsKICAgIH0KCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIG5vIHRoZW1lIHNldCwgZGlzY292ZXIgYWN0aXZlIHRoZW1lIGZyb20gVUkKICAgIGlmICghdGhlbWUgJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjawogIAllbHNlIGlmICghdGhlbWUgJiYgY2FsbGJhY2tzLnNpemUoKSA9PT0gMikgewogICAgICAgIC8vIGRpZCB3ZSBnZXQgdGhlIGlkIG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIHRoZW1lPwogICAgICAgIGlmIChjYWxsYmFja3MuZ2V0KDApLmdldFZhbHVlKCkgIT09ICJ0aGVtZS1pZC0iK2FuY2hvcikgewogICAgICAgICAgCXNoYXJlZFN0YXRlLnB1dCgidGhlbWVJZCIsIGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSk7CiAgICAgICAgfQogICAgfQogIAkvLyB0aGVtZSByZXF1ZXN0ZWQgaW4gVVJMLCBzZXQgaXQgYW5kIHByZXNlcnZlIGl0CiAgCWVsc2UgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgCS8vIHByZXNlcnZlIHRoZW1lIGluIHNoYXJlZCBzdGF0ZQogICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgdGhlbWUpOwogICAgICAgIC8vIHNldCBuZXcgdGhlbWUKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0KICAJZWxzZSB7CiAgICAgICAgLy8gY29udGludWUKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4071"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.463Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "b8afb85169152369b0e1f80254bd7a53",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 574,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Scripted Policy Condition\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Scripted%20Policy%20Condition%22"
        },
        "response": {
          "bodySize": 6880,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6880,
            "text": "{\"result\":[{\"_id\":\"9de3eb62-f131-4fac-a294-7bd170fd4acb\",\"name\":\"Scripted Policy Condition\",\"description\":\"Default global script for Scripted Policy Conditions\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTUtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCi8qKgogKiBUaGlzIGlzIGEgUG9saWN5IENvbmRpdGlvbiBleGFtcGxlIHNjcmlwdC4gSXQgZGVtb25zdHJhdGVzIGhvdyB0byBhY2Nlc3MgYSB1c2VyJ3MgaW5mb3JtYXRpb24sCiAqIHVzZSB0aGF0IGluZm9ybWF0aW9uIGluIGV4dGVybmFsIEhUVFAgY2FsbHMgYW5kIG1ha2UgYSBwb2xpY3kgZGVjaXNpb24gYmFzZWQgb24gdGhlIG91dGNvbWUuCiAqLwoKdmFyIHVzZXJBZGRyZXNzLCB1c2VySVAsIHJlc291cmNlSG9zdDsKCmlmICh2YWxpZGF0ZUFuZEluaXRpYWxpemVQYXJhbWV0ZXJzKCkpIHsKCiAgICB2YXIgY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9IGdldENvdW50cnlGcm9tVXNlckFkZHJlc3MoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJDb3VudHJ5IHJldHJpZXZlZCBmcm9tIHVzZXIncyBhZGRyZXNzOiAiICsgY291bnRyeUZyb21Vc2VyQWRkcmVzcyk7CiAgICB2YXIgY291bnRyeUZyb21Vc2VySVAgPSBnZXRDb3VudHJ5RnJvbVVzZXJJUCgpOwogICAgbG9nZ2VyLm1lc3NhZ2UoIkNvdW50cnkgcmV0cmlldmVkIGZyb20gdXNlcidzIElQOiAiICsgY291bnRyeUZyb21Vc2VySVApOwogICAgdmFyIGNvdW50cnlGcm9tUmVzb3VyY2VVUkkgPSBnZXRDb3VudHJ5RnJvbVJlc291cmNlVVJJKCk7CiAgICBsb2dnZXIubWVzc2FnZSgiQ291bnRyeSByZXRyaWV2ZWQgZnJvbSByZXNvdXJjZSBVUkk6ICIgKyBjb3VudHJ5RnJvbVJlc291cmNlVVJJKTsKCiAgICBpZiAoY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9PT0gY291bnRyeUZyb21Vc2VySVAgJiYgY291bnRyeUZyb21Vc2VyQWRkcmVzcyA9PT0gY291bnRyeUZyb21SZXNvdXJjZVVSSSkgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBdXRob3JpemF0aW9uIFN1Y2NlZWRlZCIpOwogICAgICAgIHJlc3BvbnNlQXR0cmlidXRlcy5wdXQoImNvdW50cnlPZk9yaWdpbiIsIFtjb3VudHJ5RnJvbVVzZXJBZGRyZXNzXSk7CiAgICAgICAgYXV0aG9yaXplZCA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBdXRob3JpemF0aW9uIEZhaWxlZCIpOwogICAgICAgIGF1dGhvcml6ZWQgPSBmYWxzZTsKICAgIH0KCn0gZWxzZSB7CiAgICBsb2dnZXIubWVzc2FnZSgiUmVxdWlyZWQgcGFyYW1ldGVycyBub3QgZm91bmQuIEF1dGhvcml6YXRpb24gRmFpbGVkLiIpOwogICAgYXV0aG9yaXplZCA9IGZhbHNlOwp9CgovKioKICogVXNlIHRoZSB1c2VyJ3MgYWRkcmVzcyB0byBsb29rdXAgdGhlaXIgY291bnRyeSBvZiByZXNpZGVuY2UuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgdXNlcidzIGNvdW50cnkgb2YgcmVzaWRlbmNlLgogKi8KZnVuY3Rpb24gZ2V0Q291bnRyeUZyb21Vc2VyQWRkcmVzcygpIHsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRVcmkoImh0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9hZGRyZXNzPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXNlckFkZHJlc3MpKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgZ2VvY29kZSA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgZ2VvY29kZS5yZXN1bHRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IGdlb2NvZGUucmVzdWx0c1tpXTsKICAgICAgICB2YXIgajsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgcmVzdWx0LmFkZHJlc3NfY29tcG9uZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAocmVzdWx0LmFkZHJlc3NfY29tcG9uZW50c1tpXS50eXBlc1swXSA9PSAiY291bnRyeSIpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuYWRkcmVzc19jb21wb25lbnRzW2ldLmxvbmdfbmFtZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIFVzZSB0aGUgdXNlcidzIElQIHRvIGxvb2t1cCB0aGUgY291bnRyeSBmcm9tIHdoaWNoIHRoZSByZXF1ZXN0IG9yaWdpbmF0ZWQuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgY291bnRyeSBmcm9tIHdoaWNoIHRoZSByZXF1ZXN0IG9yaWdpbmF0ZWQuCiAqLwpmdW5jdGlvbiBnZXRDb3VudHJ5RnJvbVVzZXJJUCgpIHsKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iICsgdXNlcklQKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdC5jb3VudHJ5OwogICAgfQp9CgovKioKICogVXNlIHRoZSByZXF1ZXN0ZWQgcmVzb3VyY2UncyBob3N0IG5hbWUgdG8gbG9va3VwIHRoZSBjb3VudHJ5IHdoZXJlIHRoZSByZXNvdXJjZSBpcyBob3N0ZWQuCiAqCiAqIEByZXR1cm5zIHsqfSBUaGUgY291bnRyeSBpbiB3aGljaCB0aGUgcmVzb3VyY2UgaXMgaG9zdGVkLgogKi8KZnVuY3Rpb24gZ2V0Q291bnRyeUZyb21SZXNvdXJjZVVSSSgpIHsKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iICsgZW5jb2RlVVJJQ29tcG9uZW50KHJlc291cmNlSG9zdCkpOwogIAlyZXF1ZXN0LnNldE1ldGhvZCgiR0VUIik7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgbG9nUmVzcG9uc2UocmVzcG9uc2UpOwoKICAgIHZhciByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gcmVzdWx0LmNvdW50cnk7CiAgICB9Cn0KCi8qKgogKiBSZXRyaWV2ZSBhbmQgdmFsaWRhdGUgdGhlIHZhcmlhYmxlcyByZXF1aXJlZCB0byBtYWtlIHRoZSBleHRlcm5hbCBIVFRQIGNhbGxzLgogKgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2lsbCBiZSB0cnVlIGlmIHZhbGlkYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAqLwpmdW5jdGlvbiB2YWxpZGF0ZUFuZEluaXRpYWxpemVQYXJhbWV0ZXJzKCkgewogICAgdmFyIHVzZXJBZGRyZXNzU2V0ID0gaWRlbnRpdHkuZ2V0QXR0cmlidXRlKCJwb3N0YWxBZGRyZXNzIik7CiAgICBpZiAodXNlckFkZHJlc3NTZXQgPT0gbnVsbCB8fCB1c2VyQWRkcmVzc1NldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gYWRkcmVzcyBzcGVjaWZpZWQgZm9yIHVzZXI6ICIgKyB1c2VybmFtZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdXNlckFkZHJlc3MgPSB1c2VyQWRkcmVzc1NldC5pdGVyYXRvcigpLm5leHQoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyIGFkZHJlc3M6ICIgKyB1c2VyQWRkcmVzcyk7CgogICAgaWYgKCFlbnZpcm9ubWVudCkgewogICAgICAgIGxvZ2dlci53YXJuaW5nKCJObyBlbnZpcm9ubWVudCBwYXJhbWV0ZXJzIHNwZWNpZmllZCBpbiB0aGUgZXZhbHVhdGlvbiByZXF1ZXN0LiIpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB2YXIgaXBTZXQgPSBlbnZpcm9ubWVudC5nZXQoIklQIik7CiAgICBpZiAoaXBTZXQgPT0gbnVsbCB8fCBpcFNldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gSVAgc3BlY2lmaWVkIGluIHRoZSBldmFsdWF0aW9uIHJlcXVlc3QgZW52aXJvbm1lbnQgcGFyYW1ldGVycy4iKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB1c2VySVAgPSBpcFNldC5pdGVyYXRvcigpLm5leHQoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJVc2VyIElQOiAiICsgdXNlcklQKTsKCiAgICBpZiAoIXJlc291cmNlVVJJKSB7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIk5vIHJlc291cmNlIFVSSSBzcGVjaWZpZWQuIik7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmVzb3VyY2VIb3N0ID0gcmVzb3VyY2VVUkkubWF0Y2goL14oLio6XC9cLykod3d3XC4pPyhbQS1aYS16MC05XC1cLl0rKSg6WzAtOV0rKT8oLiopJC8pWzNdOwogICAgbG9nZ2VyLm1lc3NhZ2UoIlJlc291cmNlIGhvc3Q6ICIgKyByZXNvdXJjZUhvc3QpOwoKICAgIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBsb2dSZXNwb25zZShyZXNwb25zZSkgewogICAgbG9nZ2VyLm1lc3NhZ2UoIlVzZXIgUkVTVCBDYWxsLiBTdGF0dXM6ICIgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICIsIEJvZHk6ICIgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7Cn0=\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"POLICY_CONDITION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6880"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.501Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "6d3985b76be90a623421cf1f1dab241b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ADFS Profile Normalization (JS)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ADFS%20Profile%20Normalization%20%28JS%29%22"
        },
        "response": {
          "bodySize": 7333,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7333,
            "text": "{\"result\":[{\"_id\":\"dbe0bf9a-72aa-49d5-8483-9db147985a47\",\"name\":\"ADFS Profile Normalization (JS)\",\"description\":\"Normalizes raw profile data from ADFS\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCByZXR1cm5zIHRoZSBzb2NpYWwgaWRlbnRpdHkgcHJvZmlsZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGF1dGhlbnRpY2F0aW5nIHVzZXIKICogaW4gYSBzdGFuZGFyZCBmb3JtIGV4cGVjdGVkIGJ5IHRoZSBTb2NpYWwgUHJvdmlkZXIgSGFuZGxlciBOb2RlLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogcmF3UHJvZmlsZSAtIFRoZSBzb2NpYWwgaWRlbnRpdHkgcHJvdmlkZXIgcHJvZmlsZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGF1dGhlbnRpY2F0aW5nIHVzZXIuCiAqICAgICAgICAgICAgICBKc29uVmFsdWUgKDEpLgogKiBsb2dnZXIgLSBUaGUgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiByZWFsbSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICBUaGUgbmFtZSBvZiB0aGUgcmVhbG0gdGhlIHVzZXIgaXMgYXV0aGVudGljYXRpbmcgdG8uCiAqIHJlcXVlc3RIZWFkZXJzIC0gVHJlZU1hcCAoMikuCiAqICAgICAgICAgICAgICAgICAgVGhlIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgZm9yIGFjY2Vzc2luZyBoZWFkZXJzIGluIHRoZSBsb2dpbiByZXF1ZXN0OgogKiAgICAgICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2F1dGhlbnRpY2F0aW9uLWd1aWRlL3NjcmlwdGluZy1hcGktbm9kZS5odG1sI3NjcmlwdGluZy1hcGktbm9kZS1yZXF1ZXN0SGVhZGVycy4KICogcmVxdWVzdFBhcmFtZXRlcnMgLSBUcmVlTWFwICgyKS4KICogICAgICAgICAgICAgICAgICAgICBUaGUgb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGF1dGhlbnRpY2F0aW9uIHJlcXVlc3QgcGFyYW1ldGVycy4KICogc2VsZWN0ZWRJZHAgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICAgVGhlIHNvY2lhbCBpZGVudGl0eSBwcm92aWRlciBuYW1lLiBGb3IgZXhhbXBsZTogZ29vZ2xlLgogKiBzaGFyZWRTdGF0ZSAtIExpbmtlZEhhc2hNYXAgKDMpLgogKiAgICAgICAgICAgICAgIFRoZSBvYmplY3QgdGhhdCBob2xkcyB0aGUgc3RhdGUgb2YgdGhlIGF1dGhlbnRpY2F0aW9uIHRyZWUgYW5kIGFsbG93cyBkYXRhIGV4Y2hhbmdlIGJldHdlZW4gdGhlIHN0YXRlbGVzcyBub2RlczoKICogICAgICAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hdXRoLW5vZGVzL2NvcmUtYWN0aW9uLmh0bWwjYWNjZXNzaW5nLXRyZWUtc3RhdGUuCiAqIHRyYW5zaWVudFN0YXRlIC0gTGlua2VkSGFzaE1hcCAoMykuCiAqICAgICAgICAgICAgICAgICAgVGhlIG9iamVjdCBmb3Igc3RvcmluZyBzZW5zaXRpdmUgaW5mb3JtYXRpb24gdGhhdCBtdXN0IG5vdCBsZWF2ZSB0aGUgc2VydmVyIHVuZW5jcnlwdGVkLAogKiAgICAgICAgICAgICAgICAgIGFuZCB0aGF0IG1heSBub3QgbmVlZCB0byBwZXJzaXN0IGJldHdlZW4gYXV0aGVudGljYXRpb24gcmVxdWVzdHMgZHVyaW5nIHRoZSBhdXRoZW50aWNhdGlvbiBzZXNzaW9uOgogKiAgICAgICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2F1dGgtbm9kZXMvY29yZS1hY3Rpb24uaHRtbCNhY2Nlc3NpbmctdHJlZS1zdGF0ZS4KICoKICogUmV0dXJuIC0gYSBKc29uVmFsdWUgKDEpLgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqCiAqICAgICAgICAgIFRoaXMgc2NyaXB0J3MgbGFzdCBzdGF0ZW1lbnQgc2hvdWxkIHJlc3VsdCBpbiBhIEpzb25WYWx1ZSAoMSkgd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6CiAqICAgICAgICAgIHsKICogICAgICAgICAgICAgIHsiZGlzcGxheU5hbWUiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiZW1haWwiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiZmFtaWx5TmFtZSI6ICJjb3JyZXNwb25kaW5nLXNvY2lhbC1pZGVudGl0eS1wcm92aWRlci12YWx1ZSJ9LAogKiAgICAgICAgICAgICAgeyJnaXZlbk5hbWUiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsiaWQiOiAiY29ycmVzcG9uZGluZy1zb2NpYWwtaWRlbnRpdHktcHJvdmlkZXItdmFsdWUifSwKICogICAgICAgICAgICAgIHsibG9jYWxlIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0sCiAqICAgICAgICAgICAgICB7InBob3RvVXJsIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0sCiAqICAgICAgICAgICAgICB7InVzZXJuYW1lIjogImNvcnJlc3BvbmRpbmctc29jaWFsLWlkZW50aXR5LXByb3ZpZGVyLXZhbHVlIn0KICogICAgICAgICAgfQogKgogKiAgICAgICAgICBUaGUgY29uc3VtZXIgb2YgdGhpcyBkYXRhIGRlZmluZXMgd2hpY2gga2V5cyBhcmUgcmVxdWlyZWQgYW5kIHdoaWNoIGFyZSBvcHRpb25hbC4KICogICAgICAgICAgRm9yIGV4YW1wbGUsIHRoZSBzY3JpcHQgYXNzb2NpYXRlZCB3aXRoIHRoZSBTb2NpYWwgUHJvdmlkZXIgSGFuZGxlciBOb2RlIGFuZCwKICogICAgICAgICAgdWx0aW1hdGVseSwgdGhlIG1hbmFnZWQgb2JqZWN0IGNyZWF0ZWQvdXBkYXRlZCB3aXRoIHRoaXMgZGF0YQogKiAgICAgICAgICB3aWxsIGV4cGVjdCBjZXJ0YWluIGtleXMgdG8gYmUgcG9wdWxhdGVkLgogKiAgICAgICAgICBJbiBzb21lIGNvbW1vbiBkZWZhdWx0IGNvbmZpZ3VyYXRpb25zLCB0aGUgZm9sbG93aW5nIGtleXMgYXJlIHJlcXVpcmVkIHRvIGJlIG5vdCBlbXB0eToKICogICAgICAgICAgdXNlcm5hbWUsIGdpdmVuTmFtZSwgZmFtaWx5TmFtZSwgZW1haWwuCiAqCiAqICAgICAgICAgIEZyb20gUkZDNDUxNzogQSB2YWx1ZSBvZiB0aGUgRGlyZWN0b3J5IFN0cmluZyBzeW50YXggaXMgYSBzdHJpbmcgb2Ygb25lIG9yIG1vcmUKICogICAgICAgICAgYXJiaXRyYXJ5IGNoYXJhY3RlcnMgZnJvbSB0aGUgVW5pdmVyc2FsIENoYXJhY3RlciBTZXQgKFVDUykuCiAqICAgICAgICAgIEEgemVyby1sZW5ndGggY2hhcmFjdGVyIHN0cmluZyBpcyBub3QgcGVybWl0dGVkLgogKgogKiAoMSkgSnNvblZhbHVlIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL2pzb24vSnNvblZhbHVlLmh0bWwuCiAqICgyKSBUcmVlTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9UcmVlTWFwLmh0bWwuCiAqICgzKSBMaW5rZWRIYXNoTWFwIC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqLwoKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZQogICAgKTsKCiAgICB2YXIgbm9ybWFsaXplZFByb2ZpbGVEYXRhID0gZnJKYXZhLkpzb25WYWx1ZS5qc29uKGZySmF2YS5Kc29uVmFsdWUub2JqZWN0KCkpOwogIAogICAgICAvL2xvZ2dlci5tZXNzYWdlKCdTZWd1aW4gcmF3UHJvZmlsZTogJytyYXdQcm9maWxlKTsKCiAgICBub3JtYWxpemVkUHJvZmlsZURhdGEucHV0KCdpZCcsIHJhd1Byb2ZpbGUuZ2V0KCdzdWInKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2Rpc3BsYXlOYW1lJywgcmF3UHJvZmlsZS5nZXQoJ2dpdmVuTmFtZScpLmFzU3RyaW5nKCkgKyAnICcgKyByYXdQcm9maWxlLmdldCgnc24nKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2VtYWlsJywgcmF3UHJvZmlsZS5nZXQoJ21haWwnKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2dpdmVuTmFtZScsIHJhd1Byb2ZpbGUuZ2V0KCdnaXZlbk5hbWUnKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ2ZhbWlseU5hbWUnLCByYXdQcm9maWxlLmdldCgnc24nKS5hc1N0cmluZygpKTsKICAgIG5vcm1hbGl6ZWRQcm9maWxlRGF0YS5wdXQoJ3VzZXJuYW1lJywgcmF3UHJvZmlsZS5nZXQoJ3VwbicpLmFzU3RyaW5nKCkpOwogICAgbm9ybWFsaXplZFByb2ZpbGVEYXRhLnB1dCgncm9sZXMnLCByYXdQcm9maWxlLmdldCgncm9sZXMnKS5hc1N0cmluZygpKTsKICAKICAgICAgLy9sb2dnZXIubWVzc2FnZSgnU2VndWluIG5vcm1hbGl6ZWRQcm9maWxlRGF0YTogJytub3JtYWxpemVkUHJvZmlsZURhdGEpOwoKICAgIHJldHVybiBub3JtYWxpemVkUHJvZmlsZURhdGE7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7333"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.542Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "f375ac107060aea67476a5942835699a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_IdDataWebSocialPolicyDecision\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_IdDataWebSocialPolicyDecision%22"
        },
        "response": {
          "bodySize": 2181,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2181,
            "text": "{\"result\":[{\"_id\":\"9f9814f6-a13d-4ad9-b954-8fca5ba5efaf\",\"name\":\"AT_IdDataWebSocialPolicyDecision\",\"description\":\"Script to validate that ID DataWeb Identity Proofing passed.\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiBVc2UuIAogKiBNb2RpZmllZCBieSBTdGVwaGVuIFBheW5lCiAqIEFUX0lkRGF0YVdlYlNvY2lhbFBvbGljeURlY2lzaW9uLCBTY3JpcHQgdG8gdmFsaWRhdGUgdGhhdCBJRCBEYXRhV2ViIElkZW50aXR5IFByb29maW5nIHBhc3NlZC4gCiAqLwovKiAqLwoKbG9nZ2VyLmVycm9yKCJBVF9JZERhdGFXZWJTb2NpYWxQb2xpY3lEZWNpc2lvbiA6IHN0YXJ0Iik7Cm91dGNvbWUgPSAiZXJyb3IiOwoKdmFyIFByb29mUmVzdWx0cyA9IHNoYXJlZFN0YXRlLmdldCgiY2xhaW1zX3NldCIpLmdldCgicG9saWN5RGVjaXNpb24iKTsKdmFyIFByb29mU2NvcmUgPSBzaGFyZWRTdGF0ZS5nZXQoImNsYWltc19zZXQiKS5nZXQoImlkd1Jpc2tTY29yZSIpOwoKaWYgKFByb29mUmVzdWx0cyA9PSBudWxsICkgewogIG91dGNvbWUgPSAibnVsbCI7Cn0KZWxzZSBpZiAoUHJvb2ZSZXN1bHRzID0gImFwcHJvdmUiICkgewogIG91dGNvbWUgPSAiYXBwcm92ZSI7CiAgc2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZEludGVnZXIxIiwyKTsKICBzZXRPYmplY3RBdHRyaWJ1dGUoImZyVW5pbmRleGVkU3RyaW5nMSIsICJpZGRhdGF3ZWIgcmVzdWx0OiAiICsgUHJvb2ZSZXN1bHRzICsgIiBpZGRhdHdlYiBzY29yZTogIiArIFByb29mU2NvcmUpOwp9CmVsc2UgaWYgKFByb29mUmVzdWx0cyA9ICJkZW55IiApIHsKICBvdXRjb21lID0gImRlbnkiOwp9CmVsc2UgewogIG91dGNvbWUgPSAiZXJyb3IiCn0KCmZ1bmN0aW9uIHNldE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgICAgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KG5hbWUsIHZhbHVlKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2181"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.582Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "47895ebf87e9f90cccca1a2ede1a6f95",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFAMethod_oath\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFAMethod_oath%22"
        },
        "response": {
          "bodySize": 1425,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1425,
            "text": "{\"result\":[{\"_id\":\"31142dea-c9af-4e31-916b-37076dcbffbf\",\"name\":\"AT_MFAMethod_oath\",\"description\":\"Script that puts \\\"oath\\\" in the fr-attr-str2 attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdzbXMnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfTUZBTWV0aG9kX29hdGg6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfb2F0aDogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm9hdGgiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9NRkFNZXRob2Rfb2F0aDogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1425"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.624Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "dcc34405f9b2c07186729f2a8039368f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Instagram Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Instagram%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1269,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1269,
            "text": "{\"result\":[{\"_id\":\"1244e639-4a31-401d-ab61-d75133d8dc9e\",\"name\":\"Instagram Profile Normalization\",\"description\":\"Normalizes raw profile data from Instagram\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1269"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.663Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "29f34b68c1f8a46d5588ac0ab235cae4",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 559,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_Optin-Never\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_Optin-Never%22"
        },
        "response": {
          "bodySize": 1414,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1414,
            "text": "{\"result\":[{\"_id\":\"aaaea08e-aaf5-4848-84d6-7fe105de8934\",\"name\":\"AT_Optin-Never\",\"description\":\"The script puts \\\"never\\\" into the MFA Opt-in attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICduZXZlcicgaW50byB0aGUgYXR0cmlidXRlIGZyVW5pbmRleGVkU3RyaW5nMwogIC0gSGVhbHRoY2FyZSBkZW1vOiBmclVuaW5kZXhlZFN0cmluZzIgPSBmci1hdHRyLXN0cjIgPSBzbXN8Zmlkb3xtYWlsfHB1c2ggIE1GQSB0eXBlCiAgLSBIZWFsdGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmczID0gZnItYXR0ci1zdHIzID0gTUZBIE9wdC1pbiA9IGFsd2F5c3xuZXd8bmV2ZXJ8cGFzc3dvcmRsZXNzCiAqLwoKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogU1RBUlQnKQoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKQpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBfaWQgJyArIHVzZXJuYW1lKTsKdmFyIGF0dHJpYnV0ZSA9ICJmci1hdHRyLXN0cjMiCgppZFJlcG9zaXRvcnkuc2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUsIFsibmV2ZXIiXSk7CgoKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogTmV3IHZhbHVlIGZvciAnICsgYXR0cmlidXRlICsgJzogJyArIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkpOwpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1414"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.705Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "20ffbf3538cf3757d9eafe81a7b1aead",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Onfido-Meta-Tags\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Onfido-Meta-Tags%22"
        },
        "response": {
          "bodySize": 1844,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1844,
            "text": "{\"result\":[{\"_id\":\"8a768bb3-01cd-46b8-881c-b77f5a26c283\",\"name\":\"Onfido-Meta-Tags\",\"description\":\"Write Onfido HTML Meta Tags\",\"script\":\"LyogV3JpdGUgSFRNTCBNZXRhIFRhZ3MKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd3JpdGVzIG1ldGEgdGFncyB0byB0aGUgaGVhZGVyLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICkKCiAgZnVuY3Rpb24gY3JlYXRlU2NyaXB0KCkgewogICAgcmV0dXJuIFN0cmluZygiXG5cCiAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcblwKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVxuXAogICAgKS5mb3JFYWNoKFxuXAogICAgICBmdW5jdGlvbiAoZSkge1xuXAogICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOyBcblwKICAgICAgICBtZXRhLm5hbWUgPSBcImF1dGhvclwiOyBcblwKICAgICAgICBtZXRhLmNvbnRlbnQgPSBcIkpvaG4gRG9lXCI7IFxuXAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobWV0YSk7IFxuXAogICAgICB9XG5cCiAgICApIik7CiAgfQoKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soY3JlYXRlU2NyaXB0KCkpCiAgICAgICkuYnVpbGQoKQogIH0gZWxzZSB7CiAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1844"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.744Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "55959bdf6db3b98dcac2c68ee1e988c5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 582,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"KerberosLogin: Extract Username\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22KerberosLogin%3A%20Extract%20Username%22"
        },
        "response": {
          "bodySize": 2242,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2242,
            "text": "{\"result\":[{\"_id\":\"355a8b7c-9e3c-40c1-a873-68127e483adf\",\"name\":\"KerberosLogin: Extract Username\",\"description\":\"Extract Username from request.\",\"script\":\"LyogS2VyYmVyb3NMb2dpbjogRXh0cmFjdCBVc2VybmFtZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8KCmxvZ2dlci53YXJuaW5nKCJLZXJiZXJvc0xvZ2luOiBFeHRyYWN0IFVzZXJuYW1lOiBzdGFydCIpOwpvdXRjb21lID0gImZhbHNlIjsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgVVNFUk5BTUVfSEVBREVSX05BTUUgPSAiWC1PcGVuQU0tVXNlcm5hbWUiOwovKgogKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICovCgp2YXIgdXNlcm5hbWUgPSBnZXRIZWFkZXIoVVNFUk5BTUVfSEVBREVSX05BTUUpOwppZiAodXNlcm5hbWUpIHsKCQogIAlvdXRjb21lID0gInRydWUiOwogICAgc2hhcmVkU3RhdGUucHV0KCJ1c2VybmFtZSIsIHVzZXJuYW1lKTsKICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCB1c2VybmFtZSk7Cn0KCmxvZ2dlci53YXJuaW5nKCJLZXJiZXJvc0xvZ2luOiBFeHRyYWN0IFVzZXJuYW1lOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwoKLyoKICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIHJlcXVlc3RlZCBoZWFkZXIKICovCmZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgCWlmIChyZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgJiYgcmVxdWVzdEhlYWRlcnMuZ2V0KGhlYWRlck5hbWUpLmdldCgwKSkgewogICAgCXJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApLnRvU3RyaW5nKCk7CiAgICB9CiAgCXJldHVybiBudWxsOwp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHN0b3JhZ2UucHV0KSB7CgkgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2242"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.783Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "00e2701958bcda3e4b43d6ae0c478f72",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 556,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Get Email\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Get%20Email%22"
        },
        "response": {
          "bodySize": 1346,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1346,
            "text": "{\"result\":[{\"_id\":\"d6469639-249f-4df1-9e03-335cd3e37b3d\",\"name\":\"Get Email\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJHZXQgRW1haWw6IHN0YXJ0Iik7Cm91dGNvbWUgPSAidHJ1ZSI7CmlmIChnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCBnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikpOwp9CmxvZ2dlci5lcnJvcigiR2V0IEVtYWlsOiBlbmQiKTsKCi8qCiAqIEdldCBwcm9maWxlIGF0dHJpYnV0ZQogKi8KZnVuY3Rpb24gZ2V0UHJvZmlsZUF0dHJpYnV0ZShuYW1lKSB7CiAgICByZXR1cm4gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCBuYW1lKS5pdGVyYXRvcigpLm5leHQoKTsKfQoKLyoKICogUHJvcGVybHkgc2V0IGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgICAgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KG5hbWUsIHZhbHVlKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1346"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.822Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "a6b7fc14acf0e9784d993fe5f89cae9a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 608,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"MobileOTP: Prepare Reset Of OTP Profile Attribute\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22MobileOTP%3A%20Prepare%20Reset%20Of%20OTP%20Profile%20Attribute%22"
        },
        "response": {
          "bodySize": 1332,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1332,
            "text": "{\"result\":[{\"_id\":\"d25a1315-8beb-4a0c-84bf-534214fed087\",\"name\":\"MobileOTP: Prepare Reset Of OTP Profile Attribute\",\"description\":\"Prepare Reset Of OTP Profile Attribute\",\"script\":\"LyoKICogUmVzZXQgT1RQIHByb2ZpbGUgYXR0cmlidXRlIGluIE9iamVjdEF0dHJpYnV0ZXMgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICovCm91dGNvbWUgPSAidHJ1ZSI7CgpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImZyLWF0dHItaW50NSIsICIwIik7CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1332"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.863Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "a9c49b439be01d2b64c7940e0475028a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Microsoft Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Microsoft%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 2525,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2525,
            "text": "{\"result\":[{\"_id\":\"73cecbfc-dad0-4395-be6a-6858ee3a80e5\",\"name\":\"Microsoft Profile Normalization\",\"description\":\"Normalizes raw profile data from Microsoft\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKLyoKewogICAgIkBvZGF0YS5jb250ZXh0IjogImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wLyRtZXRhZGF0YSN1c2Vycy8kZW50aXR5IiwKICAgICJAb2RhdGEuaWQiOiAiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tL3YyLzcxMWZmYTljLTU5NzItNDcxMy1hY2UzLTY4OGM5NzMyNjE0YS9kaXJlY3RvcnlPYmplY3RzLzdkNzc1OWUyLTM2ZDgtNGU2NC1iMTczLTNmODkwZDdkNDZkNi9NaWNyb3NvZnQuRGlyZWN0b3J5U2VydmljZXMuVXNlciIsCiAgICAiYnVzaW5lc3NQaG9uZXMiOiBbCiAgICAgICAgIjE4MDE0NzM1NDUxIgogICAgXSwKICAgICJkaXNwbGF5TmFtZSI6ICJWb2xrZXIgU2NoZXViZXIiLAogICAgImdpdmVuTmFtZSI6ICJWb2xrZXIiLAogICAgImpvYlRpdGxlIjogbnVsbCwKICAgICJtYWlsIjogInZzY2hldWJlckB2c2NoZXViZXIub25taWNyb3NvZnQuY29tIiwKICAgICJtb2JpbGVQaG9uZSI6IG51bGwsCiAgICAib2ZmaWNlTG9jYXRpb24iOiBudWxsLAogICAgInByZWZlcnJlZExhbmd1YWdlIjogbnVsbCwKICAgICJzdXJuYW1lIjogIlNjaGV1YmVyIiwKICAgICJ1c2VyUHJpbmNpcGFsTmFtZSI6ICJ2c2NoZXViZXJAdnNjaGV1YmVyLm9ubWljcm9zb2Z0LmNvbSIsCiAgICAiaWQiOiAiN2Q3NzU5ZTItMzZkOC00ZTY0LWIxNzMtM2Y4OTBkN2Q0NmQ2Igp9CiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmxvZ2dlci5tZXNzYWdlKCJLYXVhaSBNaWNyb3NvZnQgUHJvZmlsZSBOb3JtYWxpemF0aW9uOiByYXdQcm9maWxlPXt9IiwgcmF3UHJvZmlsZSkKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmRpc3BsYXlOYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbk5hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5zdXJuYW1lKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLnVzZXJQcmluY2lwYWxOYW1lKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJQcmluY2lwYWxOYW1lKSwKICAgICAgICBmaWVsZCgiZ3JvdXBzIiwgcmF3UHJvZmlsZS5ncm91cHMpKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2525"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.903Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "680975923e0ca4212384a836a0cc9bff",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 556,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_getMail2\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_getMail2%22"
        },
        "response": {
          "bodySize": 3656,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3656,
            "text": "{\"result\":[{\"_id\":\"5e6d276c-c5ca-434a-a682-725bb9ab8168\",\"name\":\"AT_getMail2\",\"description\":\"Get email, and set Company and selectedIdP to the Domain\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiBVc2UuCiAqIFRoaXMgc2NyaXB0IGdldHMgdGhlIG1haWwgYXR0cmlidXRlIGZyb20gc2hhcmVkIHN0YXRlIGZvciBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQgYW5kIHNldHMgdGhlIGNvcnJlY3QKICogc2hhcmVkU3RhdGUgdmFyaWFibGUgdG8gbWF0Y2ggdGhlIHNlbGVjdGVkIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciAoY29uZmlndXJlZCBpbiBBTSBTb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgU2VydmljZQogKiBTZWNvbmRhcnkgQ29uZmlndXJhdGlvbnMuIEl0IGFsc28gc2V0cyB0aGUgQ29tcGFueSBuYW1lIHRvIGF1dG9tYXRpY2FsbHkgcHV0IHRoZSB1c2VyIGluIHRoZSBjb3JyZWN0IG9yZ2FuaXphdGlvbi4KICovCmxvZ2dlci5lcnJvcigiQVRfZ2V0TWFpbDI6IHN0YXJ0Iik7Cm91dGNvbWUgPSAiTG9jYWwiOwoKCi8vICdpZiAoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSAmJiBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLmhhc05leHQoKSkgeycKaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpKSB7CiAgdmFyIG1haWwgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoIm1haWwiKTsKICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBtYWlsOiIgKyBtYWlsKTsKCgogIGlmIChtYWlsLmluZGV4T2YoJ0Bwcm92aWRlcicpICE9PSAtMSkgewogICAgICBvdXRjb21lID0gIk9JREMiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgInByb3ZpZGVyIik7CiAgICAgIHNldE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkU3RyaW5nNSIsICJwcm92aWRlciIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBQcm92aWRlciIpOwogIH0KCiAgaWYgKG1haWwuaW5kZXhPZignQGVtcGxveWVyJykgIT09IC0xKSB7CiAgICAgIG91dGNvbWUgPSAiT0lEQyI7CiAgICAgIHNoYXJlZFN0YXRlLnB1dCgic2VsZWN0ZWRJZHAiLCAiZW1wbG95ZXIiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImVtcGxveWVyIik7CiAgICAgIGxvZ2dlci5lcnJvcigiQVRfZ2V0TWFpbDI6IE91dGNvbWU6IEVtcGxveWVyIik7CiAgfQogIGlmIChtYWlsLmluZGV4T2YoJ0BwYXllcicpICE9PSAtMSkgewogICAgICBvdXRjb21lID0gIk9JREMiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgInBheWVyIik7CiAgICAgIHNldE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkU3RyaW5nNSIsICJwYXllciIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBQYXllciIpOwogIH0KICBpZiAobWFpbC5pbmRleE9mKCdAZ21haWwnKSAhPT0gLTEpIHsKICAgICAgb3V0Y29tZSA9ICJPSURDIjsKICAgICAgc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJnb29nbGUiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImdvb2dsZSIpOwogICAgICBsb2dnZXIuZXJyb3IoIkFUX2dldE1haWwyOiBPdXRjb21lOiBnb29nbGUiKTsKICB9CiAgICBpZiAobWFpbC5pbmRleE9mKCdAaGVhbHRoJykgIT09IC0xKSB7CiAgICAgIG91dGNvbWUgPSAiTG9jYWwiOwogICAgICBzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgImhlYWx0aGNhcmVJREMiKTsKICAgICAgc2V0T2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmc1IiwgImhlYWx0aGNhcmVJREMiKTsKICAgICAgbG9nZ2VyLmVycm9yKCJBVF9nZXRNYWlsMjogT3V0Y29tZTogaGVhbHRoY2FyZUlEQyIpOwogIH0KfQoKZnVuY3Rpb24gc2V0T2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CiAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dChuYW1lLCB2YWx1ZSk7CiAgfQogIGVsc2UgewogICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOiIrdmFsdWUrIn0iKSk7CiAgfQp9Cg==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3656"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.942Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "02249303b7c5578138b6258cba364209",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 579,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Populate Username From Email\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Populate%20Username%20From%20Email%22"
        },
        "response": {
          "bodySize": 1797,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1797,
            "text": "{\"result\":[{\"_id\":\"4855aac0-1efd-49c0-a153-3b9aadc911a6\",\"name\":\"Populate Username From Email\",\"description\":\"Populate Username From Email\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBnZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiKSkKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJ1c2VyTmFtZSIsIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgibWFpbCIpKQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9CgovKgogKiBSZWFkIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewogICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIG51bGw7Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1797"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:29.983Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "db90eceb79c16c3bbcc58534480bff4d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_SetSocialIddataweb\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_SetSocialIddataweb%22"
        },
        "response": {
          "bodySize": 1058,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1058,
            "text": "{\"result\":[{\"_id\":\"5a845c31-2c60-40fc-91cb-f6c1fc0a5c1b\",\"name\":\"AT_SetSocialIddataweb\",\"description\":\"Set the shared state to select Id DataWeb as the social provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICogQVRfU2V0U29jaWFsSWRkYXRhd2ViLCBTY3JpcHQgdG8gc2V0IHRoZSBzb2NpYWwgcHJvdmlkZXIgdHlwZSB0byBJRERhdGFXZWIKKi8Kc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJpZGRhdGF3ZWIiKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1058"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.023Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "40934b8c769c023c7bdee351c6f248bf",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 576,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect SAML2 Node Config\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20SAML2%20Node%20Config%22"
        },
        "response": {
          "bodySize": 5479,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 5479,
            "text": "{\"result\":[{\"_id\":\"48f17202-039f-4d40-b7fc-4ce380f1b929\",\"name\":\"Collect SAML2 Node Config\",\"description\":\"Collect all the configuration items required for the SAML2 Node to function properly.\",\"script\":\"LyogQ29sbGVjdCBTQU1MMiBOb2RlIENvbmZpZwogKiAKICogQ29sbGVjdCBhbGwgdGhlIGNvbmZpZ3VyYXRpb24gaXRlbXMgcmVxdWlyZWQgZm9yIHRoZSBTQU1MMiBOb2RlIHRvIGZ1bmN0aW9uIHByb3Blcmx5LgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogIAl2YXIgY29uZmlnID0gewogICAgICAgICJtZXRhQWxpYXMiOiAiL2lTUEF6dXJlIiwKICAgICAgICAiYWxsb3dDcmVhdGUiOiBmYWxzZSwKICAgICAgICAic2xvRW5hYmxlZCI6IGZhbHNlLAogICAgICAgICJhdXRobkNvbnRleHRDbGFzc1JlZiI6IFtdLAogICAgICAgICJhdXRobkNvbnRleHREZWNsUmVmIjogW10sCiAgICAgICAgImF1dGhDb21wYXJpc29uIjogIkVYQUNUIiwKICAgICAgICAibmFtZUlkRm9ybWF0IjogInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIiwKICAgICAgICAicmVxdWVzdEJpbmRpbmciOiAiSFRUUF9SRURJUkVDVCIsCiAgICAgICAgImJpbmRpbmciOiAiSFRUUF9QT1NUIiwKICAgICAgICAiZm9yY2VBdXRobiI6IGZhbHNlLAogICAgICAgICJpZHBFbnRpdHlJZCI6ICJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MTFmZmE5Yy01OTcyLTQ3MTMtYWNlMy02ODhjOTczMjYxNGEvIiwKICAgICAgICAiaXNQYXNzaXZlIjogZmFsc2UsCiAgICAgICAgInNsb1JlbGF5U3RhdGUiOiAiIgogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXSk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWV0YUFsaWFzIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImFsbG93Q3JlYXRlIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soInNsb0VuYWJsZWQiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYXV0aG5Db250ZXh0Q2xhc3NSZWYiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYXV0aG5Db250ZXh0RGVjbFJlZiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJhdXRoQ29tcGFyaXNvbiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJuYW1lSWRGb3JtYXQiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygicmVxdWVzdEJpbmRpbmciKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygiYmluZGluZyIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJmb3JjZUF1dGhuIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImlkcEVudGl0eUlkIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImlzUGFzc2l2ZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJzbG9SZWxheVN0YXRlIiksCiAgICAgICAgICAJbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpOwogICAgfQogICAgZWxzZSB7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgwKS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDApLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDEpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKSA9PT0gJ3RydWUnKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDIpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDIpLmdldE5hbWUoKSA9PT0gJ3RydWUnKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDMpLmdldFByb21wdCgpXSA9IFtjYWxsYmFja3MuZ2V0KDMpLmdldE5hbWUoKV07CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg0KS5nZXRQcm9tcHQoKV0gPSBbY2FsbGJhY2tzLmdldCg0KS5nZXROYW1lKCldOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoNSkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCg1KS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg2KS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDYpLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDcpLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoNykuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoOCkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCg4KS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg5KS5nZXRQcm9tcHQoKV0gPSAoY2FsbGJhY2tzLmdldCg5KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgxMCkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxMCkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMTEpLmdldFByb21wdCgpXSA9IChjYWxsYmFja3MuZ2V0KDExKS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgxMikuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxMikuZ2V0TmFtZSgpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgibm9kZUNvbmZpZyIsIGNvbmZpZyk7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "5479"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.063Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "6d6778bdba3c163db2a1a736499e1690",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 591,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Impersonate: Update Session Properties\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Impersonate%3A%20Update%20Session%20Properties%22"
        },
        "response": {
          "bodySize": 1636,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1636,
            "text": "{\"result\":[{\"_id\":\"7dd80834-e7b2-4737-85a7-40434bb19dde\",\"name\":\"Impersonate: Update Session Properties\",\"description\":\"Store the impersontor and impersonatee profile information in session properties.\",\"script\":\"LyogSW1wZXJzb25hdGU6IFVwZGF0ZSBTZXNzaW9uIFByb3BlcnRpZXMKICogCiAqIFN0b3JlIHRoZSBpbXBlcnNvbnRvciBhbmQgaW1wZXJzb25hdGVlIHByb2ZpbGUgaW5mb3JtYXRpb24gaW4gc2Vzc2lvbiBwcm9wZXJ0aWVzLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogamFrZS5mZWFzZWxAZm9yZ2Vyb2NrLmNvbSwgdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJJbXBlcnNvbmF0ZTogVXBkYXRlIFNlc3Npb24gUHJvcGVydGllczogc3RhcnQiKTsKICAJb3V0Y29tZSA9ICJ0cnVlIjsKICAKICAgIHZhciBnb1RvID0gb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24uZ29UbzsKICAgIG15R290byA9IGdvVG8ob3V0Y29tZSk7CiAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJ1c2VyTmFtZSIsIHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSk7CiAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJpbXBlcnNvbmF0b3IiLCBzaGFyZWRTdGF0ZS5nZXQoImltcGVyc29uYXRvciIpKTsKCiAgCWxvZ2dlci5tZXNzYWdlKCJJbXBlcnNvbmF0ZTogVXBkYXRlIFNlc3Npb24gUHJvcGVydGllczogZG9uZSBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKICAgIGFjdGlvbiA9IG15R290by5idWlsZCgpOwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1636"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.103Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "2cf49871f6a54a18b79e66f21ec9bcc6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 573,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Save/restore perpetrator\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Save%2Frestore%20perpetrator%22"
        },
        "response": {
          "bodySize": 1085,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1085,
            "text": "{\"result\":[{\"_id\":\"5b3b2c47-0248-46f4-8a1c-8a495d249037\",\"name\":\"Save/restore perpetrator\",\"description\":\"null\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKaWYgKHNoYXJlZFN0YXRlLmdldCgicGVycGV0cmF0b3IiKSkKewogIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBzaGFyZWRTdGF0ZS5nZXQoInBlcnBldHJhdG9yIikpOwovLyAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7Ci8vCXNoYXJlZFN0YXRlLnJlbW92ZSgib2JqZWN0QXR0cmlidXRlcyIpOwovLyAgfQogIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIHt9KTsKfQplbHNlCnsKICBzaGFyZWRTdGF0ZS5wdXQoInBlcnBldHJhdG9yIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKTsKICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgCiAgICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgidXNlck5hbWUiKSkgewoJc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucmVtb3ZlKCJ1c2VyTmFtZSIpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1085"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.141Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "e8613806778c91962c3e99d50d6b85f1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Both States\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Both%20States%22"
        },
        "response": {
          "bodySize": 2421,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2421,
            "text": "{\"result\":[{\"_id\":\"38f698de-fe11-43d2-8480-44e1312d121d\",\"name\":\"FRAAS-7955 Both States\",\"description\":\"FRAAS-7955 Both States\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC1zaGFyZWQiKTsKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXNoYXJlZCIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC1zaGFyZWRAY29tcGFueS5jb20iKTsKCnNldFRyYW5zaWVudE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC10cmFuc2llbnQiKTsKc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXRyYW5zaWVudCIpOwpzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC10cmFuc2llbnRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiB0cmFuc2llbnQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHRyYW5zaWVudFN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmICh0cmFuc2llbnRTdG9yYWdlLnB1dCkgewogICAgICAgICAgICB0cmFuc2llbnRTdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAgIHRyYW5zaWVudFN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgdHJhbnNpZW50U3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2421"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.181Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "ac71417e9445745ff74bc8f2410779c6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 565,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Setup MFA Choice\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Setup%20MFA%20Choice%22"
        },
        "response": {
          "bodySize": 5593,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 5593,
            "text": "{\"result\":[{\"_id\":\"f26cc0de-ee31-4114-8a32-27799bb49357\",\"name\":\"Setup MFA Choice\",\"description\":\"null\",\"script\":\"LyoKICogQWRhcHQgdGhlIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGJlbG93CiAqLwoKLy8gZG8gbm90IGNoYW5nZSwgbXVzdCBiZSBhIHJhbmRvbSBpZGVudGlmaWVyCnZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CgovLyBzcGVjaWZ5IHRoZSBob3Jpem9udGFsIGFsaWdubWVudCBvZiB0aGUgbWVzc2FnZTogbGVmdCwgY2VudGVyLCByaWdodAp2YXIgaGFsaWduID0gImNlbnRlciI7CgovLyBzcGVjaWZ5IHRoZSBzdHlsZSB0byBhcHBseSB0byB0aGUgYnV0dG9uIGluIHRoZSBtZXNzYWdlIHRvIG1ha2UgaXQgbG9vayBsaWtlIGEgbGluawp2YXIgbGlua0J1dHRvblN0eWxlID0gImJvcmRlcjogMDsgY29sb3I6ICMxMDlDRjE7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IjsKCi8vIHNwZWNpZnkgdGhlIGxpbmsgYnV0dG9uIEhUTUwgZWxlbWVudC4gb25seSBtb2RpZnkgdGhlIHRleHQgYmV0d2VlbiB0aGUgPGJ1dHRvbj4gYW5kIDwvYnV0dG9uPiB0YWdzLgp2YXIgbGlua0J1dHRvbiA9ICI8YnV0dG9uIGlkPVwic2tpcC1saW5rLSIuY29uY2F0KGFuY2hvcikuY29uY2F0KCJcIiB0eXBlPVwic3VibWl0XCIgc3R5bGU9XCIiKS5jb25jYXQobGlua0J1dHRvblN0eWxlKS5jb25jYXQoIlwiPnNraXAgZm9yIG5vdy48L2J1dHRvbj4iKTsKCi8vIHNwZWNpZnkgdGhlIG1lc3NhZ2UgeW91IHdhbnQgdG8gZGlzcGxheSBhbmQgcGxhY2UgdGhlIGxpbmtCdXR0b24gYW55d2hlcmUKdmFyIG1lc3NhZ2UgPSAiUGxlYXNlIHNlbGVjdCB5b3VyIHByZWZlcmVkIGZhY3RvciBvciIuY29uY2F0KGxpbmtCdXR0b24pOwoKLy8gc3BlY2lmeSB0aGUgY2hvaWNlcyB5b3Ugd2FudCB0byBvZmZlciB0aGUgdXNlci4KdmFyIGNob2ljZXMgPSBbIlNNUyIsIkZpZG8iLCJQdXNoIl07CgovLyBzcGVjaWZ5IHRoZSBkZWZhdWx0IGNob2ljZS4gdGhpcyBzZXR0aW5nIG11c3QgYmUgYSB2YWxpZCAwLWJhc2VkIGluZGV4IG9mIHRoZSBjaG9pY2VzIGFycmF5IGFib3ZlLgp2YXIgZGVmYXVsdENob2ljZSA9IDA7CgovKgogKiBBbGwgdGhlIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGFyZSBhYm92ZSB0aGlzIGNvbW1lbnQuCiAqCiAqIERPIE5PVCBNQUtFIEFOWSBDSEFOR0VTIEJFTE9XIQogKi8KCi8vIGZpbmQgdGhlIFRleHRPdXRwdXRDYWxsYmFjayB3aXRoIHRoZSBtZXNzYWdlX2FuY2hvcgovLyBhbmQgcmVwbGFjZSB0aGUgbWVzc2FnZV9hbmNob3Igd2l0aCB0aGUgbWVzc2FnZQp2YXIgZGlzcGxheU1lc3NhZ2VTY3JpcHQgPSAiIi5jb25jYXQoCiAgIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIikuY29uY2F0KAogICIgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpXG4iKS5jb25jYXQoCiAgIikuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiICBmdW5jdGlvbiAoZSkge1xuIikuY29uY2F0KAogICIgICAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgICAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnbWVzc2FnZS0iKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAiICAgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICAgIH1cbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIikiKQoKLy8gaGlqYWNrIHRoZSBsaW5rIGJ1dHRvbiBpbiB0aGUgbWVzc2FnZSBhbmQ6Ci8vIC0gZmluZCB0aGUgSGlkZGVuVmFsdWVDYWxsYmFjayBhbmQgc2V0IGl0cyB2YWx1ZSB0byAiU2tpcCIKLy8gLSB0aGVuIHNpbXVsYXRlIGEgbG9naW4gYnV0dG9uIGNsaWNrCnZhciBza2lwT3B0aW9uU2NyaXB0ID0gIiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNraXAtbGluay0iKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIlwiKS5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiIpLmNvbmNhdCgKICAiICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNraXAtaW5wdXQtIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCJcIikudmFsdWUgPSBcIlNraXBcIjtcbiIpLmNvbmNhdCgKICAiICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luQnV0dG9uXzBcIikuY2xpY2soKTtcbiIpLmNvbmNhdCgKICAiICByZXR1cm4gZmFsc2U7XG4iKS5jb25jYXQoCiAgIn0iKQoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLkNvbmZpcm1hdGlvbkNhbGxiYWNrLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5IaWRkZW5WYWx1ZUNhbGxiYWNrLAogICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCikKCmlmIChjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICJtZXNzYWdlLSIuY29uY2F0KGFuY2hvcikKICAgICAgICApLAogICAgICAgIG5ldyBmci5Db25maXJtYXRpb25DYWxsYmFjaygKICAgICAgICAgICAgZnIuQ29uZmlybWF0aW9uQ2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGNob2ljZXMsCiAgICAgICAgICAgIGRlZmF1bHRDaG9pY2UKICAgICAgICApLAogICAgICAgIG5ldyBmci5IaWRkZW5WYWx1ZUNhbGxiYWNrKCJza2lwLWlucHV0LSIuY29uY2F0KGFuY2hvciksICJmYWxzZSIpLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soZGlzcGxheU1lc3NhZ2VTY3JpcHQpLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2tpcE9wdGlvblNjcmlwdCkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIC8vIGRpZCB0aGUgdXNlciBza2lwPwogIGlmIChjYWxsYmFja3MuZ2V0KDIpLmdldFZhbHVlKCkgPT0gIlNraXAiKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygiU2tpcCIpLmJ1aWxkKCk7CiAgfQogIC8vIHVzZXIgZGlkbid0IHNraXAsIHBpY2sgdGhlIHJpZ2h0IG91dGNvbWUKICBlbHNlIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKGNob2ljZXNbY2FsbGJhY2tzLmdldCgxKS5nZXRTZWxlY3RlZEluZGV4KCldKS5idWlsZCgpOwogIH0KfQoKIC8qCiAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICogCiAgKiBFeGFtcGxlOgogICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgKi8KZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgdmFyIHYgPSByOwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgIH0pOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "5593"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.221Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "b46be828bf3243ce1f5ba21e5abace63",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 572,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Goto Specified Decision\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Goto%20Specified%20Decision%22"
        },
        "response": {
          "bodySize": 5500,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 5500,
            "text": "{\"result\":[{\"_id\":\"2a076e9e-75a9-46b5-b971-10ffafbdf652\",\"name\":\"Goto Specified Decision\",\"description\":\"Return true if a goto param has been specified, false otherwise.\",\"script\":\"LyogR290byBTcGVjaWZpZWQgRGVjaXNpb24KICogCiAqIFJldHVybiB0cnVlIGlmIGEgZ290byBwYXJhbSBoYXMgYmVlbiBzcGVjaWZpZWQsIGZhbHNlIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IHJlcXVpcmUgY29uZmlndXJhdGlvbi4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgbG9nZ2VyLm1lc3NhZ2UoIkdvdG8gU3BlY2lmaWVkIERlY2lzaW9uOiBzdGFydCIpOwogIAlvdXRjb21lID0gImZhbHNlIjsKICAJdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwogIAlpZiAocmVmZXJlci5zZWFyY2hQYXJhbS5nb3RvKSB7CiAgICAgIAlvdXRjb21lID0gInRydWUiOwogICAgfQogICAgbG9nZ2VyLm1lc3NhZ2UoIkdvdG8gU3BlY2lmaWVkIERlY2lzaW9uOiBlbmQgW291dGNvbWU9e31dIiwgb3V0Y29tZSk7CgogICAgLyoKICAgICAqIFBhcnNlIGEgVVJMIGludG8gaXRzIGNvbXBvbmVudHMgYW5kIG1ha2UgdGhlbSBlYXNpbHkgYWNjZXNzaWJsZSBieSBuYW1lCiAgICAgKgogICAgICogVXNlIGluIGEgU2NyaXB0ZSBEZWNpc2lvbiBOb2RlIFNjcmlwdCBhcyBmb2xsb3dzOgogICAgICogdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwogICAgICogdmFyIG9yaWdpbiA9IHJlZmVyZXIub3JpZ2luOwogICAgICogCiAgICAgKiBlLmcuOiBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8KICAgICAqIHsKICAgICAqICAgICBoYXNoOiAnIy8nLAogICAgICogICAgIGhvc3Q6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhvc3RuYW1lOiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBocmVmOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvJywKICAgICAqICAgICBvcmlnaW46ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgcGF0aG5hbWU6ICcvYW0vWFVJLycsCiAgICAgKiAgICAgcG9ydDogJycsCiAgICAgKiAgICAgcHJvdG9jb2w6ICdodHRwcycsCiAgICAgKiAgICAgc2VhcmNoOiAnP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltJywKICAgICAqICAgICB1c2VybmFtZTogJycsCiAgICAgKiAgICAgcGFzc3dvcmQ6ICcnLAogICAgICogICAgIHNlYXJjaFBhcmFtOiB7CiAgICAgKiAgICAgICAgIHJlYWxtOiAnL2JyYXZvJywKICAgICAqICAgICAgICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICogICAgICAgICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScKICAgICAqICAgICB9CiAgICAgKiB9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHBhcnNlVXJsKGhyZWYpIHsKICAgICAgICB2YXIgbSA9IGhyZWYubWF0Y2goL14oKFteOlwvPyNdKyk6Pyg/OlwvXC8oKD86KFteXC8/IzpdKik6KFteXC8/IzpdKilAKT8oW15cLz8jOl0qKSg/OjooW15cLz8jOl0qKSk/KSkpPyhbXj8jXSopKFw/W14jXSopPygjLiopPyQvKSwKICAgICAgICByID0gewogICAgICAgICAgICBoYXNoOiBtWzEwXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgLy8gIy8KICAgICAgICAgICAgaG9zdDogbVszXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIG9wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBob3N0bmFtZTogbVs2XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhyZWY6IG1bMF0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8KICAgICAgICAgICAgb3JpZ2luOiBtWzFdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIHBhdGhuYW1lOiBtWzhdIHx8IChtWzFdID8gIi8iIDogIiIpLCAgICAvLyAvYW0vWFVJLwogICAgICAgICAgICBwb3J0OiBtWzddIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHByb3RvY29sOiBtWzJdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBodHRwcwogICAgICAgICAgICBzZWFyY2g6IG1bOV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltCiAgICAgICAgICAgIHVzZXJuYW1lOiBtWzRdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcGFzc3dvcmQ6IG1bNV0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBzZWFyY2hQYXJhbToge30gICAgICAgICAgICAgICAgICAgICAgICAgLy8geyByZWFsbTogJy9icmF2bycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VmFsdWU6ICdJbml0aWF0ZU93bmVyQ2xhaW0nIH0KICAgICAgICB9OwogICAgICAgIGlmIChyLnByb3RvY29sLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAgIHIucHJvdG9jb2wgPSAiZmlsZTovLy8iICsgci5wcm90b2NvbC50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICByLm9yaWdpbiA9IHIucHJvdG9jb2wgKyAiLy8iICsgci5ob3N0OwogICAgICAgIH0KICAgICAgICBpZiAoci5zZWFyY2gubGVuZ3RoID4gMikgewogICAgICAgICAgICB2YXIgcXVlcnkgPSAoci5zZWFyY2guaW5kZXhPZignPycpID09PSAwKSA/IHIuc2VhcmNoLnN1YnN0cigxKSA6IHIuc2VhcmNoOwogICAgICAgICAgICB2YXIgdmFycyA9IHF1ZXJ5LnNwbGl0KCcmJyk7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgcGFpciA9IHZhcnNbaV0uc3BsaXQoJz0nKTsKICAgICAgICAgICAgci5zZWFyY2hQYXJhbVtkZWNvZGVVUklDb21wb25lbnQocGFpclswXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHIuaHJlZiA9IHIub3JpZ2luICsgci5wYXRobmFtZSArIHIuc2VhcmNoICsgci5oYXNoOwogICAgICAgIHJldHVybiByOwogICAgfTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "5500"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.260Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "d08e34a87125b7ffb72bf6855138a9e5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 556,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Set Theme\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Set%20Theme%22"
        },
        "response": {
          "bodySize": 3582,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3582,
            "text": "{\"result\":[{\"_id\":\"76421cb0-0550-43e7-89f8-51ad1d95d306\",\"name\":\"Set Theme\",\"description\":\"Detect and preserve currently active theme before setting the new theme.\",\"script\":\"LyogU2V0IFRoZW1lCiAqIAogKiBEZXRlY3QgYW5kIHByZXNlcnZlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWUgYmVmb3JlIHNldHRpbmcgdGhlIG5ldyB0aGVtZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAlvdXRjb21lID0gInRydWUiOwogIAkKICAJdmFyIHRoZW1lID0gIkV4cGFuc2VfTUZBIjsKCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIGRpc2NvdmVyIGFjdGl2ZSB0aGVtZSBmcm9tIFVJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjayBhbmQgc2V0IG5ldyB0aGVtZQogIAllbHNlIGlmIChjYWxsYmFja3Muc2l6ZSgpID09PSAyKSB7CiAgICAgICAgLy8gZGlkIHdlIGdldCB0aGUgaWQgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWU/CiAgICAgICAgaWYgKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSAhPT0gInRoZW1lLWlkLSIrYW5jaG9yKSB7CiAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgY2FsbGJhY2tzLmdldCgwKS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gc2V0IG5ldyB0aGVtZQogICAgCXZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAJbmV3IGZyLlBvbGxpbmdXYWl0Q2FsbGJhY2soIjEwMCIsICJQbGVhc2Ugd2FpdCAuLi4iKQogICAgICAgICkud2l0aFN0YWdlKHN0YWdlKS5idWlsZCgpOwogICAgfQogIAllbHNlIHsKICAgICAgICAvLyBjb250aW51ZQogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgIC8qCiAgICAgICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAgICAgKiAKICAgICAgKiBFeGFtcGxlOgogICAgICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICAgICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAgICAgKi8KICAgIGZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpKjEwfDA7CiAgICAgICAgICAgIHZhciB2ID0gcjsKICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgICAgIH0pOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3582"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.300Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "3061b032426771626e9bedd19872123e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FrodoTestScript1\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FrodoTestScript1%22"
        },
        "response": {
          "bodySize": 1106,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1106,
            "text": "{\"result\":[{\"_id\":\"c9cb4b1e-1cd3-4e5b-8f56-140f83ba9f6d\",\"name\":\"FrodoTestScript1\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1106"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:31 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.338Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "86ab66a40fae6821c073723b89b5657f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 592,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect Set Custom Cookie Node Config\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20Set%20Custom%20Cookie%20Node%20Config%22"
        },
        "response": {
          "bodySize": 4195,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4195,
            "text": "{\"result\":[{\"_id\":\"a31a1796-8410-46b8-82ca-eb0c6e901775\",\"name\":\"Collect Set Custom Cookie Node Config\",\"description\":\"Collect all the configuration items required for the Set Custom Cookie node to function properly.\",\"script\":\"LyogQ29sbGVjdCBTZXQgQ3VzdG9tIENvb2tpZSBOb2RlIENvbmZpZwogKiAKICogQ29sbGVjdCBhbGwgdGhlIGNvbmZpZ3VyYXRpb24gaXRlbXMgcmVxdWlyZWQgZm9yIHRoZSBTZXQgQ3VzdG9tIENvb2tpZSBub2RlIHRvIGZ1bmN0aW9uIHByb3Blcmx5LgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwogIAl2YXIgY29uZmlnID0gewoJCSJuYW1lIjogIm9yZW8iLAoJCSJ2YWx1ZSI6ICJvcmlnaW5hbCIsCgkJImRvbWFpbiI6ICIuc2NoZXViZXIuaW8iLAoJCSJwYXRoIjogIi8iLAoJCSJtYXhBZ2UiOiAzNjAwLAoJCSJ1c2VIdHRwT25seUNvb2tpZSI6IHRydWUsCgkJInVzZVNlY3VyZUNvb2tpZSI6IHRydWUsCgkJInNhbWVTaXRlIjogIk5PTkUiCgl9OwogIAogIAl2YXIgc2NyaXB0ID0gIiI7CiAgICBzY3JpcHQgKz0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCI7CiAgICBzY3JpcHQgKz0gIiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKSI7CiAgICBzY3JpcHQgKz0gIikuZm9yRWFjaCgiOwogICAgc2NyaXB0ICs9ICIgICAgZnVuY3Rpb24gKGlucHV0LGkpIHsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIGNvbnNvbGUubG9nKCdpbnB1dCAnK2kpOyIKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIgY29uZmlnID0gSlNPTi5wYXJzZSgnIitKU09OLnN0cmluZ2lmeShjb25maWcpKyInKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoY29uZmlnKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIGlmIChpbnB1dC50eXBlID09PSAndGV4dCcpIHsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgY29uZmlnW2tleXNbaV1dKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBLZXlib2FyZEV2ZW50KCAnaW5wdXQnICwgeydrZXknOidFbnRlcid9ICkpOyI7CiAgICBzY3JpcHQgKz0gIiAgICAgICAgfSI7CiAgICBzY3JpcHQgKz0gIiAgICB9IjsKICAgIHNjcmlwdCArPSAiKTsiOwogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5OYW1lQ2FsbGJhY2ssCiAgICAgICAgY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrCiAgICApCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJuYW1lIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soInZhbHVlIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soImRvbWFpbiIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJwYXRoIiksCiAgICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soIm1heEFnZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJ1c2VIdHRwT25seUNvb2tpZSIpLAogICAgICAgICAgICBuZXcgZnIuTmFtZUNhbGxiYWNrKCJ1c2VTZWN1cmVDb29raWUiKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygic2FtZVNpdGUiKSwKICAgICAgICAgIAluZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDApLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMCkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMSkuZ2V0UHJvbXB0KCldID0gY2FsbGJhY2tzLmdldCgxKS5nZXROYW1lKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgyKS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDIpLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDMpLmdldFByb21wdCgpXSA9IGNhbGxiYWNrcy5nZXQoMykuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoNCkuZ2V0UHJvbXB0KCldID0gcGFyc2VJbnQoY2FsbGJhY2tzLmdldCg0KS5nZXROYW1lKCksIDEwKS50b0ZpeGVkKCk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg1KS5nZXRQcm9tcHQoKV0gPSAoIiIrY2FsbGJhY2tzLmdldCg1KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg2KS5nZXRQcm9tcHQoKV0gPSAoIiIrY2FsbGJhY2tzLmdldCg2KS5nZXROYW1lKCkgPT09ICd0cnVlJyk7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCg3KS5nZXRQcm9tcHQoKV0gPSBjYWxsYmFja3MuZ2V0KDcpLmdldE5hbWUoKTsKICAgICAgCW5vZGVTdGF0ZS5wdXRTaGFyZWQoIm5vZGVDb25maWciLCBjb25maWcpOwogICAgCWFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4195"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.376Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "6d503a98c6fd899d9710bab9b15de39e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 594,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Normalized ADFS Profile to Managed User\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Normalized%20ADFS%20Profile%20to%20Managed%20User%22"
        },
        "response": {
          "bodySize": 3313,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3313,
            "text": "{\"result\":[{\"_id\":\"3156d7e9-1589-4ffb-a659-37a1647ee03d\",\"name\":\"Normalized ADFS Profile to Managed User\",\"description\":\"Converts a normalized social profile coming from ADFS into a managed user\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgbWFuYWdlZFVzZXIgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlck5hbWUiLCBub3JtYWxpemVkUHJvZmlsZS51c2VybmFtZSkpKQoKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgicG9zdGFsQWRkcmVzcyIsIG5vcm1hbGl6ZWRQcm9maWxlLnBvc3RhbEFkZHJlc3MpCmlmIChub3JtYWxpemVkUHJvZmlsZS5hZGRyZXNzTG9jYWxpdHkuaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgiY2l0eSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NMb2NhbGl0eSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24uaXNOb3ROdWxsKCkpIG1hbmFnZWRVc2VyLnB1dCgic3RhdGVQcm92aW5jZSIsIG5vcm1hbGl6ZWRQcm9maWxlLmFkZHJlc3NSZWdpb24pCmlmIChub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInBvc3RhbENvZGUiLCBub3JtYWxpemVkUHJvZmlsZS5wb3N0YWxDb2RlKQppZiAobm9ybWFsaXplZFByb2ZpbGUuY291bnRyeS5pc05vdE51bGwoKSkgbWFuYWdlZFVzZXIucHV0KCJjb3VudHJ5Iiwgbm9ybWFsaXplZFByb2ZpbGUuY291bnRyeSkKaWYgKG5vcm1hbGl6ZWRQcm9maWxlLnBob25lLmlzTm90TnVsbCgpKSBtYW5hZ2VkVXNlci5wdXQoInRlbGVwaG9uZU51bWJlciIsIG5vcm1hbGl6ZWRQcm9maWxlLnBob25lKQptYW5hZ2VkVXNlci5wdXQoImFjY291bnRTdGF0dXMiLCAobm9ybWFsaXplZFByb2ZpbGUucm9sZXMuYXNTdHJpbmcoKSA9PSAiZmlkYy12b2xrZXItZGV2LWFkbWlucyIpID8gJ0FjdGl2ZScgOiAnSW5hY3RpdmUnKQoKLy8gaWYgdGhlIGdpdmVuTmFtZSBhbmQgZmFtaWx5TmFtZSBpcyBudWxsIG9yIGVtcHR5Ci8vIHRoZW4gYWRkIGEgYm9vbGVhbiBmbGFnIHRvIHRoZSBzaGFyZWQgc3RhdGUgdG8gaW5kaWNhdGUgbmFtZXMgYXJlIG5vdCBwcmVzZW50Ci8vIHRoaXMgY291bGQgYmUgdXNlZCBlbHNld2hlcmUKLy8gZm9yIGVnLiB0aGlzIGNvdWxkIGJlIHVzZWQgaW4gYSBzY3JpcHRlZCBkZWNpc2lvbiBub2RlIHRvIGJ5LXBhc3MgcGF0Y2hpbmcKLy8gdGhlIHVzZXIgb2JqZWN0IHdpdGggYmxhbmsgdmFsdWVzIHdoZW4gZ2l2ZW5OYW1lICBhbmQgZmFtaWx5TmFtZSBpcyBub3QgcHJlc2VudApib29sZWFuIG5vR2l2ZW5OYW1lID0gbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lLmFzU3RyaW5nKCk/LnRyaW0oKSkKYm9vbGVhbiBub0ZhbWlseU5hbWUgPSBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lLmlzTnVsbCgpIHx8ICghbm9ybWFsaXplZFByb2ZpbGUuZmFtaWx5TmFtZS5hc1N0cmluZygpPy50cmltKCkpCnNoYXJlZFN0YXRlLnB1dCgibmFtZUVtcHR5T3JOdWxsIiwgbm9HaXZlbk5hbWUgJiYgbm9GYW1pbHlOYW1lKQoKcmV0dXJuIG1hbmFnZWRVc2VyCg==\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3313"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.416Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "44e730c22a54944186cc3c6ed74bbce4",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Amazon Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Amazon%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1387,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1387,
            "text": "{\"result\":[{\"_id\":\"6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30\",\"name\":\"Amazon Profile Normalization\",\"description\":\"Normalizes raw profile data from Amazon\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJfaWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUubmFtZSksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1387"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.454Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "87dde1fc4ee8f6186b0031b88d85ca22",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 572,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Select Theme from URL\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Select%20Theme%20from%20URL%22"
        },
        "response": {
          "bodySize": 1677,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1677,
            "text": "{\"result\":[{\"_id\":\"50cde102-d4b6-44c4-9ba7-8564af05ae08\",\"name\":\"Select Theme from URL\",\"description\":\"Select and apply theme from query param in the request URL.\",\"script\":\"LyogU2VsZWN0IFRoZW1lIGZyb20gVVJMCiAqIAogKiBTZWxlY3QgYW5kIGFwcGx5IHRoZW1lIGZyb20gcXVlcnkgcGFyYW0gaW4gdGhlIHJlcXVlc3QgVVJMLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciB0aGVtZSA9ICIiOwogIAlpZiAocmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJ0aGVtZUlkIikpIHsKICAgICAgCXRoZW1lID0gcmVxdWVzdFBhcmFtZXRlcnMuZ2V0KCJ0aGVtZUlkIikuZ2V0KDApOwogICAgfQoKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1677"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.492Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "2c573394d162deb79981a1fd7115f02e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Onfido-CaptureEvidence\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Onfido-CaptureEvidence%22"
        },
        "response": {
          "bodySize": 4807,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4807,
            "text": "{\"result\":[{\"_id\":\"71545db5-ce01-46b1-b79f-d41af36bd548\",\"name\":\"Onfido-CaptureEvidence\",\"description\":\"Capture Evidence\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2FwdHVyZUV2aWRlbmNlOiBTdGFydCIpOwovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICovCnZhciBvbmZpZG9fYXV0aF90b2tlbiA9IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0F1dGhUb2tlbiIpKTsKdmFyIG9uZmlkb19kaWFsb2dfdGl0bGUgPSAiSm9pbiB0aGUgRXhwYW5zZSBmYW1pbHkhIjsKdmFyIG9uZmlkb19kaWFsb2dfbXNnMSA9ICJUbyBvcGVuIGFuIEV4cGFuc2UgYWNjb3VudCwgd2Ugd2lsbCBuZWVkIHRvIHZlcmlmeSB5b3VyIGlkZW50aXR5LiI7CnZhciBvbmZpZG9fZGlhbG9nX21zZzIgPSAiSXQgd2lsbCBvbmx5IHRha2UgYSBjb3VwbGUgb2YgbWludXRlcy4iOwp2YXIgb25maWRvX2NvdW50cnlfY29kZSA9ICJVUyI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCnZhciBtb2JpbGUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKTsKdmFyIHNtc051bWJlciA9ICIiOwppZiAobW9iaWxlICYmIG1vYmlsZS5pdGVyYXRvcigpLmhhc05leHQoKSkgewogICAgc21zTnVtYmVyID0gU3RyaW5nKG1vYmlsZS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKTsKfQoKLy8gSW5qZWN0IE9uZmlkbyBTREsgaW50byBsb2dpbiBwYWdlCm9uZmlkb1NjcmlwdCA9IFN0cmluZygidmFyIGJvZHk9ZG9jdW1lbnQuYm9keTtcbiIgKwogICAgInZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiIgKwogICAgImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxsYmFja3NQYW5lbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4iICsKICAgICJ2YXIgb25maWRvX2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4iICsKICAgICJvbmZpZG9fZGl2LmlkPVwib25maWRvLW1vdW50XCI7XG4iICsKICAgICJzY3JpcHQuc3JjID0gJ2h0dHBzOi8vYXNzZXRzLm9uZmlkby5jb20vd2ViLXNkay1yZWxlYXNlcy81LjIuMS9vbmZpZG8ubWluLmpzJztcbiIgKwogICAgInZhciBoZWFkID0gZG9jdW1lbnQuaGVhZDsgXG4gIiArCiAgICAidmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTsgIFxuIiArCiAgICAiICAgICBsaW5rLnR5cGUgPSBcInRleHQvY3NzXCI7IFxuICIgKwogICAgIiAgICAgbGluay5yZWwgPSBcInN0eWxlc2hlZXRcIjsgXG4gIiArCiAgICAiICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9hc3NldHMub25maWRvLmNvbS93ZWItc2RrLXJlbGVhc2VzLzUuMi4xL3N0eWxlLmNzcyc7IFxuICIgKwogICAgIiAgICBoZWFkLmFwcGVuZENoaWxkKGxpbmspOyBcbiAiICsKICAgICI7XG4iICsKICAgICJ2YXIgb25maWRvID0ge307XG4iICsKICAgICJzY3JpcHQub25sb2FkPWZ1bmN0aW9uKCkge1xuIiArCiAgICAiCW9uZmlkbz1PbmZpZG8uaW5pdCh7XG4iICsKICAgICIgICAgICAgdG9rZW46ICciICsgb25maWRvX2F1dGhfdG9rZW4gKyAiJywgXG4iICsKICAgICIgICAgICAgdXNlTW9kYWw6IHRydWUsIFxuIiArCiAgICAiICAgICAgIGlzTW9kYWxPcGVuOiB0cnVlLCBcbiIgKwogICAgIiAgICAgICBzbXNOdW1iZXJDb3VudHJ5Q29kZTogJyIgKyBvbmZpZG9fY291bnRyeV9jb2RlICsgIicsIFxuIiArCiAgICAiICAgICAgIHVzZXJEZXRhaWxzOiB7IFxuIiArCiAgICAiICAgICAgICAgICBzbXNOdW1iZXI6ICciICsgc21zTnVtYmVyICsgIicgXG4iICsKICAgICIgICAgICAgfSwgXG4iICsKICAgICIgICAgICAgc3RlcHM6IFtcbiIgKwogICAgIiAgICAgICAgICAge1xuIiArCiAgICAiICAgICAgICAgICAgICAgdHlwZTond2VsY29tZScsXG4iICsKICAgICIgICAgICAgICAgICAgICBvcHRpb25zOntcbiIgKwogICAgIiAgICAgICAgICAgICAgICAgICB0aXRsZTonIiArIG9uZmlkb19kaWFsb2dfdGl0bGUgKyAiJyxcbiIgKwogICAgIiAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbnM6W1xuIiArCiAgICAiICAgICAgICAgICAgICAgICAgICAgICAnIiArIG9uZmlkb19kaWFsb2dfbXNnMSArICInLFxuIiArCiAgICAiICAgICAgICAgICAgICAgICAgICAgICAnIiArIG9uZmlkb19kaWFsb2dfbXNnMiArICInLFxuIiArCiAgICAiICAgICAgICAgICAgICAgICAgIF1cbiIgKwogICAgIiAgICAgICAgICAgICAgIH1cbiIgKwogICAgIiAgICAgICAgICB9LFxuIiArCiAgICAiICAgICAgICAgICdkb2N1bWVudCcsXG4iICsKICAgICIgICAgICAgICAgJ2ZhY2UnLFxuIiArCiAgICAiICAgICAgICAgICdjb21wbGV0ZScsXG4iICsKICAgICIgICAgICAgXSxcbiIgKwogICAgIiAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbihkYXRhKXsgY29uc29sZS5sb2coJ0RPTkUnKTsgb25maWRvLnNldE9wdGlvbnMoeyBpc01vZGFsT3BlbjpmYWxzZSB9KTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnV0dG9uXzAnKS5jbGljaygpOyB9IFxuIiArCiAgICAiICAgIH0pXG4iICsKICAgICJ9O1xuIiArCiAgICAiZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuIik7Cgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5OYW1lQ2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKTsKCndpdGggKGZyKSB7CiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGxvZ2dlci5lcnJvcigiT25maWRvLUNhcHR1cmVFdmlkZW5jZTogU2VuZGluZyBjYWxsYmFja3MiKTsKICAgICAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChuZXcgU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKG9uZmlkb1NjcmlwdCkpLmJ1aWxkKCk7CiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5lcnJvcigiT25maWRvLUNhcHR1cmVFdmlkZW5jZTogRW5kIChvdXRjb21lPXRydWUpIik7CiAgICAgICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4807"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.529Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "b2cd4567db14034fab27a770800631bb",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IPQS Email Address\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IPQS%20Email%20Address%22"
        },
        "response": {
          "bodySize": 6284,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6284,
            "text": "{\"result\":[{\"_id\":\"70e8aa07-aa8f-4ec3-b9fb-6f6f8aa14e3c\",\"name\":\"IPQS Email Address\",\"description\":\"Analyze an email address using the IPQualityScore (IPQS) service.\",\"script\":\"LyogSVBRUyBFbWFpbCBBZGRyZXNzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFuYWx5emUgYW4gZW1haWwgYWRkcmVzcyB1c2luZyB0aGUgSVBRdWFsaXR5U2NvcmUgKElQUVMpIHNlcnZpY2UuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHVua25vd24KICogLSB0aW1lZF9vdXQKICogLSBpbnZhbGlkCiAqIC0gdmFsaWRfdW5yZWFjaGFibGUKICogLSB2YWxpZF90ZW1wb3JhcnlfZXJyb3IKICogLSB2YWxpZF9hY2NlcHRzX2FsbAogKiAtIHZhbGlkX3ZlcmlmaWVkCiAqIC0gc3VzcGljaW91cwogKiAtIGZyYXVkdWxlbnQKICovCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiSVBRUyBFbWFpbCBBZGRyZXNzOiBzdGFydCIpOwoKICAgIG91dGNvbWUgPSAidW5rbm93biI7CgogICAgdmFyIGVtYWlsID0gZ2V0RW1haWwoKTsKICAgIGxvZ2dlci5tZXNzYWdlKCJJUFFTIEVtYWlsIEFkZHJlc3M6IG1haWw9Ii5jb25jYXQoZW1haWwpKTsKCiAgICBpZiAoZW1haWwpIHsKCiAgICAgICAgLy8gSVBRUyBBUEkgQ29uZmlndXJhdGlvbgogICAgICAgIHZhciBJUFFTX0FQSV9LRVkgPSBzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5pcHFzLmFwaS5rZXkiKTsKICAgICAgICB2YXIgSVBRU19PUFRJT05TID0gInN0cmljdG5lc3M9MCZ0aW1lb3V0PTEiOwogICAgICAgIHZhciBJUFFTX0FQSV9VUkkgPSAiaHR0cHM6Ly9pcHF1YWxpdHlzY29yZS5jb20vYXBpL2pzb24vZW1haWwvIi5jb25jYXQoSVBRU19BUElfS0VZKS5jb25jYXQoIi8iKS5jb25jYXQoZW1haWwpLmNvbmNhdCgiPyIpLmNvbmNhdChJUFFTX09QVElPTlMpOwoKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgICAgICByZXF1ZXN0LnNldFVyaShJUFFTX0FQSV9VUkkpOwoKICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICAgICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJJUFFTIEVtYWlsIEFkZHJlc3M6IEpTT04gcmVzdWx0OiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeShyZXN1bHQpKSk7CgogICAgICAgIC8vIHByZXNlcnZlIHJlc3VsdCBpbiB0cmFuc2llbnQgc3RhdGUKICAgICAgICB0cmFuc2llbnRTdGF0ZS5wdXQoIklQUVNfRW1haWxfQWRkcmVzcyIsIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgICAgICBpZiAocmVzdWx0LnRpbWVkX291dCkgewogICAgICAgICAgICBvdXRjb21lID0gInRpbWVkX291dCI7CiAgICAgICAgfSAKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSAxMDApIHsKICAgICAgICAgICAgICAgIG91dGNvbWUgPSAiZnJhdWR1bGVudCI7CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSA3NSkgewogICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJzdXNwaWNpb3VzIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN3aXRjaChyZXN1bHQub3ZlcmFsbF9zY29yZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJpbnZhbGlkIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICBvdXRjb21lID0gInZhbGlkX3VucmVhY2hhYmxlIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICBvdXRjb21lID0gInZhbGlkX3RlbXBvcmFyeV9lcnJvciI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJ2YWxpZF9hY2NlcHRzX2FsbCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0Y29tZSA9ICJ2YWxpZF92ZXJpZmllZCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJJUFFTIEVtYWlsIEFkZHJlc3M6IG5vIGVtYWlsIGFkZHJlc3MhIik7CiAgICB9CgogICAgbG9nZ2VyLm1lc3NhZ2UoIk9JUFFTIEVtYWlsIEFkZHJlc3M6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgogICAgLyoKICAgICAqICEhISBBU1NVTUVTIElEIENMT1VEICEhIQogICAgICoKICAgICAqIFJldHVybnMgdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzIGZyb20gc2hhcmVkIHN0YXRlIG9yIHRoZSByZXBvc2l0b3J5LgogICAgICovCiAgICBmdW5jdGlvbiBnZXRFbWFpbCgpIHsKICAgICAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KCJtYWlsIikpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpOwogICAgICAgIH0KICAgICAgICB2YXIgYXR0ciA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgIm1haWwiKTsKICAgICAgICBpZiAoYXR0ciAmJiBhdHRyLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgIHJldHVybiBhdHRyLml0ZXJhdG9yKCkubmV4dCgpLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQogIAogIAoKICAgICAgICAvKiBTYW1wbGUgSVBRUyBSRVNUIEFQSSBSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiU3VjY2Vzcy4iLAogICAgICAgICAgICAic3VjY2VzcyI6IHRydWUsCiAgICAgICAgICAgICJ2YWxpZCI6IHRydWUsCiAgICAgICAgICAgICJkaXNwb3NhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICJzbXRwX3Njb3JlIjogMywKICAgICAgICAgICAgIm92ZXJhbGxfc2NvcmUiOiA0LAogICAgICAgICAgICAiZmlyc3RfbmFtZSI6ICJVbmtub3duIiwKICAgICAgICAgICAgImdlbmVyaWMiOiBmYWxzZSwKICAgICAgICAgICAgImNvbW1vbiI6IHRydWUsCiAgICAgICAgICAgICJkbnNfdmFsaWQiOiB0cnVlLAogICAgICAgICAgICAiaG9uZXlwb3QiOiB0cnVlLAogICAgICAgICAgICAiZGVsaXZlcmFiaWxpdHkiOiAibWVkaXVtIiwKICAgICAgICAgICAgImZyZXF1ZW50X2NvbXBsYWluZXIiOiBmYWxzZSwKICAgICAgICAgICAgInNwYW1fdHJhcF9zY29yZSI6ICJoaWdoIiwKICAgICAgICAgICAgImNhdGNoX2FsbCI6IGZhbHNlLAogICAgICAgICAgICAidGltZWRfb3V0IjogZmFsc2UsCiAgICAgICAgICAgICJzdXNwZWN0IjogZmFsc2UsCiAgICAgICAgICAgICJyZWNlbnRfYWJ1c2UiOiBmYWxzZSwKICAgICAgICAgICAgImZyYXVkX3Njb3JlIjogNzAsCiAgICAgICAgICAgICJzdWdnZXN0ZWRfZG9tYWluIjogIk5cL0EiLAogICAgICAgICAgICAibGVha2VkIjogdHJ1ZSwKICAgICAgICAgICAgImRvbWFpbl9hZ2UiOiB7CiAgICAgICAgICAgICAgICAiaHVtYW4iOiAiMjYgeWVhcnMgYWdvIiwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiA4MDgyODY0MDAsCiAgICAgICAgICAgICAgICAiaXNvIjogIjE5OTUtMDgtMTNUMDA6MDA6MDAtMDQ6MDAiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmaXJzdF9zZWVuIjogewogICAgICAgICAgICAgICAgImh1bWFuIjogIjQgeWVhcnMgYWdvIiwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiAxNDgzMjUwNDYxLAogICAgICAgICAgICAgICAgImlzbyI6ICIyMDE3LTAxLTAxVDAxOjAxOjAxLTA1OjAwIgogICAgICAgICAgICB9LAogICAgICAgICAgICAic2FuaXRpemVkX2VtYWlsIjogInZzY2hldWJlckBnbWFpbC5jb20iLAogICAgICAgICAgICAicmVxdWVzdF9pZCI6ICI0dVRPUUd3ZmRGVzNiciIKICAgICAgICB9CiAgICAqLwp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6284"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.569Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "97e365ada37a9af61562e96f36b8cb1a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"OIDC Claims Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22OIDC%20Claims%20Script%22"
        },
        "response": {
          "bodySize": 41525,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 41525,
            "text": "{\"result\":[{\"_id\":\"36863ffb-40ec-48b9-94b1-9a99f71cc3b5\",\"name\":\"OIDC Claims Script\",\"description\":\"Default global script for OIDC claims\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.608Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "a01c7aff11fe167893eef8a0a499d040",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 599,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect Replay Password (frUnindexedString2)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20Replay%20Password%20%28frUnindexedString2%29%22"
        },
        "response": {
          "bodySize": 47674,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 47674,
            "text": "{\"result\":[{\"_id\":\"d82a4ad6-cd8a-437b-af55-7373e50d685b\",\"name\":\"Collect Replay Password (frUnindexedString2)\",\"description\":\"Collect Replay Password (frUnindexedString2).\",\"script\":\"LyogQ29sbGVjdCBBbmQgRW5jcnlwdCBDdXN0b20gUGFzc3dvcmQKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBTZWUgY29weXJpZ2h0IG5vdGljZXMsIGNvbmRpdGlvbnMsIGFuZCBkaXNjbGFpbWVycyBhdCB0aGUgYm90dG9tIG9mIHRoaXMgc2NyaXB0LgogKiAKICogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CgkidXNlIHN0cmljdCI7dmFyIHNqY2w9e2NpcGhlcjp7fSxoYXNoOnt9LGtleWV4Y2hhbmdlOnt9LG1vZGU6e30sbWlzYzp7fSxjb2RlYzp7fSxleGNlcHRpb246e2NvcnJ1cHQ6ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJDT1JSVVBUOiAiK3RoaXMubWVzc2FnZX07dGhpcy5tZXNzYWdlPW1lc3NhZ2V9LGludmFsaWQ6ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJJTlZBTElEOiAiK3RoaXMubWVzc2FnZX07dGhpcy5tZXNzYWdlPW1lc3NhZ2V9LGJ1ZzpmdW5jdGlvbihtZXNzYWdlKXt0aGlzLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIkJVRzogIit0aGlzLm1lc3NhZ2V9O3RoaXMubWVzc2FnZT1tZXNzYWdlfSxub3RSZWFkeTpmdW5jdGlvbihtZXNzYWdlKXt0aGlzLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIk5PVCBSRUFEWTogIit0aGlzLm1lc3NhZ2V9O3RoaXMubWVzc2FnZT1tZXNzYWdlfX19O3NqY2wuY2lwaGVyLmFlcz1mdW5jdGlvbihrZXkpe2lmKCF0aGlzLl90YWJsZXNbMF1bMF1bMF0pe3RoaXMuX3ByZWNvbXB1dGUoKX12YXIgaSxqLHRtcCxlbmNLZXksZGVjS2V5LHNib3g9dGhpcy5fdGFibGVzWzBdWzRdLGRlY1RhYmxlPXRoaXMuX3RhYmxlc1sxXSxrZXlMZW49a2V5Lmxlbmd0aCxyY29uPTE7aWYoa2V5TGVuIT09NCYma2V5TGVuIT09NiYma2V5TGVuIT09OCl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImludmFsaWQgYWVzIGtleSBzaXplIil9dGhpcy5fa2V5PVtlbmNLZXk9a2V5LnNsaWNlKDApLGRlY0tleT1bXV07Zm9yKGk9a2V5TGVuO2k8NCprZXlMZW4rMjg7aSsrKXt0bXA9ZW5jS2V5W2ktMV07aWYoaSVrZXlMZW49PT0wfHxrZXlMZW49PT04JiZpJWtleUxlbj09PTQpe3RtcD1zYm94W3RtcD4+PjI0XTw8MjRec2JveFt0bXA+PjE2JjI1NV08PDE2XnNib3hbdG1wPj44JjI1NV08PDhec2JveFt0bXAmMjU1XTtpZihpJWtleUxlbj09PTApe3RtcD10bXA8PDhedG1wPj4+MjRecmNvbjw8MjQ7cmNvbj1yY29uPDwxXihyY29uPj43KSoyODN9fWVuY0tleVtpXT1lbmNLZXlbaS1rZXlMZW5dXnRtcH1mb3Ioaj0wO2k7aisrLGktLSl7dG1wPWVuY0tleVtqJjM/aTppLTRdO2lmKGk8PTR8fGo8NCl7ZGVjS2V5W2pdPXRtcH1lbHNle2RlY0tleVtqXT1kZWNUYWJsZVswXVtzYm94W3RtcD4+PjI0XV1eZGVjVGFibGVbMV1bc2JveFt0bXA+PjE2JjI1NV1dXmRlY1RhYmxlWzJdW3Nib3hbdG1wPj44JjI1NV1dXmRlY1RhYmxlWzNdW3Nib3hbdG1wJjI1NV1dfX19O3NqY2wuY2lwaGVyLmFlcy5wcm90b3R5cGU9e2VuY3J5cHQ6ZnVuY3Rpb24oZGF0YSl7cmV0dXJuIHRoaXMuX2NyeXB0KGRhdGEsMCl9LGRlY3J5cHQ6ZnVuY3Rpb24oZGF0YSl7cmV0dXJuIHRoaXMuX2NyeXB0KGRhdGEsMSl9LF90YWJsZXM6W1tbXSxbXSxbXSxbXSxbXV0sW1tdLFtdLFtdLFtdLFtdXV0sX3ByZWNvbXB1dGU6ZnVuY3Rpb24oKXt2YXIgZW5jVGFibGU9dGhpcy5fdGFibGVzWzBdLGRlY1RhYmxlPXRoaXMuX3RhYmxlc1sxXSxzYm94PWVuY1RhYmxlWzRdLHNib3hJbnY9ZGVjVGFibGVbNF0saSx4LHhJbnYsZD1bXSx0aD1bXSx4Mix4NCx4OCxzLHRFbmMsdERlYztmb3IoaT0wO2k8MjU2O2krKyl7dGhbKGRbaV09aTw8MV4oaT4+NykqMjgzKV5pXT1pfWZvcih4PXhJbnY9MDshc2JveFt4XTt4Xj14Mnx8MSx4SW52PXRoW3hJbnZdfHwxKXtzPXhJbnZeeEludjw8MV54SW52PDwyXnhJbnY8PDNeeEludjw8NDtzPXM+PjhecyYyNTVeOTk7c2JveFt4XT1zO3Nib3hJbnZbc109eDt4OD1kW3g0PWRbeDI9ZFt4XV1dO3REZWM9eDgqMTY4NDMwMDleeDQqNjU1MzdeeDIqMjU3XngqMTY4NDMwMDg7dEVuYz1kW3NdKjI1N15zKjE2ODQzMDA4O2ZvcihpPTA7aTw0O2krKyl7ZW5jVGFibGVbaV1beF09dEVuYz10RW5jPDwyNF50RW5jPj4+ODtkZWNUYWJsZVtpXVtzXT10RGVjPXREZWM8PDI0XnREZWM+Pj44fX1mb3IoaT0wO2k8NTtpKyspe2VuY1RhYmxlW2ldPWVuY1RhYmxlW2ldLnNsaWNlKDApO2RlY1RhYmxlW2ldPWRlY1RhYmxlW2ldLnNsaWNlKDApfX0sX2NyeXB0OmZ1bmN0aW9uKGlucHV0LGRpcil7aWYoaW5wdXQubGVuZ3RoIT09NCl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImludmFsaWQgYWVzIGJsb2NrIHNpemUiKX12YXIga2V5PXRoaXMuX2tleVtkaXJdLGE9aW5wdXRbMF1ea2V5WzBdLGI9aW5wdXRbZGlyPzM6MV1ea2V5WzFdLGM9aW5wdXRbMl1ea2V5WzJdLGQ9aW5wdXRbZGlyPzE6M11ea2V5WzNdLGEyLGIyLGMyLG5Jbm5lclJvdW5kcz1rZXkubGVuZ3RoLzQtMixpLGtJbmRleD00LG91dD1bMCwwLDAsMF0sdGFibGU9dGhpcy5fdGFibGVzW2Rpcl0sdDA9dGFibGVbMF0sdDE9dGFibGVbMV0sdDI9dGFibGVbMl0sdDM9dGFibGVbM10sc2JveD10YWJsZVs0XTtmb3IoaT0wO2k8bklubmVyUm91bmRzO2krKyl7YTI9dDBbYT4+PjI0XV50MVtiPj4xNiYyNTVdXnQyW2M+PjgmMjU1XV50M1tkJjI1NV1ea2V5W2tJbmRleF07YjI9dDBbYj4+PjI0XV50MVtjPj4xNiYyNTVdXnQyW2Q+PjgmMjU1XV50M1thJjI1NV1ea2V5W2tJbmRleCsxXTtjMj10MFtjPj4+MjRdXnQxW2Q+PjE2JjI1NV1edDJbYT4+OCYyNTVdXnQzW2ImMjU1XV5rZXlba0luZGV4KzJdO2Q9dDBbZD4+PjI0XV50MVthPj4xNiYyNTVdXnQyW2I+PjgmMjU1XV50M1tjJjI1NV1ea2V5W2tJbmRleCszXTtrSW5kZXgrPTQ7YT1hMjtiPWIyO2M9YzJ9Zm9yKGk9MDtpPDQ7aSsrKXtvdXRbZGlyPzMmLWk6aV09c2JveFthPj4+MjRdPDwyNF5zYm94W2I+PjE2JjI1NV08PDE2XnNib3hbYz4+OCYyNTVdPDw4XnNib3hbZCYyNTVdXmtleVtrSW5kZXgrK107YTI9YTthPWI7Yj1jO2M9ZDtkPWEyfXJldHVybiBvdXR9fTtzamNsLmJpdEFycmF5PXtiaXRTbGljZTpmdW5jdGlvbihhLGJzdGFydCxiZW5kKXthPXNqY2wuYml0QXJyYXkuX3NoaWZ0UmlnaHQoYS5zbGljZShic3RhcnQvMzIpLDMyLShic3RhcnQmMzEpKS5zbGljZSgxKTtyZXR1cm4gYmVuZD09PXVuZGVmaW5lZD9hOnNqY2wuYml0QXJyYXkuY2xhbXAoYSxiZW5kLWJzdGFydCl9LGV4dHJhY3Q6ZnVuY3Rpb24oYSxic3RhcnQsYmxlbmd0aCl7dmFyIHgsc2g9TWF0aC5mbG9vcigtYnN0YXJ0LWJsZW5ndGgmMzEpO2lmKChic3RhcnQrYmxlbmd0aC0xXmJzdGFydCkmLTMyKXt4PWFbYnN0YXJ0LzMyfDBdPDwzMi1zaF5hW2JzdGFydC8zMisxfDBdPj4+c2h9ZWxzZXt4PWFbYnN0YXJ0LzMyfDBdPj4+c2h9cmV0dXJuIHgmKDE8PGJsZW5ndGgpLTF9LGNvbmNhdDpmdW5jdGlvbihhMSxhMil7aWYoYTEubGVuZ3RoPT09MHx8YTIubGVuZ3RoPT09MCl7cmV0dXJuIGExLmNvbmNhdChhMil9dmFyIGxhc3Q9YTFbYTEubGVuZ3RoLTFdLHNoaWZ0PXNqY2wuYml0QXJyYXkuZ2V0UGFydGlhbChsYXN0KTtpZihzaGlmdD09PTMyKXtyZXR1cm4gYTEuY29uY2F0KGEyKX1lbHNle3JldHVybiBzamNsLmJpdEFycmF5Ll9zaGlmdFJpZ2h0KGEyLHNoaWZ0LGxhc3R8MCxhMS5zbGljZSgwLGExLmxlbmd0aC0xKSl9fSxiaXRMZW5ndGg6ZnVuY3Rpb24oYSl7dmFyIGw9YS5sZW5ndGgseDtpZihsPT09MCl7cmV0dXJuIDB9eD1hW2wtMV07cmV0dXJuKGwtMSkqMzIrc2pjbC5iaXRBcnJheS5nZXRQYXJ0aWFsKHgpfSxjbGFtcDpmdW5jdGlvbihhLGxlbil7aWYoYS5sZW5ndGgqMzI8bGVuKXtyZXR1cm4gYX1hPWEuc2xpY2UoMCxNYXRoLmNlaWwobGVuLzMyKSk7dmFyIGw9YS5sZW5ndGg7bGVuPWxlbiYzMTtpZihsPjAmJmxlbil7YVtsLTFdPXNqY2wuYml0QXJyYXkucGFydGlhbChsZW4sYVtsLTFdJjIxNDc0ODM2NDg+Pmxlbi0xLDEpfXJldHVybiBhfSxwYXJ0aWFsOmZ1bmN0aW9uKGxlbix4LF9lbmQpe2lmKGxlbj09PTMyKXtyZXR1cm4geH1yZXR1cm4oX2VuZD94fDA6eDw8MzItbGVuKStsZW4qMTA5OTUxMTYyNzc3Nn0sZ2V0UGFydGlhbDpmdW5jdGlvbih4KXtyZXR1cm4gTWF0aC5yb3VuZCh4LzEwOTk1MTE2Mjc3NzYpfHwzMn0sZXF1YWw6ZnVuY3Rpb24oYSxiKXtpZihzamNsLmJpdEFycmF5LmJpdExlbmd0aChhKSE9PXNqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGIpKXtyZXR1cm4gZmFsc2V9dmFyIHg9MCxpO2ZvcihpPTA7aTxhLmxlbmd0aDtpKyspe3h8PWFbaV1eYltpXX1yZXR1cm4geD09PTB9LF9zaGlmdFJpZ2h0OmZ1bmN0aW9uKGEsc2hpZnQsY2Fycnksb3V0KXt2YXIgaSxsYXN0Mj0wLHNoaWZ0MjtpZihvdXQ9PT11bmRlZmluZWQpe291dD1bXX1mb3IoO3NoaWZ0Pj0zMjtzaGlmdC09MzIpe291dC5wdXNoKGNhcnJ5KTtjYXJyeT0wfWlmKHNoaWZ0PT09MCl7cmV0dXJuIG91dC5jb25jYXQoYSl9Zm9yKGk9MDtpPGEubGVuZ3RoO2krKyl7b3V0LnB1c2goY2Fycnl8YVtpXT4+PnNoaWZ0KTtjYXJyeT1hW2ldPDwzMi1zaGlmdH1sYXN0Mj1hLmxlbmd0aD9hW2EubGVuZ3RoLTFdOjA7c2hpZnQyPXNqY2wuYml0QXJyYXkuZ2V0UGFydGlhbChsYXN0Mik7b3V0LnB1c2goc2pjbC5iaXRBcnJheS5wYXJ0aWFsKHNoaWZ0K3NoaWZ0MiYzMSxzaGlmdCtzaGlmdDI+MzI/Y2Fycnk6b3V0LnBvcCgpLDEpKTtyZXR1cm4gb3V0fSxfeG9yNDpmdW5jdGlvbih4LHkpe3JldHVyblt4WzBdXnlbMF0seFsxXV55WzFdLHhbMl1eeVsyXSx4WzNdXnlbM11dfSxieXRlc3dhcE06ZnVuY3Rpb24oYSl7dmFyIGksdixtPTY1MjgwO2ZvcihpPTA7aTxhLmxlbmd0aDsrK2kpe3Y9YVtpXTthW2ldPXY+Pj4yNHx2Pj4+OCZtfCh2Jm0pPDw4fHY8PDI0fXJldHVybiBhfX07c2pjbC5jb2RlYy51dGY4U3RyaW5nPXtmcm9tQml0czpmdW5jdGlvbihhcnIpe3ZhciBvdXQ9IiIsYmw9c2pjbC5iaXRBcnJheS5iaXRMZW5ndGgoYXJyKSxpLHRtcDtmb3IoaT0wO2k8YmwvODtpKyspe2lmKChpJjMpPT09MCl7dG1wPWFycltpLzRdfW91dCs9U3RyaW5nLmZyb21DaGFyQ29kZSh0bXA+Pj44Pj4+OD4+PjgpO3RtcDw8PTh9cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUob3V0KSl9LHRvQml0czpmdW5jdGlvbihzdHIpe3N0cj11bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSk7dmFyIG91dD1bXSxpLHRtcD0wO2ZvcihpPTA7aTxzdHIubGVuZ3RoO2krKyl7dG1wPXRtcDw8OHxzdHIuY2hhckNvZGVBdChpKTtpZigoaSYzKT09PTMpe291dC5wdXNoKHRtcCk7dG1wPTB9fWlmKGkmMyl7b3V0LnB1c2goc2pjbC5iaXRBcnJheS5wYXJ0aWFsKDgqKGkmMyksdG1wKSl9cmV0dXJuIG91dH19O3NqY2wuY29kZWMuYmFzZTY0PXtfY2hhcnM6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLGZyb21CaXRzOmZ1bmN0aW9uKGFycixfbm9FcXVhbHMsX3VybCl7dmFyIG91dD0iIixpLGJpdHM9MCxjPXNqY2wuY29kZWMuYmFzZTY0Ll9jaGFycyx0YT0wLGJsPXNqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGFycik7aWYoX3VybCl7Yz1jLnN1YnN0cigwLDYyKSsiLV8ifWZvcihpPTA7b3V0Lmxlbmd0aCo2PGJsOyl7b3V0Kz1jLmNoYXJBdCgodGFeYXJyW2ldPj4+Yml0cyk+Pj4yNik7aWYoYml0czw2KXt0YT1hcnJbaV08PDYtYml0cztiaXRzKz0yNjtpKyt9ZWxzZXt0YTw8PTY7Yml0cy09Nn19d2hpbGUob3V0Lmxlbmd0aCYzJiYhX25vRXF1YWxzKXtvdXQrPSI9In1yZXR1cm4gb3V0fSx0b0JpdHM6ZnVuY3Rpb24oc3RyLF91cmwpe3N0cj1zdHIucmVwbGFjZSgvXHN8PS9nLCIiKTt2YXIgb3V0PVtdLGksYml0cz0wLGM9c2pjbC5jb2RlYy5iYXNlNjQuX2NoYXJzLHRhPTAseDtpZihfdXJsKXtjPWMuc3Vic3RyKDAsNjIpKyItXyJ9Zm9yKGk9MDtpPHN0ci5sZW5ndGg7aSsrKXt4PWMuaW5kZXhPZihzdHIuY2hhckF0KGkpKTtpZih4PDApe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJ0aGlzIGlzbid0IGJhc2U2NCEiKX1pZihiaXRzPjI2KXtiaXRzLT0yNjtvdXQucHVzaCh0YV54Pj4+Yml0cyk7dGE9eDw8MzItYml0c31lbHNle2JpdHMrPTY7dGFePXg8PDMyLWJpdHN9fWlmKGJpdHMmNTYpe291dC5wdXNoKHNqY2wuYml0QXJyYXkucGFydGlhbChiaXRzJjU2LHRhLDEpKX1yZXR1cm4gb3V0fX07c2pjbC5jb2RlYy5iYXNlNjR1cmw9e2Zyb21CaXRzOmZ1bmN0aW9uKGFycil7cmV0dXJuIHNqY2wuY29kZWMuYmFzZTY0LmZyb21CaXRzKGFyciwxLDEpfSx0b0JpdHM6ZnVuY3Rpb24oc3RyKXtyZXR1cm4gc2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHN0ciwxKX19O3NqY2wuaGFzaC5zaGEyNTY9ZnVuY3Rpb24oaGFzaCl7aWYoIXRoaXMuX2tleVswXSl7dGhpcy5fcHJlY29tcHV0ZSgpfWlmKGhhc2gpe3RoaXMuX2g9aGFzaC5faC5zbGljZSgwKTt0aGlzLl9idWZmZXI9aGFzaC5fYnVmZmVyLnNsaWNlKDApO3RoaXMuX2xlbmd0aD1oYXNoLl9sZW5ndGh9ZWxzZXt0aGlzLnJlc2V0KCl9fTtzamNsLmhhc2guc2hhMjU2Lmhhc2g9ZnVuY3Rpb24oZGF0YSl7cmV0dXJuKG5ldyBzamNsLmhhc2guc2hhMjU2KS51cGRhdGUoZGF0YSkuZmluYWxpemUoKX07c2pjbC5oYXNoLnNoYTI1Ni5wcm90b3R5cGU9e2Jsb2NrU2l6ZTo1MTIscmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oPXRoaXMuX2luaXQuc2xpY2UoMCk7dGhpcy5fYnVmZmVyPVtdO3RoaXMuX2xlbmd0aD0wO3JldHVybiB0aGlzfSx1cGRhdGU6ZnVuY3Rpb24oZGF0YSl7aWYodHlwZW9mIGRhdGE9PT0ic3RyaW5nIil7ZGF0YT1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKGRhdGEpfXZhciBpLGI9dGhpcy5fYnVmZmVyPXNqY2wuYml0QXJyYXkuY29uY2F0KHRoaXMuX2J1ZmZlcixkYXRhKSxvbD10aGlzLl9sZW5ndGgsbmw9dGhpcy5fbGVuZ3RoPW9sK3NqY2wuYml0QXJyYXkuYml0TGVuZ3RoKGRhdGEpO2lmKG5sPjkwMDcxOTkyNTQ3NDA5OTEpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJDYW5ub3QgaGFzaCBtb3JlIHRoYW4gMl41MyAtIDEgYml0cyIpfWlmKHR5cGVvZiBVaW50MzJBcnJheSE9PSJ1bmRlZmluZWQiKXt2YXIgYz1uZXcgVWludDMyQXJyYXkoYik7dmFyIGo9MDtmb3IoaT01MTIrb2wtKDUxMitvbCY1MTEpO2k8PW5sO2krPTUxMil7dGhpcy5fYmxvY2soYy5zdWJhcnJheSgxNipqLDE2KihqKzEpKSk7ais9MX1iLnNwbGljZSgwLDE2KmopfWVsc2V7Zm9yKGk9NTEyK29sLSg1MTIrb2wmNTExKTtpPD1ubDtpKz01MTIpe3RoaXMuX2Jsb2NrKGIuc3BsaWNlKDAsMTYpKX19cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGksYj10aGlzLl9idWZmZXIsaD10aGlzLl9oO2I9c2pjbC5iaXRBcnJheS5jb25jYXQoYixbc2pjbC5iaXRBcnJheS5wYXJ0aWFsKDEsMSldKTtmb3IoaT1iLmxlbmd0aCsyO2kmMTU7aSsrKXtiLnB1c2goMCl9Yi5wdXNoKE1hdGguZmxvb3IodGhpcy5fbGVuZ3RoLzQyOTQ5NjcyOTYpKTtiLnB1c2godGhpcy5fbGVuZ3RofDApO3doaWxlKGIubGVuZ3RoKXt0aGlzLl9ibG9jayhiLnNwbGljZSgwLDE2KSl9dGhpcy5yZXNldCgpO3JldHVybiBofSxfaW5pdDpbXSxfa2V5OltdLF9wcmVjb21wdXRlOmZ1bmN0aW9uKCl7dmFyIGk9MCxwcmltZT0yLGZhY3Rvcixpc1ByaW1lO2Z1bmN0aW9uIGZyYWMoeCl7cmV0dXJuKHgtTWF0aC5mbG9vcih4KSkqNDI5NDk2NzI5NnwwfWZvcig7aTw2NDtwcmltZSsrKXtpc1ByaW1lPXRydWU7Zm9yKGZhY3Rvcj0yO2ZhY3RvcipmYWN0b3I8PXByaW1lO2ZhY3RvcisrKXtpZihwcmltZSVmYWN0b3I9PT0wKXtpc1ByaW1lPWZhbHNlO2JyZWFrfX1pZihpc1ByaW1lKXtpZihpPDgpe3RoaXMuX2luaXRbaV09ZnJhYyhNYXRoLnBvdyhwcmltZSwxLzIpKX10aGlzLl9rZXlbaV09ZnJhYyhNYXRoLnBvdyhwcmltZSwxLzMpKTtpKyt9fX0sX2Jsb2NrOmZ1bmN0aW9uKHcpe3ZhciBpLHRtcCxhLGIsaD10aGlzLl9oLGs9dGhpcy5fa2V5LGgwPWhbMF0saDE9aFsxXSxoMj1oWzJdLGgzPWhbM10saDQ9aFs0XSxoNT1oWzVdLGg2PWhbNl0saDc9aFs3XTtmb3IoaT0wO2k8NjQ7aSsrKXtpZihpPDE2KXt0bXA9d1tpXX1lbHNle2E9d1tpKzEmMTVdO2I9d1tpKzE0JjE1XTt0bXA9d1tpJjE1XT0oYT4+PjdeYT4+PjE4XmE+Pj4zXmE8PDI1XmE8PDE0KSsoYj4+PjE3XmI+Pj4xOV5iPj4+MTBeYjw8MTVeYjw8MTMpK3dbaSYxNV0rd1tpKzkmMTVdfDB9dG1wPXRtcCtoNysoaDQ+Pj42Xmg0Pj4+MTFeaDQ+Pj4yNV5oNDw8MjZeaDQ8PDIxXmg0PDw3KSsoaDZeaDQmKGg1Xmg2KSkra1tpXTtoNz1oNjtoNj1oNTtoNT1oNDtoND1oMyt0bXB8MDtoMz1oMjtoMj1oMTtoMT1oMDtoMD10bXArKGgxJmgyXmgzJihoMV5oMikpKyhoMT4+PjJeaDE+Pj4xM15oMT4+PjIyXmgxPDwzMF5oMTw8MTleaDE8PDEwKXwwfWhbMF09aFswXStoMHwwO2hbMV09aFsxXStoMXwwO2hbMl09aFsyXStoMnwwO2hbM109aFszXStoM3wwO2hbNF09aFs0XStoNHwwO2hbNV09aFs1XStoNXwwO2hbNl09aFs2XStoNnwwO2hbN109aFs3XStoN3wwfX07c2pjbC5tb2RlLmNjbT17bmFtZToiY2NtIixfcHJvZ3Jlc3NMaXN0ZW5lcnM6W10sbGlzdGVuUHJvZ3Jlc3M6ZnVuY3Rpb24oY2Ipe3NqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnB1c2goY2IpfSx1bkxpc3RlblByb2dyZXNzOmZ1bmN0aW9uKGNiKXt2YXIgaW5kZXg9c2pjbC5tb2RlLmNjbS5fcHJvZ3Jlc3NMaXN0ZW5lcnMuaW5kZXhPZihjYik7aWYoaW5kZXg+LTEpe3NqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnNwbGljZShpbmRleCwxKX19LF9jYWxsUHJvZ3Jlc3NMaXN0ZW5lcjpmdW5jdGlvbih2YWwpe3ZhciBwPXNqY2wubW9kZS5jY20uX3Byb2dyZXNzTGlzdGVuZXJzLnNsaWNlKCksaTtmb3IoaT0wO2k8cC5sZW5ndGg7aSs9MSl7cFtpXSh2YWwpfX0sZW5jcnlwdDpmdW5jdGlvbihwcmYscGxhaW50ZXh0LGl2LGFkYXRhLHRsZW4pe3ZhciBMLG91dD1wbGFpbnRleHQuc2xpY2UoMCksdGFnLHc9c2pjbC5iaXRBcnJheSxpdmw9dy5iaXRMZW5ndGgoaXYpLzgsb2w9dy5iaXRMZW5ndGgob3V0KS84O3RsZW49dGxlbnx8NjQ7YWRhdGE9YWRhdGF8fFtdO2lmKGl2bDw3KXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiY2NtOiBpdiBtdXN0IGJlIGF0IGxlYXN0IDcgYnl0ZXMiKX1mb3IoTD0yO0w8NCYmb2w+Pj44Kkw7TCsrKXt9aWYoTDwxNS1pdmwpe0w9MTUtaXZsfWl2PXcuY2xhbXAoaXYsOCooMTUtTCkpO3RhZz1zamNsLm1vZGUuY2NtLl9jb21wdXRlVGFnKHByZixwbGFpbnRleHQsaXYsYWRhdGEsdGxlbixMKTtvdXQ9c2pjbC5tb2RlLmNjbS5fY3RyTW9kZShwcmYsb3V0LGl2LHRhZyx0bGVuLEwpO3JldHVybiB3LmNvbmNhdChvdXQuZGF0YSxvdXQudGFnKX0sZGVjcnlwdDpmdW5jdGlvbihwcmYsY2lwaGVydGV4dCxpdixhZGF0YSx0bGVuKXt0bGVuPXRsZW58fDY0O2FkYXRhPWFkYXRhfHxbXTt2YXIgTCx3PXNqY2wuYml0QXJyYXksaXZsPXcuYml0TGVuZ3RoKGl2KS84LG9sPXcuYml0TGVuZ3RoKGNpcGhlcnRleHQpLG91dD13LmNsYW1wKGNpcGhlcnRleHQsb2wtdGxlbiksdGFnPXcuYml0U2xpY2UoY2lwaGVydGV4dCxvbC10bGVuKSx0YWcyO29sPShvbC10bGVuKS84O2lmKGl2bDw3KXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiY2NtOiBpdiBtdXN0IGJlIGF0IGxlYXN0IDcgYnl0ZXMiKX1mb3IoTD0yO0w8NCYmb2w+Pj44Kkw7TCsrKXt9aWYoTDwxNS1pdmwpe0w9MTUtaXZsfWl2PXcuY2xhbXAoaXYsOCooMTUtTCkpO291dD1zamNsLm1vZGUuY2NtLl9jdHJNb2RlKHByZixvdXQsaXYsdGFnLHRsZW4sTCk7dGFnMj1zamNsLm1vZGUuY2NtLl9jb21wdXRlVGFnKHByZixvdXQuZGF0YSxpdixhZGF0YSx0bGVuLEwpO2lmKCF3LmVxdWFsKG91dC50YWcsdGFnMikpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5jb3JydXB0KCJjY206IHRhZyBkb2Vzbid0IG1hdGNoIil9cmV0dXJuIG91dC5kYXRhfSxfbWFjQWRkaXRpb25hbERhdGE6ZnVuY3Rpb24ocHJmLGFkYXRhLGl2LHRsZW4sb2wsTCl7dmFyIG1hYyx0bXAsaSxtYWNEYXRhPVtdLHc9c2pjbC5iaXRBcnJheSx4b3I9dy5feG9yNDttYWM9W3cucGFydGlhbCg4LChhZGF0YS5sZW5ndGg/MTw8NjowKXx0bGVuLTI8PDJ8TC0xKV07bWFjPXcuY29uY2F0KG1hYyxpdik7bWFjWzNdfD1vbDttYWM9cHJmLmVuY3J5cHQobWFjKTtpZihhZGF0YS5sZW5ndGgpe3RtcD13LmJpdExlbmd0aChhZGF0YSkvODtpZih0bXA8PTY1Mjc5KXttYWNEYXRhPVt3LnBhcnRpYWwoMTYsdG1wKV19ZWxzZSBpZih0bXA8PTQyOTQ5NjcyOTUpe21hY0RhdGE9dy5jb25jYXQoW3cucGFydGlhbCgxNiw2NTUzNCldLFt0bXBdKX1tYWNEYXRhPXcuY29uY2F0KG1hY0RhdGEsYWRhdGEpO2ZvcihpPTA7aTxtYWNEYXRhLmxlbmd0aDtpKz00KXttYWM9cHJmLmVuY3J5cHQoeG9yKG1hYyxtYWNEYXRhLnNsaWNlKGksaSs0KS5jb25jYXQoWzAsMCwwXSkpKX19cmV0dXJuIG1hY30sX2NvbXB1dGVUYWc6ZnVuY3Rpb24ocHJmLHBsYWludGV4dCxpdixhZGF0YSx0bGVuLEwpe3ZhciBtYWMsaSx3PXNqY2wuYml0QXJyYXkseG9yPXcuX3hvcjQ7dGxlbi89ODtpZih0bGVuJTJ8fHRsZW48NHx8dGxlbj4xNil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoImNjbTogaW52YWxpZCB0YWcgbGVuZ3RoIil9aWYoYWRhdGEubGVuZ3RoPjQyOTQ5NjcyOTV8fHBsYWludGV4dC5sZW5ndGg+NDI5NDk2NzI5NSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygiY2NtOiBjYW4ndCBkZWFsIHdpdGggNEdpQiBvciBtb3JlIGRhdGEiKX1tYWM9c2pjbC5tb2RlLmNjbS5fbWFjQWRkaXRpb25hbERhdGEocHJmLGFkYXRhLGl2LHRsZW4sdy5iaXRMZW5ndGgocGxhaW50ZXh0KS84LEwpO2ZvcihpPTA7aTxwbGFpbnRleHQubGVuZ3RoO2krPTQpe21hYz1wcmYuZW5jcnlwdCh4b3IobWFjLHBsYWludGV4dC5zbGljZShpLGkrNCkuY29uY2F0KFswLDAsMF0pKSl9cmV0dXJuIHcuY2xhbXAobWFjLHRsZW4qOCl9LF9jdHJNb2RlOmZ1bmN0aW9uKHByZixkYXRhLGl2LHRhZyx0bGVuLEwpe3ZhciBlbmMsaSx3PXNqY2wuYml0QXJyYXkseG9yPXcuX3hvcjQsY3RyLGw9ZGF0YS5sZW5ndGgsYmw9dy5iaXRMZW5ndGgoZGF0YSksbj1sLzUwLHA9bjtjdHI9dy5jb25jYXQoW3cucGFydGlhbCg4LEwtMSldLGl2KS5jb25jYXQoWzAsMCwwXSkuc2xpY2UoMCw0KTt0YWc9dy5iaXRTbGljZSh4b3IodGFnLHByZi5lbmNyeXB0KGN0cikpLDAsdGxlbik7aWYoIWwpe3JldHVybnt0YWc6dGFnLGRhdGE6W119fWZvcihpPTA7aTxsO2krPTQpe2lmKGk+bil7c2pjbC5tb2RlLmNjbS5fY2FsbFByb2dyZXNzTGlzdGVuZXIoaS9sKTtuKz1wfWN0clszXSsrO2VuYz1wcmYuZW5jcnlwdChjdHIpO2RhdGFbaV1ePWVuY1swXTtkYXRhW2krMV1ePWVuY1sxXTtkYXRhW2krMl1ePWVuY1syXTtkYXRhW2krM11ePWVuY1szXX1yZXR1cm57dGFnOnRhZyxkYXRhOncuY2xhbXAoZGF0YSxibCl9fX07c2pjbC5taXNjLmhtYWM9ZnVuY3Rpb24oa2V5LEhhc2gpe3RoaXMuX2hhc2g9SGFzaD1IYXNofHxzamNsLmhhc2guc2hhMjU2O3ZhciBleEtleT1bW10sW11dLGksYnM9SGFzaC5wcm90b3R5cGUuYmxvY2tTaXplLzMyO3RoaXMuX2Jhc2VIYXNoPVtuZXcgSGFzaCxuZXcgSGFzaF07aWYoa2V5Lmxlbmd0aD5icyl7a2V5PUhhc2guaGFzaChrZXkpfWZvcihpPTA7aTxicztpKyspe2V4S2V5WzBdW2ldPWtleVtpXV45MDk1MjI0ODY7ZXhLZXlbMV1baV09a2V5W2ldXjE1NDk1NTY4Mjh9dGhpcy5fYmFzZUhhc2hbMF0udXBkYXRlKGV4S2V5WzBdKTt0aGlzLl9iYXNlSGFzaFsxXS51cGRhdGUoZXhLZXlbMV0pO3RoaXMuX3Jlc3VsdEhhc2g9bmV3IEhhc2godGhpcy5fYmFzZUhhc2hbMF0pfTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUuZW5jcnlwdD1zamNsLm1pc2MuaG1hYy5wcm90b3R5cGUubWFjPWZ1bmN0aW9uKGRhdGEpe2lmKCF0aGlzLl91cGRhdGVkKXt0aGlzLnVwZGF0ZShkYXRhKTtyZXR1cm4gdGhpcy5kaWdlc3QoZGF0YSl9ZWxzZXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgiZW5jcnlwdCBvbiBhbHJlYWR5IHVwZGF0ZWQgaG1hYyBjYWxsZWQhIil9fTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLl9yZXN1bHRIYXNoPW5ldyB0aGlzLl9oYXNoKHRoaXMuX2Jhc2VIYXNoWzBdKTt0aGlzLl91cGRhdGVkPWZhbHNlfTtzamNsLm1pc2MuaG1hYy5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKGRhdGEpe3RoaXMuX3VwZGF0ZWQ9dHJ1ZTt0aGlzLl9yZXN1bHRIYXNoLnVwZGF0ZShkYXRhKX07c2pjbC5taXNjLmhtYWMucHJvdG90eXBlLmRpZ2VzdD1mdW5jdGlvbigpe3ZhciB3PXRoaXMuX3Jlc3VsdEhhc2guZmluYWxpemUoKSxyZXN1bHQ9bmV3IHRoaXMuX2hhc2godGhpcy5fYmFzZUhhc2hbMV0pLnVwZGF0ZSh3KS5maW5hbGl6ZSgpO3RoaXMucmVzZXQoKTtyZXR1cm4gcmVzdWx0fTtzamNsLm1pc2MucGJrZGYyPWZ1bmN0aW9uKHBhc3N3b3JkLHNhbHQsY291bnQsbGVuZ3RoLFByZmYpe2NvdW50PWNvdW50fHwxZTQ7aWYobGVuZ3RoPDB8fGNvdW50PDApe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJpbnZhbGlkIHBhcmFtcyB0byBwYmtkZjIiKX1pZih0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIil7cGFzc3dvcmQ9c2pjbC5jb2RlYy51dGY4U3RyaW5nLnRvQml0cyhwYXNzd29yZCl9aWYodHlwZW9mIHNhbHQ9PT0ic3RyaW5nIil7c2FsdD1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKHNhbHQpfVByZmY9UHJmZnx8c2pjbC5taXNjLmhtYWM7dmFyIHByZj1uZXcgUHJmZihwYXNzd29yZCksdSx1aSxpLGosayxvdXQ9W10sYj1zamNsLmJpdEFycmF5O2ZvcihrPTE7MzIqb3V0Lmxlbmd0aDwobGVuZ3RofHwxKTtrKyspe3U9dWk9cHJmLmVuY3J5cHQoYi5jb25jYXQoc2FsdCxba10pKTtmb3IoaT0xO2k8Y291bnQ7aSsrKXt1aT1wcmYuZW5jcnlwdCh1aSk7Zm9yKGo9MDtqPHVpLmxlbmd0aDtqKyspe3Vbal1ePXVpW2pdfX1vdXQ9b3V0LmNvbmNhdCh1KX1pZihsZW5ndGgpe291dD1iLmNsYW1wKG91dCxsZW5ndGgpfXJldHVybiBvdXR9O3NqY2wucHJuZz1mdW5jdGlvbihkZWZhdWx0UGFyYW5vaWEpe3RoaXMuX3Bvb2xzPVtuZXcgc2pjbC5oYXNoLnNoYTI1Nl07dGhpcy5fcG9vbEVudHJvcHk9WzBdO3RoaXMuX3Jlc2VlZENvdW50PTA7dGhpcy5fcm9iaW5zPXt9O3RoaXMuX2V2ZW50SWQ9MDt0aGlzLl9jb2xsZWN0b3JJZHM9e307dGhpcy5fY29sbGVjdG9ySWROZXh0PTA7dGhpcy5fc3RyZW5ndGg9MDt0aGlzLl9wb29sU3RyZW5ndGg9MDt0aGlzLl9uZXh0UmVzZWVkPTA7dGhpcy5fa2V5PVswLDAsMCwwLDAsMCwwLDBdO3RoaXMuX2NvdW50ZXI9WzAsMCwwLDBdO3RoaXMuX2NpcGhlcj11bmRlZmluZWQ7dGhpcy5fZGVmYXVsdFBhcmFub2lhPWRlZmF1bHRQYXJhbm9pYTt0aGlzLl9jb2xsZWN0b3JzU3RhcnRlZD1mYWxzZTt0aGlzLl9jYWxsYmFja3M9e3Byb2dyZXNzOnt9LHNlZWRlZDp7fX07dGhpcy5fY2FsbGJhY2tJPTA7dGhpcy5fTk9UX1JFQURZPTA7dGhpcy5fUkVBRFk9MTt0aGlzLl9SRVFVSVJFU19SRVNFRUQ9Mjt0aGlzLl9NQVhfV09SRFNfUEVSX0JVUlNUPTY1NTM2O3RoaXMuX1BBUkFOT0lBX0xFVkVMUz1bMCw0OCw2NCw5NiwxMjgsMTkyLDI1NiwzODQsNTEyLDc2OCwxMDI0XTt0aGlzLl9NSUxMSVNFQ09ORFNfUEVSX1JFU0VFRD0zZTQ7dGhpcy5fQklUU19QRVJfUkVTRUVEPTgwfTtzamNsLnBybmcucHJvdG90eXBlPXtyYW5kb21Xb3JkczpmdW5jdGlvbihud29yZHMscGFyYW5vaWEpe3ZhciBvdXQ9W10saSxyZWFkaW5lc3M9dGhpcy5pc1JlYWR5KHBhcmFub2lhKSxnO2lmKHJlYWRpbmVzcz09PXRoaXMuX05PVF9SRUFEWSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLm5vdFJlYWR5KCJnZW5lcmF0b3IgaXNuJ3Qgc2VlZGVkIil9ZWxzZSBpZihyZWFkaW5lc3MmdGhpcy5fUkVRVUlSRVNfUkVTRUVEKXt0aGlzLl9yZXNlZWRGcm9tUG9vbHMoIShyZWFkaW5lc3MmdGhpcy5fUkVBRFkpKX1mb3IoaT0wO2k8bndvcmRzO2krPTQpe2lmKChpKzEpJXRoaXMuX01BWF9XT1JEU19QRVJfQlVSU1Q9PT0wKXt0aGlzLl9nYXRlKCl9Zz10aGlzLl9nZW40d29yZHMoKTtvdXQucHVzaChnWzBdLGdbMV0sZ1syXSxnWzNdKX10aGlzLl9nYXRlKCk7cmV0dXJuIG91dC5zbGljZSgwLG53b3Jkcyl9LHNldERlZmF1bHRQYXJhbm9pYTpmdW5jdGlvbihwYXJhbm9pYSxhbGxvd1plcm9QYXJhbm9pYSl7aWYocGFyYW5vaWE9PT0wJiZhbGxvd1plcm9QYXJhbm9pYSE9PSJTZXR0aW5nIHBhcmFub2lhPTAgd2lsbCBydWluIHlvdXIgc2VjdXJpdHk7IHVzZSBpdCBvbmx5IGZvciB0ZXN0aW5nIil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoIlNldHRpbmcgcGFyYW5vaWE9MCB3aWxsIHJ1aW4geW91ciBzZWN1cml0eTsgdXNlIGl0IG9ubHkgZm9yIHRlc3RpbmciKX10aGlzLl9kZWZhdWx0UGFyYW5vaWE9cGFyYW5vaWF9LGFkZEVudHJvcHk6ZnVuY3Rpb24oZGF0YSxlc3RpbWF0ZWRFbnRyb3B5LHNvdXJjZSl7c291cmNlPXNvdXJjZXx8InVzZXIiO3ZhciBpZCxpLHRtcCx0PShuZXcgRGF0ZSkudmFsdWVPZigpLHJvYmluPXRoaXMuX3JvYmluc1tzb3VyY2VdLG9sZFJlYWR5PXRoaXMuaXNSZWFkeSgpLGVycj0wLG9iak5hbWU7aWQ9dGhpcy5fY29sbGVjdG9ySWRzW3NvdXJjZV07aWYoaWQ9PT11bmRlZmluZWQpe2lkPXRoaXMuX2NvbGxlY3Rvcklkc1tzb3VyY2VdPXRoaXMuX2NvbGxlY3RvcklkTmV4dCsrfWlmKHJvYmluPT09dW5kZWZpbmVkKXtyb2Jpbj10aGlzLl9yb2JpbnNbc291cmNlXT0wfXRoaXMuX3JvYmluc1tzb3VyY2VdPSh0aGlzLl9yb2JpbnNbc291cmNlXSsxKSV0aGlzLl9wb29scy5sZW5ndGg7c3dpdGNoKHR5cGVvZiBkYXRhKXtjYXNlIm51bWJlciI6aWYoZXN0aW1hdGVkRW50cm9weT09PXVuZGVmaW5lZCl7ZXN0aW1hdGVkRW50cm9weT0xfXRoaXMuX3Bvb2xzW3JvYmluXS51cGRhdGUoW2lkLHRoaXMuX2V2ZW50SWQrKywxLGVzdGltYXRlZEVudHJvcHksdCwxLGRhdGF8MF0pO2JyZWFrO2Nhc2Uib2JqZWN0IjpvYmpOYW1lPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRhKTtpZihvYmpOYW1lPT09IltvYmplY3QgVWludDMyQXJyYXldIil7dG1wPVtdO2ZvcihpPTA7aTxkYXRhLmxlbmd0aDtpKyspe3RtcC5wdXNoKGRhdGFbaV0pfWRhdGE9dG1wfWVsc2V7aWYob2JqTmFtZSE9PSJbb2JqZWN0IEFycmF5XSIpe2Vycj0xfWZvcihpPTA7aTxkYXRhLmxlbmd0aCYmIWVycjtpKyspe2lmKHR5cGVvZiBkYXRhW2ldIT09Im51bWJlciIpe2Vycj0xfX19aWYoIWVycil7aWYoZXN0aW1hdGVkRW50cm9weT09PXVuZGVmaW5lZCl7ZXN0aW1hdGVkRW50cm9weT0wO2ZvcihpPTA7aTxkYXRhLmxlbmd0aDtpKyspe3RtcD1kYXRhW2ldO3doaWxlKHRtcD4wKXtlc3RpbWF0ZWRFbnRyb3B5Kys7dG1wPXRtcD4+PjF9fX10aGlzLl9wb29sc1tyb2Jpbl0udXBkYXRlKFtpZCx0aGlzLl9ldmVudElkKyssMixlc3RpbWF0ZWRFbnRyb3B5LHQsZGF0YS5sZW5ndGhdLmNvbmNhdChkYXRhKSl9YnJlYWs7Y2FzZSJzdHJpbmciOmlmKGVzdGltYXRlZEVudHJvcHk9PT11bmRlZmluZWQpe2VzdGltYXRlZEVudHJvcHk9ZGF0YS5sZW5ndGh9dGhpcy5fcG9vbHNbcm9iaW5dLnVwZGF0ZShbaWQsdGhpcy5fZXZlbnRJZCsrLDMsZXN0aW1hdGVkRW50cm9weSx0LGRhdGEubGVuZ3RoXSk7dGhpcy5fcG9vbHNbcm9iaW5dLnVwZGF0ZShkYXRhKTticmVhaztkZWZhdWx0OmVycj0xfWlmKGVycil7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygicmFuZG9tOiBhZGRFbnRyb3B5IG9ubHkgc3VwcG9ydHMgbnVtYmVyLCBhcnJheSBvZiBudW1iZXJzIG9yIHN0cmluZyIpfXRoaXMuX3Bvb2xFbnRyb3B5W3JvYmluXSs9ZXN0aW1hdGVkRW50cm9weTt0aGlzLl9wb29sU3RyZW5ndGgrPWVzdGltYXRlZEVudHJvcHk7aWYob2xkUmVhZHk9PT10aGlzLl9OT1RfUkVBRFkpe2lmKHRoaXMuaXNSZWFkeSgpIT09dGhpcy5fTk9UX1JFQURZKXt0aGlzLl9maXJlRXZlbnQoInNlZWRlZCIsTWF0aC5tYXgodGhpcy5fc3RyZW5ndGgsdGhpcy5fcG9vbFN0cmVuZ3RoKSl9dGhpcy5fZmlyZUV2ZW50KCJwcm9ncmVzcyIsdGhpcy5nZXRQcm9ncmVzcygpKX19LGlzUmVhZHk6ZnVuY3Rpb24ocGFyYW5vaWEpe3ZhciBlbnRyb3B5UmVxdWlyZWQ9dGhpcy5fUEFSQU5PSUFfTEVWRUxTW3BhcmFub2lhIT09dW5kZWZpbmVkP3BhcmFub2lhOnRoaXMuX2RlZmF1bHRQYXJhbm9pYV07aWYodGhpcy5fc3RyZW5ndGgmJnRoaXMuX3N0cmVuZ3RoPj1lbnRyb3B5UmVxdWlyZWQpe3JldHVybiB0aGlzLl9wb29sRW50cm9weVswXT50aGlzLl9CSVRTX1BFUl9SRVNFRUQmJihuZXcgRGF0ZSkudmFsdWVPZigpPnRoaXMuX25leHRSZXNlZWQ/dGhpcy5fUkVRVUlSRVNfUkVTRUVEfHRoaXMuX1JFQURZOnRoaXMuX1JFQURZfWVsc2V7cmV0dXJuIHRoaXMuX3Bvb2xTdHJlbmd0aD49ZW50cm9weVJlcXVpcmVkP3RoaXMuX1JFUVVJUkVTX1JFU0VFRHx0aGlzLl9OT1RfUkVBRFk6dGhpcy5fTk9UX1JFQURZfX0sZ2V0UHJvZ3Jlc3M6ZnVuY3Rpb24ocGFyYW5vaWEpe3ZhciBlbnRyb3B5UmVxdWlyZWQ9dGhpcy5fUEFSQU5PSUFfTEVWRUxTW3BhcmFub2lhP3BhcmFub2lhOnRoaXMuX2RlZmF1bHRQYXJhbm9pYV07aWYodGhpcy5fc3RyZW5ndGg+PWVudHJvcHlSZXF1aXJlZCl7cmV0dXJuIDF9ZWxzZXtyZXR1cm4gdGhpcy5fcG9vbFN0cmVuZ3RoPmVudHJvcHlSZXF1aXJlZD8xOnRoaXMuX3Bvb2xTdHJlbmd0aC9lbnRyb3B5UmVxdWlyZWR9fSxzdGFydENvbGxlY3RvcnM6ZnVuY3Rpb24oKXtpZih0aGlzLl9jb2xsZWN0b3JzU3RhcnRlZCl7cmV0dXJufXRoaXMuX2V2ZW50TGlzdGVuZXI9e2xvYWRUaW1lQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fbG9hZFRpbWVDb2xsZWN0b3IpLG1vdXNlQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fbW91c2VDb2xsZWN0b3IpLGtleWJvYXJkQ29sbGVjdG9yOnRoaXMuX2JpbmQodGhpcy5fa2V5Ym9hcmRDb2xsZWN0b3IpLGFjY2VsZXJvbWV0ZXJDb2xsZWN0b3I6dGhpcy5fYmluZCh0aGlzLl9hY2NlbGVyb21ldGVyQ29sbGVjdG9yKSx0b3VjaENvbGxlY3Rvcjp0aGlzLl9iaW5kKHRoaXMuX3RvdWNoQ29sbGVjdG9yKX07aWYod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIix0aGlzLl9ldmVudExpc3RlbmVyLmxvYWRUaW1lQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLm1vdXNlQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5cHJlc3MiLHRoaXMuX2V2ZW50TGlzdGVuZXIua2V5Ym9hcmRDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJkZXZpY2Vtb3Rpb24iLHRoaXMuX2V2ZW50TGlzdGVuZXIuYWNjZWxlcm9tZXRlckNvbGxlY3RvcixmYWxzZSk7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsdGhpcy5fZXZlbnRMaXN0ZW5lci50b3VjaENvbGxlY3RvcixmYWxzZSl9ZWxzZSBpZihkb2N1bWVudC5hdHRhY2hFdmVudCl7ZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ubG9hZCIsdGhpcy5fZXZlbnRMaXN0ZW5lci5sb2FkVGltZUNvbGxlY3Rvcik7ZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ubW91c2Vtb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLm1vdXNlQ29sbGVjdG9yKTtkb2N1bWVudC5hdHRhY2hFdmVudCgia2V5cHJlc3MiLHRoaXMuX2V2ZW50TGlzdGVuZXIua2V5Ym9hcmRDb2xsZWN0b3IpfWVsc2V7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmJ1ZygiY2FuJ3QgYXR0YWNoIGV2ZW50Iil9dGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQ9dHJ1ZX0sc3RvcENvbGxlY3RvcnM6ZnVuY3Rpb24oKXtpZighdGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQpe3JldHVybn1pZih3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcil7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLHRoaXMuX2V2ZW50TGlzdGVuZXIubG9hZFRpbWVDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLHRoaXMuX2V2ZW50TGlzdGVuZXIubW91c2VDb2xsZWN0b3IsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlwcmVzcyIsdGhpcy5fZXZlbnRMaXN0ZW5lci5rZXlib2FyZENvbGxlY3RvcixmYWxzZSk7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImRldmljZW1vdGlvbiIsdGhpcy5fZXZlbnRMaXN0ZW5lci5hY2NlbGVyb21ldGVyQ29sbGVjdG9yLGZhbHNlKTt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIix0aGlzLl9ldmVudExpc3RlbmVyLnRvdWNoQ29sbGVjdG9yLGZhbHNlKX1lbHNlIGlmKGRvY3VtZW50LmRldGFjaEV2ZW50KXtkb2N1bWVudC5kZXRhY2hFdmVudCgib25sb2FkIix0aGlzLl9ldmVudExpc3RlbmVyLmxvYWRUaW1lQ29sbGVjdG9yKTtkb2N1bWVudC5kZXRhY2hFdmVudCgib25tb3VzZW1vdmUiLHRoaXMuX2V2ZW50TGlzdGVuZXIubW91c2VDb2xsZWN0b3IpO2RvY3VtZW50LmRldGFjaEV2ZW50KCJrZXlwcmVzcyIsdGhpcy5fZXZlbnRMaXN0ZW5lci5rZXlib2FyZENvbGxlY3Rvcil9dGhpcy5fY29sbGVjdG9yc1N0YXJ0ZWQ9ZmFsc2V9LGFkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayl7dGhpcy5fY2FsbGJhY2tzW25hbWVdW3RoaXMuX2NhbGxiYWNrSSsrXT1jYWxsYmFja30scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihuYW1lLGNiKXt2YXIgaSxqLGNicz10aGlzLl9jYWxsYmFja3NbbmFtZV0sanNUZW1wPVtdO2ZvcihqIGluIGNicyl7aWYoY2JzLmhhc093blByb3BlcnR5KGopJiZjYnNbal09PT1jYil7anNUZW1wLnB1c2goail9fWZvcihpPTA7aTxqc1RlbXAubGVuZ3RoO2krKyl7aj1qc1RlbXBbaV07ZGVsZXRlIGNic1tqXX19LF9iaW5kOmZ1bmN0aW9uKGZ1bmMpe3ZhciB0aGF0PXRoaXM7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuYy5hcHBseSh0aGF0LGFyZ3VtZW50cyl9fSxfZ2VuNHdvcmRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTw0O2krKyl7dGhpcy5fY291bnRlcltpXT10aGlzLl9jb3VudGVyW2ldKzF8MDtpZih0aGlzLl9jb3VudGVyW2ldKXticmVha319cmV0dXJuIHRoaXMuX2NpcGhlci5lbmNyeXB0KHRoaXMuX2NvdW50ZXIpfSxfZ2F0ZTpmdW5jdGlvbigpe3RoaXMuX2tleT10aGlzLl9nZW40d29yZHMoKS5jb25jYXQodGhpcy5fZ2VuNHdvcmRzKCkpO3RoaXMuX2NpcGhlcj1uZXcgc2pjbC5jaXBoZXIuYWVzKHRoaXMuX2tleSl9LF9yZXNlZWQ6ZnVuY3Rpb24oc2VlZFdvcmRzKXt0aGlzLl9rZXk9c2pjbC5oYXNoLnNoYTI1Ni5oYXNoKHRoaXMuX2tleS5jb25jYXQoc2VlZFdvcmRzKSk7dGhpcy5fY2lwaGVyPW5ldyBzamNsLmNpcGhlci5hZXModGhpcy5fa2V5KTtmb3IodmFyIGk9MDtpPDQ7aSsrKXt0aGlzLl9jb3VudGVyW2ldPXRoaXMuX2NvdW50ZXJbaV0rMXwwO2lmKHRoaXMuX2NvdW50ZXJbaV0pe2JyZWFrfX19LF9yZXNlZWRGcm9tUG9vbHM6ZnVuY3Rpb24oZnVsbCl7dmFyIHJlc2VlZERhdGE9W10sc3RyZW5ndGg9MCxpO3RoaXMuX25leHRSZXNlZWQ9cmVzZWVkRGF0YVswXT0obmV3IERhdGUpLnZhbHVlT2YoKSt0aGlzLl9NSUxMSVNFQ09ORFNfUEVSX1JFU0VFRDtmb3IoaT0wO2k8MTY7aSsrKXtyZXNlZWREYXRhLnB1c2goTWF0aC5yYW5kb20oKSo0Mjk0OTY3Mjk2fDApfWZvcihpPTA7aTx0aGlzLl9wb29scy5sZW5ndGg7aSsrKXtyZXNlZWREYXRhPXJlc2VlZERhdGEuY29uY2F0KHRoaXMuX3Bvb2xzW2ldLmZpbmFsaXplKCkpO3N0cmVuZ3RoKz10aGlzLl9wb29sRW50cm9weVtpXTt0aGlzLl9wb29sRW50cm9weVtpXT0wO2lmKCFmdWxsJiZ0aGlzLl9yZXNlZWRDb3VudCYxPDxpKXticmVha319aWYodGhpcy5fcmVzZWVkQ291bnQ+PTE8PHRoaXMuX3Bvb2xzLmxlbmd0aCl7dGhpcy5fcG9vbHMucHVzaChuZXcgc2pjbC5oYXNoLnNoYTI1Nik7dGhpcy5fcG9vbEVudHJvcHkucHVzaCgwKX10aGlzLl9wb29sU3RyZW5ndGgtPXN0cmVuZ3RoO2lmKHN0cmVuZ3RoPnRoaXMuX3N0cmVuZ3RoKXt0aGlzLl9zdHJlbmd0aD1zdHJlbmd0aH10aGlzLl9yZXNlZWRDb3VudCsrO3RoaXMuX3Jlc2VlZChyZXNlZWREYXRhKX0sX2tleWJvYXJkQ29sbGVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMSl9LF9tb3VzZUNvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIHgseTt0cnl7eD1ldi54fHxldi5jbGllbnRYfHxldi5vZmZzZXRYfHwwO3k9ZXYueXx8ZXYuY2xpZW50WXx8ZXYub2Zmc2V0WXx8MH1jYXRjaChlcnIpe3g9MDt5PTB9aWYoeCE9MCYmeSE9MCl7dGhpcy5hZGRFbnRyb3B5KFt4LHldLDIsIm1vdXNlIil9dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMCl9LF90b3VjaENvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIHRvdWNoPWV2LnRvdWNoZXNbMF18fGV2LmNoYW5nZWRUb3VjaGVzWzBdO3ZhciB4PXRvdWNoLnBhZ2VYfHx0b3VjaC5jbGllbnRYLHk9dG91Y2gucGFnZVl8fHRvdWNoLmNsaWVudFk7dGhpcy5hZGRFbnRyb3B5KFt4LHldLDEsInRvdWNoIik7dGhpcy5fYWRkQ3VycmVudFRpbWVUb0VudHJvcHkoMCl9LF9sb2FkVGltZUNvbGxlY3RvcjpmdW5jdGlvbigpe3RoaXMuX2FkZEN1cnJlbnRUaW1lVG9FbnRyb3B5KDIpfSxfYWRkQ3VycmVudFRpbWVUb0VudHJvcHk6ZnVuY3Rpb24oZXN0aW1hdGVkRW50cm9weSl7aWYodHlwZW9mIHdpbmRvdyE9PSJ1bmRlZmluZWQiJiZ3aW5kb3cucGVyZm9ybWFuY2UmJnR5cGVvZiB3aW5kb3cucGVyZm9ybWFuY2Uubm93PT09ImZ1bmN0aW9uIil7dGhpcy5hZGRFbnRyb3B5KHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSxlc3RpbWF0ZWRFbnRyb3B5LCJsb2FkdGltZSIpfWVsc2V7dGhpcy5hZGRFbnRyb3B5KChuZXcgRGF0ZSkudmFsdWVPZigpLGVzdGltYXRlZEVudHJvcHksImxvYWR0aW1lIil9fSxfYWNjZWxlcm9tZXRlckNvbGxlY3RvcjpmdW5jdGlvbihldil7dmFyIGFjPWV2LmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkueHx8ZXYuYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eS55fHxldi5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lno7aWYod2luZG93Lm9yaWVudGF0aW9uKXt2YXIgb3I9d2luZG93Lm9yaWVudGF0aW9uO2lmKHR5cGVvZiBvcj09PSJudW1iZXIiKXt0aGlzLmFkZEVudHJvcHkob3IsMSwiYWNjZWxlcm9tZXRlciIpfX1pZihhYyl7dGhpcy5hZGRFbnRyb3B5KGFjLDIsImFjY2VsZXJvbWV0ZXIiKX10aGlzLl9hZGRDdXJyZW50VGltZVRvRW50cm9weSgwKX0sX2ZpcmVFdmVudDpmdW5jdGlvbihuYW1lLGFyZyl7dmFyIGosY2JzPXNqY2wucmFuZG9tLl9jYWxsYmFja3NbbmFtZV0sY2JzVGVtcD1bXTtmb3IoaiBpbiBjYnMpe2lmKGNicy5oYXNPd25Qcm9wZXJ0eShqKSl7Y2JzVGVtcC5wdXNoKGNic1tqXSl9fWZvcihqPTA7ajxjYnNUZW1wLmxlbmd0aDtqKyspe2Nic1RlbXBbal0oYXJnKX19fTtzamNsLnJhbmRvbT1uZXcgc2pjbC5wcm5nKDYpOyhmdW5jdGlvbigpe2Z1bmN0aW9uIGdldENyeXB0b01vZHVsZSgpe3RyeXtyZXR1cm4gcmVxdWlyZSgiY3J5cHRvIil9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fXRyeXt2YXIgYnVmLGNyeXB0LGFiO2lmKHR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIiYmbW9kdWxlLmV4cG9ydHMmJihjcnlwdD1nZXRDcnlwdG9Nb2R1bGUoKSkmJmNyeXB0LnJhbmRvbUJ5dGVzKXtidWY9Y3J5cHQucmFuZG9tQnl0ZXMoMTAyNC84KTtidWY9bmV3IFVpbnQzMkFycmF5KG5ldyBVaW50OEFycmF5KGJ1ZikuYnVmZmVyKTtzamNsLnJhbmRvbS5hZGRFbnRyb3B5KGJ1ZiwxMDI0LCJjcnlwdG8ucmFuZG9tQnl0ZXMiKX1lbHNlIGlmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIiYmdHlwZW9mIFVpbnQzMkFycmF5IT09InVuZGVmaW5lZCIpe2FiPW5ldyBVaW50MzJBcnJheSgzMik7aWYod2luZG93LmNyeXB0byYmd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMpe3dpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFiKX1lbHNlIGlmKHdpbmRvdy5tc0NyeXB0byYmd2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyl7d2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhYil9ZWxzZXtyZXR1cm59c2pjbC5yYW5kb20uYWRkRW50cm9weShhYiwxMDI0LCJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIil9ZWxzZXt9fWNhdGNoKGUpe2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIiYmd2luZG93LmNvbnNvbGUpe2NvbnNvbGUubG9nKCJUaGVyZSB3YXMgYW4gZXJyb3IgY29sbGVjdGluZyBlbnRyb3B5IGZyb20gdGhlIGJyb3dzZXI6Iik7Y29uc29sZS5sb2coZSl9fX0pKCk7c2pjbC5qc29uPXtkZWZhdWx0czp7djoxLGl0ZXI6MWU0LGtzOjEyOCx0czo2NCxtb2RlOiJjY20iLGFkYXRhOiIiLGNpcGhlcjoiYWVzIn0sX2VuY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQscGxhaW50ZXh0LHBhcmFtcyxycCl7cGFyYW1zPXBhcmFtc3x8e307cnA9cnB8fHt9O3ZhciBqPXNqY2wuanNvbixwPWouX2FkZCh7aXY6c2pjbC5yYW5kb20ucmFuZG9tV29yZHMoNCwwKX0sai5kZWZhdWx0cyksdG1wLHBycCxhZGF0YTtqLl9hZGQocCxwYXJhbXMpO2FkYXRhPXAuYWRhdGE7aWYodHlwZW9mIHAuc2FsdD09PSJzdHJpbmciKXtwLnNhbHQ9c2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHAuc2FsdCl9aWYodHlwZW9mIHAuaXY9PT0ic3RyaW5nIil7cC5pdj1zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5pdil9aWYoIXNqY2wubW9kZVtwLm1vZGVdfHwhc2pjbC5jaXBoZXJbcC5jaXBoZXJdfHx0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIiYmcC5pdGVyPD0xMDB8fHAudHMhPT02NCYmcC50cyE9PTk2JiZwLnRzIT09MTI4fHxwLmtzIT09MTI4JiZwLmtzIT09MTkyJiZwLmtzIT09MjU2fHwocC5pdi5sZW5ndGg8Mnx8cC5pdi5sZW5ndGg+NCkpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGVuY3J5cHQ6IGludmFsaWQgcGFyYW1ldGVycyIpfWlmKHR5cGVvZiBwYXNzd29yZD09PSJzdHJpbmciKXt0bXA9c2pjbC5taXNjLmNhY2hlZFBia2RmMihwYXNzd29yZCxwKTtwYXNzd29yZD10bXAua2V5LnNsaWNlKDAscC5rcy8zMik7cC5zYWx0PXRtcC5zYWx0fWVsc2UgaWYoc2pjbC5lY2MmJnBhc3N3b3JkIGluc3RhbmNlb2Ygc2pjbC5lY2MuZWxHYW1hbC5wdWJsaWNLZXkpe3RtcD1wYXNzd29yZC5rZW0oKTtwLmtlbXRhZz10bXAudGFnO3Bhc3N3b3JkPXRtcC5rZXkuc2xpY2UoMCxwLmtzLzMyKX1pZih0eXBlb2YgcGxhaW50ZXh0PT09InN0cmluZyIpe3BsYWludGV4dD1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKHBsYWludGV4dCl9aWYodHlwZW9mIGFkYXRhPT09InN0cmluZyIpe3AuYWRhdGE9YWRhdGE9c2pjbC5jb2RlYy51dGY4U3RyaW5nLnRvQml0cyhhZGF0YSl9cHJwPW5ldyBzamNsLmNpcGhlcltwLmNpcGhlcl0ocGFzc3dvcmQpO2ouX2FkZChycCxwKTtycC5rZXk9cGFzc3dvcmQ7aWYocC5tb2RlPT09ImNjbSImJnNqY2wuYXJyYXlCdWZmZXImJnNqY2wuYXJyYXlCdWZmZXIuY2NtJiZwbGFpbnRleHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7cC5jdD1zamNsLmFycmF5QnVmZmVyLmNjbS5lbmNyeXB0KHBycCxwbGFpbnRleHQscC5pdixhZGF0YSxwLnRzKX1lbHNle3AuY3Q9c2pjbC5tb2RlW3AubW9kZV0uZW5jcnlwdChwcnAscGxhaW50ZXh0LHAuaXYsYWRhdGEscC50cyl9cmV0dXJuIHB9LGVuY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQscGxhaW50ZXh0LHBhcmFtcyxycCl7dmFyIGo9c2pjbC5qc29uLHA9ai5fZW5jcnlwdC5hcHBseShqLGFyZ3VtZW50cyk7cmV0dXJuIGouZW5jb2RlKHApfSxfZGVjcnlwdDpmdW5jdGlvbihwYXNzd29yZCxjaXBoZXJ0ZXh0LHBhcmFtcyxycCl7cGFyYW1zPXBhcmFtc3x8e307cnA9cnB8fHt9O3ZhciBqPXNqY2wuanNvbixwPWouX2FkZChqLl9hZGQoai5fYWRkKHt9LGouZGVmYXVsdHMpLGNpcGhlcnRleHQpLHBhcmFtcyx0cnVlKSxjdCx0bXAscHJwLGFkYXRhPXAuYWRhdGE7aWYodHlwZW9mIHAuc2FsdD09PSJzdHJpbmciKXtwLnNhbHQ9c2pjbC5jb2RlYy5iYXNlNjQudG9CaXRzKHAuc2FsdCl9aWYodHlwZW9mIHAuaXY9PT0ic3RyaW5nIil7cC5pdj1zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5pdil9aWYoIXNqY2wubW9kZVtwLm1vZGVdfHwhc2pjbC5jaXBoZXJbcC5jaXBoZXJdfHx0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIiYmcC5pdGVyPD0xMDB8fHAudHMhPT02NCYmcC50cyE9PTk2JiZwLnRzIT09MTI4fHxwLmtzIT09MTI4JiZwLmtzIT09MTkyJiZwLmtzIT09MjU2fHwhcC5pdnx8KHAuaXYubGVuZ3RoPDJ8fHAuaXYubGVuZ3RoPjQpKXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgianNvbiBkZWNyeXB0OiBpbnZhbGlkIHBhcmFtZXRlcnMiKX1pZih0eXBlb2YgcGFzc3dvcmQ9PT0ic3RyaW5nIil7dG1wPXNqY2wubWlzYy5jYWNoZWRQYmtkZjIocGFzc3dvcmQscCk7cGFzc3dvcmQ9dG1wLmtleS5zbGljZSgwLHAua3MvMzIpO3Auc2FsdD10bXAuc2FsdH1lbHNlIGlmKHNqY2wuZWNjJiZwYXNzd29yZCBpbnN0YW5jZW9mIHNqY2wuZWNjLmVsR2FtYWwuc2VjcmV0S2V5KXtwYXNzd29yZD1wYXNzd29yZC51bmtlbShzamNsLmNvZGVjLmJhc2U2NC50b0JpdHMocC5rZW10YWcpKS5zbGljZSgwLHAua3MvMzIpfWlmKHR5cGVvZiBhZGF0YT09PSJzdHJpbmciKXthZGF0YT1zamNsLmNvZGVjLnV0ZjhTdHJpbmcudG9CaXRzKGFkYXRhKX1wcnA9bmV3IHNqY2wuY2lwaGVyW3AuY2lwaGVyXShwYXNzd29yZCk7aWYocC5tb2RlPT09ImNjbSImJnNqY2wuYXJyYXlCdWZmZXImJnNqY2wuYXJyYXlCdWZmZXIuY2NtJiZwLmN0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2N0PXNqY2wuYXJyYXlCdWZmZXIuY2NtLmRlY3J5cHQocHJwLHAuY3QscC5pdixwLnRhZyxhZGF0YSxwLnRzKX1lbHNle2N0PXNqY2wubW9kZVtwLm1vZGVdLmRlY3J5cHQocHJwLHAuY3QscC5pdixhZGF0YSxwLnRzKX1qLl9hZGQocnAscCk7cnAua2V5PXBhc3N3b3JkO2lmKHBhcmFtcy5yYXc9PT0xKXtyZXR1cm4gY3R9ZWxzZXtyZXR1cm4gc2pjbC5jb2RlYy51dGY4U3RyaW5nLmZyb21CaXRzKGN0KX19LGRlY3J5cHQ6ZnVuY3Rpb24ocGFzc3dvcmQsY2lwaGVydGV4dCxwYXJhbXMscnApe3ZhciBqPXNqY2wuanNvbjtyZXR1cm4gai5fZGVjcnlwdChwYXNzd29yZCxqLmRlY29kZShjaXBoZXJ0ZXh0KSxwYXJhbXMscnApfSxlbmNvZGU6ZnVuY3Rpb24ob2JqKXt2YXIgaSxvdXQ9InsiLGNvbW1hPSIiO2ZvcihpIGluIG9iail7aWYob2JqLmhhc093blByb3BlcnR5KGkpKXtpZighaS5tYXRjaCgvXlthLXowLTldKyQvaSkpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGVuY29kZTogaW52YWxpZCBwcm9wZXJ0eSBuYW1lIil9b3V0Kz1jb21tYSsnIicraSsnIjonO2NvbW1hPSIsIjtzd2l0Y2godHlwZW9mIG9ialtpXSl7Y2FzZSJudW1iZXIiOmNhc2UiYm9vbGVhbiI6b3V0Kz1vYmpbaV07YnJlYWs7Y2FzZSJzdHJpbmciOm91dCs9JyInK2VzY2FwZShvYmpbaV0pKyciJzticmVhaztjYXNlIm9iamVjdCI6b3V0Kz0nIicrc2pjbC5jb2RlYy5iYXNlNjQuZnJvbUJpdHMob2JqW2ldLDApKyciJzticmVhaztkZWZhdWx0OnRocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5idWcoImpzb24gZW5jb2RlOiB1bnN1cHBvcnRlZCB0eXBlIil9fX1yZXR1cm4gb3V0KyJ9In0sZGVjb2RlOmZ1bmN0aW9uKHN0cil7c3RyPXN0ci5yZXBsYWNlKC9ccy9nLCIiKTtpZighc3RyLm1hdGNoKC9eXHsuKn0kLykpe3Rocm93IG5ldyBzamNsLmV4Y2VwdGlvbi5pbnZhbGlkKCJqc29uIGRlY29kZTogdGhpcyBpc24ndCBqc29uISIpfXZhciBhPXN0ci5yZXBsYWNlKC9eXHt8fSQvZywiIikuc3BsaXQoLywvKSxvdXQ9e30saSxtO2ZvcihpPTA7aTxhLmxlbmd0aDtpKyspe2lmKCEobT1hW2ldLm1hdGNoKC9eXHMqKD86KFsiJ10/KShbYS16XVthLXowLTldKilcMSlccyo6XHMqKD86KC0/XGQrKXwiKFthLXowLTkrXC8lKl8uQD1cLV0qKSJ8KHRydWV8ZmFsc2UpKSQvaSkpKXt0aHJvdyBuZXcgc2pjbC5leGNlcHRpb24uaW52YWxpZCgianNvbiBkZWNvZGU6IHRoaXMgaXNuJ3QganNvbiEiKX1pZihtWzNdIT1udWxsKXtvdXRbbVsyXV09cGFyc2VJbnQobVszXSwxMCl9ZWxzZSBpZihtWzRdIT1udWxsKXtvdXRbbVsyXV09bVsyXS5tYXRjaCgvXihjdHxhZGF0YXxzYWx0fGl2KSQvKT9zamNsLmNvZGVjLmJhc2U2NC50b0JpdHMobVs0XSk6dW5lc2NhcGUobVs0XSl9ZWxzZSBpZihtWzVdIT1udWxsKXtvdXRbbVsyXV09bVs1XT09PSJ0cnVlIn19cmV0dXJuIG91dH0sX2FkZDpmdW5jdGlvbih0YXJnZXQsc3JjLHJlcXVpcmVTYW1lKXtpZih0YXJnZXQ9PT11bmRlZmluZWQpe3RhcmdldD17fX1pZihzcmM9PT11bmRlZmluZWQpe3JldHVybiB0YXJnZXR9dmFyIGk7Zm9yKGkgaW4gc3JjKXtpZihzcmMuaGFzT3duUHJvcGVydHkoaSkpe2lmKHJlcXVpcmVTYW1lJiZ0YXJnZXRbaV0hPT11bmRlZmluZWQmJnRhcmdldFtpXSE9PXNyY1tpXSl7dGhyb3cgbmV3IHNqY2wuZXhjZXB0aW9uLmludmFsaWQoInJlcXVpcmVkIHBhcmFtZXRlciBvdmVycmlkZGVuIil9dGFyZ2V0W2ldPXNyY1tpXX19cmV0dXJuIHRhcmdldH0sX3N1YnRyYWN0OmZ1bmN0aW9uKHBsdXMsbWludXMpe3ZhciBvdXQ9e30saTtmb3IoaSBpbiBwbHVzKXtpZihwbHVzLmhhc093blByb3BlcnR5KGkpJiZwbHVzW2ldIT09bWludXNbaV0pe291dFtpXT1wbHVzW2ldfX1yZXR1cm4gb3V0fSxfZmlsdGVyOmZ1bmN0aW9uKHNyYyxmaWx0ZXIpe3ZhciBvdXQ9e30saTtmb3IoaT0wO2k8ZmlsdGVyLmxlbmd0aDtpKyspe2lmKHNyY1tmaWx0ZXJbaV1dIT09dW5kZWZpbmVkKXtvdXRbZmlsdGVyW2ldXT1zcmNbZmlsdGVyW2ldXX19cmV0dXJuIG91dH19O3NqY2wuZW5jcnlwdD1zamNsLmpzb24uZW5jcnlwdDtzamNsLmRlY3J5cHQ9c2pjbC5qc29uLmRlY3J5cHQ7c2pjbC5taXNjLl9wYmtkZjJDYWNoZT17fTtzamNsLm1pc2MuY2FjaGVkUGJrZGYyPWZ1bmN0aW9uKHBhc3N3b3JkLG9iail7dmFyIGNhY2hlPXNqY2wubWlzYy5fcGJrZGYyQ2FjaGUsYyxjcCxzdHIsc2FsdCxpdGVyO29iaj1vYmp8fHt9O2l0ZXI9b2JqLml0ZXJ8fDFlMztjcD1jYWNoZVtwYXNzd29yZF09Y2FjaGVbcGFzc3dvcmRdfHx7fTtjPWNwW2l0ZXJdPWNwW2l0ZXJdfHx7Zmlyc3RTYWx0Om9iai5zYWx0JiZvYmouc2FsdC5sZW5ndGg/b2JqLnNhbHQuc2xpY2UoMCk6c2pjbC5yYW5kb20ucmFuZG9tV29yZHMoMiwwKX07c2FsdD1vYmouc2FsdD09PXVuZGVmaW5lZD9jLmZpcnN0U2FsdDpvYmouc2FsdDtjW3NhbHRdPWNbc2FsdF18fHNqY2wubWlzYy5wYmtkZjIocGFzc3dvcmQsc2FsdCxvYmouaXRlcik7cmV0dXJue2tleTpjW3NhbHRdLnNsaWNlKDApLHNhbHQ6c2FsdC5zbGljZSgwKX19O2lmKHR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIiYmbW9kdWxlLmV4cG9ydHMpe21vZHVsZS5leHBvcnRzPXNqY2x9aWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiIpe2RlZmluZShbXSxmdW5jdGlvbigpe3JldHVybiBzamNsfSl9Cgl2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgogIAlsb2dnZXIubWVzc2FnZSgiQ29sbGVjdCBBbmQgRW5jcnlwdCBDdXN0b20gUGFzc3dvcmQ6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gInRydWUiOwogIAogICAgLyogQmVnaW4gQ29uZmlndXJhdGlvbiAqLwogIAkKICAJLy8gQXR0cmlidXRlIG5hbWUKICAJdmFyIGlkbUF0dHJOYW1lID0gImZyVW5pbmRleGVkU3RyaW5nMiI7IC8vIEFNOiAiZnItYXR0ci1zdHIyIgogIAkKICAJLy8gUGljayBhIHNoYXJlZCBzZWNyZXQgdG8gdXNlIGZvciBlbmNyeXB0aW9uIGFuZCBkZWNyeXB0aW9uCiAgICB2YXIgc2hhcmVkU2VjcmV0ID0gIlJhaW5ib3dQb25pZXNIYXZlTm9TdHJpcGVzIjsKCiAgCS8vIEZpbmUtdHVuZSBlbmNyeXB0aW9uIHNldHRpbmdzLiBEZWZhdWx0IGl0ZXJhdGlvbnMgYXJlIDEwaywgdG8gc3BlZWQgdXAgdGhlIHByb2Nlc3MsIGl0J3MgcmVkdWNlZCB0byAxayBoZXJlLgogIAl2YXIgZW5jcnlwdGlvblBhcmFtZXRlcnMgPSB7ICJpdGVyIiA6IDEwMDAgfTsKICAJCiAgICAvLyBCdWlsZCBvdXQgdGhlIHBhc3N3b3JkIHByb21wdAogICAgdmFyIHByb21wdCA9ICJSZXBsYXkgUGFzc3dvcmQiOwoKICAgIC8qIEVuZCBDb25maWd1cmF0aW9uICovCiAgCiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCgkgICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5QYXNzd29yZENhbGxiYWNrLAogICAgICAJamF2YS5sYW5nLlN0cmluZwogICAgKQoJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgbmV3IGZyLlBhc3N3b3JkQ2FsbGJhY2socHJvbXB0LCBmYWxzZSkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9IAogICAgZWxzZSB7CiAgICAgIAkvLyBQYXNzd29yZENhbGxiYWNrIHJldHVybnMgdGhlIHBhc3N3b3JkIGFzIGEgY2hhcltdLCB3aGljaCBpcyBub3QgdGhlIHNhbWUgYXMgYSBKUyBjaGFyIGFycmF5LiBJdCBtdXN0IGJlIGNvbnZlcnRlZCB0byBhIHByb3BlciBzdHJpbmcgdXNpbmcgdGhlIGphdmEubGFuZy5TdGluZy52YWx1ZU9mKGNoYXJbXSkgbWV0aG9kLgogICAgICAgIHZhciBwYXNzd29yZCA9IG5ldyBTdHJpbmcoZnIuU3RyaW5nLnZhbHVlT2YoY2FsbGJhY2tzLmdldCgwKS5nZXRQYXNzd29yZCgpKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBjYWxsYmFja3MgcmVjZWl2ZWQiKTsKCiAgICAgIAkvKgogICAgICAgIHZhciBjaXBoZXJQYXNzd29yZEpzb24gPSBzamNsLmVuY3J5cHQoc2hhcmVkU2VjcmV0LCBwYXNzd29yZCwgZW5jcnlwdGlvblBhcmFtZXRlcnMpOwogICAgICAgIC8vc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKGlkbUF0dHJOYW1lLCBCYXNlNjQuZW5jb2RlKEpTT04uc3RyaW5naWZ5KGNpcGhlclBhc3N3b3JkSnNvbikpKTsKICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoaWRtQXR0ck5hbWUsIEpTT04uc3RyaW5naWZ5KGNpcGhlclBhc3N3b3JkSnNvbikpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJDb2xsZWN0IEFuZCBFbmNyeXB0IEN1c3RvbSBQYXNzd29yZDogY2lwaGVyUGFzc3dvcmRKc29uPSIrSlNPTi5zdHJpbmdpZnkoY2lwaGVyUGFzc3dvcmRKc29uKSk7CiAgICAgICAgKi8KICAgICAgCiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBwYXNzd29yZD0iK0Jhc2U2NC5lbmNvZGUocGFzc3dvcmQpKTsKICAgICAgICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoaWRtQXR0ck5hbWUsIEJhc2U2NC5lbmNvZGUocGFzc3dvcmQpKTsKCiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkNvbGxlY3QgQW5kIEVuY3J5cHQgQ3VzdG9tIFBhc3N3b3JkOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgICB9CgogICAgLyoKICAgICAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgICAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAgICAgICBpZiAoc3RvcmFnZS5wdXQpIHsKICAgICAgICAgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgICAJdmFyIG9iamVjdCA9IHsKICAgICAgICAgICAgICAJbmFtZTogdmFsdWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgb2JqZWN0KTsKICAgICAgICAgICAgLy9zaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgICAgIH0KICAgIH0KfSgpKTsKLyogU0pDTCBpcyBvcGVuLiBZb3UgY2FuIHVzZSwgbW9kaWZ5IGFuZCByZWRpc3RyaWJ1dGUgaXQgdW5kZXIgYSBCU0QKbGljZW5zZSBvciB1bmRlciB0aGUgR05VIEdQTCwgdmVyc2lvbiAyLjAuCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMi1DbGF1c2UKCkNvcHlyaWdodCAoYykgMjAwOS0yMDE1LCBFbWlseSBTdGFyaywgTWlrZSBIYW1idXJnIGFuZCBEYW4gQm9uZWggYXQKU3RhbmZvcmQgVW5pdmVyc2l0eS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KClJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAptb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlCm1ldDoKCjEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0Cm5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KCjIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0Cm5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUKZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi4KClRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgIkFTCklTIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRApUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEKUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUCkhPTERFUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwKU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEClRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IKUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRgpMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORwpORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMKU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9HUEwtMi4wCgpUaGUgU3RhbmZvcmQgSmF2YXNjcmlwdCBDcnlwdG8gTGlicmFyeSAoaG9zdGVkIGhlcmUgb24gR2l0SHViKSBpcyBhCnByb2plY3QgYnkgdGhlIFN0YW5mb3JkIENvbXB1dGVyIFNlY3VyaXR5IExhYiB0byBidWlsZCBhIHNlY3VyZSwKcG93ZXJmdWwsIGZhc3QsIHNtYWxsLCBlYXN5LXRvLXVzZSwgY3Jvc3MtYnJvd3NlciBsaWJyYXJ5IGZvcgpjcnlwdG9ncmFwaHkgaW4gSmF2YXNjcmlwdC4KCkNvcHlyaWdodCAoYykgMjAwOS0yMDE1LCBFbWlseSBTdGFyaywgTWlrZSBIYW1idXJnIGFuZCBEYW4gQm9uZWggYXQKU3RhbmZvcmQgVW5pdmVyc2l0eS4KClRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0CnVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZQpGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyCm9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgpUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwgYnV0CldJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVSBHZW5lcmFsClB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgpZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZwp3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLAo1OSBUZW1wbGUgUGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAwMjExMS0xMzA3IFVTQSAqLwoKLyoKICogQmFzZTY0IGVuY29kZSAvIGRlY29kZQogKiAgaHR0cDovL3d3dy53ZWJ0b29sa2l0LmluZm8vCiAqIAogKiBFeGFtcGxlOgogKiBCYXNlNjQuZW5jb2RlKCdzb21lIHN0cmluZycpCiAqIEJhc2U2NC5kZWNvZGUoJ3NvbWUgZW5jb2RlZCBzdHJpbmcnKQogKi8=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.647Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "363a71f39643a664381fab9835743d38",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Check Username\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Check%20Username%22"
        },
        "response": {
          "bodySize": 1104,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1104,
            "text": "{\"result\":[{\"_id\":\"739bdc48-fd24-4c52-b353-88706d75558a\",\"name\":\"Check Username\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1104"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.687Z",
        "time": 40,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 40
        }
      },
      {
        "_id": "3e77d40091d49a74f78ea88228c0d87a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 564,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IPQS IP Address\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IPQS%20IP%20Address%22"
        },
        "response": {
          "bodySize": 4894,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4894,
            "text": "{\"result\":[{\"_id\":\"a186232a-683d-48ce-8893-d6f92652ec82\",\"name\":\"IPQS IP Address\",\"description\":\"Analyze an IP address using the IPQualityScore (IPQS) service.\",\"script\":\"LyogSVBRUyBJUCBBZGRyZXNzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFuYWx5emUgYW4gSVAgYWRkcmVzcyB1c2luZyB0aGUgSVBRdWFsaXR5U2NvcmUgKElQUVMpIHNlcnZpY2UuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIGhpZ2gKICogLSBzdXNwaWNpb3VzCiAqIC0gbG93CiAqIC0gdW5rbm93bgogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci53YXJuaW5nKCJJUFFTIElQIEFkZHJlc3M6IHN0YXJ0Iik7CgogICAgb3V0Y29tZSA9ICJ1bmtub3duIjsKCiAgICB2YXIgaXAgPSBnZXRDbGllbnRJUEFkZHJlc3MoKTsKICAgIGxvZ2dlci53YXJuaW5nKCJJUFFTIElQIEFkZHJlc3M6IGlwPSIuY29uY2F0KGlwKSk7CgogICAgaWYgKGlwKSB7CgogICAgICAgIC8vIElQUVMgQVBJIENvbmZpZ3VyYXRpb24KICAgICAgICB2YXIgSVBRU19BUElfS0VZID0gc3lzdGVtRW52LmdldFByb3BlcnR5KCJlc3YuaXBxcy5hcGkua2V5Iik7CiAgICAgICAgdmFyIElQUVNfT1BUSU9OUyA9ICJzdHJpY3RuZXNzPTAmYWxsb3dfcHVibGljX2FjY2Vzc19wb2ludHM9dHJ1ZSZ1c2VyX2FnZW50PSIuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChnZXRIZWFkZXIoInVzZXItYWdlbnQiKSkpLmNvbmNhdCgiJnVzZXJfbGFuZ3VhZ2U9IikuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChnZXRIZWFkZXIoImFjY2VwdC1sYW5ndWFnZSIpKSk7CiAgICAgICAgdmFyIElQUVNfQVBJX1VSSSA9ICJodHRwczovL2lwcXVhbGl0eXNjb3JlLmNvbS9hcGkvanNvbi9pcC8iLmNvbmNhdChJUFFTX0FQSV9LRVkpLmNvbmNhdCgiLyIpLmNvbmNhdChpcCkuY29uY2F0KCI/IikuY29uY2F0KElQUVNfT1BUSU9OUyk7CgogICAgICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICAgICAgcmVxdWVzdC5zZXRNZXRob2QoJ0dFVCcpOwogICAgICAgIHJlcXVlc3Quc2V0VXJpKElQUVNfQVBJX1VSSSk7CgogICAgICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIklQUVMgSVAgQWRkcmVzczogSlNPTiByZXN1bHQ6ICIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpKTsKCiAgICAgICAgLy8gcHJlc2VydmUgcmVzdWx0IGluIHRyYW5zaWVudCBzdGF0ZQogICAgICAgIHRyYW5zaWVudFN0YXRlLnB1dCgiSVBRU19JUF9BZGRyZXNzIiwgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogICAgICAgIGlmIChyZXN1bHQuZnJhdWRfc2NvcmUgPj0gODUpIHsKICAgICAgICAgICAgb3V0Y29tZSA9ICJoaWdoIjsKICAgICAgICB9IAogICAgICAgIGVsc2UgaWYgKHJlc3VsdC5mcmF1ZF9zY29yZSA+PSA3NSkgewogICAgICAgICAgICBvdXRjb21lID0gInN1c3BpY2lvdXMiOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgb3V0Y29tZSA9ICJsb3ciOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5lcnJvcigiSVBRUyBJUCBBZGRyZXNzOiBubyBjbGllbnQgaXAhIik7CiAgICB9CgogICAgbG9nZ2VyLndhcm5pbmcoIk9JUFFTIElQIEFkZHJlc3M6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgogICAgLyoKICAgICAqICEhISBBU1NVTUVTIElEIENMT1VEICEhIQogICAgICoKICAgICAqIFJldHVybnMgdGhlIGNsaWVudCdzIElQIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q2xpZW50SVBBZGRyZXNzKCkgewogICAgICAgIHJldHVybiBnZXRIZWFkZXIoIngtZm9yd2FyZGVkLWZvciIpLnNwbGl0KCcsJylbMF07CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCk7CiAgICB9CgogICAgICAgIC8qIFNhbXBsZSBJUFFTIFJFU1QgQVBJIFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICAic3VjY2VzcyI6IHRydWUsCiAgICAgICAgICAgICJtZXNzYWdlIjogIlN1Y2Nlc3MiLAogICAgICAgICAgICAiZnJhdWRfc2NvcmUiOiAxMDAsCiAgICAgICAgICAgICJjb3VudHJ5X2NvZGUiOiAiVVMiLAogICAgICAgICAgICAicmVnaW9uIjogIldhc2hpbmd0b24iLAogICAgICAgICAgICAiY2l0eSI6ICJTZWF0dGxlIiwKICAgICAgICAgICAgIklTUCI6ICJFbWVyYWxkIE9uaW9uIiwKICAgICAgICAgICAgIkFTTiI6IDM5NjUwNywKICAgICAgICAgICAgIm9wZXJhdGluZ19zeXN0ZW0iOiAiTWFjIDEwLjE2IiwKICAgICAgICAgICAgImJyb3dzZXIiOiAiRmlyZWZveCA4NS4wIiwKICAgICAgICAgICAgIm9yZ2FuaXphdGlvbiI6ICJFbWVyYWxkIE9uaW9uIiwKICAgICAgICAgICAgImxhdGl0dWRlIjogNDcuNiwKICAgICAgICAgICAgImxvbmdpdHVkZSI6IC0xMjIuMzMsCiAgICAgICAgICAgICJpc19jcmF3bGVyIjogZmFsc2UsCiAgICAgICAgICAgICJ0aW1lem9uZSI6ICJBbWVyaWNhXC9DaGljYWdvIiwKICAgICAgICAgICAgIm1vYmlsZSI6IGZhbHNlLAogICAgICAgICAgICAiaG9zdCI6ICIyNjIwOjE4YzowOjE5Mjo6MjMyIiwKICAgICAgICAgICAgInByb3h5IjogdHJ1ZSwKICAgICAgICAgICAgInZwbiI6IHRydWUsCiAgICAgICAgICAgICJ0b3IiOiB0cnVlLAogICAgICAgICAgICAiYWN0aXZlX3ZwbiI6IGZhbHNlLAogICAgICAgICAgICAiYWN0aXZlX3RvciI6IHRydWUsCiAgICAgICAgICAgICJkZXZpY2VfYnJhbmQiOiAiTlwvQSIsCiAgICAgICAgICAgICJkZXZpY2VfbW9kZWwiOiAiTlwvQSIsCiAgICAgICAgICAgICJyZWNlbnRfYWJ1c2UiOiB0cnVlLAogICAgICAgICAgICAiYm90X3N0YXR1cyI6IGZhbHNlLAogICAgICAgICAgICAiY29ubmVjdGlvbl90eXBlIjogIlByZW1pdW0gcmVxdWlyZWQuIiwKICAgICAgICAgICAgImFidXNlX3ZlbG9jaXR5IjogIlByZW1pdW0gcmVxdWlyZWQuIiwKICAgICAgICAgICAgInJlcXVlc3RfaWQiOiAiNHVUTzc4cER4eXIzUFAiCiAgICAgICAgfQogICAgKi8KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4894"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.731Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "b053354d3e96e3e2828f1986afdf05c8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"WeChat Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22WeChat%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1403,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1403,
            "text": "{\"result\":[{\"_id\":\"472534ec-a25f-468d-a606-3fb1935190df\",\"name\":\"WeChat Profile Normalization\",\"description\":\"Normalizes raw profile data from WeChat\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLm9wZW5pZCksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uaWNrbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5oZWFkaW1ndXJsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLm5pY2tuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1403"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.771Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "da171ffe43fa0414dde04a78281c0870",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"GitHub Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22GitHub%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1323,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1323,
            "text": "{\"result\":[{\"_id\":\"a7a78773-445b-4eca-bb93-409e86bced81\",\"name\":\"GitHub Profile Normalization\",\"description\":\"Normalizes raw profile data from GitHub\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUubG9naW4pKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1323"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.809Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "64523f841dd3447ff46e532c270f4369",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 568,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Has Profile Changed\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Has%20Profile%20Changed%22"
        },
        "response": {
          "bodySize": 1260,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1260,
            "text": "{\"result\":[{\"_id\":\"2ada53cd-5d37-4592-9c7f-5711271229c2\",\"name\":\"Has Profile Changed\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJIYXMgUHJvZmlsZSBDaGFuZ2VkOiBzdGFydCIpOwpvdXRjb21lID0gInVuY2hhbmdlZCI7CmlmIChnZXRPYmplY3RBdHRyaWJ1dGUoIm9sZF9naXZlbk5hbWUiKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJvbGRfc24iKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZFN0cmluZzUiKSB8fAogICAgZ2V0T2JqZWN0QXR0cmlidXRlKCJvbGRfdGVsZXBob25lTnVtYmVyIikpIHsKICBvdXRjb21lID0gImNoYW5nZWQiOwp9CmxvZ2dlci5lcnJvcigiSGFzIFByb2ZpbGUgQ2hhbmdlZDogZW5kIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKCi8qCiAqIEdldCBvYmplY3RBdHRyaWJ1dGUgdmFsdWUKICovCmZ1bmN0aW9uIGdldE9iamVjdEF0dHJpYnV0ZShuYW1lKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikgJiYgc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikuZ2V0KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKS50b1N0cmluZygpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1260"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.847Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c8411de3db73664462c93d6ebc9ebd19",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display States\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20States%22"
        },
        "response": {
          "bodySize": 3790,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3790,
            "text": "{\"result\":[{\"_id\":\"b703581a-e112-42b9-bc24-6db8bced5a13\",\"name\":\"Display States\",\"description\":\"Display sharedState and transientState.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICAgICAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICBzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAgICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgICAgICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAgICAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgICAgICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAgICAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2Uuc3R5bGUgPSBcInRleHQtYWxpZ246IGxlZnQ7IGlubGluZS1zaXplOiA0MzBweDsgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDtcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgICAgICIgIH1cbiIpLmNvbmNhdCgKICAgICAgIn0pIikKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIGlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBhbmNob3IKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAgLyoKICAgICAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICAgICAqIAogICAgICAqIEV4YW1wbGU6CiAgICAgICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICAgICAgdmFyIHYgPSByOwogICAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgICAgfSk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3790"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.885Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "000ff0f2b46c206e53f43f99849549df",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 581,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Normalized Profile to Identity\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Normalized%20Profile%20to%20Identity%22"
        },
        "response": {
          "bodySize": 1739,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1739,
            "text": "{\"result\":[{\"_id\":\"ed685f9f-5909-4726-86e8-22bd38b47663\",\"name\":\"Normalized Profile to Identity\",\"description\":\"Converts a normalized social profile into an Identity\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlCgpKc29uVmFsdWUgaWRlbnRpdHkgPSBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUuZ2l2ZW5OYW1lKSwKICAgICAgICBmaWVsZCgic24iLCBub3JtYWxpemVkUHJvZmlsZS5mYW1pbHlOYW1lKSwKICAgICAgICBmaWVsZCgibWFpbCIsIG5vcm1hbGl6ZWRQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgiY24iLCBub3JtYWxpemVkUHJvZmlsZS5kaXNwbGF5TmFtZSksCiAgICAgICAgZmllbGQoInVzZXJOYW1lIiwgbm9ybWFsaXplZFByb2ZpbGUudXNlcm5hbWUpLAogICAgICAgIGZpZWxkKCJpcGxhbmV0LWFtLXVzZXItYWxpYXMtbGlzdCIsIHNlbGVjdGVkSWRwICsgJy0nICsgbm9ybWFsaXplZFByb2ZpbGUuaWQuYXNTdHJpbmcoKSkpKQoKcmV0dXJuIGlkZW50aXR5\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1739"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.925Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "6374a7c67ee6e08fe6cd44cf41e79dd9",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 564,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_DebugSharedState\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_DebugSharedState%22"
        },
        "response": {
          "bodySize": 3746,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3746,
            "text": "{\"result\":[{\"_id\":\"8d786082-b00c-4756-9fe0-7f06f7efe6e9\",\"name\":\"AT_DebugSharedState\",\"description\":\"Debug Shared state\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2suIE5vdCBmb3IgcHJvZHVjdGlvbiB1c2UuCiAqIFNjcmlwdCB0byBkaXNwbGF5IHNoYXJlZFN0YXRlIGluIEludGVsbGlnZW50IEFjY2VzcyBKb3VybmV5IGZvciBkZWJ1Z2dpbmcKICovCi8qIGRlYnVnCiAqQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiBEaXNwbGF5IHNoYXJlZFN0YXRlLCB0cmFuc2llbnRTdGF0ZSwgYW5kIGhlYWRlcnMuCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCnZhciBvdXRwdXQgPSB0cnVlOwoKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIGhhbGlnbiA9ICJsZWZ0IjsKdmFyIG1lc3NhZ2UgPSAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIuY29uY2F0KAogIAlzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+VHJhbnNpZW50IFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAJdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgIjxwPjxiPlJlcXVlc3QgSGVhZGVyczwvYj46PGJyLz4iKS5jb25jYXQoCiAgCXJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwp9CgogLyoKICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgKgogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3746"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:30.966Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "20607c9b9f84cac7b3b8fa577aa6b339",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 585,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Select Theme by Browser Language\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Select%20Theme%20by%20Browser%20Language%22"
        },
        "response": {
          "bodySize": 3058,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3058,
            "text": "{\"result\":[{\"_id\":\"847aab1b-c739-4d64-b26c-180f96cba02b\",\"name\":\"Select Theme by Browser Language\",\"description\":\"Select and apply theme from based on the browser language in the request.\",\"script\":\"LyogU2VsZWN0IFRoZW1lIGJ5IEJyb3dzZXIgTGFuZ3VhZ2UKICogCiAqIFNlbGVjdCBhbmQgYXBwbHkgdGhlbWUgZnJvbSBiYXNlZCBvbiB0aGUgYnJvd3NlciBsYW5ndWFnZSBpbiB0aGUgcmVxdWVzdC4KICogCiAqIFRoaXMgc2NyaXB0IG5lZWRzIHRvIGJlIHBhcmFtZXRyaXplZCEKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLyogQmVnaW4gU2NyaXB0IENvbmZpZ3VyYXRpb24gKi8KCiAgICAvLyB0aGUgc2NyaXB0IGV4cGVjdHMgdGhlIHRoZW1lcyB0byBiZSBuYW1lZCA8YmFzZVRoZW1lPl88bGFuZ3VhZ2U+LCBlLmcuICJaYXJkb3pfZW4iCiAgICB2YXIgYmFzZVRoZW1lID0gIlphcmRveiI7CgogICAgLy8gYWRkIGFsbCB0aGUgbGFuZ3VhZ2UgY29kZXMgeW91IHdhbnQgdG8gc3VwcG9ydAogICAgdmFyIHN1cHBvcnRlZExhbmd1YWdlcyA9IFsiZGUiLCAiZW4iLCAiZnIiXTsKCiAgICAvLyBzcGVjaWZ5IHRoZSBkZWZhdWx0IGxhbmd1YWdlIHRvIGZhbGwgYmFjayBvbiBpZiB0aGUgYnJvd3NlciBsYW5ndWFnZSBpcyBub3QgYSBzdXBwb3J0ZWQgbGFuZ3VhZ2UKICAgIHZhciBkZWZhdWx0TGFuZ3VhZ2UgPSAiZW4iOwoKICAgIC8qIEVuZCBTY3JpcHQgQ29uZmlndXJhdGlvbiAgICovCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgICB2YXIgdGhlbWUgPSBnZXRUaGVtZUJ5TGFuZ3VhZ2UoYmFzZVRoZW1lKTsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKHRoZW1lICYmIGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICB2YXIgc3RhZ2UgPSAidGhlbWVJZD0iICsgdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAvKgogICAgICogUmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgdGhlbWUgdG8gc2VsZWN0IGJhc2VkIG9uIGJyb3dzZXIgbGFuZ3VhZ2UKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0VGhlbWVCeUxhbmd1YWdlKHRoZW1lKSB7CiAgICAgICAgdmFyIGxhbmd1YWdlSGVhZGVyID0gZ2V0SGVhZGVyKCJhY2NlcHQtbGFuZ3VhZ2UiKTsKICAgICAgICB2YXIgbGFuZ3VhZ2UgPSBsYW5ndWFnZUhlYWRlci5zcGxpdCgnOycpWzBdLnNwbGl0KCcsJylbMF0uc3BsaXQoJy0nKVswXTsKICAgICAgICBpZiAoc3VwcG9ydGVkTGFuZ3VhZ2VzLmluZGV4T2YobGFuZ3VhZ2UpIDwgMCkgewogICAgICAgICAgICBsYW5ndWFnZSA9IGRlZmF1bHRMYW5ndWFnZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoZW1lICsgIl8iICsgbGFuZ3VhZ2U7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkgKyAiIjsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3058"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.007Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "d2e578f630eaeee3eebe4134b9bee78f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 575,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ResetPasswordReplayCredentials\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ResetPasswordReplayCredentials%22"
        },
        "response": {
          "bodySize": 1306,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1306,
            "text": "{\"result\":[{\"_id\":\"a8f10e93-3f6c-4d6c-b6a3-a8453e3d6b3a\",\"name\":\"ResetPasswordReplayCredentials\",\"description\":\"Reset the attributes holding replay credentials for the IG replay use case.\",\"script\":\"LyogUmVzZXRQYXNzd29yZFJlcGxheUNyZWRlbnRpYWxzCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJlc2V0IHRoZSBhdHRyaWJ1dGVzIGhvbGRpbmcgcmVwbGF5IGNyZWRlbnRpYWxzIGZvciB0aGUgSUcgcmVwbGF5IHVzZSBjYXNlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkIGZvciB5b3VyIGVudi4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqLwooZnVuY3Rpb24gKCkgewogIG91dGNvbWUgPSAidHJ1ZSI7CiAgdmFyIFJFUExBWV9VU0VSTkFNRV9JRE1fQVRUUiA9ICJmclVuaW5kZXhlZFN0cmluZzEiOwogIHZhciBSRVBMQVlfUEFTU1dPUkRfSURNX0FUVFIgPSAiZnJVbmluZGV4ZWRTdHJpbmcyIjsKICAKICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoUkVQTEFZX1VTRVJOQU1FX0lETV9BVFRSLCBudWxsKTsKICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoUkVQTEFZX1BBU1NXT1JEX0lETV9BVFRSLCBudWxsKTsKfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1306"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.048Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "107a4931480ecae131b0dd4dbfc827bd",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 593,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ForgeRock Internal: OIDC Claims Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ForgeRock%20Internal%3A%20OIDC%20Claims%20Script%22"
        },
        "response": {
          "bodySize": 41535,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 41535,
            "text": "{\"result\":[{\"_id\":\"1f389a3d-21cf-417c-a6d3-42ea620071f0\",\"name\":\"ForgeRock Internal: OIDC Claims Script\",\"description\":\"Internal OIDC Claims script\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUwogKiBvciB3aXRoIG9uZSBvZiBpdHMgYWZmaWxpYXRlcy4gQWxsIHVzZSBzaGFsbCBiZSBleGNsdXNpdmVseSBzdWJqZWN0CiAqIHRvIHN1Y2ggbGljZW5zZSBiZXR3ZWVuIHRoZSBsaWNlbnNlZSBhbmQgRm9yZ2VSb2NrIEFTLgogKi8KCi8qCiAqIFRoaXMgc2NyaXB0IGNvbXB1dGVzIGNsYWltIHZhbHVlcyByZXR1cm5lZCBpbiBJRCB0b2tlbnMgYW5kL29yIGF0IHRoZSBVc2VySW5mbyBFbmRwb2ludC4KICogVGhlIGNsYWltIHZhbHVlcyBhcmUgY29tcHV0ZWQgZm9yOgogKiB0aGUgY2xhaW1zIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICogdGhlIGNsYWltcyBwcm92aWRlZCBieSB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIsCiAqIGFuZCB0aGUgY2xhaW1zIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHZpYSB0aGUgY2xhaW1zIHBhcmFtZXRlci4KICoKICogSW4gdGhlIENPTkZJR1VSQVRJT04gQU5EIENVU1RPTUlaQVRJT04gc2VjdGlvbiwgeW91IGNhbgogKiBkZWZpbmUgdGhlIHNjb3BlLXRvLWNsYWltcyBtYXBwaW5nLCBhbmQKICogYXNzaWduIHRvIGVhY2ggY2xhaW0gYSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IHdpbGwgY29tcHV0ZSB0aGUgY2xhaW0gdmFsdWUuCiAqCiAqIERlZmluZWQgdmFyaWFibGVzIChjbGFzcyByZWZlcmVuY2VzIGFyZSBwcm92aWRlZCBiZWxvdyk6CiAqIHNjb3BlcyAtIFNldDxTdHJpbmc+ICg2KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogKiBjbGFpbXMgLSBNYXA8U3RyaW5nLCBPYmplY3Q+ICg1KS4KICogICAgICAgICAgQWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogY2xhaW1PYmplY3RzIC0gTGlzdDxDbGFpbT4gKDcsIDIpLgogKiAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcy4KICogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+ICg1KS4KICogICAgICAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIG5vdCBlbXB0eSBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgY2xhaW1zIHBhcmFtZXRlciBhbmQgdGhlIHNlcnZlciBoYXMgZW5hYmxlZAogKiAgICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZC4gQSBtYXAgb2YgdGhlIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHk7CiAqICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBubyByZXF1ZXN0ZWQgdmFsdWVzIHdpbGwgaGF2ZSBhIGtleSBidXQgbm8gdmFsdWUgaW4gdGhlIG1hcC4gQSBrZXkgd2l0aAogKiAgICAgICAgICAgICAgICAgICBhIHNpbmdsZSB2YWx1ZSBpbiBpdHMgU2V0ICg2KSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiByZXF1ZXN0ZWRUeXBlZENsYWltcyAtIExpc3Q8Q2xhaW0+ICg3LCAyKS4KICogICAgICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIHJlcXVlc3RlZCBjbGFpbXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgQSBjbGFpbSB3aXRoIGEgc2luZ2xlIHZhbHVlIGluZGljYXRlcyB0aGlzIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgc2hvdWxkIGJlIHJldHVybmVkLgogKiBjbGFpbXNMb2NhbGVzIC0gTGlzdDxTdHJpbmc+ICg3KS4KICogICAgICAgICAgICAgICAgIFRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIuCiAqICAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjQ2xhaW1zTGFuZ3VhZ2VzQW5kU2NyaXB0cyBmb3IgdGhlIE9JREMgc3BlY2lmaWNhdGlvbiBkZXRhaWxzLgogKiByZXF1ZXN0UHJvcGVydGllcyAtIFVubW9kaWZpYWJsZSBNYXAgKDUpLgogKiAgICAgICAgICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCBjb250YWlucyBhIG1hcCBvZiByZXF1ZXN0IHByb3BlcnRpZXM6CiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVyaSAtIFRoZSByZXF1ZXN0IFVSSS4KICogICAgICAgICAgICAgICAgICAgICByZWFsbSAtIFRoZSByZWFsbSB0aGF0IHRoZSByZXF1ZXN0IHJlbGF0ZXMgdG8uCiAqICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFBhcmFtcyAtIEEgbWFwIG9mIHRoZSByZXF1ZXN0IHBhcmFtcyBhbmQvb3IgcG9zdGVkIGRhdGEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhY2ggdmFsdWUgaXMgYSBsaXN0IG9mIG9uZSBvciBtb3JlIHByb3BlcnRpZXMuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlIHRoYXQgdGhlc2Ugc2hvdWxkIGJlIGhhbmRsZWQgaW4gYWNjb3JkYW5jZSB3aXRoIE9XQVNQIGJlc3QgcHJhY3RpY2VzOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwczovL293YXNwLm9yZy93d3ctY29tbXVuaXR5L3Z1bG5lcmFiaWxpdGllcy9VbnNhZmVfdXNlX29mX1JlZmxlY3Rpb24uCiAqIGNsaWVudFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgIFByZXNlbnQgaWYgdGhlIGNsaWVudCBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIGlkZW50aWZpZWQsIGNvbnRhaW5zIGEgbWFwIG9mIGNsaWVudCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgLSBUaGUgY2xpZW50J3MgVVJJIGZvciB0aGUgcmVxdWVzdCBsb2NhbGUuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkR3JhbnRUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgZ3JhbnQgdHlwZXMgKG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuR3JhbnRUeXBlKSBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZXNwb25zZVR5cGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCByZXNwb25zZSB0eXBlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGFsbG93ZWRTY29wZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIHNjb3BlcyBmb3IgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXMgLSBBIG1hcCBvZiB0aGUgY3VzdG9tIHByb3BlcnRpZXMgb2YgdGhlIGNsaWVudC4KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0cyBvciBtYXBzIHdpbGwgYmUgaW5jbHVkZWQgYXMgc3ViLW1hcHM7IGZvciBleGFtcGxlOgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbU1hcFtLZXkxXT1WYWx1ZTEgd2lsbCBiZSByZXR1cm5lZCBhcyBjdXN0b21NYXAgLT4gS2V5MSAtPiBWYWx1ZTEuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG8gYWRkIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGEgY2xpZW50LCB1cGRhdGUgdGhlIEN1c3RvbSBQcm9wZXJ0aWVzIGZpZWxkCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gQU0gQ29uc29sZSA+IFJlYWxtIE5hbWUgPiBBcHBsaWNhdGlvbnMgPiBPQXV0aCAyLjAgPiBDbGllbnRzID4gQ2xpZW50IElEID4gQWR2YW5jZWQuCiAqIGlkZW50aXR5IC0gQU1JZGVudGl0eSAoMykuCiAqICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2Ugb3duZXIuCiAqIHNlc3Npb24gLSBTU09Ub2tlbiAoNCkuCiAqICAgICAgICAgICBQcmVzZW50IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIHRoZSBzZXNzaW9uIGNvb2tpZSwgdGhlIHVzZXIncyBzZXNzaW9uIG9iamVjdC4KICogc2NyaXB0TmFtZSAtIFN0cmluZyAocHJpbWl0aXZlKS4KICogICAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgZGlzcGxheSBuYW1lIG9mIHRoZSBzY3JpcHQuCiAqIGxvZ2dlciAtIEFsd2F5cyBwcmVzZW50LCB0aGUgIk9BdXRoMlByb3ZpZGVyIiBkZWJ1ZyBsb2dnZXIgaW5zdGFuY2U6CiAqICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuaHRtbCNzY3JpcHRpbmctYXBpLWdsb2JhbC1sb2dnZXIuCiAqICAgICAgICAgIENvcnJlc3BvbmRpbmcgZmlsZXMgd2lsbCBiZSBwcmVmaXhlZCB3aXRoOiBzY3JpcHRzLk9JRENfQ0xBSU1TLgogKiBodHRwQ2xpZW50IC0gSFRUUCBDbGllbnQgKDgpLgogKiAgICAgICAgICAgICAgQWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIENsaWVudCBpbnN0YW5jZToKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHRpbmctYXBpLWdsb2JhbC1odHRwLWNsaWVudC5odG1sI3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50LgogKiAgICAgICAgICAgICAgSW4gb3JkZXIgdG8gdXNlIHRoZSBjbGllbnQsIHlvdSBtYXkgbmVlZCB0byBhZGQKICogICAgICAgICAgICAgIG9yZy5mb3JnZXJvY2suaHR0cC5DbGllbnQsCiAqICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuKiwKICogICAgICAgICAgICAgIGFuZCBvcmcuZm9yZ2Vyb2NrLnV0aWwucHJvbWlzZS5Qcm9taXNlSW1wbAogKiAgICAgICAgICAgICAgdG8gdGhlIGFsbG93ZWQgSmF2YSBjbGFzc2VzIGluIHRoZSBzY3JpcHRpbmcgZW5naW5lIGNvbmZpZ3VyYXRpb24sIGFzIGRlc2NyaWJlZCBpbjoKICogICAgICAgICAgICAgIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L3NjcmlwdGluZy1ndWlkZS9zY3JpcHQtZW5naW5lLXNlY3VyaXR5Lmh0bWwKICoKICogUmV0dXJuIC0gYSBuZXcgVXNlckluZm9DbGFpbXMoTWFwPFN0cmluZywgT2JqZWN0PiB2YWx1ZXMsIE1hcDxTdHJpbmcsIExpc3Q8U3RyaW5nPj4gY29tcG9zaXRlU2NvcGVzKSAoMSkgb2JqZWN0LgogKiAgICAgICAgICBUaGUgcmVzdWx0IG9mIHRoZSBsYXN0IHN0YXRlbWVudCBpbiB0aGUgc2NyaXB0IGlzIHJldHVybmVkIHRvIHRoZSBzZXJ2ZXIuCiAqICAgICAgICAgIEN1cnJlbnRseSwgdGhlIEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbiAoYWxzbyBrbm93biBhcyBTZWxmLUV4ZWN1dGluZyBBbm9ueW1vdXMgRnVuY3Rpb24pCiAqICAgICAgICAgIGlzIHRoZSBsYXN0IChhbmQgb25seSkgc3RhdGVtZW50IGluIHRoaXMgc2NyaXB0LCBhbmQgaXRzIHJldHVybiB2YWx1ZSB3aWxsIGJlY29tZSB0aGUgc2NyaXB0IHJlc3VsdC4KICogICAgICAgICAgRG8gbm90IHVzZSAicmV0dXJuIHZhcmlhYmxlIiBzdGF0ZW1lbnQgb3V0c2lkZSBvZiBhIGZ1bmN0aW9uIGRlZmluaXRpb24uCiAqICAgICAgICAgIFNlZSBSRVNVTFRTIHNlY3Rpb24gZm9yIGFkZGl0aW9uYWwgZGV0YWlscy4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgVXNlckluZm9DbGFpbXMgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvVXNlckluZm9DbGFpbXMuaHRtbC4KICogKDIpIENsYWltIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbCkuCiAqICAgICAgICAgQW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGhhcyBtZXRob2RzIHRvIGFjY2VzcwogKiAgICAgICAgIHRoZSBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgdmFsdWVzLCBsb2NhbGUsIGFuZCB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwuCiAqICgzKSBBTUlkZW50aXR5IC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vc3VuL2lkZW50aXR5L2lkbS9BTUlkZW50aXR5Lmh0bWwuCiAqICg0KSBTU09Ub2tlbiAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3MvY29tL2lwbGFuZXQvc3NvL1NTT1Rva2VuLmh0bWwuCiAqICg1KSBNYXAgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hNYXAuaHRtbCwKICogICAgICAgICAgIG9yIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvTGlua2VkSGFzaE1hcC5odG1sLgogKiAoNikgU2V0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9IYXNoU2V0Lmh0bWwuCiAqICg3KSBMaXN0IC0gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9BcnJheUxpc3QuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgoqLwoKKGZ1bmN0aW9uICgpIHsKICAgIC8vIFNFVFVQCgogICAgLyoqCiAgICAgKiBDbGFpbSBwcm9jZXNzaW5nIHV0aWxpdGllcy4KICAgICAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHJldXNhYmxlIGZ1bmN0aW9ucyBmb3IgcHJvY2Vzc2luZyBjbGFpbXMuCiAgICAgKiBAc2VlIENMQUlNIFBST0NFU1NJTkcgVVRJTElUSUVTIHNlY3Rpb24gZm9yIGRldGFpbHMuCiAgICAgKi8KICAgIHZhciB1dGlscyA9IGdldFV0aWxzKCk7CgogICAgLy8gQ09ORklHVVJBVElPTiBBTkQgQ1VTVE9NSVpBVElPTgoKICAgIC8qKgogICAgICogT0F1dGggMi4wIHNjb3BlIHZhbHVlcyAoc2NvcGVzKSBjYW4gYmUgdXNlZCBieSB0aGUgQ2xpZW50IHRvIHJlcXVlc3QgT0lEQyBjbGFpbXMuCiAgICAgKgogICAgICogQ2FsbCB0aGlzIGNvbmZpZ3VyYXRpb24gbWV0aG9kLCBhbmQgcGFzcyBpbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQKICAgICAqIGFuIG9iamVjdCB0aGF0IG1hcHMgYSBzY29wZSB2YWx1ZSB0byBhbiBhcnJheSBvZiBjbGFpbSBuYW1lcwogICAgICogdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgYW5kIHJldHVybmVkIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfQogICAgICogZm9yIHRoZSBzY29wZSB2YWx1ZXMgdGhhdCBjb3VsZCBiZSB1c2VkIHRvIHJlcXVlc3QgY2xhaW1zIGFzIGRlZmluZWQgaW4gdGhlIE9JREMgc3BlY2lmaWNhdGlvbi4KICAgICAqCiAgICAgKiBCZWxvdywgZmluZCBhIGRlZmF1bHQgY29uZmlndXJhdGlvbiB0aGF0IGlzIGV4cGVjdGVkIHRvIHdvcmsgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiBjaG9vc2UgdGhlIGNsYWltIG5hbWVzIHJldHVybmVkIGZvciBhIHNjb3BlLgogICAgICovCiAgICB1dGlscy5zZXRTY29wZUNsYWltc01hcCh7CiAgICAgICAgcHJvZmlsZTogWwogICAgICAgICAgICAnbmFtZScsCiAgICAgICAgICAgICdmYW1pbHlfbmFtZScsCiAgICAgICAgICAgICdnaXZlbl9uYW1lJywKICAgICAgICAgICAgJ3pvbmVpbmZvJywKICAgICAgICAgICAgJ2xvY2FsZScKICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbJ2VtYWlsJ10sCiAgICAgICAgYWRkcmVzczogWydhZGRyZXNzJ10sCiAgICAgICAgcGhvbmU6IFsncGhvbmVfbnVtYmVyJ10KICAgIH0pOwoKICAgIC8qKgogICAgICogSW4gdGhpcyBzY3JpcHQsIGVhY2ggY2xhaW0KICAgICAqIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3BlcywKICAgICAqIHByb3ZpZGVkIGJ5IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciwgYW5kCiAgICAgKiByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudCB2aWEgdGhlIGNsYWltcyBwYXJhbWV0ZXIKICAgICAqIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IGEgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBjbGFpbSBuYW1lLgogICAgICoKICAgICAqIENhbGwgdGhpcyBjb25maWd1cmF0aW9uIG1ldGhvZCwgYW5kIHBhc3MgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50CiAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIGEgY2xhaW0gbmFtZSB0byBhIHJlc29sdmVyIGZ1bmN0aW9uLAogICAgICogd2hpY2ggd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGV4ZWN1dGVkIGZvciBlYWNoIGNsYWltIHByb2Nlc3NlZCBieSB0aGUgc2NyaXB0LgogICAgICoKICAgICAqIFRoZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB3aWxsIHJlY2VpdmUgdGhlIHJlcXVlc3RlZCBjbGFpbSBpbmZvcm1hdGlvbgogICAgICogaW4gYW4gaW5zdGFuY2Ugb2Ygb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4KICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9CiAgICAgKiBmb3IgZGV0YWlscyBvbiB0aGUgQ2xhaW0gY2xhc3MuCiAgICAgKgogICAgICogSWYgdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIHJldHVybnMgYSB2YWx1ZSwKICAgICAqIG90aGVyIHRoYW4gdW5kZWZpbmVkIG9yIG51bGwsCiAgICAgKiB0aGUgY2xhaW0gd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgc2NyaXB0J3MgcmVzdWx0cy4KICAgICAqCiAgICAgKiBUaGUgQ2xhaW0gaW5zdGFuY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBjaGVjawogICAgICogd2hhdCB0aGUgbmFtZSBvZiB0aGUgY2xhaW0gaXMsCiAgICAgKiB3aGljaCB2YWx1ZXMgdGhlIGNsYWltIHJlcXVlc3QgY29udGFpbnMsCiAgICAgKiB3aGV0aGVyIHRoZSBjbGFpbSBpcyBlc3NlbnRpYWwsIGFuZAogICAgICogd2hpY2ggbG9jYWxlIHRoZSBjbGFpbSBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKiBUaGUgcmVzb2x2ZXIgZnVuY3Rpb24gY2FuIGNvbnNpZGVyIHRoaXMgaW5mb3JtYXRpb24gd2hlbiBjb21wdXRpbmcgYW5kIHJldHVybmluZyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgKgogICAgICogQmVsb3csIGZpbmQgYSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gdGhhdCBpcyBleHBlY3RlZCB0byB3b3JrIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LgogICAgICogQSByZXVzYWJsZSBmdW5jdGlvbiwgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKFN0cmluZyBhdHRyaWJ1dGUtbmFtZSksCiAgICAgKiBpcyBjYWxsZWQgdG8gcmV0dXJuIGEgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICogQHNlZSBDTEFJTSBSRVNPTFZFUlMgc2VjdGlvbiBmb3IgdGhlIGltcGxlbWVudGF0aW9uIGRldGFpbHMgYW5kIGV4YW1wbGVzLgogICAgICogRm9yIHRoZSBhZGRyZXNzIGNsYWltLCBhbiBleGFtcGxlIG9mIGEgY2xhaW0gcmVzb2x2ZXIgdGhhdCB1c2VzIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIgaXMgcHJvdmlkZWQuCiAgICAgKgogICAgICogQ1VTVE9NSVpBVElPTgogICAgICogWW91IGNhbiByZXVzZSB0aGUgcHJlZGVmaW5lZCB1dGlscyBtZXRob2RzIHdpdGggeW91ciBjdXN0b20gYXJndW1lbnRzLgogICAgICogWW91IGNhbiBhbHNvIHNwZWNpZnkgYSBjdXN0b20gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIGEgY2xhaW0gbmFtZSwKICAgICAqIHRoYXQgd2lsbCBjb21wdXRlIGFuZCByZXR1cm4gdGhlIGNsYWltIHZhbHVl4oCUYXMgc2hvd24gaW4gdGhlIGNvbW1lbnRlZCBvdXQgZXhhbXBsZSBiZWxvdy4KICAgICAqLwogICAgdXRpbHMuc2V0Q2xhaW1SZXNvbHZlcnMoewogICAgICAgIC8qCiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiBhIHNpbXBsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbiB0aGF0IGlzIGRlZmluZWQgZm9yIGEgY2xhaW0KICAgICAgICAvLyBkaXJlY3RseSBpbiB0aGUgY29uZmlndXJhdGlvbiBvYmplY3Q6CiAgICAgICAgY3VzdG9tLWNsYWltLW5hbWU6IGZ1bmN0aW9uIChyZXF1ZXN0ZWRDbGFpbSkgewogICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGluaXRpYWxseSwgdGhlIGNsYWltIHZhbHVlIGNvbWVzIHN0cmFpZ2h0IGZyb20gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlOgogICAgICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgnY3VzdG9tLWF0dHJpYnV0ZS1uYW1lJykudG9BcnJheSgpWzBdCgogICAgICAgICAgICAvLyBPcHRpb25hbGx5LCBwcm92aWRlIGFkZGl0aW9uYWwgbG9naWMgZm9yIHByb2Nlc3NpbmcgKGZpbHRlcmluZywgZm9ybWF0dGluZywgZXRjLikgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAgICAvLyBZb3UgY2FuIHVzZToKICAgICAgICAgICAgLy8gcmVxdWVzdGVkQ2xhaW0uZ2V0TmFtZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldFZhbHVlcygpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmdldExvY2FsZSgpCiAgICAgICAgICAgIC8vIHJlcXVlc3RlZENsYWltLmlzRXNzZW50aWFsKCkKCiAgICAgICAgICAgIHJldHVybiBjbGFpbVZhbHVlCiAgICAgICAgfSwKICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1c2Ugb2YgdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIHNob3dzIGhvdwogICAgICAgICAqIGFuIGFyZ3VtZW50IHBhc3NlZCB0byBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNsYWltIHJlc29sdmVyCiAgICAgICAgICogYmVjb21lcyBhdmFpbGFibGUgdG8gdGhlIHJlc29sdmVyIGZ1bmN0aW9uICh2aWEgaXRzIGxleGljYWwgY29udGV4dCkuCiAgICAgICAgICovCiAgICAgICAgbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdjbicpLAogICAgICAgIGZhbWlseV9uYW1lOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3NuJyksCiAgICAgICAgZ2l2ZW5fbmFtZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdnaXZlbm5hbWUnKSwKICAgICAgICB6b25laW5mbzogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWR0aW1lem9uZScpLAogICAgICAgIGxvY2FsZTogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdwcmVmZXJyZWRsb2NhbGUnKSwKICAgICAgICBlbWFpbDogdXRpbHMuZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyKCdtYWlsJyksCiAgICAgICAgYWRkcmVzczogdXRpbHMuZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXIoCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBUaGUgcGFzc2VkIGluIHVzZXIgcHJvZmlsZSBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiBjYW4gYmUgdXNlZCBieSB0aGUgYWRkcmVzcyBjbGFpbSByZXNvbHZlciBmdW5jdGlvbgogICAgICAgICAgICAgKiB0byBvYnRhaW4gdGhlIGNsYWltIHZhbHVlIHRvIGJlIGZvcm1hdHRlZCBhcyBwZXIgdGhlIE9JREMgc3BlY2lmaWNhdGlvbjoKICAgICAgICAgICAgICogQHNlZSBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNBZGRyZXNzQ2xhaW0uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3Bvc3RhbGFkZHJlc3MnKQogICAgICAgICksCiAgICAgICAgcGhvbmVfbnVtYmVyOiB1dGlscy5nZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXIoJ3RlbGVwaG9uZW51bWJlcicpCiAgICB9KTsKCiAgICAvLyBDTEFJTSBQUk9DRVNTSU5HIFVUSUxJVElFUwoKICAgIC8qKgogICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgcmV1c2FibGUgY2xhaW0gcHJvY2Vzc2luZyB1dGlsaXRpZXMuCiAgICAgKiBAc2VlIFBVQkxJQyBNRVRIT0RTIHNlY3Rpb24gYW5kIHRoZSByZXR1cm4gc3RhdGVtZW50IGZvciB0aGUgbGlzdCBvZiBleHBvcnRlZCBmdW5jdGlvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFV0aWxzICgpIHsKICAgICAgICAvLyBJTVBPUlQgSkFWQQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm92aWRlcyBKYXZhIHNjcmlwdGluZyBmdW5jdGlvbmFsaXR5LgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9Qcm9qZWN0cy9SaGluby9TY3JpcHRpbmdfSmF2YSNqYXZhaW1wb3J0ZXJfY29uc3RydWN0b3J9LgogICAgICAgICAqLwogICAgICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgICAgIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiwKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcywKICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltLAoKICAgICAgICAgICAgamF2YS51dGlsLkxpbmtlZEhhc2hNYXAsCiAgICAgICAgICAgIGphdmEudXRpbC5BcnJheUxpc3QKICAgICAgICApOwoKICAgICAgICAvLyBTRVQgVVAgQ09ORklHVVJBVElPTgoKICAgICAgICAvKioKICAgICAgICAgKiBQbGFjZWhvbGRlciBmb3IgYSBjb25maWd1cmF0aW9uIG9wdGlvbiB0aGF0IGNvbnRhaW5zCiAgICAgICAgICogYW4gb2JqZWN0IHRoYXQgbWFwcyB0aGUgc3VwcG9ydGVkIHNjb3BlIHZhbHVlcyAoc2NvcGVzKQogICAgICAgICAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjbGFpbSBuYW1lcyBmb3IgZWFjaCBzY29wZSB2YWx1ZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgc2NvcGVDbGFpbXNNYXA7CgogICAgICAgIC8qKgogICAgICAgICAqIFBsYWNlaG9sZGVyIGZvciBhIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRoYXQgY29udGFpbnMKICAgICAgICAgKiBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLgogICAgICAgICAqLwogICAgICAgIHZhciBjbGFpbVJlc29sdmVyczsKCiAgICAgICAgLyoqCiAgICAgICAgICogQSAocHVibGljKSBtZXRob2QgdGhhdCBhY2NlcHRzIGFuIG9iamVjdCB0aGF0IG1hcHMgdGhlIHN1cHBvcnRlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMgZWFjaCBzdXBwb3J0ZWQgc2NvcGUgdmFsdWUgdG8gYW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMsCiAgICAgICAgICogaW4gb3JkZXIgdG8gc3BlY2lmeSB3aGljaCBjbGFpbXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZm9yIHRoZSByZXF1ZXN0ZWQgc2NvcGVzLgogICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Njb3BlQ2xhaW1zfSBmb3IgZGV0YWlscy4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLnByb2ZpbGVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHByb2ZpbGUgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMuZW1haWxdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGVtYWlsIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbcGFyYW1zLmFkZHJlc3NdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIGFkZHJlc3Mgc2NvcGUgaXMgcmVxdWVzdGVkLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtwYXJhbXMucGhvbmVdIC0gQW4gYXJyYXkgb2YgY2xhaW0gbmFtZXMgdG8gYmUgcmV0dXJuZWQgaWYgdGhlIHBob25lIHNjb3BlIGlzIHJlcXVlc3RlZC4KICAgICAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHNldFNjb3BlQ2xhaW1zTWFwKHBhcmFtcykgewogICAgICAgICAgICBzY29wZUNsYWltc01hcCA9IHBhcmFtczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEEgKHB1YmxpYykgbWV0aG9kIHRoYXQgYWNjZXB0cyBhbiBvYmplY3QgdGhhdCBtYXBzIHRoZSBzdXBwb3J0ZWQgY2xhaW0gbmFtZXMKICAgICAgICAgKiBhbmQgdGhlIHJlc29sdmVyIGZ1bmN0aW9ucyByZXR1cm5pbmcgdGhlIGNsYWltIHZhbHVlLAogICAgICAgICAqIGFuZCBhc3NpZ25zIGl0IHRvIGEgKHByaXZhdGUpIHZhcmlhYmxlIHRoYXQgc2VydmVzIGFzIGEgY29uZmlndXJhdGlvbiBvcHRpb24uCiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB0aGF0IG1hcHMKICAgICAgICAgKiBlYWNoIHN1cHBvcnRlZCBjbGFpbSBuYW1lIHRvIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhbmQgcmV0dXJucyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gc2V0Q2xhaW1SZXNvbHZlcnMocGFyYW1zKSB7CiAgICAgICAgICAgIGNsYWltUmVzb2x2ZXJzID0gcGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgLy8gQ0xBSU0gUkVTT0xWRVJTCgogICAgICAgIC8qKgogICAgICAgICAqIENsYWltIHJlc29sdmVycyBhcmUgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHBhcmFtIHsqfQogICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAqLwoKICAgICAgICAvKioKICAgICAgICAgKiBEZWZpbmVzIGEgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlLgogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC0gTmFtZSBvZiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGRldGVybWluZSB0aGUgY2xhaW0gdmFsdWUKICAgICAgICAgKiBiYXNlZCBvbiB0aGUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZSBhbmQgdGhlIChyZXF1ZXN0ZWQpIGNsYWltIHByb3BlcnRpZXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGVDbGFpbVJlc29sdmVyIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXNvbHZlcyBhIGNsYWltIHdpdGggYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAgICAgKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaWRlbnRpdHkgYXR0cmlidXRlIGlzIG5vdCBwb3B1bGF0ZWQsCiAgICAgICAgICAgICAqIE9SIGlmIHRoZSBjbGFpbSBoYXMgcmVxdWVzdGVkIHZhbHVlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgICAgICAgICAqIEFUVEVOVElPTjogdGhlIGFmb3JlbWVudGlvbmVkIGNvbXBhcmlzb24gaXMgY2FzZS1zZW5zaXRpdmUuCiAgICAgICAgICAgICAqIEBwYXJhbSB7b3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltfSBjbGFpbQogICAgICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciBkZXRhaWxzLgogICAgICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfEhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUNsYWltKGNsYWltKSB7CiAgICAgICAgICAgICAgICB2YXIgdXNlclByb2ZpbGVWYWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyUHJvZmlsZVZhbHVlID0gZ2V0Q2xhaW1WYWx1ZUZyb21TZXQoY2xhaW0sIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICYmICF1c2VyUHJvZmlsZVZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYWltLmdldFZhbHVlcygpIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9maWxlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIGFuIGFkZHJlc3MgY2xhaW0gcmVzb2x2ZXIgYmFzZWQgb24gYSBjbGFpbSB2YWx1ZSBvYnRhaW5lZCB3aXRoIGFub3RoZXIgY2xhaW0gcmVzb2x2ZXIuCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVzb2x2ZUNsYWltIC0gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB3aWxsIGFjY2VwdCBhIGNsYWltIGFzIGFuIGFyZ3VtZW50LAogICAgICAgICAqIHJ1biB0aGUgY2xhaW0gcmVzb2x2ZXIgZnVuY3Rpb24gZm9yIHRoZSBjbGFpbSBhbmQgb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwKICAgICAgICAgKiBhbmQgYXBwbHkgYWRkaXRpb25hbCBmb3JtYXR0aW5nIHRvIHRoZSB2YWx1ZSBiZWZvcmUgcmV0dXJuaW5nIGl0LgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NDbGFpbVJlc29sdmVyIChyZXNvbHZlQ2xhaW0pIHsKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIENyZWF0ZXMgYW4gYWRkcmVzcyBjbGFpbSBvYmplY3QgZnJvbSBhIHZhbHVlIHJldHVybmVkIGJ5IGEgY2xhaW0gcmVzb2x2ZXIsCiAgICAgICAgICAgICAqIGFuZCByZXR1cm5zIHRoZSBhZGRyZXNzIGNsYWltIG9iamVjdCBhcyB0aGUgY2xhaW0gdmFsdWUuCiAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0FkZHJlc3NDbGFpbX0uCiAgICAgICAgICAgICAqIFRoZSBjbGFpbSB2YWx1ZSBpcyBvYnRhaW5lZCB3aXRoIGEgY2xhaW0gcmVzb2x2aW5nIGZ1bmN0aW9uIGF2YWlsYWJsZSBmcm9tIHRoZSBjbG9zdXJlLgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfHVuZGVmaW5lZH0gVGhlIGFkZHJlc3MgY2xhaW0gb2JqZWN0IGNyZWF0ZWQgZnJvbSBhIGNsYWltIHZhbHVlLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgdmFyIGFkZHJlc3NPYmplY3Q7CgogICAgICAgICAgICAgICAgaWYgKGlzQ2xhaW1WYWx1ZVZhbGlkKGNsYWltVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc09iamVjdCA9IG5ldyBmckphdmEuTGlua2VkSGFzaE1hcCgpOwoKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzT2JqZWN0LnB1dCgnZm9ybWF0dGVkJywgY2xhaW1WYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRyZXNzT2JqZWN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZUFkZHJlc3NDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gZXNzZW50aWFsIGNsYWltIHJlc29sdmVyIGJhc2VkIG9uIGEgY2xhaW0gdmFsdWUgb2J0YWluZWQgd2l0aCBhbm90aGVyIGNsYWltIHJlc29sdmVyLgogICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVDbGFpbSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgY2xhaW0gdmFsdWUuCiAgICAgICAgICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBhY2NlcHQgYSBjbGFpbSBhcyBhbiBhcmd1bWVudCwKICAgICAgICAgKiBydW4gdGhlIGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uIGZvciB0aGUgY2xhaW0gYW5kIG9idGFpbiB0aGUgY2xhaW0gdmFsdWUsCiAgICAgICAgICogYW5kIGFwcGx5IGFkZGl0aW9uYWwgbG9naWMgZm9yIGVzc2VudGlhbCBjbGFpbXMuCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0RXNzZW50aWFsQ2xhaW1SZXNvbHZlciAocmVzb2x2ZUNsYWltKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBSZXR1cm5zIGEgY2xhaW0gdmFsdWUgb3IgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgICAgKiBUaGUgY2xhaW0gdmFsdWUgaXMgb2J0YWluZWQgd2l0aCBhIGNsYWltIHJlc29sdmluZyBmdW5jdGlvbiBhdmFpbGFibGUgZnJvbSB0aGUgY2xvc3VyZS4KICAgICAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgY2xhaW0gaXMgZXNzZW50aWFsIGFuZCBubyB2YWx1ZSBpcyByZXR1cm5lZCBmb3IgdGhlIGNsYWltLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBVc2Ugb2YgdGhpcyByZXNvbHZlciBpcyBvcHRpb25hbC4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjSW5kaXZpZHVhbENsYWltc1JlcXVlc3RzfSBzdGF0aW5nOgogICAgICAgICAgICAgKiAiTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIENsYWltcyBhcmUgbm90IGF2YWlsYWJsZSBiZWNhdXNlIHRoZSBFbmQtVXNlciBkaWQgbm90IGF1dGhvcml6ZSB0aGVpciByZWxlYXNlIG9yIHRoZXkgYXJlIG5vdCBwcmVzZW50LAogICAgICAgICAgICAgKiB0aGUgQXV0aG9yaXphdGlvbiBTZXJ2ZXIgTVVTVCBOT1QgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBDbGFpbXMgYXJlIG5vdCByZXR1cm5lZCwgd2hldGhlciB0aGV5IGFyZSBFc3NlbnRpYWwgb3IgVm9sdW50YXJ5LAogICAgICAgICAgICAgKiB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZCBpbiB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHNwZWNpZmljIGNsYWltLiIKICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHBhcmFtIHtvcmcuZm9yZ2Vyb2NrLm9wZW5pZGNvbm5lY3QuQ2xhaW19IGNsYWltCiAgICAgICAgICAgICAqIEFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIG1ldGhvZHMgdG8gb2J0YWluIGluZm9ybWF0aW9uL3JlcXVpcmVtZW50cyBhc3NvY2lhdGVkIHdpdGggYSBjbGFpbS4KICAgICAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICAgICAqIEByZXR1cm5zIHsqfQogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRXNzZW50aWFsQ2xhaW0oY2xhaW0pIHsKICAgICAgICAgICAgICAgIHZhciBjbGFpbVZhbHVlID0gcmVzb2x2ZUNsYWltKGNsYWltKTsKCiAgICAgICAgICAgICAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAhaXNDbGFpbVZhbHVlVmFsaWQoY2xhaW1WYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZnJKYXZhLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uKCdDb3VsZCBub3QgcHJvdmlkZSB2YWx1ZSBmb3IgZXNzZW50aWFsIGNsYWltOiAnICsgY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1WYWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVFc3NlbnRpYWxDbGFpbTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFByb3ZpZGVzIGRlZmF1bHQgcmVzb2x1dGlvbiBmb3IgYSBjbGFpbS4KICAgICAgICAgKiBVc2UgaXQgaWYgYSBjbGFpbS1zcGVjaWZpYyByZXNvbHZlciBpcyBub3QgZGVmaW5lZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHJldHVybnMgeyp9IEEgc2luZ2xlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNsYWltLgogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIHJlc29sdmVBbnlDbGFpbSAoY2xhaW0pIHsKICAgICAgICAgICAgaWYgKGNsYWltLmdldFZhbHVlcygpLnNpemUoKSA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGNsYWltLmdldFZhbHVlcygpLnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVVRJTElUSUVTCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgY2xhaW0gdmFsdWUgZnJvbSBhIHNldC4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIGEgc2luZ2xlIHZhbHVlLCByZXR1cm5zIHRoZSB2YWx1ZS4KICAgICAgICAgKiBJZiB0aGUgc2V0IGNvbnRhaW5zIG11bHRpcGxlIHZhbHVlcywgcmV0dXJucyB0aGUgc2V0LgogICAgICAgICAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgKiBBbiBvYmplY3QgdGhhdCBwcm92aWRlcyBtZXRob2RzIHRvIG9idGFpbiBpbmZvcm1hdGlvbi9yZXF1aXJlbWVudHMgYXNzb2NpYXRlZCB3aXRoIGEgY2xhaW0uCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29wZW5pZGNvbm5lY3QvQ2xhaW0uaHRtbH0gZm9yIGRldGFpbHMuCiAgICAgICAgICogQHBhcmFtIHtqYXZhLnV0aWwuSGFzaFNldH0gc2V0IFRoZSBzZXTigJRmb3IgZXhhbXBsZSwgYSB1c2VyIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlLgogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd8amF2YS51dGlsLkhhc2hTZXR8dW5kZWZpbmVkfQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIGdldENsYWltVmFsdWVGcm9tU2V0IChjbGFpbSwgc2V0KSB7CiAgICAgICAgICAgIGlmIChzZXQgJiYgc2V0LnNpemUoKSkgewogICAgICAgICAgICAgICAgaWYgKHNldC5zaXplKCkgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0LnRvQXJyYXkoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ09JREMgQ2xhaW1zIHNjcmlwdC4gR290IGFuIGVtcHR5IHNldCBmb3IgY2xhaW06ICcgKyBjbGFpbS5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsYWltVmFsdWVWYWxpZCAoY2xhaW1WYWx1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGNsYWltVmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IGNsYWltVmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBDTEFJTSBQUk9DRVNTSU5HCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdHMgYW5kIHJldHVybnMgYW4gb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMKICAgICAgICAgKiBhbmQgdGhlIHJlcXVlc3RlZCBzY29wZXMgbWFwcGVkIHRvIHRoZSBjbGFpbSBuYW1lcy4KICAgICAgICAgKiBAcmV0dXJucyB7b3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltc30gVGhlIG9iamVjdCB0byBiZSByZXR1cm5lZCB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIuCiAgICAgICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICAgICAqIEBzZWUgUkVTVUxUUyBzZWN0aW9uIGZvciB0aGUgdXNlIG9mIHRoaXMgZnVuY3Rpb24uCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckluZm9DbGFpbXMgKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IGZySmF2YS5Vc2VySW5mb0NsYWltcyhnZXRDb21wdXRlZENsYWltcygpLCBnZXRDb21wb3NpdGVTY29wZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIChyZXF1ZXN0ZWQpIGNsYWltIG5hbWVzIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMuCiAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5MaW5rZWRIYXNoTWFwfQogICAgICAgICAqIEEgbWFwIG9mIHRoZSByZXF1ZXN0ZWQgY2xhaW0gbmFtZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIHZhbHVlcy4KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wdXRlZENsYWltcyAoKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBDcmVhdGVzIGEgY29tcGxldGUgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZyb206CiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgZGVyaXZlZCBmcm9tIHRoZSBzY29wZXMsCiAgICAgICAgICAgICAqIHRoZSBjbGFpbXMgcHJvdmlkZWQgYnkgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLAogICAgICAgICAgICAgKiBhbmQgdGhlIGNsYWltcyByZXF1ZXN0ZWQgYnkgdGhlIGNsaWVudC4KICAgICAgICAgICAgICogQHJldHVybnMge2phdmEudXRpbC5BcnJheUxpc3R9CiAgICAgICAgICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGF2YWlsYWJsZSB0byB0aGUgc2NyaXB0LgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgdGhlIGNsYWltIG9iamVjdCBkZXRhaWxzLgogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhaW1zKCkgewogICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBjbGFpbSBvYmplY3RzIGZvciB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIFVzZXMgdGhlIHNjb3BlQ2xhaW1zTWFwIGNvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRlcml2ZSB0aGUgY2xhaW0gbmFtZXM7CiAgICAgICAgICAgICAgICAgKiBubyBvdGhlciBwcm9wZXJ0aWVzIG9mIGEgY2xhaW0gZGVyaXZlZCBmcm9tIGEgc2NvcGUgYXJlIHBvcHVsYXRlZC4KICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuQXJyYXlMaXN0fQogICAgICAgICAgICAgICAgICogQSBsaXN0IG9mIG9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbSBvYmplY3RzIGRlcml2ZWQgZnJvbSB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICAgICAgICAgICAgICAgICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9vcGVuaWRjb25uZWN0L0NsYWltLmh0bWx9IGZvciB0aGUgY2xhaW0gb2JqZWN0IGRldGFpbHMuCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRTY29wZVRvQ2xhaW1zKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoc2NvcGUpICE9PSAnb3BlbmlkJyAmJiBzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zTWFwW3Njb3BlXS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFpbXMuYWRkKG5ldyBmckphdmEuQ2xhaW0oY2xhaW1OYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBjbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGNsYWltcy5hZGRBbGwoY29udmVydFNjb3BlVG9DbGFpbXMoKSk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKGNsYWltT2JqZWN0cyk7CiAgICAgICAgICAgICAgICBjbGFpbXMuYWRkQWxsKHJlcXVlc3RlZFR5cGVkQ2xhaW1zKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY2xhaW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQ29tcHV0ZXMgYW5kIHJldHVybnMgYSBjbGFpbSB2YWx1ZS4KICAgICAgICAgICAgICogVG8gb2J0YWluIHRoZSBjbGFpbSB2YWx1ZSwgdXNlcyB0aGUgcmVzb2x2ZXIgZnVuY3Rpb24gc3BlY2lmaWVkIGZvciB0aGUgY2xhaW0gaW4gdGhlIGNsYWltUmVzb2x2ZXJzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LgogICAgICAgICAgICAgKiBAc2VlIGNsYWltUmVzb2x2ZXJzCiAgICAgICAgICAgICAqIElmIG5vIHJlc29sdmVyIGZ1bmN0aW9uIGlzIGZvdW5kLCB1c2VzIHRoZSBkZWZhdWx0IGNsYWltIHJlc29sdmVyIGZ1bmN0aW9uLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAcGFyYW0ge29yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5DbGFpbX0gY2xhaW0KICAgICAgICAgICAgICogQW4gb2JqZWN0IHRoYXQgcHJvdmlkZXMgbWV0aG9kcyB0byBvYnRhaW4gaW5mb3JtYXRpb24vcmVxdWlyZW1lbnRzIGFzc29jaWF0ZWQgd2l0aCBhIGNsYWltLgogICAgICAgICAgICAgKiBAc2VlIHtAbGluayBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb3BlbmlkY29ubmVjdC9DbGFpbS5odG1sfSBmb3IgZGV0YWlscy4KICAgICAgICAgICAgICogQHJldHVybnMgeyp9IENsYWltIHZhbHVlLgogICAgICAgICAgICAgKiBAdGhyb3dzIHtvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLmV4Y2VwdGlvbnMuSW52YWxpZFJlcXVlc3RFeGNlcHRpb259CiAgICAgICAgICAgICAqIFJldGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIGEgY2xhaW0gcmVzb2x2ZXIgdGhyb3dzIGl0LgogICAgICAgICAgICAgKiBZb3UgY2FuIHRocm93IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbiBmcm9tIHlvdXIgY3VzdG9tIGNsYWltIHJlc29sdmVyCiAgICAgICAgICAgICAqIGlmIHlvdSB3YW50IHRvIHRlcm1pbmF0ZSB0aGUgY2xhaW0gcHJvY2Vzc2luZy4KICAgICAgICAgICAgICovCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGFpbShjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIHJlc29sdmVDbGFpbTsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNsYWltID0gY2xhaW1SZXNvbHZlcnNbY2xhaW0uZ2V0TmFtZSgpXSB8fCByZXNvbHZlQW55Q2xhaW07CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlQ2xhaW0oY2xhaW0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnT0lEQyBDbGFpbXMgc2NyaXB0IGV4Y2VwdGlvbi4gVW5hYmxlIHRvIHJlc29sdmUgT0lEQyBDbGFpbS4gJyArIGU7CgogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcoZSkuaW5kZXhPZignb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5leGNlcHRpb25zLkludmFsaWRSZXF1ZXN0RXhjZXB0aW9uJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29tcHV0ZWRDbGFpbXMgPSBuZXcgZnJKYXZhLkxpbmtlZEhhc2hNYXAoKTsKCiAgICAgICAgICAgIGdldENsYWltcygpLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFpbSkgewogICAgICAgICAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBjb21wdXRlQ2xhaW0oY2xhaW0pOwoKICAgICAgICAgICAgICAgIGlmIChpc0NsYWltVmFsdWVWYWxpZChjbGFpbVZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkQ2xhaW1zLnB1dChjbGFpbS5nZXROYW1lKCksIGNsYWltVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBJZiBhIGNsYWltIGhhcyBiZWVuIHByb2Nlc3NlZCwgYnV0IGFwcGVhcnMgaW4gdGhlIGxpc3QgYWdhaW4sCiAgICAgICAgICAgICAgICAgICAgICogYW5kIGl0cyB2YWx1ZSBjYW5ub3QgYmUgY29tcHV0ZWQgdW5kZXIgdGhlIG5ldyBjb25kaXRpb25zLAogICAgICAgICAgICAgICAgICAgICAqIHRoZSBjbGFpbSBpcyByZW1vdmVkIGZyb20gdGhlIGZpbmFsIHJlc3VsdC4KICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAqIEZvciBleGFtcGxlLCBhIGNsYWltIGNvdWxkIGJlIG1hcHBlZCB0byBhIHNjb3BlIGFuZCBmb3VuZCBpbiB0aGUgdXNlciBwcm9maWxlLAogICAgICAgICAgICAgICAgICAgICAqIGJ1dCBhbHNvIHJlcXVlc3RlZCBieSB0aGUgY2xpZW50IHdpdGggcmVxdWlyZWQgdmFsdWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGNvbXB1dGVkIG9uZS4KICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIHtsaW5rIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI0luZGl2aWR1YWxDbGFpbXNSZXF1ZXN0c30uCiAgICAgICAgICAgICAgICAgICAgICogZm9yIHRoZSByZWxldmFudCBPSURDIHNwZWNpZmljYXRpb24gZGV0YWlscy4KICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBjb21wdXRlZENsYWltcy5yZW1vdmUoY2xhaW0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gY29tcHV0ZWRDbGFpbXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIGEgbWFwIG9mIHJlcXVlc3RlZCBzY29wZXMgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGNsYWltIG5hbWVzLgogICAgICAgICAqIEByZXR1cm5zIHtqYXZhLnV0aWwuTGlua2VkSGFzaE1hcH0KICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBnZXRDb21wb3NpdGVTY29wZXMgKCkgewogICAgICAgICAgICB2YXIgY29tcG9zaXRlU2NvcGVzID0gbmV3IGZySmF2YS5MaW5rZWRIYXNoTWFwKCk7CgogICAgICAgICAgICBzY29wZXMudG9BcnJheSgpLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NvcGVDbGFpbXMgPSBuZXcgZnJKYXZhLkFycmF5TGlzdCgpOwoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltc01hcFtzY29wZV0pIHsKICAgICAgICAgICAgICAgICAgICBzY29wZUNsYWltc01hcFtzY29wZV0uZm9yRWFjaChmdW5jdGlvbiAoY2xhaW1OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlQ2xhaW1zLmFkZChjbGFpbU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzY29wZUNsYWltcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTY29wZXMucHV0KHNjb3BlLCBzY29wZUNsYWltcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVNjb3BlczsKICAgICAgICB9CgogICAgICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNldFNjb3BlQ2xhaW1zTWFwOiBzZXRTY29wZUNsYWltc01hcCwKICAgICAgICAgICAgc2V0Q2xhaW1SZXNvbHZlcnM6IHNldENsYWltUmVzb2x2ZXJzLAogICAgICAgICAgICBnZXRVc2VyUHJvZmlsZUNsYWltUmVzb2x2ZXI6IGdldFVzZXJQcm9maWxlQ2xhaW1SZXNvbHZlciwKICAgICAgICAgICAgZ2V0QWRkcmVzc0NsYWltUmVzb2x2ZXI6IGdldEFkZHJlc3NDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyOiBnZXRFc3NlbnRpYWxDbGFpbVJlc29sdmVyLAogICAgICAgICAgICBnZXRVc2VySW5mb0NsYWltczogZ2V0VXNlckluZm9DbGFpbXMKICAgICAgICB9OwogICAgfQoKICAgIC8vIFJFU1VMVFMKCiAgICAvKioKICAgICAqIFRoaXMgc2NyaXB0IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuVXNlckluZm9DbGFpbXMgY2xhc3MKICAgICAqIHBvcHVsYXRlZCB3aXRoIHRoZSBjb21wdXRlZCBjbGFpbSB2YWx1ZXMgYW5kCiAgICAgKiB0aGUgcmVxdWVzdGVkIHNjb3BlcyBtYXBwZWQgdG8gdGhlIGNsYWltIG5hbWVzLgogICAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9vcmcvZm9yZ2Vyb2NrL29hdXRoMi9jb3JlL1VzZXJJbmZvQ2xhaW1zLmh0bWx9LgogICAgICoKICAgICAqIEFzc2lnbmluZyBpdCB0byBhIHZhcmlhYmxlIGdpdmVzIHlvdSBhbiBvcHBvcnR1bml0eQogICAgICogdG8gbG9nIHRoZSBjb250ZW50IG9mIHRoZSByZXR1cm5lZCB2YWx1ZSBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgKi8KICAgIHZhciB1c2VySW5mb0NsYWltcyA9IHV0aWxzLmdldFVzZXJJbmZvQ2xhaW1zKCk7CgogICAgLyoKICAgIGxvZ2dlci5lcnJvcihzY3JpcHROYW1lICsgJyByZXN1bHRzOicpCiAgICBsb2dnZXIuZXJyb3IoJ1ZhbHVlczogJyArIHVzZXJJbmZvQ2xhaW1zLmdldFZhbHVlcygpKQogICAgbG9nZ2VyLmVycm9yKCdTY29wZXM6ICcgKyB1c2VySW5mb0NsYWltcy5nZXRDb21wb3NpdGVTY29wZXMoKSkKICAgICovCgogICAgcmV0dXJuIHVzZXJJbmZvQ2xhaW1zOwp9KCkpOw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OIDC_CLAIMS\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.086Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c122e0c34632754298c1cf3d78d7a86f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"WordPress Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22WordPress%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1473,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1473,
            "text": "{\"result\":[{\"_id\":\"91d197de-5916-4dca-83b5-9a4df26e7159\",\"name\":\"WordPress Profile Normalization\",\"description\":\"Normalizes raw profile data from WordPress\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnVzZXJuYW1lKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmRpc3BsYXlfbmFtZSksCiAgICAgICAgZmllbGQoInBob3RvVXJsIiwgcmF3UHJvZmlsZS5hdmF0YXJfVVJMKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnVzZXJuYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1473"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.125Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "10ae4a1c921be42237a2014dfae60bb0",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"deviceprofile_to_attribute\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22deviceprofile_to_attribute%22"
        },
        "response": {
          "bodySize": 1647,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1647,
            "text": "{\"result\":[{\"_id\":\"123725a9-2119-4efd-a6b0-456f3ccd34b7\",\"name\":\"deviceprofile_to_attribute\",\"description\":\"null\",\"script\":\"dmFyIG9iamVjdEF0dHJpYnV0ZXMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKdmFyIGRldmljZUhhc2ggPSBzaGFyZWRTdGF0ZS5nZXQoImRldmljZUhhc2giKTsKCnNoYXJlZFN0YXRlLnB1dCgiZnJJbmRleGVkU3RyaW5nMSIgLCBkZXZpY2VIYXNoICk7CgoKCmlmKG9iamVjdEF0dHJpYnV0ZXMgPT09IG51bGwgfHwgb2JqZWN0QXR0cmlidXRlcyA9PT0gdW5kZWZpbmVkKQp7CgoKIG9iamVjdEF0dHJpYnV0ZXMgPSB7CiAgIAkJCQkJICJ1c2VyTmFtZSIgOiAiYW5vbi0iLmNvbmNhdChkZXZpY2VIYXNoKSwKICAgICAgICAgICAgICAgICAgICAgImdpdmVuTmFtZSIgOiAiICIsCiAgICAgICAgICAgICAgICAgICAgICJzbiIgOiAiICIsCiAgICAgICAgICAgICAgICAgICAgICJtYWlsIiA6ICJhbm9uLSIuY29uY2F0KGRldmljZUhhc2gpLmNvbmNhdCgiQG15dGVzdHJ1bi5jb20iKSwKICAgICAgICAgICAgICAgICAgICAgImZySW5kZXhlZFN0cmluZzEiIDogZGV2aWNlSGFzaAogICAgICAgICAgICAgICAgICAgIH0KfQplbHNlCnsKCiAgICBvYmplY3RBdHRyaWJ1dGVzLnB1dCgidXNlck5hbWUiLCAgImFub24tIi5jb25jYXQoZGV2aWNlSGFzaCkpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoImdpdmVuTmFtZSIsICIgIik7CiAgICBvYmplY3RBdHRyaWJ1dGVzLnB1dCgic24iLCAiICIpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoIm1haWwiLCAiYW5vbi0iLmNvbmNhdChkZXZpY2VIYXNoKS5jb25jYXQoIkBteXRlc3RydW4uY29tIikpOwogICAgb2JqZWN0QXR0cmlidXRlcy5wdXQoImZySW5kZXhlZFN0cmluZzEiLCBkZXZpY2VIYXNoKTsKICAgCn0KCgpzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLG9iamVjdEF0dHJpYnV0ZXMpOwogICAgCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1647"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.164Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "4734b76a1e4e881d4ce7eceb872bbe83",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 607,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Impersonate: Switch Actors And Become Impersonatee\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Impersonate%3A%20Switch%20Actors%20And%20Become%20Impersonatee%22"
        },
        "response": {
          "bodySize": 2133,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2133,
            "text": "{\"result\":[{\"_id\":\"878816b3-2bb4-4b43-8001-10f926ddefff\",\"name\":\"Impersonate: Switch Actors And Become Impersonatee\",\"description\":\"Switch Actors And Become Impersonatee.\",\"script\":\"LyogSW1wZXJzb25hdGU6IFN3aXRjaCBBY3RvcnMgQW5kIEJlY29tZSBJbXBlcnNvbmF0ZWUKICoKICogU3dpdGNoIEFjdG9ycyBBbmQgQmVjb21lIEltcGVyc29uYXRlZS4KICoKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8KCihmdW5jdGlvbiAoKSB7CiAgICBsb2dnZXIud2FybmluZygiSW1wZXJzb25hdGU6IFN3aXRjaCBBY3RvcnM6IHN0YXJ0Iik7CiAgICBvdXRjb21lID0gImZhbHNlIjsKCiAgICB2YXIgaW1wZXJzb25hdGVlID0gc2hhcmVkU3RhdGUuZ2V0KCJpbXBlcnNvbmF0ZWUiKTsKICAgIHZhciBpbXBlcnNvbmF0b3IgPSBzaGFyZWRTdGF0ZS5nZXQoImltcGVyc29uYXRvciIpOwogICAgaWYgKGltcGVyc29uYXRlZSAmJiBpbXBlcnNvbmF0b3IpIHsKICAgICAgICBvdXRjb21lID0gInRydWUiOwogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBpbXBlcnNvbmF0ZWUpOwogICAgICAgIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCBpbXBlcnNvbmF0ZWUpOwogICAgfQoKICAgIGxvZ2dlci53YXJuaW5nKCJJbXBlcnNvbmF0ZTogU3dpdGNoIEFjdG9yczogZmluaXNoIFtvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiXSIpKTsKICAKICAgIC8qCiAgICAgKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogICAgICAgICB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChzdG9yYWdlLnB1dCkgewogICAgICAgICAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgICAgICB9CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2133"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.204Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "cb7ab2bd3d6073662120e7a4de4b467c",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"iddataweb Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22iddataweb%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 4163,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4163,
            "text": "{\"result\":[{\"_id\":\"2997bd4d-14be-4dc6-8701-27f08d10b8b7\",\"name\":\"iddataweb Profile Normalization\",\"description\":\"Profile Normalization Script for idddataweb\",\"script\":\"LyovKgogKiBDb3B5cmlnaHQgMjAyMiBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4gTm90IGZvciBQcm9kdWN0aW9uIHVzZS4gCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICovCi8qIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdCBmb3IgSUQgRGF0YVdlYiAqLwppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKbG9nZ2VyLmVycm9yKCJpZGRhdGF3ZWJfU29jaWFsIElkZW50aXR5IFByb3ZpZGVyIFByb2ZpbGUgVHJhbnNmb3JtYXRpb24gc2NyaXB0OiBTdGFydCIpOwp1c2VyTmFtZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldCgibWFpbCIpOwpsb2dnZXIuZXJyb3IoImlkZGF0YXdlYl9Tb2NpYWwgSWRlbnRpdHkgUHJvdmlkZXIgUHJvZmlsZSBUcmFuc2Zvcm1hdGlvbiBzY3JpcHQ6IHVzZXJOYW1lIiArIHVzZXJOYW1lICk7CnVzZXJuYW1lID0gdXNlck5hbWU7CnNoYXJlZFN0YXRlLnB1dCgidXNlck5hbWUiLCB1c2VyTmFtZSk7CgpyZXR1cm4ganNvbihvYmplY3QoCiAgICAgICAgZmllbGQoImlkIiwgcmF3UHJvZmlsZS5zdWIpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfZm5hbWUuYXNTdHJpbmcoKSArICIgIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmNhcGl0YWxpemUoKSApLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEZ1bGxOYW1lX2ZuYW1lLmFzU3RyaW5nKCkudG9Mb3dlckNhc2UoKS5jYXBpdGFsaXplKCkgKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmNhcGl0YWxpemUoKSApLAogICAgICAgIGZpZWxkKCJwb3N0YWxBZGRyZXNzIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2FkZHJlc3MpLAogICAgICAgIGZpZWxkKCJhZGRyZXNzTG9jYWxpdHkiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEFkZHJlc3NfbG9jYWxpdHkpLAogICAgICAgIGZpZWxkKCJhZGRyZXNzUmVnaW9uIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSksCiAgICAgICAgZmllbGQoInBvc3RhbENvZGUiLCByYXdQcm9maWxlLmFjcXVpcmVkQXR0cmlidXRlc19BY3F1aXJlZEFkZHJlc3NfcG9zdGFsX2NvZGUpLAogICAgICAgIGZpZWxkKCJjb3VudHJ5IiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRBZGRyZXNzX2NvdW50cnkpLAogICAgICAgIGZpZWxkKCJkcml2ZXJzTGljZW5zZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRHJpdmVyc0xpY2Vuc2VOdW1iZXJfYWNxdWlyZWREcml2ZXJzTGljZW5zZU51bWJlciksCiAgICAgICAgZmllbGQoImRyaXZlcnNMaWNlbnNlSXNzdWVyIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfRHJpdmVyc0xpY2Vuc2VJc3N1ZXJDb2RlX0RyaXZlcnNMaWNlbnNlSXNzdWVyQ29kZSksCiAgCQlmaWVsZCgiRE9CIiwgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRET0JfbW9udGguYXNTdHJpbmcoKSArICIvIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRE9CX2RheS5hc1N0cmluZygpICsgIi8iICsgcmF3UHJvZmlsZS5hY3F1aXJlZEF0dHJpYnV0ZXNfQWNxdWlyZWRET0JfeWVhci5hc1N0cmluZygpICksCgogICAgICAgIGZpZWxkKCJJRFdTY29yZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0lEV1Njb3JlKSwKICAgICAgICBmaWVsZCgicG9saWN5RGVjaXNpb24iLCByYXdQcm9maWxlLnBvbGljeURlY2lzaW9uX2NvbmNsdXNpb24pLAogICAgICAgIGZpZWxkKCJwaG9uZSIsIHJhd1Byb2ZpbGUudXNlckF0dHJpYnV0ZXNfSW50ZXJuYXRpb25hbFRlbGVwaG9uZV9kaWFsQ29kZS5hc1N0cmluZygpICsgcmF3UHJvZmlsZS51c2VyQXR0cmlidXRlc19JbnRlcm5hdGlvbmFsVGVsZXBob25lX3RlbGVwaG9uZS5hc1N0cmluZygpKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCB1c2VyTmFtZSApCiAgICAgICAvL2ZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfZm5hbWUuYXNTdHJpbmcoKSArICIuIiArIHJhd1Byb2ZpbGUuYWNxdWlyZWRBdHRyaWJ1dGVzX0FjcXVpcmVkRnVsbE5hbWVfbG5hbWUuYXNTdHJpbmcoKSApCgogICApCikK\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4163"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.241Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "85b51cf5ba464c27c3d14557e5809b44",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Onfido-CreateApplicant\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Onfido-CreateApplicant%22"
        },
        "response": {
          "bodySize": 8451,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 8451,
            "text": "{\"result\":[{\"_id\":\"25d8a628-3556-4219-aaf5-2384e2e5f19a\",\"name\":\"Onfido-CreateApplicant\",\"description\":\"Create Applicant\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ3JlYXRlQXBwbGljYW50OiBTdGFydCIpOwoKLyoKICogISEhIEV4dGVuZCB5b3VyIGF1dGhlbnRpY2F0aW9uIHNlc3Npb24gdGltZSBzbyB5b3VyIGlkZW50aXR5IHByb29maW5nIGZsb3dzIGRvbid0IHRpbWUgb3V0ICEhIQogKgogKiBBdXRoZW50aWNhdGlvbiA+IFNldHRpbmdzID4gVHJlZXMgPiBNYXggRHVyYXRpb24gKE1pbnV0ZXMpCiAqCiAqIFNldCB0byAxNSBtaW51dGVzLgogKgogKi8KCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqCiAqIFJFUExBQ0UgV0lUSCBZT1VSIE9XTiBPTkZJRE8gQVBJIFRPS0VOCiAqLwp2YXIgT05GSURPX0FQSV9UT0tFTiA9ICJhcGlfbGl2ZS5TdFVkZnhkaUNGYi5ZcnpiYWR4Ql9SMi1xRzVsRlVjM2xXZzZKQWMzQ25xLSI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCi8vIFJlcXVpcmVzIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgYXV0aCBub2RlIHRvIHJldHJpZXZlIHJlYWwgdXNlciBJRCBmcm9tIElETQp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpOwoKLy8gUmV0cmlldmUgdXNlciBwcm9maWxlIGF0dHJpYnV0ZXMgZm9yIGNvbXBhcmlzb24gd2l0aCBkb2N1bWVudCB2ZXJpZmljYXRpb24KLy8gdmFyIHJlcXVlc3RCb2R5SnNvbiA9IHsKLy8gICAgICJmaXJzdF9uYW1lIjogU3RyaW5nKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJnaXZlbk5hbWUiKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKSwKLy8gICAgICJsYXN0X25hbWUiOiBTdHJpbmcoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgInNuIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKSksCi8vICAgICAiZG9iIjogU3RyaW5nKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJmci1hdHRyLWlzdHIxIikuaXRlcmF0b3IoKS5uZXh0KCkudG9TdHJpbmcoKSkKLy8gfQp2YXIgcmVxdWVzdEJvZHlKc29uID0gewogICAgImZpcnN0X25hbWUiOiBTdHJpbmcoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgImdpdmVuTmFtZSIpLml0ZXJhdG9yKCkubmV4dCgpLnRvU3RyaW5nKCkpLAogICAgImxhc3RfbmFtZSI6IFN0cmluZyhpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCAic24iKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpKQp9Cgp2YXIgZmFpbHVyZSA9IHRydWUKCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0CikKCnZhciByZXF1ZXN0ID0gbmV3IGZyLlJlcXVlc3QoKTsKcmVxdWVzdC5zZXRVcmkoImh0dHBzOi8vYXBpLm9uZmlkby5jb20vdjMvYXBwbGljYW50cy8iKTsKcmVxdWVzdC5zZXRNZXRob2QoIlBPU1QiKTsKcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCIpOwpyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pOwpyZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keUpzb24pKTsKCnZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ3JlYXRlQXBwbGljYW50OiBDcmVhdGUgYXBwbGljYW50IElEIHJlc3BvbnNlOiAiLmNvbmNhdChyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkpOwoKaWYgKHJlc3BvbnNlLmdldFN0YXR1cygpLmdldENvZGUoKSA9PT0gMjAxKSB7CiAgICB2YXIgYXBwbGljYW50SUQgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKS5pZDsKICAgIGZhaWx1cmUgPSAhYXBwbGljYW50SUQ7CiAgICBpZiAoIWZhaWx1cmUpIHNoYXJlZFN0YXRlLnB1dCgib25maWRvQXBwbGljYW50SUQiLCBhcHBsaWNhbnRJRCk7Cn0KZWxzZSB7CiAgICBmYWlsdXJlID0gdHJ1ZTsKfQoKLy8gR2V0IE9uZmlkbyBjbGllbnQgSldUIHRva2VuIHJlcXVpcmVkIGJ5IGNsaWVudCBTREsKaWYgKCFmYWlsdXJlKSB7CgkvLyBnZXQgdGhlIHJlZmVyZXIKCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAgIHZhciByZXF1ZXN0Qm9keUpzb24gPSB7CiAgICAgICAgImFwcGxpY2FudF9pZCI6IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0FwcGxpY2FudElEIikpLAogICAgICAgICJyZWZlcnJlciI6IHJlZmVyZXIub3JpZ2luLmNvbmNhdCgiLyIpCiAgICB9CgogICAgZmFpbHVyZSA9IHRydWU7CgogICAgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9hcGkub25maWRvLmNvbS92My9zZGtfdG9rZW4iKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCJQT1NUIik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CiAgICByZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pOwogICAgcmVxdWVzdC5nZXRFbnRpdHkoKS5zZXRTdHJpbmcoSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHlKc29uKSk7CgogICAgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICBsb2dnZXIuZXJyb3IoIk9uZmlkby1DcmVhdGVBcHBsaWNhbnQ6IEdldCBzZGsgdG9rZW4gcmVzcG9uc2U6ICIuY29uY2F0KHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKSk7CgogICAgaWYgKHJlc3BvbnNlLmdldFN0YXR1cygpLmdldENvZGUoKSA9PT0gMjAwKSB7CiAgICAgICAgdmFyIHRva2VuID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkudG9rZW4KICAgICAgICBmYWlsdXJlID0gIXRva2VuOwogICAgICAgIGlmICghZmFpbHVyZSkgc2hhcmVkU3RhdGUucHV0KCJvbmZpZG9BdXRoVG9rZW4iLCB0b2tlbik7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBmYWlsdXJlID0gdHJ1ZTsKICAgIH0KfQoKb3V0Y29tZSA9IGZhaWx1cmUgPyAiZmFsc2UiIDogInRydWUiOwpsb2dnZXIuZXJyb3IoIk9uZmlkby1DcmVhdGVBcHBsaWNhbnQ6IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CgovKgogKiBQYXJzZSBhIFVSTCBpbnRvIGl0cyBjb21wb25lbnRzIGFuZCBtYWtlIHRoZW0gZWFzaWx5IGFjY2Vzc2libGUgYnkgbmFtZQogKiAKICogZS5nLjogaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAqIHsKICogICAgIGhhc2g6ICcjLycsCiAqICAgICBob3N0OiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICogICAgIGhvc3RuYW1lOiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogKiAgICAgb3JpZ2luOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogKiAgICAgcGF0aG5hbWU6ICcvYW0vWFVJLycsCiAqICAgICBwb3J0OiAnJywKICogICAgIHByb3RvY29sOiAnaHR0cHMnLAogKiAgICAgc2VhcmNoOiAnP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltJywKICogICAgIHVzZXJuYW1lOiAnJywKICogICAgIHBhc3N3b3JkOiAnJywKICogICAgIHNlYXJjaFBhcmFtOiB7CiAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogKiAgICAgICAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICogICAgICAgICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScKICogICAgIH0KICogfQogKi8KZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgdmFyIG0gPSBocmVmLm1hdGNoKC9eKChbXjpcLz8jXSspOj8oPzpcL1wvKCg/OihbXlwvPyM6XSopOihbXlwvPyM6XSopQCk/KFteXC8/IzpdKikoPzo6KFteXC8/IzpdKikpPykpKT8oW14/I10qKShcP1teI10qKT8oIy4qKT8kLyksCiAgICByID0gewogICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgIGhvc3Q6IG1bM10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICBob3N0bmFtZTogbVs2XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgIG9yaWdpbjogbVsxXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgIHBhdGhuYW1lOiBtWzhdIHx8IChtWzFdID8gIi8iIDogIiIpLCAgICAvLyAvYW0vWFVJLwogICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICBwcm90b2NvbDogbVsyXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gaHR0cHMKICAgICAgICBzZWFyY2g6IG1bOV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltCiAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgIHBhc3N3b3JkOiBtWzVdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICBzZWFyY2hQYXJhbToge30gICAgICAgICAgICAgICAgICAgICAgICAgLy8geyByZWFsbTogJy9icmF2bycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJyB9CiAgICB9OwogICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICByLnByb3RvY29sID0gImZpbGU6Ly8vIiArIHIucHJvdG9jb2wudG9VcHBlckNhc2UoKTsKICAgICAgICByLm9yaWdpbiA9IHIucHJvdG9jb2wgKyAiLy8iICsgci5ob3N0OwogICAgfQogICAgaWYgKHIuc2VhcmNoLmxlbmd0aCA+IDIpIHsKICAgICAgICB2YXIgcXVlcnkgPSAoci5zZWFyY2guaW5kZXhPZignPycpID09PSAwKSA/IHIuc2VhcmNoLnN1YnN0cigxKSA6IHIuc2VhcmNoOwogICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcGFpciA9IHZhcnNbaV0uc3BsaXQoJz0nKTsKICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgfQogICAgfQogICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICByZXR1cm4gcjsKfTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.281Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "24425954262aee8bebd351ed53f9ea4b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"CopyIDToObjectAttributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22CopyIDToObjectAttributes%22"
        },
        "response": {
          "bodySize": 769,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 769,
            "text": "{\"result\":[{\"_id\":\"c253a7ac-ebc9-4268-9e62-89f38f98e4ab\",\"name\":\"CopyIDToObjectAttributes\",\"description\":\"null\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KCJfaWQiLCBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "769"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.323Z",
        "time": 42,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 42
        }
      },
      {
        "_id": "c53a3edb3423b18300f7f67d34f31e93",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 584,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AAD Passthru Parse Access Token\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AAD%20Passthru%20Parse%20Access%20Token%22"
        },
        "response": {
          "bodySize": 6126,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6126,
            "text": "{\"result\":[{\"_id\":\"ae04e1a0-c662-43aa-9d80-21af78528b45\",\"name\":\"AAD Passthru Parse Access Token\",\"description\":\"Parse Access Token from Azure AD pass through authentication using the Resource Owner Password Credential flow\",\"script\":\"LyogQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBQYXJzZSBBY2Nlc3MgVG9rZW4gZnJvbSBBenVyZSBBRCBwYXNzIHRocm91Z2ggYXV0aGVudGljYXRpb24gdXNpbmcgdGhlIAogKiBSZXNvdXJjZSBPd25lciBQYXNzd29yZCBDcmVkZW50aWFsIGZsb3cKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgQUFEIFBhc3N0aHJ1IFJPUEMgc2NyaXB0IHRvIHJ1biBiZWZvcmUgYW5kIGZpbmlzaCB3aXRoIHRoZSAKICogIlZhbGlkIiBvdXRjb21lIChvbmx5IG91dGNvbWUgdGhhdCByZXN1bHRzIGluIGFuIGFjY2VzcyB0b2tlbikuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbjogc3RhcnQiKTsKCi8qCiAqIEJhc2U2NCBlbmNvZGUgLyBkZWNvZGUKICogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvLwogKiAKICogVXNhZ2U6CiAqIEJhc2U2NC5lbmNvZGUoJ3NvbWUgc3RyaW5nJykKICogQmFzZTY0LmRlY29kZSgnc29tZSBlbmNvZGVkIHN0cmluZycpCiAqLwp2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgpvdXRjb21lID0gImZhbHNlIjsKaWYgKHRyYW5zaWVudFN0YXRlLmdldCgiYWFkQWNjZXNzVG9rZW4iKSkgewogIAl0cnkgewogICAgICAgIHZhciBqc29uVG9rZW4gPSBwYXJzZUp3dCh0cmFuc2llbnRTdGF0ZS5nZXQoImFhZEFjY2Vzc1Rva2VuIikudG9TdHJpbmcoKSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJnaXZlbk5hbWUiLCBqc29uVG9rZW4uZ2l2ZW5fbmFtZSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsIGpzb25Ub2tlbi5mYW1pbHlfbmFtZSk7CiAgICAgICAgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJtYWlsIiwganNvblRva2VuLnVuaXF1ZV9uYW1lKTsKICAgICAgICBvdXRjb21lID0gInRydWUiCiAgICB9IGNhdGNoIChlKSB7CgkJbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBQYXJzZSBBY2Nlc3MgVG9rZW46IEV4Y2VwdGlvbjogIi5jb25jYXQoZSkpOwogICAgfQp9IGVsc2UgewogIAlvdXRjb21lID0gImZhbHNlIjsKICAJbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBQYXJzZSBBY2Nlc3MgVG9rZW46IE5vIGFjY2VzcyB0b2tlbiBmb3VuZCBpbiB0cmFuc2llbnQgc3RhdGUhIFVzZSBST1BDIHNjcmlwdCBiZWZvcmUgdGhpcyBzY3JpcHQgdG8gcG9wdWxhdGUgdHJhbnNpZW50IHN0YXRlISciKTsKfQpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFBhcnNlIEFjY2VzcyBUb2tlbjogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTsKCi8qCiAqIFBhcnNlIGEgbm9uLWVuY3J5cHRlZCBKV1QgdG9rZW4gYW5kIHJldHVybiBpdHMgSlNPTiBib2R5IHdpdGhvdXQgaGVhZGVyIGFuZCBzaWduYXR1cmUKICovCmZ1bmN0aW9uIHBhcnNlSnd0ICh0b2tlbikgewogIAlyZXR1cm4gSlNPTi5wYXJzZShCYXNlNjQuZGVjb2RlKCIiLmNvbmNhdCh0b2tlbikuc3BsaXQoJy4nKVsxXSkucmVwbGFjZSgvXDAvZywgJycpKTsKfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6126"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:32 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.368Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "a1809da3310dd2502bd3d1cdea68dd8f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 558,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_MFA_Method\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_MFA_Method%22"
        },
        "response": {
          "bodySize": 2699,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2699,
            "text": "{\"result\":[{\"_id\":\"a71b5794-ba0e-426e-bb1b-351b2d942a08\",\"name\":\"AT_MFA_Method\",\"description\":\"Script to determine MFA Method - sms, mail, fido, push, oath, duo\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCB3aWxsIHJlYWQgdGhlIEZvcmdlUm9jayBJZGVudGl0eSBDbG91ZCBhdHRyaWJ1dGUgImZyVW5pbmRleGVkU3RyaW5nMiIgdG8gc2VlIHRoZSB1c2VyJ3MKICAtIE1GQSBPcHQtaW4gY2hvaWNlLiBvdXRjb21lcyB3aWxsIGJlICJlbXB0eSIgInNtcyIgIm1haWwiICJmaWRvIiAicHVzaCIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCgpsb2dnZXIuZXJyb3IoJ0FUX01GQV9NZXRob2Qgc2NyaXB0OiBTVEFSVCcpCmxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZDogdGhpczogIiArIE9iamVjdC5rZXlzKHRoaXMpKQpsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2Q6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSkKCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIyIgoKbG9nZ2VyLmVycm9yKCJBVF9NRkFfTWV0aG9kOiB1c2VybmFtZTogIiArIHVzZXJuYW1lKQpsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2Q6IE1GQSBNZXRob2Q6ICIgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKQoKb3V0Y29tZSA9ICJlbXB0eSIKICAKaWYgKGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkudG9BcnJheSgpLmxlbmd0aCkgewogIGxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZCAgaWRlbnRpdHkgYXR0cmlidXRlOiAiICsgYXR0cmlidXRlICsgIiBpcyBwcmVzZW50IiApOyAgCiAgdmFyIGNob2ljZSA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsIGF0dHJpYnV0ZSkuaXRlcmF0b3IoKS5uZXh0KCk7IAogIGxvZ2dlci5lcnJvcigiQVRfTUZBX01ldGhvZCAgaWRlbnRpdHkgYXR0cmlidXRlOiBjaG9pY2UgaXM6ICIgKyBjaG9pY2UgKQoKICBpZihjaG9pY2UgPT0gInNtcyIpewogICAgb3V0Y29tZSA9ICJzbXMiCgogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJwdXNoIikgewogICAgb3V0Y29tZSA9ICJwdXNoIgoKICB9IGVsc2UgaWYgKGNob2ljZSA9PSAibWFpbCIpIHsKICAgIG91dGNvbWUgPSAibWFpbCIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImZpZG8iKXsKICAgIG91dGNvbWUgPSAiZmlkbyIKCiAgfSAgZWxzZSBpZiAoY2hvaWNlID09ICJvYXRoIil7CiAgICBvdXRjb21lID0gIm9hdGgiCgogIH0gIGVsc2UgaWYgKGNob2ljZSA9PSAiZHVvIil7CiAgICBvdXRjb21lID0gImR1byIKCiAgfSAKCn0gZWxzZSB7CiAgb3V0Y29tZSA9ICJlbXB0eSIKICBsb2dnZXIuZXJyb3IoIkFUX01GQV9NZXRob2QgIG91dGNvbWUgaXMgbmV2ZXIgYmVjYXVzZSBhdHRyaWJ1dGUgZW1wdHkgIikKICAKfQoKbG9nZ2VyLmVycm9yKCJBVF9NRkFfTWV0aG9kOiBvdXRjb21lOiAiICsgb3V0Y29tZSk=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2699"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.409Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "647bbbf7045949c74f1ad63a90558b28",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 582,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Post Redirect Language Selector\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Post%20Redirect%20Language%20Selector%22"
        },
        "response": {
          "bodySize": 1459,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1459,
            "text": "{\"result\":[{\"_id\":\"35f56a51-cb99-410d-a7d2-7dc0bb9e4cb7\",\"name\":\"Post Redirect Language Selector\",\"description\":\"Use this script to switch to the preferred language after a node that redirects the browser (SAML2 node, Social IDP Handler node, etc.) or even to switch language mid-journey.\",\"script\":\"KGZ1bmN0aW9uICgpIHsKICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwgCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLnNwaS5SZWRpcmVjdENhbGxiYWNrCiAgKTsKCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsgCiAgICB2YXIgcGFyYW1zID0gcmVxdWVzdFBhcmFtZXRlcnMudG9TdHJpbmcoKTsKICAgIHBhcmFtcyA9IHBhcmFtcy5yZXBsYWNlKC9cWy9nLCAiIikucmVwbGFjZSgvXF0vZywgIiIpLnJlcGxhY2UoL1x7L2csICIiKS5yZXBsYWNlKC99L2csICIiKS5yZXBsYWNlKC8gL2csICIiKS5yZXBsYWNlKC8sL2csICImIik7CiAgICBwYXJhbXMgPSAiPyIgKyBwYXJhbXM7CiAgICB2YXIgcmVkaXJlY3QgPSBuZXcgZnIuUmVkaXJlY3RDYWxsYmFjayhwYXJhbXMgKyAiJmxvY2FsZT0iICsgImZyIiwgbnVsbCwgIkdFVCIpOwogICAgcmVkaXJlY3Quc2V0VHJhY2tpbmdDb29raWUodHJ1ZSk7CgogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgIHJlZGlyZWN0CiAgICApLmJ1aWxkKCk7CiAgfSAKICBlbHNlIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsgICAgICAgIAogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1459"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.450Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c88ea544cf5534f3c2ab39b192aba01b",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 551,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Logout\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Logout%22"
        },
        "response": {
          "bodySize": 6858,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6858,
            "text": "{\"result\":[{\"_id\":\"2aab9d46-9363-4061-9f63-eb824e33c505\",\"name\":\"Logout\",\"description\":\"Logout.\",\"script\":\"LyogTG9nb3V0CiAqIAogKiBMb2dvdXQuCiAqIAogKiBUaGlzIHNjcmlwdCByZXF1aXJlcyBwYXJhbWV0cml6YXRpb24uIE1ha2Ugc3VyZSB5b3UgY2FyZWZ1bGx5IHJldmlldyB0aGUgY29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci5tZXNzYWdlKCJMb2dvdXQ6IHN0YXJ0Iik7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKCiAgCS8qIEJlZ2luIENvbmZpZ3VyYXRpb24gKi8KICAKICAJdmFyIEFNX1JFQUxNID0gImFscGhhIjsKICAgIAogICAgLy8gQU0gQVBJIENvbmZpZ3VyYXRpb24KICAgIHZhciBBTV9BUElfVVJJID0gcmVmZXJlci5vcmlnaW4gKyAiL2FtL2pzb24vIiArIEFNX1JFQUxNICsgIi9zZXNzaW9ucy8/X2FjdGlvbj1sb2dvdXQiOwoKICAJLyogRW5kIENvbmZpZ3VyYXRpb24gKi8KCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKEFNX0FQSV9VUkkpOwoJcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCIpOwoJcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb29raWUiLCByZXF1ZXN0SGVhZGVycy5nZXQoImNvb2tpZSIpLmdldCgwKSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkFjY2VwdC1BUEktVmVyc2lvbiIsICJyZXNvdXJjZT0zLjEiKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiTG9nb3V0OiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwogIAogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uc3BpLlJlZGlyZWN0Q2FsbGJhY2ssCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2sKICAgICkKICAgIC8vIHJlZGlyZWN0IHRvIHRoaXMgam91cm5leSBhZ2FpbgogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLlJlZGlyZWN0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICByZWZlcmVyLmhyZWYsCiAgICAgICAgICAgICAgICBudWxsLAogICAgICAgICAgICAgICAgIkdFVCIKICAgICAgICAgICAgKQogICAgICAgICkuYnVpbGQoKTsKICAgIH0KICAgIGVsc2UgewogICAgCWxvZ2dlci5tZXNzYWdlKCJMb2dvdXQ6IGVuZCBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKICAgIH0KCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6858"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.489Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c7b460d486ef0dba13b8d41138ce20d8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 568,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"UOP Get Course ID\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22UOP%20Get%20Course%20ID%22"
        },
        "response": {
          "bodySize": 3002,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3002,
            "text": "{\"result\":[{\"_id\":\"6ad22934-5d12-43a6-96a7-a2fba8d999bf\",\"name\":\"UOP Get Course ID\",\"description\":\"Call out to University of Phoenix Course Registration System and get current course.\",\"script\":\"LyogVU9QIEdldCBDb3Vyc2UgSUQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2FsbCBvdXQgdG8gVW5pdmVyc2l0eSBvZiBQaG9lbml4IENvdXJzZSBSZWdpc3RyYXRpb24gU3lzdGVtIGFuZCBnZXQgY3VycmVudCBjbGFzcy4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSBpdCBpcyBiZWluZyBjYWxsZWQuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gaGFzIGNsYXNzZXMKICogLSBubyBjbGFzc2VzCiAqIC0gZXJyb3IKICovCmxvZ2dlci53YXJuaW5nKCJVT1AgR2V0IENvdXJzZSBJRDogc3RhcnQiKTsKCm91dGNvbWUgPSAiZXJyb3IiOwoKaWYgKHNoYXJlZFN0YXRlLmdldCgiX2lkIikgJiYgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAibWFpbCIpLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CgogICAJLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVBJIFNFVFRJTkdTCiAgICAgKi8KICAJdmFyIGVtYWlsID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCAibWFpbCIpLml0ZXJhdG9yKCkubmV4dCgpOwogICAgdmFyIFVPUF9DTEFTU19BUElfVVJJID0gImh0dHBzOi8vZHk0cnBldzV2YS5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9mb3JnZXJvY2svY291cnNlP2NvdXJzZUlkPUNFUzQyMiI7CiAgCS8vdmFyIFVPUF9DTEFTU19BUElfVVJJID0gImh0dHBzOi8vZHk0cnBldzV2YS5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9mb3JnZXJvY2svY291cnNlP2VtYWlsSWQ9Ii5jb25jYXQoZW1haWwpOwogICAgLyoKICAgICAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogICAgICovCgogICAgdmFyIHJlcXVlc3QgPSBuZXcgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QoKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFVPUF9DTEFTU19BUElfVVJJKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgVU9QQ2xhc3NJRCA9IHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpOwogICAgbG9nZ2VyLndhcm5pbmcoIlVPUCBHZXQgQ291cnNlIElEOiBBUEkgY2FsbCByZXN1bHQ6IENvdXJzZSBJRD0iLmNvbmNhdChVT1BDbGFzc0lEKSk7CgogICAgLyogU2FtcGxlIEFQSSByZXNwb25zZQogICAgQ0VTNDIxCgkqLwoKICAgIGlmIChVT1BDbGFzc0lEKSB7CiAgICAgICAgb3V0Y29tZSA9ICJoYXMgY2xhc3NlcyI7CgogICAgICAgIC8vIHByZXNlcnZlIHJlc3VsdCBpbiBzaGFyZWQgc3RhdGUKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoInVvcEN1cnJlbnRDbGFzc0lEIiwgVU9QQ2xhc3NJRCk7CiAgICB9IAogICAgZWxzZSBpZiAoVU9QQ2xhc3NJRCA9PT0gIiIpIHsKICAgICAgICBvdXRjb21lID0gIm5vIGNsYXNzZXMiOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgb3V0Y29tZSA9ICJlcnJvciI7CiAgICB9Cgp9IGVsc2UgewogICAgbG9nZ2VyLmVycm9yKCJVT1AgR2V0IENvdXJzZSBJRDogbm8gY2xhc3NlcyEiKTsKfQoKbG9nZ2VyLndhcm5pbmcoIlVPUCBHZXQgQ291cnNlIElEOiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3002"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.528Z",
        "time": 33,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 33
        }
      },
      {
        "_id": "7bed9a8b4db5f01e50d2047050eb2202",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 571,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Check Existing Session\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Check%20Existing%20Session%22"
        },
        "response": {
          "bodySize": 1058,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1058,
            "text": "{\"result\":[{\"_id\":\"0ab1dd57-eafd-4063-8e60-65bfac8108b7\",\"name\":\"Check Existing Session\",\"description\":\"Check existing session and set username\",\"script\":\"aWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICd1bmRlZmluZWQnKQp7CiAgb3V0Y29tZSA9ICJoYXNTZXNzaW9uIjsKICBzaGFyZWRTdGF0ZS5wdXQoInVzZXJuYW1lIiwgZXhpc3RpbmdTZXNzaW9uLmdldCgiVXNlcklkIikpOwogIHNoYXJlZFN0YXRlLnB1dCgiX2lkIiwgZXhpc3RpbmdTZXNzaW9uLmdldCgiVXNlcklkIikpOwogIGlmIChzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKSkgewoJc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikucHV0KCJ1c2VyTmFtZSIsIGV4aXN0aW5nU2Vzc2lvbi5nZXQoIlVzZXJJZCIpKTsKICB9CiAgZWxzZSB7CglzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCB7dXNlck5hbWU6IGV4aXN0aW5nU2Vzc2lvbi5nZXQoIlVzZXJJZCIpfSk7CiAgfQp9CmVsc2UKewogIG91dGNvbWUgPSAibm9TZXNzaW9uIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1058"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.565Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "f9a50b003aa8f23329b77c1d5ab857d3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 579,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Connect Caller\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Connect%20Caller%22"
        },
        "response": {
          "bodySize": 2091,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2091,
            "text": "{\"result\":[{\"_id\":\"181817ea-b8dc-4b3b-a366-99239f6f274d\",\"name\":\"Twilio IVR: Connect Caller\",\"description\":\"Connect caller to a real person.\",\"script\":\"LyogVHdpbGlvIElWUjogQ29ubmVjdCBDYWxsZXIKICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIAogKiBEZXBlbmRpbmcgb24gdGhlIGFtb3VudCBvZiBkYXRhIGNvbGxlY3RlZCB0aHJvdWdoIGNhbGxiYWNrcyBhbmQgaG93IG1hbnkgb2YgdGhlIGNhbGxQYXJhbXMKICogeW91IGFjdGl2YXRlIGJlbG93LCB5b3Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB5b3VyIGF1dGhlbnRpY2F0aW9uIHNlc3Npb24gZnJvbSBKV1QgdG8gQ1RTIG9yCiAqIE1lbW9yeS4KICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBDb25uZWN0IENhbGxlcjogc3RhcnQiKTsKb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBNZXNzYWdlCnZhciBtZXNzYWdlID0gIkknbSBjb25uZWN0aW5nIHlvdSB0byBhIHJlYWwgcGVyc29uIG5vdy4iOwoKLy8gVHdpTUwgdG8gc2VuZCBiYWNrIHRvIFR3aWxpbwp2YXIgdHdpbWwgPSBbIjxEaWFsIGFjdGlvbj1cIiIsICJodHRwczovL2lnLm15dGVzdHJ1bi5jb20vaXZyL2lkYyIsICJcIj4rMTgwMTQ3MzU0NTE8L0RpYWw+Il0uam9pbigiIik7CgovKiBFbmQgQ29uZmlndXJhdGlvbgogKi8KCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgCWNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJdmFyIHNjcmlwdCA9IG5ldyBTY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sodHdpbWwpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5zZW5kKG91dHB1dCwgc2NyaXB0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ29ubmVjdCBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2091"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.605Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "c1c4838a4eada61cb6adbf5f708af38a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"MFA Status\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22MFA%20Status%22"
        },
        "response": {
          "bodySize": 1159,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1159,
            "text": "{\"result\":[{\"_id\":\"ac9fc25e-3ad9-4f80-a796-2d9093795439\",\"name\":\"MFA Status\",\"description\":\"Check if MFA has already been performed for this journey. This allows journeys and inner journeys not to perform MFA multiple times.\",\"script\":\"LyogTUZBIFN0YXR1cwogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBDaGVjayBpZiBNRkEgaGFzIGFscmVhZHkgYmVlbiBwZXJmb3JtZWQgZm9yIHRoaXMgam91cm5leS4gCiAqIFRoaXMgYWxsb3dzIGpvdXJuZXlzIGFuZCBpbm5lciBqb3VybmV5cyBub3QgdG8gcGVyZm9ybSBNRkEgbXVsdGlwbGUgdGltZXMuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKi8Kb3V0Y29tZSA9ICJmYWxzZSI7CmlmIChzaGFyZWRTdGF0ZS5nZXQoIm1mYVBlcmZvcm1lZCIpPT0idHJ1ZSIpIHsKICAJb3V0Y29tZSA9ICJ0cnVlIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1159"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.645Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "bada2669ac08f345574d39d50e0ebae1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display Password\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20Password%22"
        },
        "response": {
          "bodySize": 1476,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1476,
            "text": "{\"result\":[{\"_id\":\"ec8b314c-8e11-4364-93b9-a3e82d2a074a\",\"name\":\"Display Password\",\"description\":\"Display Password from nodeState\",\"script\":\"LyogRGlzcGxheSBQYXNzd29yZAogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqIAogKiBEaXNwbGF5IFBhc3N3b3JkIGNvbGxlY3RlZCB2aWEgUGxhdGZvcm0gUGFzc3dvcmQgbm9kZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KdmFyIHBhc3N3b3JkID0gInVuYWJsZSB0byByZXRyaWV2ZSEiOwppZiAobm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKSkgewogIHBhc3N3b3JkID0gbm9kZVN0YXRlLmdldCgicGFzc3dvcmQiKS5hc1N0cmluZygpOwp9CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBwYXNzd29yZAogICAgICAgICkKICAgICkuYnVpbGQoKQp9CmVsc2UgewogIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1476"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.687Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "75d67cb54b1596db4dd7aef88161182c",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 600,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Alpha OAuth2 Access Token Modification Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Alpha%20OAuth2%20Access%20Token%20Modification%20Script%22"
        },
        "response": {
          "bodySize": 10080,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 10080,
            "text": "{\"result\":[{\"_id\":\"39c08084-1238-43e8-857f-2e11005eac49\",\"name\":\"Alpha OAuth2 Access Token Modification Script\",\"description\":\"Default alpha realm script for OAuth2 Access Token Modification\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTktMjAyMSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMKICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgovKgogKiBUaGlzIHNjcmlwdCBsZXRzIHlvdSBtb2RpZnkgaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIGFuIE9BdXRoMiBhY2Nlc3MgdG9rZW4KICogd2l0aCBtZXRob2RzIHByb3ZpZGVkIGJ5IHRoZSBBY2Nlc3NUb2tlbiAoMSkgaW50ZXJmYWNlLgogKiBUaGUgY2hhbmdlcyBtYWRlIHRvIE9BdXRoMiBhY2Nlc3MgdG9rZW5zIHdpbGwgZGlyZWN0bHkgaW1wYWN0IHRoZSBzaXplIG9mIHRoZSBDVFMgdG9rZW5zLAogKiBhbmQsIHNpbWlsYXJseSwgdGhlIHNpemUgb2YgdGhlIEpXVHMgaWYgY2xpZW50LWJhc2VkIE9BdXRoMiB0b2tlbnMgYXJlIHV0aWxpemVkLgogKiBXaGVuIGFkZGluZy91cGRhdGluZyBmaWVsZHMgbWFrZSBzdXJlIHRoYXQgdGhlIHRva2VuIHNpemUgcmVtYWlucyB3aXRoaW4gY2xpZW50L3VzZXItYWdlbnQgbGltaXRzLgogKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogYWNjZXNzVG9rZW4gLSBBY2Nlc3NUb2tlbiAoMSkuCiAqICAgICAgICAgICAgICAgVGhlIGFjY2VzcyB0b2tlbiB0byBiZSB1cGRhdGVkLgogKiAgICAgICAgICAgICAgIE11dGFibGUgb2JqZWN0LCBhbGwgY2hhbmdlcyB0byB0aGUgYWNjZXNzIHRva2VuIHdpbGwgYmUgcmVmbGVjdGVkLgogKiBzY29wZXMgLSBTZXQ8U3RyaW5nPiAoNikuCiAqICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgcmVxdWVzdGVkIHNjb3Blcy4KICogcmVxdWVzdFByb3BlcnRpZXMgLSBVbm1vZGlmaWFibGUgTWFwICg1KS4KICogICAgICAgICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgY29udGFpbnMgYSBtYXAgb2YgcmVxdWVzdCBwcm9wZXJ0aWVzOgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVcmkgLSBUaGUgcmVxdWVzdCBVUkkuCiAqICAgICAgICAgICAgICAgICAgICAgcmVhbG0gLSBUaGUgcmVhbG0gdGhhdCB0aGUgcmVxdWVzdCByZWxhdGVzIHRvLgogKiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQYXJhbXMgLSBBIG1hcCBvZiB0aGUgcmVxdWVzdCBwYXJhbXMgYW5kL29yIHBvc3RlZCBkYXRhLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFYWNoIHZhbHVlIGlzIGEgbGlzdCBvZiBvbmUgb3IgbW9yZSBwcm9wZXJ0aWVzLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQbGVhc2Ugbm90ZSB0aGF0IHRoZXNlIHNob3VsZCBiZSBoYW5kbGVkIGluIGFjY29yZGFuY2Ugd2l0aCBPV0FTUCBiZXN0IHByYWN0aWNlczoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS92dWxuZXJhYmlsaXRpZXMvVW5zYWZlX3VzZV9vZl9SZWZsZWN0aW9uLgogKiBjbGllbnRQcm9wZXJ0aWVzIC0gVW5tb2RpZmlhYmxlIE1hcCAoNSkuCiAqICAgICAgICAgICAgICAgICAgICBQcmVzZW50IGlmIHRoZSBjbGllbnQgc3BlY2lmaWVkIGluIHRoZSByZXF1ZXN0IHdhcyBpZGVudGlmaWVkLCBjb250YWlucyBhIG1hcCBvZiBjbGllbnQgcHJvcGVydGllczoKICogICAgICAgICAgICAgICAgICAgIGNsaWVudElkIC0gVGhlIGNsaWVudCdzIFVSSSBmb3IgdGhlIHJlcXVlc3QgbG9jYWxlLgogKiAgICAgICAgICAgICAgICAgICAgYWxsb3dlZEdyYW50VHlwZXMgLSBMaXN0IG9mIHRoZSBhbGxvd2VkIGdyYW50IHR5cGVzIChvcmcuZm9yZ2Vyb2NrLm9hdXRoMi5jb3JlLkdyYW50VHlwZSkgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkUmVzcG9uc2VUeXBlcyAtIExpc3Qgb2YgdGhlIGFsbG93ZWQgcmVzcG9uc2UgdHlwZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU2NvcGVzIC0gTGlzdCBvZiB0aGUgYWxsb3dlZCBzY29wZXMgZm9yIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzIC0gQSBtYXAgb2YgdGhlIGN1c3RvbSBwcm9wZXJ0aWVzIG9mIHRoZSBjbGllbnQuCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdHMgb3IgbWFwcyB3aWxsIGJlIGluY2x1ZGVkIGFzIHN1Yi1tYXBzOyBmb3IgZXhhbXBsZToKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21NYXBbS2V5MV09VmFsdWUxIHdpbGwgYmUgcmV0dXJuZWQgYXMgY3VzdG9tTWFwIC0+IEtleTEgLT4gVmFsdWUxLgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvIGFkZCBjdXN0b20gcHJvcGVydGllcyB0byBhIGNsaWVudCwgdXBkYXRlIHRoZSBDdXN0b20gUHJvcGVydGllcyBmaWVsZAogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIEFNIENvbnNvbGUgPiBSZWFsbSBOYW1lID4gQXBwbGljYXRpb25zID4gT0F1dGggMi4wID4gQ2xpZW50cyA+IENsaWVudCBJRCA+IEFkdmFuY2VkLgogKiBpZGVudGl0eSAtIEFNSWRlbnRpdHkgKDMpLgogKiAgICAgICAgICAgIEFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyLgogKiBzZXNzaW9uIC0gU1NPVG9rZW4gKDQpLgogKiAgICAgICAgICAgUHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QuCiAqIHNjcmlwdE5hbWUgLSBTdHJpbmcgKHByaW1pdGl2ZSkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgc2NyaXB0LgogKiBsb2dnZXIgLSBBbHdheXMgcHJlc2VudCwgdGhlICJPQXV0aDJQcm92aWRlciIgZGVidWcgbG9nZ2VyIGluc3RhbmNlOgogKiAgICAgICAgICBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9zY3JpcHRpbmctZ3VpZGUvc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtbG9nZ2VyLgogKiAgICAgICAgICBDb3JyZXNwb25kaW5nIGxvZyBmaWxlcyB3aWxsIGJlIHByZWZpeGVkIHdpdGg6IHNjcmlwdHMuT0FVVEgyX0FDQ0VTU19UT0tFTl9NT0RJRklDQVRJT04uCiAqIGh0dHBDbGllbnQgLSBIVFRQIENsaWVudCAoOCkuCiAqICAgICAgICAgICAgICBBbHdheXMgcHJlc2VudCwgdGhlIEhUVFAgQ2xpZW50IGluc3RhbmNlOgogKiAgICAgICAgICAgICAgaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvc2NyaXB0aW5nLWd1aWRlL3NjcmlwdGluZy1hcGktZ2xvYmFsLWh0dHAtY2xpZW50Lmh0bWwjc2NyaXB0aW5nLWFwaS1nbG9iYWwtaHR0cC1jbGllbnQuCiAqCiAqIFJldHVybiAtIG5vIHZhbHVlIGlzIGV4cGVjdGVkLCBjaGFuZ2VzIHNoYWxsIGJlIG1hZGUgdG8gdGhlIGFjY2Vzc1Rva2VuIHBhcmFtZXRlciBkaXJlY3RseS4KICoKICogQ2xhc3MgcmVmZXJlbmNlOgogKiAoMSkgQWNjZXNzVG9rZW4gLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL29yZy9mb3JnZXJvY2svb2F1dGgyL2NvcmUvQWNjZXNzVG9rZW4uaHRtbC4KICogKDMpIEFNSWRlbnRpdHkgLSBodHRwczovL2JhY2tzdGFnZS5mb3JnZXJvY2suY29tL2RvY3MvYW0vNy9hcGlkb2NzL2NvbS9zdW4vaWRlbnRpdHkvaWRtL0FNSWRlbnRpdHkuaHRtbC4KICogKDQpIFNTT1Rva2VuIC0gaHR0cHM6Ly9iYWNrc3RhZ2UuZm9yZ2Vyb2NrLmNvbS9kb2NzL2FtLzcvYXBpZG9jcy9jb20vaXBsYW5ldC9zc28vU1NPVG9rZW4uaHRtbC4KICogKDUpIE1hcCAtIGh0dHBzOi8vZG9jcy5vcmFjbGUuY29tL2VuL2phdmEvamF2YXNlLzExL2RvY3MvYXBpL2phdmEuYmFzZS9qYXZhL3V0aWwvSGFzaE1hcC5odG1sLAogKiAgICAgICAgICAgb3IgaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTEvZG9jcy9hcGkvamF2YS5iYXNlL2phdmEvdXRpbC9MaW5rZWRIYXNoTWFwLmh0bWwuCiAqICg2KSBTZXQgLSBodHRwczovL2RvY3Mub3JhY2xlLmNvbS9lbi9qYXZhL2phdmFzZS8xMS9kb2NzL2FwaS9qYXZhLmJhc2UvamF2YS91dGlsL0hhc2hTZXQuaHRtbC4KICogKDgpIENsaWVudCAtIGh0dHBzOi8vYmFja3N0YWdlLmZvcmdlcm9jay5jb20vZG9jcy9hbS83L2FwaWRvY3Mvb3JnL2Zvcmdlcm9jay9odHRwL0NsaWVudC5odG1sLgogKi8KCi8qIEVYQU1QTEUKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmckphdmEgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QsCiAgICAgICAgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlc3BvbnNlCiAgICApOwoKICAgIC8vIEFsd2F5cyBpbmNsdWRlcyB0aGlzIGZpZWxkIGluIHRoZSB0b2tlbi4KICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkKCdrZXkxJywgJ3ZhbHVlMScpOwoKICAgIC8vIFJlY2VpdmVzIGFuZCBhZGRzIHRvIHRoZSBhY2Nlc3MgdG9rZW4gYWRkaXRpb25hbCB2YWx1ZXMgYnkgcGVyZm9ybWluZyBhIFJFU1QgY2FsbCB0byBhbiBleHRlcm5hbCBzZXJ2aWNlLgogICAgLy8gV0FSTklORzogQmVsb3csIHlvdSB3aWxsIGZpbmQgYSByZWZlcmVuY2UgdG8gYSB0aGlyZC1wYXJ0eSBzaXRlLCB3aGljaCBpcyBwcm92aWRlZCBvbmx5IGFzIGFuIGV4YW1wbGUuCiAgICB2YXIgdXJpID0gJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cyc7CgogICAgdHJ5IHsKICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmckphdmEuUmVxdWVzdCgpOwoKICAgICAgICAvLyBZb3UgY2FuIGNoYWluIG1ldGhvZHMgdGhhdCByZXR1cm4gdGhlIHJlcXVlc3Qgb2JqZWN0LgogICAgICAgIHJlcXVlc3Quc2V0VXJpKHVyaSkKICAgICAgICAgICAgLnNldE1ldGhvZCgnUE9TVCcpCiAgICAgICAgICAgIC5zZXRFbnRpdHkoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgdXBkYXRlZEZpZWxkczogewogICAgICAgICAgICAgICAgICAgIGtleTI6ICd2YWx1ZTInLAogICAgICAgICAgICAgICAgICAgIGtleTM6ICd2YWx1ZTMnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgLy8gWW91IGNhbiBjYWxsIGEgbWV0aG9kIHdoZW4gY2hhaW5pbmcgaXMgbm90IHBvc3NpYmxlLgogICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnKTsKCiAgICAgICAgLy8gU2VuZHMgdGhlIHJlcXVlc3QgYW5kIHJlY2VpdmVzIHRoZSByZXNwb25zZS4KICAgICAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0T3JUaHJvdygpOwoKICAgICAgICAvLyBDaGVja3MgaWYgdGhlIHJlc3BvbnNlIHN0YXR1cyBpcyBhcyBleHBlY3RlZC4KICAgICAgICBpZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkgPT09IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5TdGF0dXMuQ1JFQVRFRCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CgogICAgICAgICAgICAvLyBTZXQgbXVsdGlwbGUgdG9rZW4gZmllbGRzIGF0IG9uY2UuCiAgICAgICAgICAgIGFjY2Vzc1Rva2VuLnNldEZpZWxkcyhyZXN1bHQudXBkYXRlZEZpZWxkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdVbmFibGUgdG8gb2J0YWluIGFjY2VzcyB0b2tlbiBtb2RpZmljYXRpb25zLiBTdGF0dXM6ICcgKyByZXNwb25zZS5nZXRTdGF0dXMoKSArICcuIENvbnRlbnQ6ICcgKyByZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5lcnJvcignVGhlIHJlcXVlc3QgcHJvY2Vzc2luZyB3YXMgaW50ZXJydXB0ZWQuICcgKyBlKTsKCiAgICAgICAgLy8gVGhlIGFjY2VzcyB0b2tlbiByZXF1ZXN0IGZhaWxzIHdpdGggdGhlIEhUVFAgNTAwIGVycm9yIGluIHRoaXMgY2FzZS4KICAgICAgICB0aHJvdyAoJ1VuYWJsZSB0byBvYnRhaW4gcmVzcG9uc2UgZnJvbTogJyArIHVyaSk7CiAgICB9CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgaWRlbnRpdHkgYXR0cmlidXRlIHZhbHVlcyB0byB0aGUgYWNjZXNzIHRva2VuLgogICAgYWNjZXNzVG9rZW4uc2V0RmllbGQoJ21haWwnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ21haWwnKSk7CiAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgncGhvbmUnLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoJ3RlbGVwaG9uZU51bWJlcicpLnRvQXJyYXkoKVswXSk7CgogICAgLy8gQWRkcyBuZXcgZmllbGRzIGNvbnRhaW5pbmcgdGhlIHNlc3Npb24gcHJvcGVydHkgdmFsdWVzLgogICAgLy8gTk9URTogc2Vzc2lvbiBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igbm9uLWludGVyYWN0aXZlIGF1dGhvcml6YXRpb24gZ3JhbnRzLgogICAgaWYgKHNlc3Npb24pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgnaXBBZGRyZXNzJywgc2Vzc2lvbi5nZXRQcm9wZXJ0eSgnSG9zdCcpKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignVW5hYmxlIHRvIHJldHJpZXZlIHNlc3Npb24gcHJvcGVydHkgdmFsdWUuICcgKyBlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gUmVtb3ZlcyBhIG5hdGl2ZSBmaWVsZCBmcm9tIHRoZSB0b2tlbiBlbnRyeSwgdGhhdCB3YXMgc2V0IGJ5IEFNLgogICAgLy8gV0FSTklORzogcmVtb3ZpbmcgbmF0aXZlIGZpZWxkcyBmcm9tIHRoZSB0b2tlbiBtYXkgcmVzdWx0IGluIGxvc3Mgb2YgZnVuY3Rpb25hbGl0eS4KICAgIC8vIGFjY2Vzc1Rva2VuLnJlbW92ZVRva2VuTmFtZSgpCgogICAgLy8gTm8gcmV0dXJuIHZhbHVlIGlzIGV4cGVjdGVkLiBMZXQgaXQgYmUgdW5kZWZpbmVkLgp9KCkpOwoqLw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.727Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "8fa21dba38d242b31999a7f332c01e62",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Goodbye Message\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Goodbye%20Message%22"
        },
        "response": {
          "bodySize": 1767,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1767,
            "text": "{\"result\":[{\"_id\":\"849ef5f3-7481-4607-a668-f0b5bf47db4c\",\"name\":\"Twilio IVR: Goodbye Message\",\"description\":\"Goodbye Message\",\"script\":\"LyogVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgZnVsbCBtZXNzYWdlCnZhciBtZXNzYWdlID0gIlRoYW5rIHlvdSBmb3IgY2FsbGluZyBGb3JnZVJvY2sgSWRlbnRpdHkgQ2xvdWQuIEdvb2RieWUhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogR29vZGJ5ZSBNZXNzYWdlOiBmaW5pc2ggW291dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCJdIikpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5nb1RvKG91dGNvbWUpLmJ1aWxkKCk7CiAgCX0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1767"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.765Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "dca69e065db2f28d53a5091ed7f550a5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 560,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"TimeStamp_Login\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22TimeStamp_Login%22"
        },
        "response": {
          "bodySize": 1601,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1601,
            "text": "{\"result\":[{\"_id\":\"b3824c66-2dff-4613-9e54-4a7577fdb765\",\"name\":\"TimeStamp_Login\",\"description\":\"Places a timestamp in the frIndexedMultivalued1 attribute\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKCi8vdmFyIHRpbWVzdGFtcHMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQoImZySW5kZXhlZE11bHRpdmFsdWVkMSIpOwoKCnZhciBsYXN0TG9naW4gPSBuZXcgRGF0ZSgpOwovKgp2YXIgZGF0ZXRpbWUgPSAiIisgY3VycmVudGRhdGUuZ2V0RGF0ZSgpICsgIi8iCiAgICAgICAgICAgICAgICArIChjdXJyZW50ZGF0ZS5nZXRNb250aCgpKzEpICArICIvIiAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0RnVsbFllYXIoKSArICIgQCAiICAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0SG91cnMoKSArICI6IiAgCiAgICAgICAgICAgICAgICArIGN1cnJlbnRkYXRlLmdldE1pbnV0ZXMoKSArICI6IiAKICAgICAgICAgICAgICAgICsgY3VycmVudGRhdGUuZ2V0U2Vjb25kcygpOwoqLwoKdmFyIG9iamVjdEF0dHJpYnV0ZXMgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKCgpzaGFyZWRTdGF0ZS5wdXQoImxhc3QgTG9naW4iLGxhc3RMb2dpbi50b1N0cmluZygpKTsKCgoKCgpvYmplY3RBdHRyaWJ1dGVzLnB1dCgiZnJVbmluZGV4ZWRTdHJpbmcxIixsYXN0TG9naW4udG9TdHJpbmcoKSk7CgoKc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIixvYmplY3RBdHRyaWJ1dGVzKTsKCgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1601"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.809Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "00ea4a4a21519229259c452a1b859b41",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Resend OTP Option\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Resend%20OTP%20Option%22"
        },
        "response": {
          "bodySize": 4847,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4847,
            "text": "{\"result\":[{\"_id\":\"4ee5b182-1b09-45cc-97a9-0e609f0a2915\",\"name\":\"Resend OTP Option\",\"description\":\"Resend OTP Option\",\"script\":\"LyogQ1Jlc2VuZCBPVFAgT3B0aW9uCiAqCiAqIEF1dGhvcjogam9uLmtuaWdodEBmb3JnZXJvY2suY29tLCB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ29sbGVjdCBPVFAgYW5kIHZhbGlkYXRlIHRoZSBjb2xsZWN0ZWQgT1RQLiBBbHNvIG9mZmVyIGEgcmVzZW5kIG9wdGlvbi4KICogUmV0dXJuICJ0cnVlIiBpZiBjb2xsZWN0ZWQgT1RQIGlzIHZhbGlkLCAiZmFsc2UiIGlmIGNvbGxlY3RlZCBPVFAgaXMgaW52YWxpZCwgCiAqIGFuZCByZXNlbmQgaWYgdGhlIHVzZXIgc2VsZWN0ZWQgdGhlIHJlc2VuZCBidXR0b24uCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAtIHJlc2VuZAogKi8KKGZ1bmN0aW9uICgpIHsKICAvLyBob3cgbG9uZyB1bnRpbCB0aGUgInJlc2VuZCIgYnV0dG9uIGJlY29tZXMgZW5hYmxlZC4KICBERUxBWT0yMDsKICAKICAvLyBob3cgbG9uZyAoaW4gc2Vjb25kcykgc2hvdWxkIHRoZSBPVFAgYmUgYWNjZXB0ZWQgYXMgdmFsaWQKICBPVFBfVFRMID0gMzA7CgogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICApCgogIGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdCgpIHsKICAgICAgcmV0dXJuIFN0cmluZygiIFxuXAogICAgICAgICAgdmFyIENPVU5UID0gIiArIERFTEFZICsgIjsgXG5cCiAgICAgICAgICBmdW5jdGlvbiBnbyhvYnMpIHsgXG5cCiAgICAgICAgICAgICAgY29uc3QgcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtdnYtYXM9XCJPbmUgVGltZSBQYXNzY29kZVwiXScpWzBdOyBcblwKICAgICAgICAgICAgICBpZiAocCkgeyBcblwKICAgICAgICAgICAgICAgICAgdmFyIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgXG5cCiAgICAgICAgICAgICAgICAgIGIuaWQgPSAncmVzZW5kQnV0dG9uJzsgXG5cCiAgICAgICAgICAgICAgICAgIGIuY2xhc3NMaXN0LmFkZChcImJ0blwiLCBcIm10LTNcIiwgXCJidG4tc2Vjb25kYXJ5XCIsIFwiYnRuLXNtXCIpOyBcblwKICAgICAgICAgICAgICAgICAgYi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7IHAudmFsdWU9J19fX1JFU0VORF9fXyc7IHAuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpOyB9OyBcblwKICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSAnUmVzZW5kIENvZGUgLi4uICcgKyBDT1VOVCArICdzJzsgXG5cCiAgICAgICAgICAgICAgICAgIGIuZGlzYWJsZWQgPSB0cnVlOyBcblwKICAgICAgICAgICAgICAgICAgcC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShiLCBwLm5leHRTaWJsaW5nKTsgXG5cCiAgICAgICAgICAgICAgICAgIHZhciB0ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7IFxuXAogICAgICAgICAgICAgICAgICAgICAgaWYgKENPVU5UID09IDEpIHsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0KTsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgYi5kaXNhYmxlZCA9IGZhbHNlOyBcblwKICAgICAgICAgICAgICAgICAgICAgICAgICBiLmlubmVySFRNTCA9ICdSZXNlbmQgQ29kZSc7IFxuXAogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgQ09VTlQtLTsgXG5cCiAgICAgICAgICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSAnUmVzZW5kIENvZGUgLi4uICcgKyBDT1VOVCArICdzJzsgXG5cCiAgICAgICAgICAgICAgICAgICAgICB9IFxuXAogICAgICAgICAgICAgICAgICB9LCAxMDAwICk7IFxuXAogICAgICAgICAgICAgICAgICBpZiAob2JzKSBvYnMuZGlzY29ubmVjdCgpOyBcblwKICAgICAgICAgICAgICAgICAgcmV0dXJuOyBcblwKICAgICAgICAgICAgICB9IFxuXAogICAgICAgICAgfSBcblwKICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtkYXRhLXZ2LWFzPVwiT25lIFRpbWUgUGFzc2NvZGVcIl0nKVswXSkgZ28oKTsgXG5cCiAgICAgICAgICBlbHNlIHsgXG5cCiAgICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zLCBvYnMpID0+IHsgZ28ob2JzKTsgfSk7IFxuXAogICAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOyBcblwKICAgICAgICAgIH0gXG5cCiAgICAgICIpOwogIH0KCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKGNyZWF0ZVNjcmlwdCgpKSwKICAgICAgICAgIG5ldyBmci5OYW1lQ2FsbGJhY2soIk9uZSBUaW1lIFBhc3Njb2RlIikKICAgICAgKS5idWlsZCgpCiAgfSBlbHNlIHsKICAgICAgdmFyIG90cFRpbWVzdGFtcCA9IE1hdGguZmxvb3IobmV3IGphdmEudXRpbC5EYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCk7CiAgICAgIHZhciBvdHAgPSBjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKTsKICAgICAgaWYgKG90cCA9PT0gIl9fX1JFU0VORF9fXyIpIHsKICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJyZXNlbmQiKS5idWlsZCgpOwogICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHNlbnRPdHAgPSBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpOwogICAgICAgICAgdmFyIHNlbnRPdHBUaW1lc3RhbXAgPSBzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZFRpbWVzdGFtcCIpOwogICAgICAgICAgaWYgKHNlbnRPdHAgPT0gb3RwICYmIG90cFRpbWVzdGFtcCAtIE9UUF9UVEwgPj0gc2VudE90cFRpbWVzdGFtcCkgewogICAgICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJ0cnVlIikuYnVpbGQoKTsKICAgICAgCSAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5nb1RvKCJmYWxzZSIpLmJ1aWxkKCk7CiAgICAgICAgICB9CiAgICAgIH0KICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4847"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.851Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "9929cd2e154bb9bc3cf8af08a38735a2",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Get Lockout Status\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Get%20Lockout%20Status%22"
        },
        "response": {
          "bodySize": 991,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 991,
            "text": "{\"result\":[{\"_id\":\"cdea92a1-d2bf-4364-a525-fde8b7a95792\",\"name\":\"Get Lockout Status\",\"description\":\"null\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKdmFyIGxvY2tvdXREYXRhQXR0ciA9ICJzdW5BTUF1dGhJbnZhbGlkQXR0ZW1wdHNEYXRhIgp2YXIgYWNjb3VudFN0YXR1c0F0dHIgPSAiaW5ldFVzZXJTdGF0dXMiCgp2YXIgbG9ja291dERhdGEgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBsb2Nrb3V0RGF0YUF0dHIpCnZhciBhY2NvdW50U3RhdHVzID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYWNjb3VudFN0YXR1c0F0dHIpCgp0cmFuc2llbnRTdGF0ZS5wdXQoImxvY2tvdXREYXRhIiwgbG9ja291dERhdGEpCnRyYW5zaWVudFN0YXRlLnB1dCgiYWNjb3VudFN0YXR1cyIsIGFjY291bnRTdGF0dXMpCgpsb2dnZXIuZXJyb3IobG9ja291dERhdGEudG9TdHJpbmcoKSk=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "991"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.894Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "5187b0f50493173936be01fac3f14480",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IDP Lookup\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IDP%20Lookup%22"
        },
        "response": {
          "bodySize": 7641,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7641,
            "text": "{\"result\":[{\"_id\":\"68d5a8e7-fcc9-4215-9e63-a01afe8fa849\",\"name\":\"IDP Lookup\",\"description\":\"Perform IDP lookup based on email domain. Set users' external IDP in shared state or continue to local authentication.\",\"script\":\"LyogSURQIExvb2t1cAogKiAKICogUGVyZm9ybSBJRFAgbG9va3VwIGJhc2VkIG9uIGVtYWlsIGRvbWFpbi4gU2V0IHVzZXJzJyBleHRlcm5hbCBJRFAgaW4gc2hhcmVkIHN0YXRlIG9yIGNvbnRpbnVlIHRvIGxvY2FsIGF1dGhlbnRpY2F0aW9uLgogKiAKICogVGhpcyBzY3JpcHQgcmVxdWlyZXMgcGFyYW1ldHJpemF0aW9uLiBNYWtlIHN1cmUgeW91IGNhcmVmdWxseSByZXZpZXcgdGhlIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVycy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSBvbmUKICogLSBtdWx0aXBsZQogKiAtIG5vbmUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIGxvZ2dlci5tZXNzYWdlKCJJRFAgTG9va3VwOiBzdGFydCIpOwogIAlvdXRjb21lID0gIm5vbmUiOwogIAl2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIik7CiAgCXZhciBkb21haW4gPSB1c2VybmFtZS5zdWJzdHIodXNlcm5hbWUubGFzdEluZGV4T2YoIkAiKSsxKTsKICAJdmFyIHJlZmVyZXIgPSBwYXJzZVVybChyZXF1ZXN0SGVhZGVycy5nZXQoInJlZmVyZXIiKS5nZXQoMCkpOwoKICAJLyogQmVnaW4gQ29uZmlndXJhdGlvbiAqLwogIAogICAgLy8gbG9uZy1saXZlZCB0b2tlbgogICAgdmFyIElETV9BUElfVE9LRU4gPSBzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5hZG1pbi50b2tlbiIpOwogIAogICAgLy8gSURNIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSURNX0FQSV9VUkkgPSByZWZlcmVyLm9yaWdpbiArICIvb3BlbmlkbS9tYW5hZ2VkL2FscGhhX29yZ2FuaXphdGlvbj9fcXVlcnlGaWx0ZXI9aWRwRG9tYWlucytjbysnIiArIGRvbWFpbiArICInJl9maWVsZHM9bmFtZSxkZXNjcmlwdGlvbixpZHBOYW1lLGlkcFR5cGUsaWRwRG9tYWlucyxpZHBKb3VybmV5LGlkcFRoZW1lLGlkcFBlcnNpc3Qsc2FtbENvbmZpZyI7CgogIAkvKiBFbmQgQ29uZmlndXJhdGlvbiAqLwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnR0VUJyk7CiAgICByZXF1ZXN0LnNldFVyaShJRE1fQVBJX1VSSSk7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7CglyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiQmVhcmVyICIgKyBJRE1fQVBJX1RPS0VOKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCQogIAl2YXIgcm91dGVkSURQcyA9IHJlc3VsdC5yZXN1bHQubGVuZ3RoID8gcmVzdWx0LnJlc3VsdCA6IFt7fV07CiAgCS8vIHN0cmluZ2lmeSB0aGUgc2FtbENvbmZpZyBwcm9wZXJ0eQogIAlyb3V0ZWRJRFBzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlZElEUCwgaW5kZXgpIHsKICAgICAgCXJvdXRlZElEUHNbaW5kZXhdLnNhbWxDb25maWcgPSBKU09OLnN0cmluZ2lmeShyb3V0ZWRJRFAuc2FtbENvbmZpZyk7CiAgICB9KTsKICAJc2hhcmVkU3RhdGUucHV0KCJyb3V0ZWRJRFBzIiwgcm91dGVkSURQcyk7CglpZiAocmVzdWx0LnJlc3VsdENvdW50ID09PSAxKSB7CiAgICAJbG9nZ2VyLm1lc3NhZ2UoIklEUCBMb29rdXA6IEZvdW5kIGV4YWN0bHkgMSBJRFAiKTsKICAgICAgICBvdXRjb21lID0gIm9uZSI7CiAgICB9CiAgCWVsc2UgaWYgKHJlc3VsdC5yZXN1bHRDb3VudCA+IDEpIHsKICAgIAlsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogRm91bmQge30gSURQcyIsIHJlc3VsdC5yZXN1bHRDb3VudCk7CiAgICAgICAgb3V0Y29tZSA9ICJtdWx0aXBsZSI7CiAgICB9CiAgCWVsc2UgewogICAgCWxvZ2dlci5tZXNzYWdlKCJJRFAgTG9va3VwOiBGb3VuZCBubyBJRFBzIik7CiAgICB9CiAgICBsb2dnZXIubWVzc2FnZSgiSURQIExvb2t1cDogZW5kIFtvdXRjb21lPXt9XSIsIG91dGNvbWUpOwoKICAgIC8qCiAgICAgKiBQYXJzZSBhIFVSTCBpbnRvIGl0cyBjb21wb25lbnRzIGFuZCBtYWtlIHRoZW0gZWFzaWx5IGFjY2Vzc2libGUgYnkgbmFtZQogICAgICoKICAgICAqIFVzZSBpbiBhIFNjcmlwdGUgRGVjaXNpb24gTm9kZSBTY3JpcHQgYXMgZm9sbG93czoKICAgICAqIHZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAgICAqIHZhciBvcmlnaW4gPSByZWZlcmVyLm9yaWdpbjsKICAgICAqIAogICAgICogZS5nLjogaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAgICAgKiB7CiAgICAgKiAgICAgaGFzaDogJyMvJywKICAgICAqICAgICBob3N0OiAnb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBob3N0bmFtZTogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaHJlZjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLycsCiAgICAgKiAgICAgb3JpZ2luOiAnaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIHBhdGhuYW1lOiAnL2FtL1hVSS8nLAogICAgICogICAgIHBvcnQ6ICcnLAogICAgICogICAgIHByb3RvY29sOiAnaHR0cHMnLAogICAgICogICAgIHNlYXJjaDogJz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbScsCiAgICAgKiAgICAgdXNlcm5hbWU6ICcnLAogICAgICogICAgIHBhc3N3b3JkOiAnJywKICAgICAqICAgICBzZWFyY2hQYXJhbTogewogICAgICogICAgICAgICByZWFsbTogJy9icmF2bycsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFR5cGU6ICdzZXJ2aWNlJywKICAgICAqICAgICAgICAgYXV0aEluZGV4VmFsdWU6ICdJbml0aWF0ZU93bmVyQ2xhaW0nCiAgICAgKiAgICAgfQogICAgICogfQogICAgICovCiAgICBmdW5jdGlvbiBwYXJzZVVybChocmVmKSB7CiAgICAgICAgdmFyIG0gPSBocmVmLm1hdGNoKC9eKChbXjpcLz8jXSspOj8oPzpcL1wvKCg/OihbXlwvPyM6XSopOihbXlwvPyM6XSopQCk/KFteXC8/IzpdKikoPzo6KFteXC8/IzpdKikpPykpKT8oW14/I10qKShcP1teI10qKT8oIy4qKT8kLyksCiAgICAgICAgciA9IHsKICAgICAgICAgICAgaGFzaDogbVsxMF0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgIC8vICMvCiAgICAgICAgICAgIGhvc3Q6IG1bM10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaG9zdG5hbWU6IG1bNl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIG9wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBocmVmOiBtWzBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20vYW0vWFVJLz9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbSMvCiAgICAgICAgICAgIG9yaWdpbjogbVsxXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbQogICAgICAgICAgICBwYXRobmFtZTogbVs4XSB8fCAobVsxXSA/ICIvIiA6ICIiKSwgICAgLy8gL2FtL1hVSS8KICAgICAgICAgICAgcG9ydDogbVs3XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwcm90b2NvbDogbVsyXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gaHR0cHMKICAgICAgICAgICAgc2VhcmNoOiBtWzldIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgIC8vID9yZWFsbT0vYnJhdm8mYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPUluaXRpYXRlT3duZXJDbGFpbQogICAgICAgICAgICB1c2VybmFtZTogbVs0XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHBhc3N3b3JkOiBtWzVdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgc2VhcmNoUGFyYW06IHt9ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHsgcmVhbG06ICcvYnJhdm8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJyB9CiAgICAgICAgfTsKICAgICAgICBpZiAoci5wcm90b2NvbC5sZW5ndGggPT0gMikgewogICAgICAgICAgICByLnByb3RvY29sID0gImZpbGU6Ly8vIiArIHIucHJvdG9jb2wudG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgci5vcmlnaW4gPSByLnByb3RvY29sICsgIi8vIiArIHIuaG9zdDsKICAgICAgICB9CiAgICAgICAgaWYgKHIuc2VhcmNoLmxlbmd0aCA+IDIpIHsKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gKHIuc2VhcmNoLmluZGV4T2YoJz8nKSA9PT0gMCkgPyByLnNlYXJjaC5zdWJzdHIoMSkgOiByLnNlYXJjaDsKICAgICAgICAgICAgdmFyIHZhcnMgPSBxdWVyeS5zcGxpdCgnJicpOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KCc9Jyk7CiAgICAgICAgICAgIHIuc2VhcmNoUGFyYW1bZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByLmhyZWYgPSByLm9yaWdpbiArIHIucGF0aG5hbWUgKyByLnNlYXJjaCArIHIuaGFzaDsKICAgICAgICByZXR1cm4gcjsKICAgIH07Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7641"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.932Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "f4d237bca4e32a799ade30131dd79e5a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Show Password Policy\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Show%20Password%20Policy%22"
        },
        "response": {
          "bodySize": 3117,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3117,
            "text": "{\"result\":[{\"_id\":\"021e434f-89b6-45fb-9d67-5147bc1650c3\",\"name\":\"Show Password Policy\",\"description\":\"null\",\"script\":\"dmFyIG91dHB1dCA9IHRydWU7CnZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CnZhciBoYWxpZ24gPSAibGVmdCI7CnZhciBtZXNzYWdlID0gIjx1bD48bGk+TXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZzwvbGk+Ii5jb25jYXQoCiAgICAiPGxpPk11c3QgYmUgbGVzcyB0aGFuIDY0IGNoYXJhY3RlcnMgbG9uZzwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IG5vdCBzaGFyZSBjaGFyYWN0ZXJzIHdpdGggZW1haWwsIHVzZXJuYW1lLCBmaXJzdCBuYW1lLCBsYXN0IG5hbWU8L2xpPiIpLmNvbmNhdCgKICAgICI8bGk+TXVzdCBoYXZlIGF0IGxlYXN0IDEgbG93ZXJjYXNlIGxldHRlcihzKTwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IGhhdmUgYXQgbGVhc3QgMSBjYXBpdGFsIGxldHRlcihzKTwvbGk+IikuY29uY2F0KAogICAgIjxsaT5NdXN0IGhhdmUgYXQgbGVhc3QgMSBudW1iZXIocyk8L2xpPiIpLmNvbmNhdCgKICAgICI8bGk+TXVzdCBoYXZlIGF0IGxlYXN0IDEgc3ltYm9sKHMpPC9saT48L3VsPiIpCnZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FsbGJhY2stY29tcG9uZW50JykpLmZvckVhY2goXG4iKS5jb25jYXQoCiAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICIgIGlmIChtZXNzYWdlLmZpcnN0Q2hpbGQgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVOYW1lID09ICcjdGV4dCcgJiYgbWVzc2FnZS5maXJzdENoaWxkLm5vZGVWYWx1ZS50cmltKCkgPT0gJyIpLmNvbmNhdChhbmNob3IpLmNvbmNhdCgiJykge1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcInRleHQtbGVmdFwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5hbGlnbiA9IFwiIikuY29uY2F0KGhhbGlnbikuY29uY2F0KCJcIjtcbiIpLmNvbmNhdCgKICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgIiAgfVxuIikuY29uY2F0KAogICJ9KSIpCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2ssCiAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAobWVzc2FnZS5sZW5ndGggJiYgY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICBhbmNob3IKICAgICAgICApLAogICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KQogICAgKS5idWlsZCgpCn0KZWxzZSB7CiAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwp9CgogLyoKICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgKiAKICAqIEV4YW1wbGU6CiAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAqICd4eHgteHh4JyBwcm9kdWNlcyAnNDMyLTUyMScKICAqLwpmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvW3hdL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTApOwogICAgfSk7Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3117"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:31.971Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "f3bc0a41febd32096ac168e879a7f6ca",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_SetSocialGoogle\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_SetSocialGoogle%22"
        },
        "response": {
          "bodySize": 1047,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1047,
            "text": "{\"result\":[{\"_id\":\"16d15256-9670-482c-b4da-2547591be4c7\",\"name\":\"AT_SetSocialGoogle\",\"description\":\"Set the shared state to select Google as the social provider\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICogQVRfU2V0U29jaWFsSWRkYXRhd2ViLCBTY3JpcHQgdG8gc2V0IHRoZSBzb2NpYWwgcHJvdmlkZXIgdHlwZSB0byBJRERhdGFXZWIKKi8Kc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsICJnb29nbGUiKTsKCm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1047"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.010Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "ac4a5690b516ce3d9151094554bd8692",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 578,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"APIProtection: Reset States\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22APIProtection%3A%20Reset%20States%22"
        },
        "response": {
          "bodySize": 2470,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2470,
            "text": "{\"result\":[{\"_id\":\"f1a2764b-d05a-4480-8f5f-78fda7814227\",\"name\":\"APIProtection: Reset States\",\"description\":\"APIProtection: Reset State\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IFJlc2V0IFN0YXRlczogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqCiAqIE91dGNvbWVzOgogKiAtICJ0cnVlIgogKi8KdmFyIEtFWV9IRUFERVJfTkFNRSA9ICJ4LWFwaS1rZXkiOwp2YXIgU0VDUkVUX0hFQURFUl9OQU1FID0gIngtYXBpLXNlY3JldCI7Ci8qCiAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogKi8KCm91dGNvbWUgPSAidHJ1ZSI7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpID09IHJlYWRWYWx1ZShLRVlfSEVBREVSX05BTUUpKSB7Cglsb2dnZXIud2FybmluZygiQVBJUHJvdGVjdGlvbjogUmVzZXQgU3RhdGVzOiByZXNldHRpbmcgdXNlcm5hbWUgdG86Ii5jb25jYXQocmVhZFZhbHVlKCJ1c2VybmFtZSIpKSk7CiAgCXNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCByZWFkVmFsdWUoInVzZXJuYW1lIikpOwp9CgppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpID09IHJlYWRUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUpKSB7Cglsb2dnZXIud2FybmluZygiQVBJUHJvdGVjdGlvbjogUmVzZXQgU3RhdGVzOiByZXNldHRpbmcgcGFzc3dvcmQiKTsKICAJdHJhbnNpZW50U3RhdGUucHV0KCJwYXNzd29yZCIsIHJlYWRUcmFuc2llbnRWYWx1ZSgicGFzc3dvcmQiKSk7Cn0KCmxvZ2dlci53YXJuaW5nKCJBUElQcm90ZWN0aW9uOiBSZXNldCBTdGF0ZXM6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgovKgogKiBSZWFkIHZhbHVlIGZyb20gc3RvcmFnZSBmb3IgQVBJUHJvdGVjdGlvbiBzY3JpcHQgdXNlCiAqLwpmdW5jdGlvbiByZWFkVmFsdWUobmFtZSkgewogIAl2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgiQVBJUHJvdGVjdGlvbiIpOwogICAgaWYgKHN0b3JhZ2UpIHsKICAgICAgCWlmIChzdG9yYWdlLmdldCkgewoJICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiBzdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogIAlyZXR1cm4gbnVsbDsKfQoKLyoKICogUmVhZCB0cmFuc2llbnQgdmFsdWUgZnJvbSBzdG9yYWdlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHJlYWRUcmFuc2llbnRWYWx1ZShuYW1lKSB7CiAgCXZhciB0cmFuc2llbnRTdG9yYWdlID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIik7CiAgICBpZiAodHJhbnNpZW50U3RvcmFnZSkgewogICAgICAJaWYgKHRyYW5zaWVudFN0b3JhZ2UuZ2V0KSB7CgkgICAgICAgIHJldHVybiB0cmFuc2llbnRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKS5nZXQobmFtZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJcmV0dXJuIHRyYW5zaWVudFN0b3JhZ2UubmFtZTsKICAgICAgICB9CiAgICB9CiAgCXJldHVybiBudWxsOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2470"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.048Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "95687ca8cd54b4080cd26c9763faff82",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_Optin-New\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_Optin-New%22"
        },
        "response": {
          "bodySize": 1409,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1409,
            "text": "{\"result\":[{\"_id\":\"0ef43500-b374-435e-9411-3d9046013676\",\"name\":\"AT_Optin-New\",\"description\":\"This script puts 'new' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICduZXcnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbIm5ldyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1409"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.085Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "00361605591f1ff9389afa080c9b2be2",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 573,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_CopyOTPToObjectAttributes\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_CopyOTPToObjectAttributes%22"
        },
        "response": {
          "bodySize": 1083,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1083,
            "text": "{\"result\":[{\"_id\":\"1a916c19-8d81-47c5-9707-c3d33923304c\",\"name\":\"AT_CopyOTPToObjectAttributes\",\"description\":\"Copy an OTP generated by the \\\"HOTP Generator\\\" node to the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyoKICogQ29weSBhbiBPVFAgZ2VuZXJhdGVkIGJ5IHRoZSAiSE9UUCBHZW5lcmF0b3IiIG5vZGUgdG8gdGhlIElETSBwcm9maWxlIAogKiBzaGFyZWQgc3RhdGUgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICovCgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLnB1dCgiZGVzY3JpcHRpb24iLCB0cmFuc2llbnRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKQp9CmVsc2UgewogICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwge2Rlc2NyaXB0aW9uOiB0cmFuc2llbnRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpfSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1083"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.124Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "2a9f530643f4706d7f45ce06633d6226",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 574,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio Voice OTP Sender\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20Voice%20OTP%20Sender%22"
        },
        "response": {
          "bodySize": 7959,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7959,
            "text": "{\"result\":[{\"_id\":\"e0666b8b-f625-4047-89d8-e7e91151027f\",\"name\":\"Twilio Voice OTP Sender\",\"description\":\"Twilio Voice OTP Sender\",\"script\":\"LyogVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXIKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogVGhpcyBzY3JpcHQgd2lsbCBkZWxpdmVyIHRoZSBPVFAgdmlhIHZvaWNlIHRvIHRoZSBwaG9uZSBudW1iZXIgaW4gdGhlIHVzZXIncyBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBhbmQgSE9UUCBHZW5lcmF0b3Igbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHNlbnQKICogLSBmYWlsZWQKICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogc3RhcnQiKTsKCmlmIChzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpICYmIGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkuaGFzTmV4dCgpKSB7CiAgICB2YXIgQmFzZTY0PXtfa2V5U3RyOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSIsZW5jb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMyxlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9QmFzZTY0Ll91dGY4X2VuY29kZShpbnB1dCk7d2hpbGUoaTxpbnB1dC5sZW5ndGgpe2NocjE9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjI9aW5wdXQuY2hhckNvZGVBdChpKyspO2NocjM9aW5wdXQuY2hhckNvZGVBdChpKyspO2VuYzE9Y2hyMT4+MjtlbmMyPShjaHIxJjMpPDw0fGNocjI+PjQ7ZW5jMz0oY2hyMiYxNSk8PDJ8Y2hyMz4+NjtlbmM0PWNocjMmNjM7aWYoaXNOYU4oY2hyMikpe2VuYzM9ZW5jND02NH1lbHNlIGlmKGlzTmFOKGNocjMpKXtlbmM0PTY0fW91dHB1dD1vdXRwdXQrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMxKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzIpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMykrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KX1yZXR1cm4gb3V0cHV0fSxkZWNvZGU6ZnVuY3Rpb24oaW5wdXQpe3ZhciBvdXRwdXQ9IiI7dmFyIGNocjEsY2hyMixjaHIzO3ZhciBlbmMxLGVuYzIsZW5jMyxlbmM0O3ZhciBpPTA7aW5wdXQ9aW5wdXQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXD1dL2csIiIpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtlbmMxPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMyPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmMzPXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtlbmM0PXRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtjaHIxPWVuYzE8PDJ8ZW5jMj4+NDtjaHIyPShlbmMyJjE1KTw8NHxlbmMzPj4yO2NocjM9KGVuYzMmMyk8PDZ8ZW5jNDtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7aWYoZW5jMyE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKX1pZihlbmM0IT02NCl7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjMpfX1vdXRwdXQ9QmFzZTY0Ll91dGY4X2RlY29kZShvdXRwdXQpO3JldHVybiBvdXRwdXR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXHJcbi9nLCJcbiIpO3ZhciB1dGZ0ZXh0PSIiO2Zvcih2YXIgbj0wO248c3RyaW5nLmxlbmd0aDtuKyspe3ZhciBjPXN0cmluZy5jaGFyQ29kZUF0KG4pO2lmKGM8MTI4KXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGMpfWVsc2UgaWYoYz4xMjcmJmM8MjA0OCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42fDE5Mik7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9ZWxzZXt1dGZ0ZXh0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKGM+PjEyfDIyNCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj42JjYzfDEyOCk7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjJjYzfDEyOCl9fXJldHVybiB1dGZ0ZXh0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24odXRmdGV4dCl7dmFyIHN0cmluZz0iIjt2YXIgaT0wO3ZhciBjPWMxPWMyPTA7d2hpbGUoaTx1dGZ0ZXh0Lmxlbmd0aCl7Yz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSk7aWYoYzwxMjgpe3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZShjKTtpKyt9ZWxzZSBpZihjPjE5MSYmYzwyMjQpe2MyPXV0ZnRleHQuY2hhckNvZGVBdChpKzEpO3N0cmluZys9U3RyaW5nLmZyb21DaGFyQ29kZSgoYyYzMSk8PDZ8YzImNjMpO2krPTJ9ZWxzZXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtjMz11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsyKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtpKz0zfX1yZXR1cm4gc3RyaW5nfX07CgogICAgLyogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqLwogICAgdmFyIFRXSUxJT19BUElfU0lEID0gIkFDNzUwNDE1ZTMxNjNhMmU1N2I3YWVlYTdlZWQ4MmQ5NDQiOwogICAgdmFyIFRXSUxJT19BUElfVE9LRU4gPSAiY2UyODMzNTgwOGUwYmZjZGI2YjliYTkxYzNiOGFmYzMiOwogICAgdmFyIFRXSUxJT19BUElfRlJPTSA9ICIrMTMxNzY0NDMxMDciOwogICAgLyoKICAgICAqIEVORCBTQ1JJUFQgQ09ORklHVVJBVElPTgogICAgICovCiAgCiAgICAvLyBUd2lsaW8gU01TIE1lc3NhZ2UgQVBJIENvbmZpZ3VyYXRpb24KICAgIHZhciBUV0lMSU9fQVBJX1VSSSA9ICJodHRwczovL2FwaS50d2lsaW8uY29tLzIwMTAtMDQtMDEvQWNjb3VudHMvIi5jb25jYXQoVFdJTElPX0FQSV9TSUQpLmNvbmNhdCgiL0NhbGxzLmpzb24iKTsJCiAgICB2YXIgVFdJTElPX0FQSV9UTyA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSwgInRlbGVwaG9uZU51bWJlciIpLml0ZXJhdG9yKCkubmV4dCgpOwogIAl2YXIgT1RQID0gc2hhcmVkU3RhdGUuZ2V0KCJvbmVUaW1lUGFzc3dvcmQiKS5zcGxpdCgiIikuam9pbigiOyAiKTsKICAgIHZhciBUV0lMSU9fQVBJX1RXSU1MID0gIjxSZXNwb25zZT48UGF1c2UgbGVuZ3RoPScxJy8+PFNheSB2b2ljZT0nYWxpY2UnPllvdXIgb25lLXRpbWUgcGFzc3dvcmQgaXMgIi5jb25jYXQoT1RQKS5jb25jYXQoIjwvU2F5PjxQYXVzZSBsZW5ndGg9JzEnLz48U2F5PllvdXIgb25lLXRpbWUgcGFzc3dvcmQgaXMgIikuY29uY2F0KE9UUCkuY29uY2F0KCI8L1NheT48UGF1c2UgbGVuZ3RoPScxJy8+PFNheT5Hb29kYnllPC9TYXk+PC9SZXNwb25zZT4iKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBWb2ljZSBPVFAgU2VuZGVyOiBUbzogIi5jb25jYXQoVFdJTElPX0FQSV9UTykpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IFR3aW1sOiAiLmNvbmNhdChUV0lMSU9fQVBJX1RXSU1MKSk7CgogICAgdmFyIEFVVEhaID0gIkJhc2ljICIuY29uY2F0KEJhc2U2NC5lbmNvZGUoVFdJTElPX0FQSV9TSUQuY29uY2F0KCc6JykuY29uY2F0KFRXSUxJT19BUElfVE9LRU4pKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJUd2ltbCIsIFRXSUxJT19BUElfVFdJTUwpOwogICAgcGFyYW1zLmFkZCgiVG8iLCBUV0lMSU9fQVBJX1RPKTsKICAgIHJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKHBhcmFtcy50b1N0cmluZygpKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEpTT04gcmVzdWx0OiAiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogICAgaWYgKHJlc3VsdFsic3RhdHVzIl09PSJxdWV1ZWQiKSB7CiAgICAgICAgb3V0Y29tZSA9IHJlc3VsdFsic3RhdHVzIl07CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogc3RhdHVzID0gIi5jb25jYXQocmVzdWx0WyJzdGF0dXMiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IHN1YnJlc291cmNlX3VyaXMgPSAiLmNvbmNhdChyZXN1bHRbInN1YnJlc291cmNlX3VyaXMiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG91dGNvbWUgPSAiLmNvbmNhdChvdXRjb21lKSk7CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBWb2ljZSBPVFAgU2VuZGVyOiBzdGF0dXMgPSAiLmNvbmNhdChyZXN1bHRbInN0YXR1cyJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogbW9yZV9pbmZvID0gIi5jb25jYXQocmVzdWx0WyJtb3JlX2luZm8iXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG1lc3NhZ2UgPSAiLmNvbmNhdChyZXN1bHRbIm1lc3NhZ2UiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFZvaWNlIE9UUCBTZW5kZXI6IG91dGNvbWUgPSAiLmNvbmNhdChvdXRjb21lKSk7CiAgICB9Cn0gZWxzZSB7CiAgCW91dGNvbWUgPSAiZmFpbGVkIjsKICAJbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogTm8gdXNlciBvciBwaG9uZSBudW1iZXIgZm91bmQhIFVzZSAnSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSB0aGUgdXNlcidzIF9pZCBpbiBzaGFyZWQgc3RhdGUhJyIpOwogICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gVm9pY2UgT1RQIFNlbmRlcjogb3V0Y29tZSA9ICIuY29uY2F0KG91dGNvbWUpKTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7959"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.163Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "61d203bb450e8837a09ab43e3560c862",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"hashdeviceProfile\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22hashdeviceProfile%22"
        },
        "response": {
          "bodySize": 1438,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1438,
            "text": "{\"result\":[{\"_id\":\"e15a13ee-9168-40cf-934f-656a5f568a6a\",\"name\":\"hashdeviceProfile\",\"description\":\"null\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKLy88c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vd3d3Lm15ZXJzZGFpbHkub3JnL2pvc2VwaC9qYXZhc2NyaXB0L21kNS5qcyIgLz4KCmZ1bmN0aW9uIGhhc2hDb2RlKHIpe3ZhciBlLGg9MDtmb3IoZT0wO2U8ci5sZW5ndGg7ZSsrKWg9KGg8PDUpLWgrci5jaGFyQ29kZUF0KGUpLGh8PTA7cmV0dXJuIGg+Pj4wfQoKCnZhciBoYXNoTWUgPSBzaGFyZWRTdGF0ZS5nZXQoImZvcmdlUm9jay5kZXZpY2UucHJvZmlsZSIpOwp2YXIgaGFzaE1lID0gc2hhcmVkU3RhdGUucHV0KCJmb3JnZVJvY2suZGV2aWNlLnByb2ZpbGUiLCJkZWxldGVkIGluIHNjcmlwdCAtIGhhc2hkZXZpY2VQcm9maWxlIik7Ci8vdmFyIGhhc2hNZVN0ciA9IEpTT04uc3RyaW5naWZ5KGhhc2hNZSk7Ci8vbG9nZ2VyLmVycm9yKCJIYXNoTWVTdHI6ICIgKyBoYXNoTWVTdHIpOwoKc2hhcmVkU3RhdGUucHV0KCJkZXZpY2VIYXNoIixoYXNoQ29kZShlc2NhcGUoaGFzaE1lKSkudG9TdHJpbmcoKSk7CnNoYXJlZFN0YXRlLnB1dCgiZnJJbmRleGVkU3RyaW5nMSIsaGFzaENvZGUoZXNjYXBlKGhhc2hNZSkpLnRvU3RyaW5nKCkpOwoKb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1438"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.204Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "9196116f3b5de29eb77fdcbf37e9bd53",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display States - imported (1)\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20States%20-%20imported%20%281%29%22"
        },
        "response": {
          "bodySize": 3805,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3805,
            "text": "{\"result\":[{\"_id\":\"e49225eb-e7ad-4699-bf2a-d57689f9cd6e\",\"name\":\"Display States - imported (1)\",\"description\":\"Display sharedState and transientState.\",\"script\":\"LyogRGlzcGxheSBTdGF0ZXMKICogCiAqIERpc3BsYXkgc2hhcmVkU3RhdGUgYW5kIHRyYW5zaWVudFN0YXRlLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwogICAgdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICAgICAiPHA+PGI+U2hhcmVkIFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAgICAgICBzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAgICAgIjxwPjxiPlRyYW5zaWVudCBTdGF0ZTwvYj46PGJyLz4iKS5jb25jYXQoCiAgICAgICAgdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikuY29uY2F0KAogICAgICAgICI8cD48Yj5SZXF1ZXN0IEhlYWRlcnM8L2I+Ojxici8+IikuY29uY2F0KAogICAgICAgIHJlcXVlc3RIZWFkZXJzLnRvU3RyaW5nKCkpLmNvbmNhdCgiPC9wPiIpCiAgICB2YXIgc2NyaXB0ID0gIkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKFxuIi5jb25jYXQoCiAgICAgICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAgICAgImZ1bmN0aW9uIChlKSB7XG4iKS5jb25jYXQoCiAgICAgICIgIHZhciBtZXNzYWdlID0gZS5maXJzdEVsZW1lbnRDaGlsZDtcbiIpLmNvbmNhdCgKICAgICAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5jbGFzc05hbWUgPSBcIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2Uuc3R5bGUgPSBcInRleHQtYWxpZ246IGxlZnQ7IGlubGluZS1zaXplOiA0MzBweDsgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDtcIjtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuaW5uZXJIVE1MID0gJyIpLmNvbmNhdChtZXNzYWdlKS5jb25jYXQoIic7XG4iKS5jb25jYXQoCiAgICAgICIgIH1cbiIpLmNvbmNhdCgKICAgICAgIn0pIikKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIGlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAgIG5ldyBmci5UZXh0T3V0cHV0Q2FsbGJhY2soCiAgICAgICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBhbmNob3IKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KCiAgICAgLyoKICAgICAgKiBHZW5lcmF0ZSBhIHRva2VuIGluIHRoZSBkZXNpcmVkIGZvcm1hdC4gQWxsICd4JyBjaGFyYWN0ZXJzIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHJhbmRvbSBudW1iZXIgMC05LgogICAgICAqIAogICAgICAqIEV4YW1wbGU6CiAgICAgICogJ3h4eHh4JyBwcm9kdWNlcyAnMjg1MzUnCiAgICAgICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVOdW1lcmljVG9rZW4oZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTB8MDsKICAgICAgICAgICAgdmFyIHYgPSByOwogICAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICAgICAgfSk7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3805"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.244Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "4bc9120f25a9243849c85a20a60e3c33",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 618,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ForgeRock Internal: OAuth2 Access Token Modification Script\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ForgeRock%20Internal%3A%20OAuth2%20Access%20Token%20Modification%20Script%22"
        },
        "response": {
          "bodySize": 536,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 536,
            "text": "{\"result\":[{\"_id\":\"c234ba0b-58a1-4cfd-9567-09edde980745\",\"name\":\"ForgeRock Internal: OAuth2 Access Token Modification Script\",\"description\":\"Internal token modification script\",\"script\":\"Ly8gU2NyaXB0IGlzIGludGVudGlvbmFsbHkgZW1wdHkK\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"OAUTH2_ACCESS_TOKEN_MODIFICATION\",\"createdBy\":\"null\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "536"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.285Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "865fb6f22306e7de30ce28e5ec301705",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 562,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"display country\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22display%20country%22"
        },
        "response": {
          "bodySize": 1100,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1100,
            "text": "{\"result\":[{\"_id\":\"8bccfdd0-5556-4562-a1ca-6d725a449556\",\"name\":\"display country\",\"description\":\"null\",\"script\":\"dmFyIGZyID0gSmF2YUltcG9ydGVyKAogIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKTsKICAKb3V0Y29tZSA9ICJ0cnVlIjsKCnZhciBjb3VudHJ5ID0gInVua25vd24iOwppZiAodHJhbnNpZW50U3RhdGUuZ2V0KCJpcHN0YWNrIikpIHsKCWNvdW50cnkgPSBKU09OLnBhcnNlKHRyYW5zaWVudFN0YXRlLmdldCgiaXBzdGFjayIpKS5jb3VudHJ5X2NvZGU7Cn0KICAKd2l0aCAoZnIpIHsKICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgdmFyIGNhbGxiYWNrID0gbmV3IFRleHRPdXRwdXRDYWxsYmFjayhUZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sICJDb3VudHJ5OiAiLmNvbmNhdChjb3VudHJ5KSk7CiAgICBhY3Rpb24gPSBBY3Rpb24uc2VuZChjYWxsYmFjaykuYnVpbGQoKTsKICB9IGVsc2UgewogICAgYWN0aW9uID0gQWN0aW9uLmdvVG8oInRydWUiKS5idWlsZCgpOwogIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1100"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.325Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "7fe967363d461a51ddb1515ede56cbbd",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Onfido-CheckApplicant\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Onfido-CheckApplicant%22"
        },
        "response": {
          "bodySize": 2713,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2713,
            "text": "{\"result\":[{\"_id\":\"d2a41d85-d33a-42d9-a7dd-50dfbc9fa7c0\",\"name\":\"Onfido-CheckApplicant\",\"description\":\"Check Applicant\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tBcHBsaWNhbnQ6IFN0YXJ0Iik7CgovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICoKICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIE9ORklETyBBUEkgVE9LRU4KICovCi8vdmFyIE9ORklET19BUElfVE9LRU4gPSAiYXBpX2xpdmUuU3RVZGZ4ZGlDRmIuWXJ6YmFkeEJfUjItcUc1bEZVYzNsV2c2SkFjM0NucS0iCnZhciBPTkZJRE9fQVBJX1RPS0VOID0gImFwaV9saXZlLkg1eXNSdXNBb21ZLm5iYmtpbW9XYzkxY0RaQVdKWmtKdDBUa3Fkam0xUmpyIjsKLyoKICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwoKdmFyIHJlcXVlc3RCb2R5SnNvbiA9IHsKICAgICJhcHBsaWNhbnRfaWQiOiBTdHJpbmcoc2hhcmVkU3RhdGUuZ2V0KCJvbmZpZG9BcHBsaWNhbnRJRCIpKSwKICAgICJyZXBvcnRfbmFtZXMiOiBbImRvY3VtZW50IiwgImZhY2lhbF9zaW1pbGFyaXR5X3Bob3RvIl0KfQovLyB2YXIgcmVxdWVzdEJvZHlKc29uID0gewovLyAgICAgImFwcGxpY2FudF9pZCI6IFN0cmluZyhzaGFyZWRTdGF0ZS5nZXQoIm9uZmlkb0FwcGxpY2FudElEIikpLAovLyAgICAgInJlcG9ydF9uYW1lcyI6IFsiZG9jdW1lbnQiXQovLyB9Cgp2YXIgZmFpbHVyZSA9IHRydWUKCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0CikKCnZhciByZXF1ZXN0ID0gbmV3IGZyLlJlcXVlc3QoKQpyZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9hcGkub25maWRvLmNvbS92My9jaGVja3MiKQpyZXF1ZXN0LnNldE1ldGhvZCgiUE9TVCIpCnJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgiKQpyZXF1ZXN0LmdldEhlYWRlcnMoKS5hZGQoIkF1dGhvcml6YXRpb24iLCAiVG9rZW4gdG9rZW49IiArIE9ORklET19BUElfVE9LRU4pCnJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5SnNvbikpCgp2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCkKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tBcHBsaWNhbnQ6IEluaXRpYXRlIGNoZWNrcyByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCmlmIChyZXNwb25zZS5nZXRTdGF0dXMoKS5nZXRDb2RlKCkgPT09IDIwMCkgewogICAgdmFyIGlkID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSkuaWQKICAgIGZhaWx1cmUgPSAhaWQKICAgIGlmICghZmFpbHVyZSkgc2hhcmVkU3RhdGUucHV0KCJvbmZpZG9BdXRoVG9rZW4iLCBpZCk7Cn0gZWxzZSB7CiAgICBmYWlsdXJlID0gdHJ1ZQp9CgpvdXRjb21lID0gZmFpbHVyZSA/ICJmYWxzZSIgOiAidHJ1ZSI7CmxvZ2dlci5lcnJvcigiT25maWRvLUNoZWNrQXBwbGljYW50OiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2713"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.365Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "baaad590616db993e8fcd1d072a604a4",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 572,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio SMS OTP Sender\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20SMS%20OTP%20Sender%22"
        },
        "response": {
          "bodySize": 7459,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7459,
            "text": "{\"result\":[{\"_id\":\"91554b10-79a5-4aa8-aca1-59481a734c19\",\"name\":\"Twilio SMS OTP Sender\",\"description\":\"Twilio SMS OTP Sender\",\"script\":\"LyogVHdpbGlvIFNNUyBPVFAgU2VuZGVyCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFRoaXMgc2NyaXB0IHdpbGwgc2VuZCBhbiBTTVMgY29udGFpbmluZyB0aGUgT1RQIHRvIHRoZSBwaG9uZSBudW1iZXIgaW4gdGhlIHVzZXIncyBwcm9maWxlLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIElkZW50aWZ5IEV4aXN0aW5nIFVzZXIgbm9kZSBhbmQgSE9UUCBHZW5lcmF0b3Igbm9kZSBiZWZvcmUgaXQgaXMgYmVpbmcgY2FsbGVkLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHNlbnQKICogLSBmYWlsZWQKICovCmxvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IHN0YXJ0Iik7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKSAmJiBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLmhhc05leHQoKSkgewogICAgdmFyIEJhc2U2ND17X2tleVN0cjoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iLGVuY29kZTpmdW5jdGlvbihpbnB1dCl7dmFyIG91dHB1dD0iIjt2YXIgY2hyMSxjaHIyLGNocjMsZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PUJhc2U2NC5fdXRmOF9lbmNvZGUoaW5wdXQpO3doaWxlKGk8aW5wdXQubGVuZ3RoKXtjaHIxPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIyPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtjaHIzPWlucHV0LmNoYXJDb2RlQXQoaSsrKTtlbmMxPWNocjE+PjI7ZW5jMj0oY2hyMSYzKTw8NHxjaHIyPj40O2VuYzM9KGNocjImMTUpPDwyfGNocjM+PjY7ZW5jND1jaHIzJjYzO2lmKGlzTmFOKGNocjIpKXtlbmMzPWVuYzQ9NjR9ZWxzZSBpZihpc05hTihjaHIzKSl7ZW5jND02NH1vdXRwdXQ9b3V0cHV0K3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jMSkrdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMyKSt0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzMpK3RoaXMuX2tleVN0ci5jaGFyQXQoZW5jNCl9cmV0dXJuIG91dHB1dH0sZGVjb2RlOmZ1bmN0aW9uKGlucHV0KXt2YXIgb3V0cHV0PSIiO3ZhciBjaHIxLGNocjIsY2hyMzt2YXIgZW5jMSxlbmMyLGVuYzMsZW5jNDt2YXIgaT0wO2lucHV0PWlucHV0LnJlcGxhY2UoL1teQS1aYS16MC05XCtcL1w9XS9nLCIiKTt3aGlsZShpPGlucHV0Lmxlbmd0aCl7ZW5jMT10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMj10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jMz10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7ZW5jND10aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7Y2hyMT1lbmMxPDwyfGVuYzI+PjQ7Y2hyMj0oZW5jMiYxNSk8PDR8ZW5jMz4+MjtjaHIzPShlbmMzJjMpPDw2fGVuYzQ7b3V0cHV0PW91dHB1dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjEpO2lmKGVuYzMhPTY0KXtvdXRwdXQ9b3V0cHV0K1N0cmluZy5mcm9tQ2hhckNvZGUoY2hyMil9aWYoZW5jNCE9NjQpe291dHB1dD1vdXRwdXQrU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKX19b3V0cHV0PUJhc2U2NC5fdXRmOF9kZWNvZGUob3V0cHV0KTtyZXR1cm4gb3V0cHV0fSxfdXRmOF9lbmNvZGU6ZnVuY3Rpb24oc3RyaW5nKXtzdHJpbmc9c3RyaW5nLnJlcGxhY2UoL1xyXG4vZywiXG4iKTt2YXIgdXRmdGV4dD0iIjtmb3IodmFyIG49MDtuPHN0cmluZy5sZW5ndGg7bisrKXt2YXIgYz1zdHJpbmcuY2hhckNvZGVBdChuKTtpZihjPDEyOCl7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjKX1lbHNlIGlmKGM+MTI3JiZjPDIwNDgpe3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NnwxOTIpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfWVsc2V7dXRmdGV4dCs9U3RyaW5nLmZyb21DaGFyQ29kZShjPj4xMnwyMjQpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYz4+NiY2M3wxMjgpO3V0ZnRleHQrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyY2M3wxMjgpfX1yZXR1cm4gdXRmdGV4dH0sX3V0ZjhfZGVjb2RlOmZ1bmN0aW9uKHV0ZnRleHQpe3ZhciBzdHJpbmc9IiI7dmFyIGk9MDt2YXIgYz1jMT1jMj0wO3doaWxlKGk8dXRmdGV4dC5sZW5ndGgpe2M9dXRmdGV4dC5jaGFyQ29kZUF0KGkpO2lmKGM8MTI4KXtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoYyk7aSsrfWVsc2UgaWYoYz4xOTEmJmM8MjI0KXtjMj11dGZ0ZXh0LmNoYXJDb2RlQXQoaSsxKTtzdHJpbmcrPVN0cmluZy5mcm9tQ2hhckNvZGUoKGMmMzEpPDw2fGMyJjYzKTtpKz0yfWVsc2V7YzI9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMSk7YzM9dXRmdGV4dC5jaGFyQ29kZUF0KGkrMik7c3RyaW5nKz1TdHJpbmcuZnJvbUNoYXJDb2RlKChjJjE1KTw8MTJ8KGMyJjYzKTw8NnxjMyY2Myk7aSs9M319cmV0dXJuIHN0cmluZ319OwoKICAgCS8qIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAgICAgKgogICAgICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIEFaVVJFIEFEIFNFVFRJTkdTCiAgICAgKi8KICAgIHZhciBUV0lMSU9fQVBJX1NJRCA9ICJBQzc1MDQxNWUzMTYzYTJlNTdiN2FlZWE3ZWVkODJkOTQ0IjsKICAgIHZhciBUV0lMSU9fQVBJX1RPS0VOID0gImNlMjgzMzU4MDhlMGJmY2RiNmI5YmE5MWMzYjhhZmMzIjsKICAgIHZhciBUV0lMSU9fQVBJX0ZST00gPSAiKzEzMTc2NDQzMTA3IjsKICAgIC8qCiAgICAgKiBFTkQgU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqLwogIAogICAgLy8gVHdpbGlvIFNNUyBNZXNzYWdlIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgVFdJTElPX0FQSV9VUkkgPSAiaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyIuY29uY2F0KFRXSUxJT19BUElfU0lEKS5jb25jYXQoIi9NZXNzYWdlcy5qc29uIik7CQogICAgdmFyIFRXSUxJT19BUElfVE8gPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHNoYXJlZFN0YXRlLmdldCgiX2lkIiksICJ0ZWxlcGhvbmVOdW1iZXIiKS5pdGVyYXRvcigpLm5leHQoKTsKICAgIHZhciBUV0lMSU9fQVBJX0JPRFkgPSAiT1RQIGZvciBhY2NvdW50ICIuY29uY2F0KHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSkuY29uY2F0KCI6ICIpLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoIm9uZVRpbWVQYXNzd29yZCIpKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogVG86ICIuY29uY2F0KFRXSUxJT19BUElfVE8pKTsKICAgIC8vbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogTWVzc2FnZTogIi5jb25jYXQoVFdJTElPX0FQSV9CT0RZKSk7CgogICAgdmFyIEFVVEhaID0gIkJhc2ljICIuY29uY2F0KEJhc2U2NC5lbmNvZGUoVFdJTElPX0FQSV9TSUQuY29uY2F0KCc6JykuY29uY2F0KFRXSUxJT19BUElfVE9LRU4pKSk7CiAgICAvL2xvZ2dlci53YXJuaW5nKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IEFVVEhaIC0gIi5jb25jYXQoQVVUSFopKTsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRNZXRob2QoJ1BPU1QnKTsKICAgIHJlcXVlc3Quc2V0VXJpKFRXSUxJT19BUElfVVJJKTsKICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgQVVUSFopOwogICAgdmFyIHBhcmFtcyA9IHJlcXVlc3QuZ2V0Rm9ybSgpOwogICAgcGFyYW1zLmFkZCgiRnJvbSIsIFRXSUxJT19BUElfRlJPTSk7CiAgICBwYXJhbXMuYWRkKCJCb2R5IiwgVFdJTElPX0FQSV9CT0RZKTsKICAgIHBhcmFtcy5hZGQoIlRvIiwgVFdJTElPX0FQSV9UTyk7CiAgICByZXF1ZXN0LmdldEVudGl0eSgpLnNldFN0cmluZyhwYXJhbXMudG9TdHJpbmcoKSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgLy9sb2dnZXIud2FybmluZygiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBKU09OIHJlc3VsdDogIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpOwoKICAgIGlmIChyZXN1bHRbImVycm9yX2NvZGUiXSkgewogICAgICAgIG91dGNvbWUgPSAiZmFpbGVkIjsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogZXJyb3JfY29kZSA9ICIuY29uY2F0KHJlc3VsdFsiZXJyb3JfY29kZSJdKSk7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUd2lsaW8gU01TIE9UUCBTZW5kZXI6IGVycm9yX21lc3NhZ2UgPSAiLmNvbmNhdChyZXN1bHRbImVycm9yX21lc3NhZ2UiXSkpOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBvdXRjb21lID0gZmFpbGVkIik7CiAgICB9IGVsc2UgaWYgKHJlc3VsdFsiY29kZSJdKSB7CiAgICAgICAgb3V0Y29tZSA9ICJmYWlsZWQiOwogICAgICAgIGxvZ2dlci5lcnJvcigiVHdpbGlvIFNNUyBPVFAgU2VuZGVyOiBjb2RlID0gIi5jb25jYXQocmVzdWx0WyJjb2RlIl0pKTsKICAgICAgICBsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogbWVzc2FnZSA9ICIuY29uY2F0KHJlc3VsdFsibWVzc2FnZSJdKSk7CiAgICB9IGVsc2UgewogICAgICAgIG91dGNvbWUgPSAic2VudCI7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogb3V0Y29tZSA9IHNlbnQiKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJmYWlsZWQiOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogTm8gdXNlciBvciBwaG9uZSBudW1iZXIgZm91bmQhIFVzZSAnSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSB0aGUgdXNlcidzIF9pZCBpbiBzaGFyZWQgc3RhdGUhJyIpOwogIAlsb2dnZXIuZXJyb3IoIlR3aWxpbyBTTVMgT1RQIFNlbmRlcjogb3V0Y29tZSA9IGZhaWxlZCIpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7459"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:33 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.405Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "cdb6bf47cf4e63bb698595aa7700365d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 578,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twitter Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twitter%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1469,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1469,
            "text": "{\"result\":[{\"_id\":\"8e298710-b55e-4085-a464-88a375a4004b\",\"name\":\"Twitter Profile Normalization\",\"description\":\"Normalizes raw profile data from Twitter\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkX3N0ciksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgicGhvdG9VcmwiLCByYXdQcm9maWxlLnByb2ZpbGVfaW1hZ2VfdXJsKSwKICAgICAgICBmaWVsZCgiZW1haWwiLCByYXdQcm9maWxlLmVtYWlsKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCByYXdQcm9maWxlLnNjcmVlbl9uYW1lKSkp\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1469"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.447Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "959a24ab335299f03bf1e13339148843",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 557,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IDP Router\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IDP%20Router%22"
        },
        "response": {
          "bodySize": 7276,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 7276,
            "text": "{\"result\":[{\"_id\":\"aef262d0-7a42-4a34-9826-e7dbc2ea6eb9\",\"name\":\"IDP Router\",\"description\":\"Route users to their organization's IDP of type saml, oidc, local, or custom and apply the organization's theme, if specified\",\"script\":\"LyogSURQIFJvdXRlcgogKiAKICogUm91dGUgdXNlcnMgdG8gdGhlaXIgb3JnYW5pemF0aW9uJ3MgSURQIG9mIHR5cGUgc2FtbCwgb2lkYywgbG9jYWwsIAogKiBvciBjdXN0b20gYW5kIGFwcGx5IHRoZSBvcmdhbml6YXRpb24ncyB0aGVtZSwgaWYgc3BlY2lmaWVkLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSBzYW1sCiAqIC0gb2lkYwogKiAtIGxvY2FsCiAqIC0gY3VzdG9tCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCWxvZ2dlci5tZXNzYWdlKCJJRFAgUm91dGVyOiBTdGFydCIpOwogICAgb3V0Y29tZSA9ICJsb2NhbCI7CiAgCXZhciByZWZlcmVyID0gcGFyc2VVcmwocmVxdWVzdEhlYWRlcnMuZ2V0KCJyZWZlcmVyIikuZ2V0KDApKTsKICAJdmFyIHJvdXRlZElEUCA9IHNoYXJlZFN0YXRlLmdldCgicm91dGVkSURQcyIpLmdldCgwKTsKICAJaWYgKHJvdXRlZElEUCkgewogICAgICAgIG91dGNvbWUgPSByb3V0ZWRJRFAuZ2V0KCJpZHBUeXBlIik7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSb3V0ZXI6IFJvdXRlZCBJRFA6ICIgKyByb3V0ZWRJRFApOwogICAgICAJc2hhcmVkU3RhdGUucHV0KCJzZWxlY3RlZElkcCIsIHJvdXRlZElEUC5nZXQoImlkcE5hbWUiKSk7CiAgICAgICAgdmFyIG5vZGVDb25maWcgPSB7fTsKICAgICAgCS8vIGxvYWQgc2FtbENvbmZpZwogICAgICAJaWYgKHJvdXRlZElEUC5nZXQoInNhbWxDb25maWciKSkgewogICAgICAgICAgCW5vZGVDb25maWcgPSBKU09OLnBhcnNlKHJvdXRlZElEUC5nZXQoInNhbWxDb25maWciKSk7CiAgICAgICAgfQogICAgICAJLy8gcm91dGUgdG8gYSBjdXN0b20gam91cm5leQogICAgICAgIGlmIChyb3V0ZWRJRFAuZ2V0KCJpZHBKb3VybmV5IikpIHsKICAgICAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIklEUCBSb3V0ZXI6IFJvdXRlIHRvIGN1c3RvbSBJRFAge30sIGpvdXJuZXk6IHt9Iiwgcm91dGVkSURQLmdldCgiaWRwTmFtZSIpLCByb3V0ZWRJRFAuZ2V0KCJpZHBKb3VybmV5IikpOwogICAgICAgICAgCW5vZGVDb25maWcudHJlZSA9IHJvdXRlZElEUC5nZXQoImlkcEpvdXJuZXkiKTsKICAgICAgICAgIAlvdXRjb21lID0gImN1c3RvbSI7CiAgICAgICAgfQogICAgICAJc2hhcmVkU3RhdGUucHV0KCJub2RlQ29uZmlnIiwgbm9kZUNvbmZpZyk7CiAgICAgIAkvLyBvbmx5IHNlbmQgY2FsbGJhY2sgaWYgdGhlIG9yZy9pZHAgcmVxdWlyZXMgYSBjdXN0b20gdGhlbWUKICAgICAgICBpZiAocm91dGVkSURQLmdldCgiaWRwVGhlbWUiKSAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrcm91dGVkSURQLmdldCgiaWRwVGhlbWUiKTsKICAgICAgICAgICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgICAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgICAgICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgICAgICAgICApCiAgICAgICAgICAJYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgIAkJCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIwIiwgIlBsZWFzZSB3YWl0IC4uLiIpCiAgICAJCSkud2l0aFN0YWdlKHN0YWdlKS5idWlsZCgpOwogIAkJfQogICAgfQogIAlsb2dnZXIubWVzc2FnZSgiSURQIFJvdXRlcjogRG9uZSBbb3V0Y29tZT17fV0iLCBvdXRjb21lKTsKCiAgICAvKgogICAgICogUGFyc2UgYSBVUkwgaW50byBpdHMgY29tcG9uZW50cyBhbmQgbWFrZSB0aGVtIGVhc2lseSBhY2Nlc3NpYmxlIGJ5IG5hbWUKICAgICAqCiAgICAgKiBVc2UgaW4gYSBTY3JpcHRlIERlY2lzaW9uIE5vZGUgU2NyaXB0IGFzIGZvbGxvd3M6CiAgICAgKiB2YXIgcmVmZXJlciA9IHBhcnNlVXJsKHJlcXVlc3RIZWFkZXJzLmdldCgicmVmZXJlciIpLmdldCgwKSk7CiAgICAgKiB2YXIgb3JpZ2luID0gcmVmZXJlci5vcmlnaW47CiAgICAgKiAKICAgICAqIGUuZy46IGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICogewogICAgICogICAgIGhhc2g6ICcjLycsCiAgICAgKiAgICAgaG9zdDogJ29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbScsCiAgICAgKiAgICAgaG9zdG5hbWU6ICdvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20nLAogICAgICogICAgIGhyZWY6ICdodHRwczovL29wZW5hbS12b2xrZXItZGV2LmZvcmdlYmxvY2tzLmNvbS9hbS9YVUkvP3JlYWxtPS9icmF2byZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9SW5pdGlhdGVPd25lckNsYWltIy8nLAogICAgICogICAgIG9yaWdpbjogJ2h0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tJywKICAgICAqICAgICBwYXRobmFtZTogJy9hbS9YVUkvJywKICAgICAqICAgICBwb3J0OiAnJywKICAgICAqICAgICBwcm90b2NvbDogJ2h0dHBzJywKICAgICAqICAgICBzZWFyY2g6ICc/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0nLAogICAgICogICAgIHVzZXJuYW1lOiAnJywKICAgICAqICAgICBwYXNzd29yZDogJycsCiAgICAgKiAgICAgc2VhcmNoUGFyYW06IHsKICAgICAqICAgICAgICAgcmVhbG06ICcvYnJhdm8nLAogICAgICogICAgICAgICBhdXRoSW5kZXhUeXBlOiAnc2VydmljZScsCiAgICAgKiAgICAgICAgIGF1dGhJbmRleFZhbHVlOiAnSW5pdGlhdGVPd25lckNsYWltJwogICAgICogICAgIH0KICAgICAqIH0KICAgICAqLwogICAgZnVuY3Rpb24gcGFyc2VVcmwoaHJlZikgewogICAgICAgIHZhciBtID0gaHJlZi5tYXRjaCgvXigoW146XC8/I10rKTo/KD86XC9cLygoPzooW15cLz8jOl0qKTooW15cLz8jOl0qKUApPyhbXlwvPyM6XSopKD86OihbXlwvPyM6XSopKT8pKSk/KFtePyNdKikoXD9bXiNdKik/KCMuKik/JC8pLAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIGhhc2g6IG1bMTBdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAvLyAjLwogICAgICAgICAgICBob3N0OiBtWzNdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tCiAgICAgICAgICAgIGhvc3RuYW1lOiBtWzZdIHx8ICIiLCAgICAgICAgICAgICAgICAgICAvLyBvcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgaHJlZjogbVswXSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vb3BlbmFtLXZvbGtlci1kZXYuZm9yZ2VibG9ja3MuY29tL2FtL1hVSS8/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0jLwogICAgICAgICAgICBvcmlnaW46IG1bMV0gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9vcGVuYW0tdm9sa2VyLWRldi5mb3JnZWJsb2Nrcy5jb20KICAgICAgICAgICAgcGF0aG5hbWU6IG1bOF0gfHwgKG1bMV0gPyAiLyIgOiAiIiksICAgIC8vIC9hbS9YVUkvCiAgICAgICAgICAgIHBvcnQ6IG1bN10gfHwgIiIsICAgICAgICAgICAgICAgICAgICAgICAvLyAKICAgICAgICAgICAgcHJvdG9jb2w6IG1bMl0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzCiAgICAgICAgICAgIHNlYXJjaDogbVs5XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgICAvLyA/cmVhbG09L2JyYXZvJmF1dGhJbmRleFR5cGU9c2VydmljZSZhdXRoSW5kZXhWYWx1ZT1Jbml0aWF0ZU93bmVyQ2xhaW0KICAgICAgICAgICAgdXNlcm5hbWU6IG1bNF0gfHwgIiIsICAgICAgICAgICAgICAgICAgIC8vIAogICAgICAgICAgICBwYXNzd29yZDogbVs1XSB8fCAiIiwgICAgICAgICAgICAgICAgICAgLy8gCiAgICAgICAgICAgIHNlYXJjaFBhcmFtOiB7fSAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7IHJlYWxtOiAnL2JyYXZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYXV0aEluZGV4VHlwZTogJ3NlcnZpY2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBhdXRoSW5kZXhWYWx1ZTogJ0luaXRpYXRlT3duZXJDbGFpbScgfQogICAgICAgIH07CiAgICAgICAgaWYgKHIucHJvdG9jb2wubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgci5wcm90b2NvbCA9ICJmaWxlOi8vLyIgKyByLnByb3RvY29sLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIHIub3JpZ2luID0gci5wcm90b2NvbCArICIvLyIgKyByLmhvc3Q7CiAgICAgICAgfQogICAgICAgIGlmIChyLnNlYXJjaC5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IChyLnNlYXJjaC5pbmRleE9mKCc/JykgPT09IDApID8gci5zZWFyY2guc3Vic3RyKDEpIDogci5zZWFyY2g7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpOwogICAgICAgICAgICByLnNlYXJjaFBhcmFtW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgci5ocmVmID0gci5vcmlnaW4gKyByLnBhdGhuYW1lICsgci5zZWFyY2ggKyByLmhhc2g7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9Owp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "7276"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.485Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "bdb484c0a5d4bad077537e0f972d3632",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 579,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Facebook Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Facebook%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1479,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1479,
            "text": "{\"result\":[{\"_id\":\"bae1d54a-e97d-4997-aa5d-c027f21af82c\",\"name\":\"Facebook Profile Normalization\",\"description\":\"Normalizes raw profile data from Facebook\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLm5hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGljdHVyZS5kYXRhLnVybCksCiAgICAgICAgZmllbGQoImVtYWlsIiwgcmF3UHJvZmlsZS5lbWFpbCksCiAgICAgICAgZmllbGQoInVzZXJuYW1lIiwgcmF3UHJvZmlsZS5lbWFpbCkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1479"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.522Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "ccaefd0598c357a88dc4953f27bc7637",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_Optin-passwordless\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_Optin-passwordless%22"
        },
        "response": {
          "bodySize": 1451,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1451,
            "text": "{\"result\":[{\"_id\":\"ffd1898e-39a9-4085-a4a0-f69c6ac8b8bd\",\"name\":\"AT_Optin-passwordless\",\"description\":\"This script puts 'passwordless' into the attribute frUnindexedString3\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCBwdXRzICdwYXNzd29yZGxlc3MnIGludG8gdGhlIGF0dHJpYnV0ZSBmclVuaW5kZXhlZFN0cmluZzMKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCmxvZ2dlci5lcnJvcignQVRfT3B0aW4tTmV2ZXI6IFNUQVJUJykKCnZhciB1c2VybmFtZSA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKbG9nZ2VyLmVycm9yKCdBVF9PcHRpbi1OZXZlcjogX2lkICcgKyB1c2VybmFtZSk7CnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKaWRSZXBvc2l0b3J5LnNldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlLCBbInBhc3N3b3JkbGVzcyJdKTsKCgpsb2dnZXIuZXJyb3IoJ0FUX09wdGluLU5ldmVyOiBOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSk7Cm91dGNvbWUgPSAidHJ1ZSI7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1451"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.560Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "e39004c4b805621f4e93a8ecd97d69ba",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 558,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Reset Theme\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Reset%20Theme%22"
        },
        "response": {
          "bodySize": 1850,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1850,
            "text": "{\"result\":[{\"_id\":\"199405e4-050e-4f2a-87d1-d9125f74a8df\",\"name\":\"Reset Theme\",\"description\":\"Reset theme to what's preserved in shared state variable \\\"theme-id\\\" or to default theme.\",\"script\":\"LyogUmVzZXQgVGhlbWUKICogCiAqIFJlc2V0IHRoZW1lIHRvIHdoYXQncyBwcmVzZXJ2ZWQgaW4gc2hhcmVkIHN0YXRlIHZhcmlhYmxlICJ0aGVtZUlkIiBvciB0byBkZWZhdWx0IHRoZW1lLgogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkIQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAJLyogQmVnaW4gU2NyaXB0IENvbmZpZ3VyYXRpb24gKi8KICAJdmFyIGRlZmF1bHRUaGVtZSA9ICJFeHBhbnNlIjsKICAJLyogRW5kIFNjcmlwdCBDb25maWd1cmF0aW9uICovCiAgCQogIAlvdXRjb21lID0gInRydWUiOwogIAkKICAJdmFyIHRoZW1lID0gZGVmYXVsdFRoZW1lOwogIAlpZiAoc2hhcmVkU3RhdGUuZ2V0KCJ0aGVtZUlkIikgJiYgIiIrc2hhcmVkU3RhdGUuZ2V0KCJ0aGVtZUlkIikgIT09ICIiKSB7CiAgICAgIAl0aGVtZSA9IHNoYXJlZFN0YXRlLmdldCgidGhlbWVJZCIpOwogICAgfQoKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuUG9sbGluZ1dhaXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgc3RhZ2UgPSAidGhlbWVJZD0iK3RoZW1lOwogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgCW5ldyBmci5Qb2xsaW5nV2FpdENhbGxiYWNrKCIxMDAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0gZWxzZSB7CiAgICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1850"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.600Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "a63f85a66b175088b51ca201e0fa81ab",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 577,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Check For Existing Session\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Check%20For%20Existing%20Session%22"
        },
        "response": {
          "bodySize": 573,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 573,
            "text": "{\"result\":[{\"_id\":\"616d3541-14d6-4a54-94dd-46a146ef2423\",\"name\":\"Check For Existing Session\",\"description\":\"Check For Existing Session\",\"script\":\"aWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICd1bmRlZmluZWQnKQp7CiAgb3V0Y29tZSA9ICJ0cnVlIjsKfQplbHNlCnsKICBvdXRjb21lID0gImZhbHNlIjsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "573"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.639Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "001d75a7a2ab7aa424b9f38cda8aeed3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 578,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Routed IDP Persist Decision\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Routed%20IDP%20Persist%20Decision%22"
        },
        "response": {
          "bodySize": 1264,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1264,
            "text": "{\"result\":[{\"_id\":\"5b553f58-16bd-42b7-a782-4a981a66dbd4\",\"name\":\"Routed IDP Persist Decision\",\"description\":\"Branch based on the IDP setting.\",\"script\":\"LyogUm91dGVkIElEUCBQZXJzaXN0IERlY2lzaW9uCiAqIAogKiBCcmFuY2ggYmFzZWQgb24gdGhlIElEUCBzZXR0aW5nLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqIC0gZmFsc2UKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAJbG9nZ2VyLm1lc3NhZ2UoIlJvdXRlZCBJRFAgUGVyc2lzdCBEZWNpc2lvbjogU3RhcnQiKTsKICAJb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCWlmIChyb3V0ZWRJRFApIHsKICAgICAgICBvdXRjb21lID0gIiIuY29uY2F0KHJvdXRlZElEUC5nZXQoImlkcFBlcnNpc3QiKSk7CiAgICB9CiAgCWxvZ2dlci5tZXNzYWdlKCJSb3V0ZWQgSURQIFBlcnNpc3QgRGVjaXNpb246IERvbmUgW291dGNvbWU9e31dIiwgb3V0Y29tZSk7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1264"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.680Z",
        "time": 38,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 38
        }
      },
      {
        "_id": "6fb1b4652b46c7c26309ebde2d6df5b2",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_SecondFactorChoice_KL\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_SecondFactorChoice_KL%22"
        },
        "response": {
          "bodySize": 3334,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3334,
            "text": "{\"result\":[{\"_id\":\"c8ed3ae5-b8bc-4773-804b-6d2c61e9c337\",\"name\":\"AT_SecondFactorChoice_KL\",\"description\":\"- This script will read the ForgeRock Identity Cloud attribute AM attribute \\\"fr-attr-str3\\\" to see the user's\\n - MFA Opt-in choice. outcomes will be \\\"always\\\" \\\"Never\\\" \\\"new\\\" \\\"passwordless\\\"\\n - Healthcare demo: frUnindexedString2 = fr-attr-str2 = sms|fido|mail|push MFA type\",\"script\":\"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGlzIHNjcmlwdCB3aWxsIHJlYWQgdGhlIEZvcmdlUm9jayBJZGVudGl0eSBDbG91ZCBhdHRyaWJ1dGUgImZyVW5pbmRleGVkU3RyaW5nMyIgdG8gc2VlIHRoZSB1c2VyJ3MKICAtIE1GQSBPcHQtaW4gY2hvaWNlLiBvdXRjb21lcyB3aWxsIGJlICJhbHdheXMiICJOZXZlciIgIm5ldyIgInBhc3N3b3JkbGVzcyIKICAtIEhlYWx0aGNhcmUgZGVtbzogZnJVbmluZGV4ZWRTdHJpbmcyID0gZnItYXR0ci1zdHIyID0gc21zfGZpZG98bWFpbHxwdXNoICBNRkEgdHlwZQogIC0gSGVhbHRjYXJlIGRlbW86IGZyVW5pbmRleGVkU3RyaW5nMyA9IGZyLWF0dHItc3RyMyA9IE1GQSBPcHQtaW4gPSBhbHdheXN8bmV3fG5ldmVyfHBhc3N3b3JkbGVzcwogKi8KCgpsb2dnZXIuZXJyb3IoJ0FUX1NlY29uZEZhY3RvckNob2ljZSBzY3JpcHQ6IFNUQVJUJykKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IHRoaXM6ICIgKyBPYmplY3Qua2V5cyh0aGlzKSkKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSkKCgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpCnZhciBhdHRyaWJ1dGUgPSAiZnItYXR0ci1zdHIzIgoKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IHVzZXJuYW1lOiAiICsgdXNlcm5hbWUpCmxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlOiBNRkFDaG9pY2U6ICIgKyBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpKQoKb3V0Y29tZT0ibmEiCgovLyBFeGFtcGxlIGZvciB1c2VyLjAKdmFyIHZhbHVlID0gJ25ldmVyJwppZiAodXNlcm5hbWUgPT0gJ2QzMGY0MzM2LTAxYmUtNGUzZi04YjQ3LWUwNzhmNGIzNGZjYScpIHsKICBpZFJlcG9zaXRvcnkuc2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUsIFt2YWx1ZV0pCiAgCiAgbG9nZ2VyLmVycm9yKCdOZXcgdmFsdWUgZm9yICcgKyBhdHRyaWJ1dGUgKyAnOiAnICsgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKSkKfQogIAppZiAoaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS50b0FycmF5KCkubGVuZ3RoKSB7CgogIGxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlICBpZGVudGl0eSBhdHRyaWJ1dGU6ICIgKyBhdHRyaWJ1dGUgKyAiIGlzIHByZXNlbnQiICkKICAKICB2YXIgY2hvaWNlID0gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VybmFtZSwgYXR0cmlidXRlKS5pdGVyYXRvcigpLm5leHQoKQogIAogIGxvZ2dlci5lcnJvcigiQVRfU2Vjb25kRmFjdG9yQ2hvaWNlICBpZGVudGl0eSBhdHRyaWJ1dGU6IGNob2ljZSBpczogIiArIGNob2ljZSApCgogIGlmKGNob2ljZSA9PSAiYWx3YXlzIil7CiAgICBvdXRjb21lID0gImFsd2F5cyIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gIm5ldmVyIikgewogICAgb3V0Y29tZSA9ICJuZXZlciIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gIm5ldyIpIHsKICAgIG91dGNvbWUgPSAibmV3IgoKICB9IGVsc2UgaWYgKGNob2ljZSA9PSAicGFzc3dvcmRsZXNzIil7CiAgICBvdXRjb21lID0gInBhc3N3b3JkbGVzcyIKCiAgfSBlbHNlIGlmIChjaG9pY2UgPT0gInNraXAiKSB7CiAgICBvdXRjb21lID0gInNraXAiCgogIH0gCgp9IGVsc2UgewogIG91dGNvbWUgPSAiZW1wdHkiCiAgbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2UgIG91dGNvbWUgaXMgbmV2ZXIgYmVjYXVzZSBhdHRyaWJ1dGUgZW1wdHkgIikKICAKfQoKbG9nZ2VyLmVycm9yKCJBVF9TZWNvbmRGYWN0b3JDaG9pY2U6IG91dGNvbWU6ICIgKyBvdXRjb21lKQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3334"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.723Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "1b73772f48be953676490cd5bf518ec5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 592,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Record Changes And Preserve Old Email\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Record%20Changes%20And%20Preserve%20Old%20Email%22"
        },
        "response": {
          "bodySize": 2522,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2522,
            "text": "{\"result\":[{\"_id\":\"12bdbce4-268b-4b95-bfdf-640de9bddead\",\"name\":\"Record Changes And Preserve Old Email\",\"description\":\"null\",\"script\":\"bG9nZ2VyLmVycm9yKCJSZWNvcmQgQ2hhbmdlcyBBbmQgUHJlc2VydmUgT2xkIEVtYWlsOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwppZiAoZ2V0UHJvZmlsZUF0dHJpYnV0ZSgiZ2l2ZW5OYW1lIikgIT0gZ2V0T2JqZWN0QXR0cmlidXRlKCJnaXZlbk5hbWUiKSkgewogIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgib2xkX2dpdmVuTmFtZSIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoImdpdmVuTmFtZSIpKTsKfQppZiAoZ2V0UHJvZmlsZUF0dHJpYnV0ZSgic24iKSAhPSBnZXRPYmplY3RBdHRyaWJ1dGUoInNuIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm9sZF9zbiIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoInNuIikpOwp9CmlmIChnZXRQcm9maWxlQXR0cmlidXRlKCJtYWlsIikgIT0gZ2V0T2JqZWN0QXR0cmlidXRlKCJtYWlsIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImZyVW5pbmRleGVkU3RyaW5nNSIsIGdldFByb2ZpbGVBdHRyaWJ1dGUoIm1haWwiKSk7Cn0KaWYgKGdldFByb2ZpbGVBdHRyaWJ1dGUoInRlbGVwaG9uZU51bWJlciIpICE9IGdldE9iamVjdEF0dHJpYnV0ZSgidGVsZXBob25lTnVtYmVyIikpIHsKICBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm9sZF90ZWxlcGhvbmVOdW1iZXIiLCBnZXRQcm9maWxlQXR0cmlidXRlKCJ0ZWxlcGhvbmVOdW1iZXIiKSk7Cn0KbG9nZ2VyLmVycm9yKCJSZWNvcmQgQ2hhbmdlcyBBbmQgUHJlc2VydmUgT2xkIEVtYWlsOiBlbmQiKTsKCi8qCiAqIEdldCBwcm9maWxlIGF0dHJpYnV0ZQogKi8KZnVuY3Rpb24gZ2V0UHJvZmlsZUF0dHJpYnV0ZShuYW1lKSB7CiAgICByZXR1cm4gaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZShzaGFyZWRTdGF0ZS5nZXQoIl9pZCIpLCBuYW1lKS5pdGVyYXRvcigpLm5leHQoKS50b1N0cmluZygpOwp9CgovKgogKiBHZXQgb2JqZWN0QXR0cmlidXRlIHZhbHVlCiAqLwpmdW5jdGlvbiBnZXRPYmplY3RBdHRyaWJ1dGUobmFtZSkgewogICAgaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpICYmIHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpLmdldChuYW1lKSkgewogICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5nZXQobmFtZSkudG9TdHJpbmcoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9CgovKgogKiBQcm9wZXJseSBzZXQgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIikpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQobmFtZSwgdmFsdWUpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjoiK3ZhbHVlKyJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2522"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.761Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "6b46d57dbd5be348b67bd74437da0d29",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 586,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Choose Security PIN\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Choose%20Security%20PIN%22"
        },
        "response": {
          "bodySize": 2957,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2957,
            "text": "{\"result\":[{\"_id\":\"030af5e5-ac77-4176-bafe-f4558f94818e\",\"name\":\"Twilio IVR: Choose Security PIN\",\"description\":\"Choose a 4-digit security PIN\",\"script\":\"LyogVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTjogc3RhcnQiKTsKb3V0Y29tZSA9ICJmYWxzZSI7CgovKiBCZWdpbiBDb25maWd1cmF0aW9uCiAqLwoKLy8gQnVpbGQgb3V0IHRoZSB2ZXJpZmljYXRpb24gcHJvbXB0CnZhciBwcm9tcHQgPSAiUGxlYXNlIGNob29zZSB5b3VyIDQtZGlnaXQgc2VjdXJpdHkgUElOLiI7CgovKiBFbmQgQ29uZmlndXJhdGlvbgogKi8KCnZhciBmciA9IEphdmFJbXBvcnRlcigKICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaSwKICAJamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0SW5wdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBpbnB1dCA9IG5ldyBUZXh0SW5wdXRDYWxsYmFjayhwcm9tcHQpOwogICAgCWFjdGlvbiA9IEFjdGlvbi5zZW5kKGlucHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKICAgICAgCXZhciBhbnN3ZXIgPSBuZXcgU3RyaW5nKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VGV4dCgpKS5yZXBsYWNlKC9bXjAtOV0vZywgIiIpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBDaG9vc2UgU2VjdXJpdHkgUElOOiBjYWxsYmFja3MgcmVjZWl2ZWQiKTsKICAgIAlpZiAoYW5zd2VyLmxlbmd0aCA9PSA0KSB7CiAgICAgICAgICAJc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJmclVuaW5kZXhlZEludGVnZXI1IiwgYW5zd2VyKTsKICAgICAgICAgIAlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogQ2hvb3NlIFNlY3VyaXR5IFBJTjogc2hhcmVkU3RhdGU6ICIuY29uY2F0KHNoYXJlZFN0YXRlKSk7CiAgICAgIAkJb3V0Y29tZSA9ICJ0cnVlIjsKICAgIAl9CgkJbG9nZ2VyLndhcm5pbmcoIlR3aWxpbyBJVlI6IENob29zZSBTZWN1cml0eSBQSU46IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCBuZXcgamF2YS5sYW5nLkludGVnZXIodmFsdWUpKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gbmV3IGphdmEubGFuZy5JbnRlZ2VyKHZhbHVlKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6Iit2YWx1ZSsifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2957"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.800Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "ebc9b9f906ba3287a9a8eea3014a67f6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_CheckOrgMembership\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_CheckOrgMembership%22"
        },
        "response": {
          "bodySize": 2000,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2000,
            "text": "{\"result\":[{\"_id\":\"e155e57f-3c0c-46de-900d-36ea5a60e18d\",\"name\":\"AT_CheckOrgMembership\",\"description\":\"Scfript to find Org Membership\",\"script\":\"bG9nZ2VyLmVycm9yKCdBVF9DaGVja09yZ01lbWJlcnNoaXAgc2NyaXB0OiBTVEFSVCcpOwpsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcDogdGhpczogIiArIE9iamVjdC5rZXlzKHRoaXMpKTsKbG9nZ2VyLmVycm9yKCJBVF9DaGVja09yZ01lbWJlcnNoaXA6IFNoYXJlZFNhdGU6ICIgKyBzaGFyZWRTdGF0ZSk7CgoKdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJfaWQiKTsKdmFyIGF0dHJpYnV0ZSA9ICJkZXNjcmlwdGlvbiI7CnZhciBhdHRyVmFsdWUgPSBpZFJlcG9zaXRvcnkuZ2V0QXR0cmlidXRlKHVzZXJuYW1lLCBhdHRyaWJ1dGUpOwoKbG9nZ2VyLmVycm9yKCJBVF9DaGVja09yZ01lbWJlcnNoaXA6IHVzZXJuYW1lOiAiICsgdXNlcm5hbWUpOwpsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcDogRW50aXR5IFR5cGUgaXM6ICIgKyBhdHRyVmFsdWUpOwoKb3V0Y29tZSA9ICJlbXB0eSIKICAKaWYgKGF0dHJWYWx1ZSkgewogIGxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwICBpZGVudGl0eSBhdHRyaWJ1dGU6ICIgKyBhdHRyaWJ1dGUgKyAiIGlzIHByZXNlbnQiICk7ICAKICB2YXIgY2hvaWNlID0gYXR0clZhbHVlLml0ZXJhdG9yKCkubmV4dCgpOyAKICBsb2dnZXIuZXJyb3IoIkFUX0NoZWNrT3JnTWVtYmVyc2hpcCAgaWRlbnRpdHkgYXR0cmlidXRlOiBjaG9pY2UgaXM6ICIgKyBjaG9pY2UgKTsKCiAgaWYoY2hvaWNlID09ICJzdHVkZW50Iil7CiAgICBvdXRjb21lID0gInN0dWRlbnQiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJlbXBsb3llZSIpIHsKICAgIG91dGNvbWUgPSAiZW1wbG95ZWUiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjdXN0b21lciIpIHsKICAgIG91dGNvbWUgPSAiY3VzdG9tZXIiOwogIH0gZWxzZSBpZiAoY2hvaWNlID09ICJwYXJ0bmVyIil7CiAgICBvdXRjb21lID0gInBhcnRuZXIiOwogIH0gZWxzZSB7CiAgb3V0Y29tZSA9ICJlbXB0eSI7CiAgfQp9IGVsc2UgewogIG91dGNvbWUgPSAiZW1wdHkiOwogIGxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwICBvdXRjb21lIGlzIG5ldmVyIGJlY2F1c2UgYXR0cmlidXRlIGVtcHR5ICIpOyAgCn0KCmxvZ2dlci5lcnJvcigiQVRfQ2hlY2tPcmdNZW1iZXJzaGlwOiBvdXRjb21lOiAiICsgb3V0Y29tZSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2000"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.840Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "6b9be5262528f264a35a005dd43e94aa",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 553,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Dropdown\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Dropdown%22"
        },
        "response": {
          "bodySize": 1510,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1510,
            "text": "{\"result\":[{\"_id\":\"71b3c70b-920c-464b-a918-4c86eaaddccd\",\"name\":\"Dropdown\",\"description\":\"Render a dropdown\",\"script\":\"LyogRHJvcGRvd24KICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmVuZGVyIGEgZHJvcGRvd24gc2VsZWN0b3IKICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KKGZ1bmN0aW9uICgpIHsKICBvdXRjb21lID0gInRydWUiOwogIHZhciBjaG9pY2VzID0gWyIgIiwgIlJlZCBwaWxsIiwgIkJsdWUgcGlsbCIsICJTdGVhayIsICJSYWJiaXQgaG9sZSJdOwogIAogIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5DaG9pY2VDYWxsYmFjawogICkKCiAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKFsKICAgICAgbmV3IGZyLkNob2ljZUNhbGxiYWNrKCJNYWtlIHlvdXIgY2hvaWNlIiwgY2hvaWNlcywgMCwgZmFsc2UpCiAgICBdKS5idWlsZCgpOwogIH0gZWxzZSB7CiAgICB2YXIgY2hvaWNlID0gcGFyc2VJbnQoY2FsbGJhY2tzLmdldCgwKS5nZXRTZWxlY3RlZEluZGV4ZXMoKVswXSk7CiAgICBub2RlU3RhdGUucHV0U2hhcmVkKCJjaG9pY2UiLCBjaG9pY2VzW2Nob2ljZV0pOwogICAgYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1510"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.880Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "4223011c547417ee4e286ca36fdd9d4e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ResetOTPProfileAttribute\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ResetOTPProfileAttribute%22"
        },
        "response": {
          "bodySize": 1173,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1173,
            "text": "{\"result\":[{\"_id\":\"98a87024-3d07-4c75-b1ea-43ff905e9def\",\"name\":\"ResetOTPProfileAttribute\",\"description\":\"Reset the IDM profile shared state so it can be patched to the user profile.\",\"script\":\"LyogUmVzZXRPVFBQcm9maWxlQXR0cmlidXRlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIFJlc2V0IHRoZSBJRE0gcHJvZmlsZSBzaGFyZWQgc3RhdGUgc28gaXQgY2FuIGJlIHBhdGNoZWQgdG8gdGhlIHVzZXIgcHJvZmlsZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKi8KaWYgKHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpKSB7CglzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKS5wdXQoImRlc2NyaXB0aW9uIiwgIiIpCn0KZWxzZSB7CglzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCB7ZGVzY3JpcHRpb246ICIifSk7Cn0Kb3V0Y29tZSA9ICJ0cnVlIjs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1173"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.918Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "d3af4f4c72e384f18ea7e6e408bf5d8c",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 582,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Scripted Module - Server Side\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Scripted%20Module%20-%20Server%20Side%22"
        },
        "response": {
          "bodySize": 4662,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4662,
            "text": "{\"result\":[{\"_id\":\"7e3d7067-d50f-4674-8c76-a3e13a810c33\",\"name\":\"Scripted Module - Server Side\",\"description\":\"Default global script for server side Scripted Authentication Module\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTUtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCgp2YXIgU1RBUlRfVElNRSA9IDk7ICAvLyA5YW0KdmFyIEVORF9USU1FICAgPSAxNzsgLy8gNXBtCnZhciBsb25naXR1ZGUsIGxhdGl0dWRlOwp2YXIgbG9jYWxUaW1lOwoKbG9nZ2VyLm1lc3NhZ2UoIlN0YXJ0aW5nIHNjcmlwdGVkIGF1dGhlbnRpY2F0aW9uIik7CmxvZ2dlci5tZXNzYWdlKCJVc2VyOiAiICsgdXNlcm5hbWUpOwoKdmFyIHVzZXJQb3N0YWxBZGRyZXNzID0gZ2V0VXNlclBvc3RhbEFkZHJlc3MoKTsKbG9nZ2VyLm1lc3NhZ2UoIlVzZXIgYWRkcmVzczogIiArIHVzZXJQb3N0YWxBZGRyZXNzKTsKCmdldExvbmdpdHVkZUxhdGl0dWRlRnJvbVVzZXJQb3N0YWxBZGRyZXNzKCk7CmdldExvY2FsVGltZSgpOwoKbG9nZ2VyLm1lc3NhZ2UoIkN1cnJlbnQgdGltZSBhdCB0aGUgdXNlcnMgbG9jYXRpb246ICIgKyBsb2NhbFRpbWUuZ2V0SG91cnMoKSk7CmlmIChsb2NhbFRpbWUuZ2V0SG91cnMoKSA8IFNUQVJUX1RJTUUgfHwgbG9jYWxUaW1lLmdldEhvdXJzKCkgPiBFTkRfVElNRSkgewogICAgbG9nZ2VyLmVycm9yKCJMb2dpbiBmb3JiaWRkZW4gb3V0c2lkZSB3b3JrIGhvdXJzISIpOwogICAgYXV0aFN0YXRlID0gRkFJTEVEOwp9IGVsc2UgewogICAgbG9nZ2VyLm1lc3NhZ2UoIkF1dGhlbnRpY2F0aW9uIGFsbG93ZWQhIik7CiAgICBhdXRoU3RhdGUgPSBTVUNDRVNTOwp9CgpmdW5jdGlvbiBnZXRMb25naXR1ZGVMYXRpdHVkZUZyb21Vc2VyUG9zdGFsQWRkcmVzcygpIHsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdCgpOwogICAgcmVxdWVzdC5zZXRVcmkoImh0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9hZGRyZXNzPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXNlclBvc3RhbEFkZHJlc3MpKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwogIAkvL3RoZSBhYm92ZSBVUkkgaGFzIHRvIGJlIGV4dGVuZGVkIHdpdGggYW4gQVBJX0tFWSBpZiB1c2VkIGluIGEgZnJlcXVlbnQgbWFubmVyCiAgCS8vc2VlIGRvY3VtZW50YXRpb246IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL21hcHMvZG9jdW1lbnRhdGlvbi9nZW9jb2RpbmcvaW50cm8KCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICBsb2dSZXNwb25zZShyZXNwb25zZSk7CgogICAgdmFyIGdlb2NvZGUgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIHZhciBpOwogICAgZm9yIChpID0gMDsgaSA8IGdlb2NvZGUucmVzdWx0cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciByZXN1bHQgPSBnZW9jb2RlLnJlc3VsdHNbaV07CiAgICAgICAgbGF0aXR1ZGUgPSByZXN1bHQuZ2VvbWV0cnkubG9jYXRpb24ubGF0OwogICAgICAgIGxvbmdpdHVkZSA9IHJlc3VsdC5nZW9tZXRyeS5sb2NhdGlvbi5sbmc7CiAgICAgIAogICAJICAgIGxvZ2dlci5tZXNzYWdlKCJsYXRpdHVkZToiICsgbGF0aXR1ZGUgKyAiIGxvbmdpdHVkZToiICsgbG9uZ2l0dWRlKTsKICAgIH0KfQoKZnVuY3Rpb24gZ2V0TG9jYWxUaW1lKCkgewoKICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDA7CiAgICB2YXIgbG9jYXRpb24gPSAibG9jYXRpb249IiArIGxhdGl0dWRlICsgIiwiICsgbG9uZ2l0dWRlOwogICAgdmFyIHRpbWVzdGFtcCA9ICJ0aW1lc3RhbXA9IiArIG5vdzsKICAJICAKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldFVyaSgiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3RpbWV6b25lL2pzb24/IiArIGxvY2F0aW9uICsgIiYiICsgdGltZXN0YW1wKTsKICAJcmVxdWVzdC5zZXRNZXRob2QoIkdFVCIpOwogIAkvL3RoZSBhYm92ZSBVUkkgaGFzIHRvIGJlIGV4dGVuZGVkIHdpdGggYW4gQVBJX0tFWSBpZiB1c2VkIGluIGEgZnJlcXVlbnQgbWFubmVyCiAgCS8vc2VlIGRvY3VtZW50YXRpb246IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL21hcHMvZG9jdW1lbnRhdGlvbi90aW1lem9uZS9pbnRybwoKICAgIHZhciByZXNwb25zZSA9IGh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KS5nZXQoKTsKICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTsKCiAgICB2YXIgdGltZXpvbmUgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKICAgIHZhciBsb2NhbFRpbWVzdGFtcCA9IHBhcnNlSW50KG5vdykgKyBwYXJzZUludCh0aW1lem9uZS5kc3RPZmZzZXQpICsgcGFyc2VJbnQodGltZXpvbmUucmF3T2Zmc2V0KTsKICAgIGxvY2FsVGltZSA9IG5ldyBEYXRlKGxvY2FsVGltZXN0YW1wKjEwMDApOwp9CgpmdW5jdGlvbiBnZXRVc2VyUG9zdGFsQWRkcmVzcygpIHsKICAgIHZhciB1c2VyQWRkcmVzc1NldCA9IGlkUmVwb3NpdG9yeS5nZXRBdHRyaWJ1dGUodXNlcm5hbWUsICJwb3N0YWxBZGRyZXNzIik7CiAgICBpZiAodXNlckFkZHJlc3NTZXQgPT0gbnVsbCB8fCB1c2VyQWRkcmVzc1NldC5pc0VtcHR5KCkpIHsKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gYWRkcmVzcyBzcGVjaWZpZWQgZm9yIHVzZXI6ICIgKyB1c2VybmFtZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHVzZXJBZGRyZXNzU2V0Lml0ZXJhdG9yKCkubmV4dCgpCn0KCmZ1bmN0aW9uIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKSB7CiAgICBsb2dnZXIubWVzc2FnZSgiVXNlciBSRVNUIENhbGwuIFN0YXR1czogIiArIHJlc3BvbnNlLmdldFN0YXR1cygpICsgIiwgQm9keTogIiArIHJlc3BvbnNlLmdldEVudGl0eSgpLmdldFN0cmluZygpKTsKfQ==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_SERVER_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4662"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:32.959Z",
        "time": 37,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 37
        }
      },
      {
        "_id": "da4d27c156ebb747173dc67ef8c55dd7",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 588,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"APIProtection: Get Key And Secret\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22APIProtection%3A%20Get%20Key%20And%20Secret%22"
        },
        "response": {
          "bodySize": 4427,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 4427,
            "text": "{\"result\":[{\"_id\":\"9399ac8b-3a6e-423b-95a2-6e0fd07262b1\",\"name\":\"APIProtection: Get Key And Secret\",\"description\":\"APIProtection: Get Key And Secret\",\"script\":\"bG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IEdldCBLZXkgQW5kIFNlY3JldDogc3RhcnQiKTsKCi8qCiAqIEJFR0lOIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwp2YXIgS0VZX0hFQURFUl9OQU1FID0gIngtYXBpLWtleSI7CnZhciBTRUNSRVRfSEVBREVSX05BTUUgPSAieC1hcGktc2VjcmV0IjsKdmFyIFVTRVJOQU1FX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLVVzZXJuYW1lIjsKdmFyIFBBU1NXT1JEX0hFQURFUl9OQU1FID0gIlgtT3BlbkFNLVBhc3N3b3JkIjsKLyoKICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAqLwoKb3V0Y29tZSA9ICJmYWxzZSI7Cgp2YXIga2V5ID0gZ2V0SGVhZGVyKEtFWV9IRUFERVJfTkFNRSkgfHwgcmVhZFZhbHVlKEtFWV9IRUFERVJfTkFNRSkgfHwgbnVsbDsKdmFyIHNlY3JldCA9IGdldEhlYWRlcihTRUNSRVRfSEVBREVSX05BTUUpIHx8IHJlYWRUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUpIHx8IG51bGw7Cgp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIikgfHwgbnVsbDsKdmFyIHBhc3N3b3JkID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpIHx8IG51bGw7CgppZiAoa2V5ICYmIHNlY3JldCkgewoJbG9nZ2VyLndhcm5pbmcoIkFQSVByb3RlY3Rpb246IEdldCBLZXkgQW5kIFNlY3JldDoga2V5PSIuY29uY2F0KGtleSkpOwogIAogIAlzdG9yZVZhbHVlKEtFWV9IRUFERVJfTkFNRSwga2V5KTsKICAJc3RvcmVWYWx1ZSgidXNlcm5hbWUiLCB1c2VybmFtZSk7CiAgCXNoYXJlZFN0YXRlLnB1dCgidXNlcm5hbWUiLCBrZXkpOwogIAkKICAJc3RvcmVUcmFuc2llbnRWYWx1ZShTRUNSRVRfSEVBREVSX05BTUUsIHNlY3JldCk7CiAgCXN0b3JlVHJhbnNpZW50VmFsdWUoInBhc3N3b3JkIiwgcGFzc3dvcmQpOwogIAl0cmFuc2llbnRTdGF0ZS5wdXQoInBhc3N3b3JkIiwgc2VjcmV0KTsKICAKICAgIG91dGNvbWUgPSAidHJ1ZSI7Cn0KCmxvZ2dlci53YXJuaW5nKCJBUElQcm90ZWN0aW9uOiBHZXQgS2V5IEFuZCBTZWNyZXQ6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CgovKgogKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgcmVxdWVzdGVkIGhlYWRlcgogKi8KZnVuY3Rpb24gZ2V0SGVhZGVyKGhlYWRlck5hbWUpIHsKICAJaWYgKHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKSAmJiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApKSB7CiAgICAJcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkudG9TdHJpbmcoKTsKICAgIH0KICAJcmV0dXJuIG51bGw7Cn0KCi8qCiAqIFN0b3JlIHZhbHVlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHN0b3JlVmFsdWUobmFtZSwgdmFsdWUpIHsKICAJdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgiQVBJUHJvdGVjdGlvbiIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0KCi8qCiAqIFJlYWQgdmFsdWUgZnJvbSBzdG9yYWdlIGZvciBBUElQcm90ZWN0aW9uIHNjcmlwdCB1c2UKICovCmZ1bmN0aW9uIHJlYWRWYWx1ZShuYW1lKSB7CiAgCXZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIik7CiAgICBpZiAoc3RvcmFnZSkgewogICAgICAJaWYgKHN0b3JhZ2UuZ2V0KSB7CgkgICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKS5nZXQobmFtZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJcmV0dXJuIHN0b3JhZ2UubmFtZTsKICAgICAgICB9CiAgICB9CiAgCXJldHVybiBudWxsOwp9CgovKgogKiBTdG9yZSB0cmFuc2llbnQgdmFsdWUgZm9yIEFQSVByb3RlY3Rpb24gc2NyaXB0IHVzZQogKi8KZnVuY3Rpb24gc3RvcmVUcmFuc2llbnRWYWx1ZShuYW1lLCB2YWx1ZSkgewogICAgdmFyIHRyYW5zaWVudFN0b3JhZ2UgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIkFQSVByb3RlY3Rpb24iKTsKICAgIGlmICh0cmFuc2llbnRTdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAodHJhbnNpZW50U3RvcmFnZS5wdXQpIHsKCSAgICAgICAgdHJhbnNpZW50U3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXRyYW5zaWVudFN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHRyYW5zaWVudFN0YXRlLnB1dCgiQVBJUHJvdGVjdGlvbiIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0KCi8qCiAqIFJlYWQgdHJhbnNpZW50IHZhbHVlIGZyb20gc3RvcmFnZSBmb3IgQVBJUHJvdGVjdGlvbiBzY3JpcHQgdXNlCiAqLwpmdW5jdGlvbiByZWFkVHJhbnNpZW50VmFsdWUobmFtZSkgewogIAl2YXIgdHJhbnNpZW50U3RvcmFnZSA9IHRyYW5zaWVudFN0YXRlLmdldCgiQVBJUHJvdGVjdGlvbiIpOwogICAgaWYgKHRyYW5zaWVudFN0b3JhZ2UpIHsKICAgICAgCWlmICh0cmFuc2llbnRTdG9yYWdlLmdldCkgewoJICAgICAgICByZXR1cm4gdHJhbnNpZW50U3RhdGUuZ2V0KCJBUElQcm90ZWN0aW9uIikuZ2V0KG5hbWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXJldHVybiB0cmFuc2llbnRTdG9yYWdlLm5hbWU7CiAgICAgICAgfQogICAgfQogIAlyZXR1cm4gbnVsbDsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "4427"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.002Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "1e93235e5c16b4c94a41d418581246e8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 589,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Unknown Caller Message\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Unknown%20Caller%20Message%22"
        },
        "response": {
          "bodySize": 1605,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1605,
            "text": "{\"result\":[{\"_id\":\"7f1c30ec-ea27-4bb1-bd0b-be5792c9a1a6\",\"name\":\"Twilio IVR: Unknown Caller Message\",\"description\":\"Unknown caller message\",\"script\":\"LyogVHdpbGlvIElWUjogVW52ZXJpZmllZCBDYWxsZXIgTWVzc2FnZQogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogCiAqIERlcGVuZGluZyBvbiB0aGUgYW1vdW50IG9mIGRhdGEgY29sbGVjdGVkIHRocm91Z2ggY2FsbGJhY2tzIGFuZCBob3cgbWFueSBvZiB0aGUgY2FsbFBhcmFtcwogKiB5b3UgYWN0aXZhdGUgYmVsb3csIHlvdSB3aWxsIG5lZWQgdG8gY2hhbmdlIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiBmcm9tIEpXVCB0byBDVFMgb3IKICogTWVtb3J5LgogKi8Kb3V0Y29tZSA9ICJ0cnVlIjsKCi8qIEJlZ2luIENvbmZpZ3VyYXRpb24KICovCgovLyBCdWlsZCBvdXQgdGhlIGZ1bGwgbWVzc2FnZQp2YXIgbWVzc2FnZSA9ICJJIHNlZSB3ZSBkb24ndCBoYXZlIGEgcHJvZmlsZSBhc3NvY2lhdGVkIHdpdGggeW91ciBwaG9uZSBudW1iZXIhIjsKCi8qIEVuZCBDb25maWd1cmF0aW9uCiAqLwoKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogIAlvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLAogIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjawopOwogIAp3aXRoIChmcikgewogIAlpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgCXZhciBvdXRwdXQgPSBuZXcgVGV4dE91dHB1dENhbGxiYWNrKFRleHRPdXRwdXRDYWxsYmFjay5JTkZPUk1BVElPTiwgbWVzc2FnZSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLnNlbmQob3V0cHV0KS5idWlsZCgpOwogIAl9IAogIAllbHNlIHsKICAgIAlhY3Rpb24gPSBBY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogIAl9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1605"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.040Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "e525ee151420b9f073bf23d6903c48f7",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 552,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ipstack\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ipstack%22"
        },
        "response": {
          "bodySize": 3468,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3468,
            "text": "{\"result\":[{\"_id\":\"87497360-d89c-412a-a99e-c8a9bec465cc\",\"name\":\"ipstack\",\"description\":\"null\",\"script\":\"bG9nZ2VyLndhcm5pbmcoImlwc3RhY2s6IHN0YXJ0Iik7CgpvdXRjb21lID0gInVua25vd24iOwoKdmFyIGlwID0gZ2V0Q2xpZW50SVBBZGRyZXNzKCk7CmxvZ2dlci53YXJuaW5nKCJpcHN0YWNrOiBpcD0iLmNvbmNhdChpcCkpOwoKaWYgKGlwKSB7CgogIAkvLyBpcHN0YWNrIEFQSSBDb25maWd1cmF0aW9uCiAgICB2YXIgSVBTVEFDS19BQ0NFU1NfS0VZID0gImVmYzJmOGQ5Nzk2YjlmZWZmNWYwMzM1OWQ2ZmJjY2M5IjsKICAgIHZhciBJUFNUQUNLX0FQSV9VUkkgPSAiaHR0cDovL2FwaS5pcHN0YWNrLmNvbS8iLmNvbmNhdChpcCkuY29uY2F0KCI/YWNjZXNzX2tleT0iKS5jb25jYXQoSVBTVEFDS19BQ0NFU1NfS0VZKTsJCgogICAgdmFyIHJlcXVlc3QgPSBuZXcgb3JnLmZvcmdlcm9jay5odHRwLnByb3RvY29sLlJlcXVlc3QoKTsKICAgIHJlcXVlc3Quc2V0TWV0aG9kKCdHRVQnKTsKICAgIHJlcXVlc3Quc2V0VXJpKElQU1RBQ0tfQVBJX1VSSSk7CgogICAgdmFyIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpOwogICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpOwogICAgbG9nZ2VyLndhcm5pbmcoImlwc3RhY2s6IEpTT04gcmVzdWx0OiAiICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7CgogIAkvKgogICAgewogICAgICAgICJpcCI6ICI5OS43Mi4yOC4xODIiLAogICAgICAgICJ0eXBlIjogImlwdjQiLAogICAgICAgICJjb250aW5lbnRfY29kZSI6ICJOQSIsCiAgICAgICAgImNvbnRpbmVudF9uYW1lIjogIk5vcnRoIEFtZXJpY2EiLAogICAgICAgICJjb3VudHJ5X2NvZGUiOiAiVVMiLAogICAgICAgICJjb3VudHJ5X25hbWUiOiAiVW5pdGVkIFN0YXRlcyIsCiAgICAgICAgInJlZ2lvbl9jb2RlIjogIlRYIiwKICAgICAgICAicmVnaW9uX25hbWUiOiAiVGV4YXMiLAogICAgICAgICJjaXR5IjogIkdlb3JnZXRvd24iLAogICAgICAgICJ6aXAiOiAiNzg2MjYiLAogICAgICAgICJsYXRpdHVkZSI6IDMwLjU5MjUwMDY4NjY0NTUwOCwKICAgICAgICAibG9uZ2l0dWRlIjogLTk3LjY2NzEwNjYyODQxNzk3LAogICAgICAgICJsb2NhdGlvbiI6IHsKICAgICAgICAgICAgImdlb25hbWVfaWQiOiA0NjkzMzQyLAogICAgICAgICAgICAiY2FwaXRhbCI6ICJXYXNoaW5ndG9uIEQuQy4iLAogICAgICAgICAgICAibGFuZ3VhZ2VzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJjb2RlIjogImVuIiwKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJFbmdsaXNoIiwKICAgICAgICAgICAgICAgICAgICAibmF0aXZlIjogIkVuZ2xpc2giCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJjb3VudHJ5X2ZsYWciOiAiaHR0cDovL2Fzc2V0cy5pcHN0YWNrLmNvbS9mbGFncy91cy5zdmciLAogICAgICAgICAgICAiY291bnRyeV9mbGFnX2Vtb2ppIjogIvCfh7rwn4e4IiwKICAgICAgICAgICAgImNvdW50cnlfZmxhZ19lbW9qaV91bmljb2RlIjogIlUrMUYxRkEgVSsxRjFGOCIsCiAgICAgICAgICAgICJjYWxsaW5nX2NvZGUiOiAiMSIsCiAgICAgICAgICAgICJpc19ldSI6IGZhbHNlCiAgICAgICAgfQogICAgfQoJKi8KICAKICAJLy8gcHJlc2VydmUgcmVzdWx0IGluIHRyYW5zaWVudCBzdGF0ZQogIAl0cmFuc2llbnRTdGF0ZS5wdXQoImlwc3RhY2siLCBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCiAgICBzd2l0Y2gocmVzdWx0LmNvdW50cnlfY29kZSkgewogICAgICBjYXNlICJDQSI6CiAgICAgICAgb3V0Y29tZSA9IHJlc3VsdC5jb3VudHJ5X2NvZGU7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlVLIjoKICAgICAgICBvdXRjb21lID0gcmVzdWx0LmNvdW50cnlfY29kZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiVVMiOgogICAgICAgIG91dGNvbWUgPSByZXN1bHQuY291bnRyeV9jb2RlOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIG91dGNvbWUgPSAib3RoZXIiOwogICAgfQoKfSBlbHNlIHsKICAJbG9nZ2VyLmVycm9yKCJpcHN0YWNrOiBubyBjbGllbnQgaXAhIik7Cn0KCmxvZ2dlci53YXJuaW5nKCJpcHN0YWNrOiBmaW5pc2giKTsKCiAvKgogICogISEhIEFTU1VNRVMgSUQgQ0xPVUQgISEhCiAgKgogICogUmV0dXJucyB0aGUgY2xpZW50J3MgSVAgYWRkcmVzcwogICovCiBmdW5jdGlvbiBnZXRDbGllbnRJUEFkZHJlc3MoKSB7CiAgICByZXR1cm4gcmVxdWVzdEhlYWRlcnMuZ2V0KCJ4LWZvcndhcmRlZC1mb3IiKS5nZXQoMCkuc3BsaXQoJywnKVswXTsKIH0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3468"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.079Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "06ce3ea27c10dfe3b2126566796b00b5",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 565,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AT_SetSocialFacebook\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AT_SetSocialFacebook%22"
        },
        "response": {
          "bodySize": 1056,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1056,
            "text": "{\"result\":[{\"_id\":\"04664029-3867-4192-829b-d749088cbdbe\",\"name\":\"AT_SetSocialFacebook\",\"description\":\"Set the Social Identity to Facebook\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuIE5vdCBmb3IgUHJvZHVjdGlvbiB1c2UKICogTW9kaWZpZWQgYnkgU3RlcGhlbiBQYXluZQogKiBBVF9TZXRTb2NpYWxGYWNlYm9vaywgU2NyaXB0IHRvIHNldCB0aGUgc29jaWFsIHByb3ZpZGVyIHR5cGUgdG8gZmFjZW9vawoqLwpzaGFyZWRTdGF0ZS5wdXQoInNlbGVjdGVkSWRwIiwgImZhY2Vib29rIik7CgpvdXRjb21lID0gInRydWUiOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1056"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.120Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "76d3a4acf5686cb6567ed09804d45bca",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect Extra Fields\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20Extra%20Fields%22"
        },
        "response": {
          "bodySize": 1629,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1629,
            "text": "{\"result\":[{\"_id\":\"92edf2c7-0bab-412c-a0da-82ad4f04505b\",\"name\":\"Collect Extra Fields\",\"description\":\"null\",\"script\":\"LyogQ29sbGVjdCBFeHRyYSBGaWVsZHMKICogCiAqIENvbGxlY3QgZXh0cmEgZmllbGRzIG5vdCBwYXJ0IG9mIHRoZSB1c2VyIHByb2ZpbGUuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKi8KKGZ1bmN0aW9uICgpIHsKICAgIG91dGNvbWUgPSAndHJ1ZSc7CiAgICB2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICAgIAlqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLk5hbWVDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygnbW9kYWxpdHknKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygnand0VG9rZW4nKQogICAgICAgICkuYnVpbGQoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAJdmFyIG1vZGFsaXR5ID0gY2FsbGJhY2tzLmdldCgwKS5nZXROYW1lKCk7CiAgICAgIAl2YXIgand0VG9rZW4gPSBjYWxsYmFja3MuZ2V0KDEpLmdldE5hbWUoKTsKICAgICAgCW5vZGVTdGF0ZS5wdXRTaGFyZWQoJ21vZGFsaXR5JywgbW9kYWxpdHkpOwogICAgICAJbm9kZVN0YXRlLnB1dFNoYXJlZCgnand0VG9rZW4nLCBqd3RUb2tlbik7CiAgICAJYWN0aW9uID0gZnIuQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1629"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.158Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "63054e0911bafed4c6e0d118e2b5d118",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 576,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Apple Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Apple%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 2917,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2917,
            "text": "{\"result\":[{\"_id\":\"484e6246-dbc6-4288-97e6-54e55431402e\",\"name\":\"Apple Profile Normalization\",\"description\":\"Normalizes raw profile data from Apple\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjEtMjAyMiBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICoKICogSW4gc29tZSBjb21tb24gZGVmYXVsdCBjb25maWd1cmF0aW9ucywgdGhlIGZvbGxvd2luZyBrZXlzIGFyZSByZXF1aXJlZCB0byBiZSBub3QgZW1wdHk6CiAqIHVzZXJuYW1lLCBnaXZlbk5hbWUsIGZhbWlseU5hbWUsIGVtYWlsLgogKgogKiBGcm9tIFJGQzQ1MTc6IEEgdmFsdWUgb2YgdGhlIERpcmVjdG9yeSBTdHJpbmcgc3ludGF4IGlzIGEgc3RyaW5nIG9mIG9uZSBvciBtb3JlCiAqIGFyYml0cmFyeSBjaGFyYWN0ZXJzIGZyb20gdGhlIFVuaXZlcnNhbCBDaGFyYWN0ZXIgU2V0IChVQ1MpLgogKiBBIHplcm8tbGVuZ3RoIGNoYXJhY3RlciBzdHJpbmcgaXMgbm90IHBlcm1pdHRlZC4KICovCgppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKU3RyaW5nIGVtYWlsID0gImNoYW5nZUBtZS5jb20iClN0cmluZyBzdWJqZWN0SWQgPSByYXdQcm9maWxlLnN1YgpTdHJpbmcgZmlyc3ROYW1lID0gIiAiClN0cmluZyBsYXN0TmFtZSA9ICIgIgpTdHJpbmcgdXNlcm5hbWUgPSBzdWJqZWN0SWQKU3RyaW5nIG5hbWUKCmlmIChyYXdQcm9maWxlLmlzRGVmaW5lZCgiZW1haWwiKSAmJiByYXdQcm9maWxlLmVtYWlsLmlzTm90TnVsbCgpKXsgLy8gVXNlciBjYW4gZWxlY3QgdG8gbm90IHNoYXJlIHRoZWlyIGVtYWlsCiAgICBlbWFpbCA9IHJhd1Byb2ZpbGUuZW1haWwuYXNTdHJpbmcoKQogICAgdXNlcm5hbWUgPSBlbWFpbAp9CmlmIChyYXdQcm9maWxlLmlzRGVmaW5lZCgibmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5pc05vdE51bGwoKSkgewogICAgaWYgKHJhd1Byb2ZpbGUubmFtZS5pc0RlZmluZWQoImZpcnN0TmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5maXJzdE5hbWUuaXNOb3ROdWxsKCkpIHsKICAgICAgICBmaXJzdE5hbWUgPSByYXdQcm9maWxlLm5hbWUuZmlyc3ROYW1lLmFzU3RyaW5nKCkKICAgIH0KICAgIGlmIChyYXdQcm9maWxlLm5hbWUuaXNEZWZpbmVkKCJsYXN0TmFtZSIpICYmIHJhd1Byb2ZpbGUubmFtZS5sYXN0TmFtZS5pc05vdE51bGwoKSkgewogICAgICAgIGxhc3ROYW1lID0gcmF3UHJvZmlsZS5uYW1lLmxhc3ROYW1lLmFzU3RyaW5nKCkKICAgIH0KfQoKbmFtZSA9IChmaXJzdE5hbWU/LnRyaW0oKSA/IGZpcnN0TmFtZSA6ICIiKSArIChsYXN0TmFtZT8udHJpbSgpID8gKChmaXJzdE5hbWU/LnRyaW0oKSA/ICIgIiA6ICIiKSArIGxhc3ROYW1lKSA6ICIiKQpuYW1lID0gICghbmFtZT8udHJpbSgpKSA/ICIgIiA6IG5hbWUKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCBzdWJqZWN0SWQpLAogICAgICAgIGZpZWxkKCJkaXNwbGF5TmFtZSIsIG5hbWUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIGVtYWlsKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgZmlyc3ROYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIGxhc3ROYW1lKSwKICAgICAgICBmaWVsZCgidXNlcm5hbWUiLCB1c2VybmFtZSkpKQ==\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2917"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.199Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "af6570cd3d7d5a8c8e66fa79d624b8b3",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 566,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"AAD Passthru ROPC\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22AAD%20Passthru%20ROPC%22"
        },
        "response": {
          "bodySize": 5428,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 5428,
            "text": "{\"result\":[{\"_id\":\"13cd3c60-a04b-4455-b028-fbfd01ed88b1\",\"name\":\"AAD Passthru ROPC\",\"description\":\"Azure AD pass through authentication using Resource Owner Password Credential flow\",\"script\":\"LyogQUFEIFBhc3N0aHJ1IFJPUEMKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQXp1cmUgQUQgcGFzcyB0aHJvdWdoIGF1dGhlbnRpY2F0aW9uIHVzaW5nIFJlc291cmNlIE93bmVyIFBhc3N3b3JkIENyZWRlbnRpYWwgZmxvdwogKiAKICogVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIG5vdCB3b3JrIHByb3Blcmx5IGFzIGlzLiAKICogSXQgcmVxdWlyZXMgdGhlIFBsYXRmb3JtIFVzZXJuYW1lIGFuZCBQbGF0Zm9ybSBQYXNzd29yZCBjb2xsZWN0b3Igbm9kZXMKICogYmVmb3JlIGl0IGNhbiBvcGVyYXRlLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIFZhbGlkCiAqIC0gSW52YWxpZAogKiAtIEV4cGlyZWQKICogLSBEaXNhYmxlZAogKiAtIEVycm9yCiAqLwpsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFJPUEM6IHN0YXJ0Iik7CgppZiAoc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpICYmIHRyYW5zaWVudFN0YXRlLmdldCgicGFzc3dvcmQiKSkgewogIAkvKgogICAgICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICAgICAqCiAgICAgKiBSRVBMQUNFIFdJVEggWU9VUiBPV04gQVpVUkUgQUQgU0VUVElOR1MKICAgICAqCiAgICAgKiBBQURfVEVOQU5UX0lEIGlzIHlvdXIgdGVuYW50IElEOiBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9henVyZS9hY3RpdmUtZGlyZWN0b3J5L2Z1bmRhbWVudGFscy9hY3RpdmUtZGlyZWN0b3J5LWhvdy10by1maW5kLXRlbmFudAogICAgICogQUFEX0NMSUVOVF9JRCBpcyB5b3VyIHJlZ2lzdGVyZWQgYXBwIElEOiBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9henVyZS9hY3RpdmUtZGlyZWN0b3J5L2RldmVsb3AvcXVpY2tzdGFydC1yZWdpc3Rlci1hcHAKICAgICAqLwogICAgdmFyIEFBRF9URU5BTlRfSUQgPSAiNzExZmZhOWMtNTk3Mi00NzEzLWFjZTMtNjg4Yzk3MzI2MTRhIjsKICAgIHZhciBBQURfQ0xJRU5UX0lEID0gIjUxZjEzMGVjLWQyOWQtNDQxOS1hNDkyLTAwMTFkMDljMWExNiI7CiAgICAvKgogICAgICogRU5EIFNDUklQVCBDT05GSUdVUkFUSU9OCiAgICAgKi8KICAJCiAgICAvLyBBenVyZSBBRCBST1BDIENvbmZpZ3VyYXRpb24KICAgIHZhciBBQURfU0NPUEUgPSAicHJvZmlsZSI7CiAgCXZhciBBQURfUkVTT1VSQ0UgPSAiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tLyIKICAgIHZhciBBQURfT0FVVEgyX1RPS0VOX1VSSSA9ICJodHRwczovL2xvZ2luLndpbmRvd3MubmV0LyIuY29uY2F0KEFBRF9URU5BTlRfSUQpLmNvbmNhdCgiL29hdXRoMi90b2tlbiIpOwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0KCk7CiAgICByZXF1ZXN0LnNldE1ldGhvZCgnUE9TVCcpOwogICAgcmVxdWVzdC5zZXRVcmkoQUFEX09BVVRIMl9UT0tFTl9VUkkpOwogICAgcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICB2YXIgcGFyYW1zID0gcmVxdWVzdC5nZXRGb3JtKCk7CiAgICBwYXJhbXMuYWRkKCJyZXNvdXJjZSIsIEFBRF9SRVNPVVJDRSk7CiAgICBwYXJhbXMuYWRkKCJjbGllbnRfaWQiLCBBQURfQ0xJRU5UX0lEKTsKICAgIHBhcmFtcy5hZGQoImdyYW50X3R5cGUiLCAicGFzc3dvcmQiKTsKICAgIHBhcmFtcy5hZGQoInNjb3BlIiwgQUFEX1NDT1BFKTsKICAgIHBhcmFtcy5hZGQoInVzZXJuYW1lIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKTsKICAgIHBhcmFtcy5hZGQoInBhc3N3b3JkIiwgdHJhbnNpZW50U3RhdGUuZ2V0KCJwYXNzd29yZCIpKTsKICAgIHJlcXVlc3QuZ2V0RW50aXR5KCkuc2V0U3RyaW5nKHBhcmFtcy50b1N0cmluZygpKTsKCiAgICB2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCk7CiAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAvL2xvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogSlNPTiByZXN1bHQ6ICIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKCiAgCWlmIChyZXNwb25zZS5nZXRTdGF0dXMoKS5nZXRDb2RlKCkgPT09IDIwMCkgewogICAgICAJb3V0Y29tZSA9ICJWYWxpZCIKICAgICAgICB0cmFuc2llbnRTdGF0ZS5wdXQoImFhZEFjY2Vzc1Rva2VuIiwgcmVzdWx0LmFjY2Vzc190b2tlbik7CiAgICB9IGVsc2UgewogICAgICAgIC8qIE91dGNvbWVzOgogICAgICAgICAqIC0gVmFsaWQKICAgICAgICAgKiAtIEludmFsaWQKICAgICAgICAgKiAtIEV4cGlyZWQKICAgICAgICAgKiAtIERpc2FibGVkCiAgICAgICAgICogLSBFcnJvcgogICAgICAgICAqCiAgICAgICAgICogRXhwZWN0ZWQgRXJyb3IgQ29kZXM6CiAgICAgICAgICogNTAxMjYgLSBFcnJvciB2YWxpZGF0aW5nIGNyZWRlbnRpYWxzIGR1ZSB0byBpbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkLgogICAgICAgICAqIDUwMDU1IC0gVGhlIHBhc3N3b3JkIGlzIGV4cGlyZWQuCiAgICAgICAgICogNTAwNTcgLSBUaGUgdXNlciBhY2NvdW50IGlzIGRpc2FibGVkLgogICAgICAgICAqIDUwMTk2IC0gVGhlIHNlcnZlciB0ZXJtaW5hdGVkIGFuIG9wZXJhdGlvbiBiZWNhdXNlIGl0IGVuY291bnRlcmVkIGEgY2xpZW50IHJlcXVlc3QgbG9vcC4gUGxlYXNlIGNvbnRhY3QgeW91ciBhcHAgdmVuZG9yLgogICAgICAgICAqLwogICAgICAgIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAxMjYpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiSW52YWxpZCI7CiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAwNTUpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRXhwaXJlZCI7CiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZXJyb3JfY29kZXMuaW5jbHVkZXMoNTAwNTcpKSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRGlzYWJsZWQiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG91dGNvbWUgPSAiRXJyb3IiOwogICAgICAgIH0KICAgICAgICBsb2dnZXIubWVzc2FnZSgiQUFEIFBhc3N0aHJ1IFJPUEM6IGVycm9yID0gIi5jb25jYXQocmVzdWx0LmVycm9yKSk7CiAgICAgICAgbG9nZ2VyLm1lc3NhZ2UoIkFBRCBQYXNzdGhydSBST1BDOiBlcnJvcl9kZXNjcmlwdGlvbiA9ICIuY29uY2F0KHJlc3VsdC5lcnJvcl9kZXNjcmlwdGlvbikpOwogICAgICAgIGxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogZXJyb3JfY29kZXMgPSAiLmNvbmNhdChyZXN1bHQuZXJyb3JfY29kZXMpKTsKICAgIH0KfSBlbHNlIHsKICAJb3V0Y29tZSA9ICJFcnJvciI7CiAgCWxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogTm8gdXNlciBvciBwYXNzd29yZCBmb3VuZCBpbiBzaGFyZWQgc3RhdGUhIFVzZSB1c2VybmFtZSBhbmQgcGFzc3dvcmQgY29sbGVjdG9yIG5vZGVzIGJlZm9yZSB0aGlzIHNjcmlwdCB0byBwb3B1bGF0ZSBzaGFyZWQgYW5kIHRyYW5zaWVudCBzdGF0ZXMhJyIpOwp9CmxvZ2dlci5tZXNzYWdlKCJBQUQgUGFzc3RocnUgUk9QQzogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "5428"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.240Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "c5cda9fdad2bde1459bbb88c54fff9e7",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 590,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Device Id (Match) - Client Side\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Device%20Id%20%28Match%29%20-%20Client%20Side%22"
        },
        "response": {
          "bodySize": 12821,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 12821,
            "text": "{\"result\":[{\"_id\":\"157298c0-7d31-4059-a95b-eeb08473b7e5\",\"name\":\"Device Id (Match) - Client Side\",\"description\":\"Default global script for client side Device Id (Match) Authentication Module\",\"script\":\"dmFyIGZvbnREZXRlY3RvciA9IChmdW5jdGlvbiAoKSB7CiAgICAvKioKICAgICAqIEphdmFTY3JpcHQgY29kZSB0byBkZXRlY3QgYXZhaWxhYmxlIGF2YWlsYWJpbGl0eSBvZiBhCiAgICAgKiBwYXJ0aWN1bGFyIGZvbnQgaW4gYSBicm93c2VyIHVzaW5nIEphdmFTY3JpcHQgYW5kIENTUy4KICAgICAqCiAgICAgKiBBdXRob3IgOiBMYWxpdCBQYXRlbAogICAgICogV2Vic2l0ZTogaHR0cDovL3d3dy5sYWxpdC5vcmcvbGFiL2phdmFzY3JpcHQtY3NzLWZvbnQtZGV0ZWN0LwogICAgICogTGljZW5zZTogQXBhY2hlIFNvZnR3YXJlIExpY2Vuc2UgMi4wCiAgICAgKiAgICAgICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqIFZlcnNpb246IDAuMTUgKDIxIFNlcCAyMDA5KQogICAgICogICAgICAgICAgQ2hhbmdlZCBjb21wYXJpc2lvbiBmb250IHRvIGRlZmF1bHQgZnJvbSBzYW5zLWRlZmF1bHQtZGVmYXVsdCwKICAgICAqICAgICAgICAgIGFzIGluIEZGMy4wIGZvbnQgb2YgY2hpbGQgZWxlbWVudCBkaWRuJ3QgZmFsbGJhY2sKICAgICAqICAgICAgICAgIHRvIHBhcmVudCBlbGVtZW50IGlmIHRoZSBmb250IGlzIG1pc3NpbmcuCiAgICAgKiBWZXJzaW9uOiAwLjIgKDA0IE1hciAyMDEyKQogICAgICogICAgICAgICAgQ29tcGFyaW5nIGZvbnQgYWdhaW5zdCBhbGwgdGhlIDMgZ2VuZXJpYyBmb250IGZhbWlsaWVzIGllLAogICAgICogICAgICAgICAgJ21vbm9zcGFjZScsICdzYW5zLXNlcmlmJyBhbmQgJ3NhbnMnLiBJZiBpdCBkb2Vzbid0IG1hdGNoIGFsbCAzCiAgICAgKiAgICAgICAgICB0aGVuIHRoYXQgZm9udCBpcyAxMDAlIG5vdCBhdmFpbGFibGUgaW4gdGhlIHN5c3RlbQogICAgICogVmVyc2lvbjogMC4zICgyNCBNYXIgMjAxMikKICAgICAqICAgICAgICAgIFJlcGxhY2VkIHNhbnMgd2l0aCBzZXJpZiBpbiB0aGUgbGlzdCBvZiBiYXNlRm9udHMKICAgICAqLwogICAgLyoKICAgICAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMgRm9yZ2VSb2NrIEFTLgogICAgICovCiAgICB2YXIgZGV0ZWN0b3IgPSB7fSwgYmFzZUZvbnRzLCB0ZXN0U3RyaW5nLCB0ZXN0U2l6ZSwgaCwgcywgZGVmYXVsdFdpZHRoID0ge30sIGRlZmF1bHRIZWlnaHQgPSB7fSwgaW5kZXg7CgogICAgLy8gYSBmb250IHdpbGwgYmUgY29tcGFyZWQgYWdhaW5zdCBhbGwgdGhlIHRocmVlIGRlZmF1bHQgZm9udHMuCiAgICAvLyBhbmQgaWYgaXQgZG9lc24ndCBtYXRjaCBhbGwgMyB0aGVuIHRoYXQgZm9udCBpcyBub3QgYXZhaWxhYmxlLgogICAgYmFzZUZvbnRzID0gWydtb25vc3BhY2UnLCAnc2Fucy1zZXJpZicsICdzZXJpZiddOwoKICAgIC8vd2UgdXNlIG0gb3IgdyBiZWNhdXNlIHRoZXNlIHR3byBjaGFyYWN0ZXJzIHRha2UgdXAgdGhlIG1heGltdW0gd2lkdGguCiAgICAvLyBBbmQgd2UgdXNlIGEgTExpIHNvIHRoYXQgdGhlIHNhbWUgbWF0Y2hpbmcgZm9udHMgY2FuIGdldCBzZXBhcmF0ZWQKICAgIHRlc3RTdHJpbmcgPSAibW1tbW1tbW1tbWxsaSI7CgogICAgLy93ZSB0ZXN0IHVzaW5nIDcycHggZm9udCBzaXplLCB3ZSBtYXkgdXNlIGFueSBzaXplLiBJIGd1ZXNzIGxhcmdlciB0aGUgYmV0dGVyLgogICAgdGVzdFNpemUgPSAnNzJweCc7CgogICAgaCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CgogICAgLy8gY3JlYXRlIGEgU1BBTiBpbiB0aGUgZG9jdW1lbnQgdG8gZ2V0IHRoZSB3aWR0aCBvZiB0aGUgdGV4dCB3ZSB1c2UgdG8gdGVzdAogICAgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgIHMuc3R5bGUuZm9udFNpemUgPSB0ZXN0U2l6ZTsKICAgIHMuaW5uZXJIVE1MID0gdGVzdFN0cmluZzsKICAgIGZvciAoaW5kZXggaW4gYmFzZUZvbnRzKSB7CiAgICAgICAgLy9nZXQgdGhlIGRlZmF1bHQgd2lkdGggZm9yIHRoZSB0aHJlZSBiYXNlIGZvbnRzCiAgICAgICAgcy5zdHlsZS5mb250RmFtaWx5ID0gYmFzZUZvbnRzW2luZGV4XTsKICAgICAgICBoLmFwcGVuZENoaWxkKHMpOwogICAgICAgIGRlZmF1bHRXaWR0aFtiYXNlRm9udHNbaW5kZXhdXSA9IHMub2Zmc2V0V2lkdGg7IC8vd2lkdGggZm9yIHRoZSBkZWZhdWx0IGZvbnQKICAgICAgICBkZWZhdWx0SGVpZ2h0W2Jhc2VGb250c1tpbmRleF1dID0gcy5vZmZzZXRIZWlnaHQ7IC8vaGVpZ2h0IGZvciB0aGUgZGVmdWFsdCBmb250CiAgICAgICAgaC5yZW1vdmVDaGlsZChzKTsKICAgIH0KCiAgICBkZXRlY3Rvci5kZXRlY3QgPSBmdW5jdGlvbihmb250KSB7CiAgICAgICAgdmFyIGRldGVjdGVkID0gZmFsc2UsIGluZGV4LCBtYXRjaGVkOwogICAgICAgIGZvciAoaW5kZXggaW4gYmFzZUZvbnRzKSB7CiAgICAgICAgICAgIHMuc3R5bGUuZm9udEZhbWlseSA9IGZvbnQgKyAnLCcgKyBiYXNlRm9udHNbaW5kZXhdOyAvLyBuYW1lIG9mIHRoZSBmb250IGFsb25nIHdpdGggdGhlIGJhc2UgZm9udCBmb3IgZmFsbGJhY2suCiAgICAgICAgICAgIGguYXBwZW5kQ2hpbGQocyk7CiAgICAgICAgICAgIG1hdGNoZWQgPSAocy5vZmZzZXRXaWR0aCAhPT0gZGVmYXVsdFdpZHRoW2Jhc2VGb250c1tpbmRleF1dIHx8IHMub2Zmc2V0SGVpZ2h0ICE9PSBkZWZhdWx0SGVpZ2h0W2Jhc2VGb250c1tpbmRleF1dKTsKICAgICAgICAgICAgaC5yZW1vdmVDaGlsZChzKTsKICAgICAgICAgICAgZGV0ZWN0ZWQgPSBkZXRlY3RlZCB8fCBtYXRjaGVkOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZGV0ZWN0ZWQ7CiAgICB9OwoKICAgIHJldHVybiBkZXRlY3RvcjsKfSgpKTsKLyoKICogRE8gTk9UIEFMVEVSIE9SIFJFTU9WRSBDT1BZUklHSFQgTk9USUNFUyBPUiBUSElTIEhFQURFUi4KICoKICogQ29weXJpZ2h0IChjKSAyMDA5IFN1biBNaWNyb3N5c3RlbXMgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIHRlcm1zCiAqIG9mIHRoZSBDb21tb24gRGV2ZWxvcG1lbnQgYW5kIERpc3RyaWJ1dGlvbiBMaWNlbnNlCiAqICh0aGUgTGljZW5zZSkuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluCiAqIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICoKICogWW91IGNhbiBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqIGh0dHBzOi8vb3BlbnNzby5kZXYuamF2YS5uZXQvcHVibGljL0NEREx2MS4wLmh0bWwgb3IKICogb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQKICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nCiAqIHBlcm1pc3Npb24gYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBXaGVuIGRpc3RyaWJ1dGluZyBDb3ZlcmVkIENvZGUsIGluY2x1ZGUgdGhpcyBDRERMCiAqIEhlYWRlciBOb3RpY2UgaW4gZWFjaCBmaWxlIGFuZCBpbmNsdWRlIHRoZSBMaWNlbnNlIGZpbGUKICogYXQgb3BlbnNzby9sZWdhbC9DRERMdjEuMC50eHQuCiAqIElmIGFwcGxpY2FibGUsIGFkZCB0aGUgZm9sbG93aW5nIGJlbG93IHRoZSBDRERMIEhlYWRlciwKICogd2l0aCB0aGUgZmllbGRzIGVuY2xvc2VkIGJ5IGJyYWNrZXRzIFtdIHJlcGxhY2VkIGJ5CiAqIHlvdXIgb3duIGlkZW50aWZ5aW5nIGluZm9ybWF0aW9uOgogKiAiUG9ydGlvbnMgQ29weXJpZ2h0ZWQgW3llYXJdIFtuYW1lIG9mIGNvcHlyaWdodCBvd25lcl0iCiAqCiAqLwovKgogKiBQb3J0aW9ucyBDb3B5cmlnaHRlZCAyMDEzIFN5bnRlZ3JpdHkuCiAqIFBvcnRpb25zIENvcHlyaWdodGVkIDIwMTMtMjAxNCBGb3JnZVJvY2sgQVMuCiAqLwoKdmFyIGNvbGxlY3RTY3JlZW5JbmZvID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzY3JlZW5JbmZvID0ge307CiAgICAgICAgaWYgKHNjcmVlbikgewogICAgICAgICAgICBpZiAoc2NyZWVuLndpZHRoKSB7CiAgICAgICAgICAgICAgICBzY3JlZW5JbmZvLnNjcmVlbldpZHRoID0gc2NyZWVuLndpZHRoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2NyZWVuLmhlaWdodCkgewogICAgICAgICAgICAgICAgc2NyZWVuSW5mby5zY3JlZW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2NyZWVuLnBpeGVsRGVwdGgpIHsKICAgICAgICAgICAgICAgIHNjcmVlbkluZm8uc2NyZWVuQ29sb3VyRGVwdGggPSBzY3JlZW4ucGl4ZWxEZXB0aDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiQ2Fubm90IGNvbGxlY3Qgc2NyZWVuIGluZm9ybWF0aW9uLiBzY3JlZW4gaXMgbm90IGRlZmluZWQuIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzY3JlZW5JbmZvOwogICAgfSwKICAgIGNvbGxlY3RUaW1lem9uZUluZm8gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHRpbWV6b25lSW5mbyA9ICB7fSwgb2Zmc2V0ID0gbmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpOwoKICAgICAgICBpZiAob2Zmc2V0KSB7CiAgICAgICAgICAgIHRpbWV6b25lSW5mby50aW1lem9uZSA9IG9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIkNhbm5vdCBjb2xsZWN0IHRpbWV6b25lIGluZm9ybWF0aW9uLiB0aW1lem9uZSBpcyBub3QgZGVmaW5lZC4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aW1lem9uZUluZm87CiAgICB9LAogICAgY29sbGVjdEJyb3dzZXJQbHVnaW5zSW5mbyA9IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgaWYgKG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IucGx1Z2lucykgewogICAgICAgICAgICB2YXIgcGx1Z2luc0luZm8gPSB7fSwgaSwgcGx1Z2lucyA9IG5hdmlnYXRvci5wbHVnaW5zOwogICAgICAgICAgICBwbHVnaW5zSW5mby5pbnN0YWxsZWRQbHVnaW5zID0gIiI7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGx1Z2lucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgcGx1Z2luc0luZm8uaW5zdGFsbGVkUGx1Z2lucyA9IHBsdWdpbnNJbmZvLmluc3RhbGxlZFBsdWdpbnMgKyBwbHVnaW5zW2ldLmZpbGVuYW1lICsgIjsiOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcGx1Z2luc0luZm87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJDYW5ub3QgY29sbGVjdCBicm93c2VyIHBsdWdpbiBpbmZvcm1hdGlvbi4gbmF2aWdhdG9yLnBsdWdpbnMgaXMgbm90IGRlZmluZWQuIik7CiAgICAgICAgICAgIHJldHVybiB7fTsKICAgICAgICB9CgogICAgfSwKLy8gR2V0dGluZyBnZW9sb2NhdGlvbiB0YWtlcyBzb21lIHRpbWUgYW5kIGlzIGRvbmUgYXN5bmNocm9ub3VzbHksIGhlbmNlIG5lZWQgYSBjYWxsYmFjayB3aGljaCBpcyBjYWxsZWQgb25jZSBnZW9sb2NhdGlvbiBpcyByZXRyaWV2ZWQuCiAgICBjb2xsZWN0R2VvbG9jYXRpb25JbmZvID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgdmFyIGdlb2xvY2F0aW9uSW5mbyA9IHt9LAogICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2sgPSBmdW5jdGlvbihwb3NpdGlvbikgewogICAgICAgICAgICAgICAgZ2VvbG9jYXRpb25JbmZvLmxvbmdpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGU7CiAgICAgICAgICAgICAgICBnZW9sb2NhdGlvbkluZm8ubGF0aXR1ZGUgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7CiAgICAgICAgICAgICAgICBjYWxsYmFjayhnZW9sb2NhdGlvbkluZm8pOwogICAgICAgICAgICB9LCBlcnJvckNhbGxiYWNrID0gZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiQ2Fubm90IGNvbGxlY3QgZ2VvbG9jYXRpb24gaW5mb3JtYXRpb24uICIgKyBlcnJvci5jb2RlICsgIjogIiArIGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgY2FsbGJhY2soZ2VvbG9jYXRpb25JbmZvKTsKICAgICAgICAgICAgfTsKICAgICAgICBpZiAobmF2aWdhdG9yICYmIG5hdmlnYXRvci5nZW9sb2NhdGlvbikgewogICAgICAgICAgICAvLyBOQjogSWYgdXNlciBjaG9vc2VzICdOb3Qgbm93JyBvbiBGaXJlZm94IG5laXRoZXIgY2FsbGJhY2sgZ2V0cyBjYWxsZWQKICAgICAgICAgICAgLy8gICAgIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY3NTUzMwogICAgICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjayk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJDYW5ub3QgY29sbGVjdCBnZW9sb2NhdGlvbiBpbmZvcm1hdGlvbi4gbmF2aWdhdG9yLmdlb2xvY2F0aW9uIGlzIG5vdCBkZWZpbmVkLiIpOwogICAgICAgICAgICBjYWxsYmFjayhnZW9sb2NhdGlvbkluZm8pOwogICAgICAgIH0KICAgIH0sCiAgICBjb2xsZWN0QnJvd3NlckZvbnRzSW5mbyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZm9udHNJbmZvID0ge30sIGksIGZvbnRzTGlzdCA9IFsiY3Vyc2l2ZSIsIm1vbm9zcGFjZSIsInNlcmlmIiwic2Fucy1zZXJpZiIsImZhbnRhc3kiLCJkZWZhdWx0IiwiQXJpYWwiLCJBcmlhbCBCbGFjayIsCiAgICAgICAgICAgICJBcmlhbCBOYXJyb3ciLCJBcmlhbCBSb3VuZGVkIE1UIEJvbGQiLCJCb29rbWFuIE9sZCBTdHlsZSIsIkJyYWRsZXkgSGFuZCBJVEMiLCJDZW50dXJ5IiwiQ2VudHVyeSBHb3RoaWMiLAogICAgICAgICAgICAiQ29taWMgU2FucyBNUyIsIkNvdXJpZXIiLCJDb3VyaWVyIE5ldyIsIkdlb3JnaWEiLCJHZW50aXVtIiwiSW1wYWN0IiwiS2luZyIsIkx1Y2lkYSBDb25zb2xlIiwiTGFsaXQiLAogICAgICAgICAgICAiTW9kZW5hIiwiTW9ub3R5cGUgQ29yc2l2YSIsIlBhcHlydXMiLCJUYWhvbWEiLCJUZVgiLCJUaW1lcyIsIlRpbWVzIE5ldyBSb21hbiIsIlRyZWJ1Y2hldCBNUyIsIlZlcmRhbmEiLAogICAgICAgICAgICAiVmVyb25hIl07CiAgICAgICAgZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzID0gIiI7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBmb250c0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGZvbnREZXRlY3Rvci5kZXRlY3QoZm9udHNMaXN0W2ldKSkgewogICAgICAgICAgICAgICAgZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzID0gZm9udHNJbmZvLmluc3RhbGxlZEZvbnRzICsgZm9udHNMaXN0W2ldICsgIjsiOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmb250c0luZm87CiAgICB9LAogICAgZGV2aWNlUHJpbnQgPSB7fTsKCmRldmljZVByaW50LnNjcmVlbiA9IGNvbGxlY3RTY3JlZW5JbmZvKCk7CmRldmljZVByaW50LnRpbWV6b25lID0gY29sbGVjdFRpbWV6b25lSW5mbygpOwpkZXZpY2VQcmludC5wbHVnaW5zID0gY29sbGVjdEJyb3dzZXJQbHVnaW5zSW5mbygpOwpkZXZpY2VQcmludC5mb250cyA9IGNvbGxlY3RCcm93c2VyRm9udHNJbmZvKCk7CgppZiAobmF2aWdhdG9yLnVzZXJBZ2VudCkgewogICAgZGV2aWNlUHJpbnQudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsKfQppZiAobmF2aWdhdG9yLmFwcE5hbWUpIHsKICAgIGRldmljZVByaW50LmFwcE5hbWUgPSBuYXZpZ2F0b3IuYXBwTmFtZTsKfQppZiAobmF2aWdhdG9yLmFwcENvZGVOYW1lKSB7CiAgICBkZXZpY2VQcmludC5hcHBDb2RlTmFtZSA9IG5hdmlnYXRvci5hcHBDb2RlTmFtZTsKfQppZiAobmF2aWdhdG9yLmFwcFZlcnNpb24pIHsKICAgIGRldmljZVByaW50LmFwcFZlcnNpb24gPSBuYXZpZ2F0b3IuYXBwVmVyc2lvbjsKfQppZiAobmF2aWdhdG9yLmFwcE1pbm9yVmVyc2lvbikgewogICAgZGV2aWNlUHJpbnQuYXBwTWlub3JWZXJzaW9uID0gbmF2aWdhdG9yLmFwcE1pbm9yVmVyc2lvbjsKfQppZiAobmF2aWdhdG9yLmJ1aWxkSUQpIHsKICAgIGRldmljZVByaW50LmJ1aWxkSUQgPSBuYXZpZ2F0b3IuYnVpbGRJRDsKfQppZiAobmF2aWdhdG9yLnBsYXRmb3JtKSB7CiAgICBkZXZpY2VQcmludC5wbGF0Zm9ybSA9IG5hdmlnYXRvci5wbGF0Zm9ybTsKfQppZiAobmF2aWdhdG9yLmNwdUNsYXNzKSB7CiAgICBkZXZpY2VQcmludC5jcHVDbGFzcyA9IG5hdmlnYXRvci5jcHVDbGFzczsKfQppZiAobmF2aWdhdG9yLm9zY3B1KSB7CiAgICBkZXZpY2VQcmludC5vc2NwdSA9IG5hdmlnYXRvci5vc2NwdTsKfQppZiAobmF2aWdhdG9yLnByb2R1Y3QpIHsKICAgIGRldmljZVByaW50LnByb2R1Y3QgPSBuYXZpZ2F0b3IucHJvZHVjdDsKfQppZiAobmF2aWdhdG9yLnByb2R1Y3RTdWIpIHsKICAgIGRldmljZVByaW50LnByb2R1Y3RTdWIgPSBuYXZpZ2F0b3IucHJvZHVjdFN1YjsKfQppZiAobmF2aWdhdG9yLnZlbmRvcikgewogICAgZGV2aWNlUHJpbnQudmVuZG9yID0gbmF2aWdhdG9yLnZlbmRvcjsKfQppZiAobmF2aWdhdG9yLnZlbmRvclN1YikgewogICAgZGV2aWNlUHJpbnQudmVuZG9yU3ViID0gbmF2aWdhdG9yLnZlbmRvclN1YjsKfQppZiAobmF2aWdhdG9yLmxhbmd1YWdlKSB7CiAgICBkZXZpY2VQcmludC5sYW5ndWFnZSA9IG5hdmlnYXRvci5sYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLnVzZXJMYW5ndWFnZSkgewogICAgZGV2aWNlUHJpbnQudXNlckxhbmd1YWdlID0gbmF2aWdhdG9yLnVzZXJMYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLmJyb3dzZXJMYW5ndWFnZSkgewogICAgZGV2aWNlUHJpbnQuYnJvd3Nlckxhbmd1YWdlID0gbmF2aWdhdG9yLmJyb3dzZXJMYW5ndWFnZTsKfQppZiAobmF2aWdhdG9yLnN5c3RlbUxhbmd1YWdlKSB7CiAgICBkZXZpY2VQcmludC5zeXN0ZW1MYW5ndWFnZSA9IG5hdmlnYXRvci5zeXN0ZW1MYW5ndWFnZTsKfQoKLy8gQXR0ZW1wdCB0byBjb2xsZWN0IGdlby1sb2NhdGlvbiBpbmZvcm1hdGlvbiBhbmQgcmV0dXJuIHRoaXMgd2l0aCB0aGUgZGF0YSBjb2xsZWN0ZWQgc28gZmFyLgovLyBPdGhlcndpc2UsIGlmIGdlby1sb2NhdGlvbiBmYWlscyBvciB0YWtlcyBsb25nZXIgdGhhbiAzMCBzZWNvbmRzLCBhdXRvLXN1Ym1pdCB0aGUgZGF0YSBjb2xsZWN0ZWQgc28gZmFyLgphdXRvU3VibWl0RGVsYXkgPSAzMDAwMDsKb3V0cHV0LnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoZGV2aWNlUHJpbnQpOwpjb2xsZWN0R2VvbG9jYXRpb25JbmZvKGZ1bmN0aW9uKGdlb2xvY2F0aW9uSW5mbykgewogICAgZGV2aWNlUHJpbnQuZ2VvbG9jYXRpb24gPSBnZW9sb2NhdGlvbkluZm87CiAgICBvdXRwdXQudmFsdWUgPSBKU09OLnN0cmluZ2lmeShkZXZpY2VQcmludCk7CiAgICBzdWJtaXQoKTsKfSk7\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_CLIENT_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "transfer-encoding",
              "value": "chunked"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.279Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "0b5bdd5efa8fa86e894e34cbb0737401",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 561,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FrodoTestScript3\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FrodoTestScript3%22"
        },
        "response": {
          "bodySize": 1106,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1106,
            "text": "{\"result\":[{\"_id\":\"3b2f6836-184c-4ee9-8a1d-557cb01837a5\",\"name\":\"FrodoTestScript3\",\"description\":\"Check if username has already been collected.\",\"script\":\"LyogQ2hlY2sgVXNlcm5hbWUKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogQ2hlY2sgaWYgdXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiBjb2xsZWN0ZWQuCiAqIFJldHVybiAia25vd24iIGlmIHllcywgInVua25vd24iIG90aGVyd2lzZS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0ga25vd24KICogLSB1bmtub3duCiAqLwooZnVuY3Rpb24gKCkgewogICAgaWYgKG51bGwgIT0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpKSB7CiAgICAgICAgb3V0Y29tZSA9ICJrbm93biI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvdXRjb21lID0gInVua25vd24iOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1106"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.320Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "d4256f684eef44548de77078894a3384",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 578,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Collect Message Node Config\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Collect%20Message%20Node%20Config%22"
        },
        "response": {
          "bodySize": 3331,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3331,
            "text": "{\"result\":[{\"_id\":\"169150da-0bd1-4866-8095-eae0bbc269e4\",\"name\":\"Collect Message Node Config\",\"description\":\"Collect all the configuration items required for the Message Node to function properly.\",\"script\":\"LyogQ29sbGVjdCBNZXNzYWdlIE5vZGUgQ29uZmlnCiAqIAogKiBDb2xsZWN0IGFsbCB0aGUgY29uZmlndXJhdGlvbiBpdGVtcyByZXF1aXJlZCBmb3IgdGhlIE1lc3NhZ2UgTm9kZSB0byBmdW5jdGlvbiBwcm9wZXJseS4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJ0cnVlIjsKICAJdmFyIGNvbmZpZyA9IHsKICAgICAgICAibWVzc2FnZSI6IHsiZW4iOiAiSSBiZWxpZXZlIEkgY2FuIGZseSEifSwKICAgICAgICAibWVzc2FnZVllcyI6IHsiZW4iOiAiR2xvcmlvdXMhIn0sCiAgICAgICAgIm1lc3NhZ2VObyI6IHsiZW4iOiAiSW5jb25jZWl2YWJsZSEifQogICAgfTsKICAJdmFyIHNjcmlwdCA9ICIiOwogICAgc2NyaXB0ICs9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgiOwogICAgc2NyaXB0ICs9ICIgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0JykiOwogICAgc2NyaXB0ICs9ICIpLmZvckVhY2goIjsKICAgIHNjcmlwdCArPSAiICAgIGZ1bmN0aW9uIChpbnB1dCxpKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQgJytpKTsiCiAgICBzY3JpcHQgKz0gIiAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoJyIrSlNPTi5zdHJpbmdpZnkoY29uZmlnKSsiJyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZyk7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ3RleHQnKSB7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbmZpZ1trZXlzW2ldXS5lbik7IjsKICAgIHNjcmlwdCArPSAiICAgICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgS2V5Ym9hcmRFdmVudCggJ2lucHV0JyAsIHsna2V5JzonRW50ZXInfSApKTsiOwogICAgc2NyaXB0ICs9ICIgICAgICAgIH0iOwogICAgc2NyaXB0ICs9ICIgICAgfSI7CiAgICBzY3JpcHQgKz0gIik7IjsKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgICBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbiwKICAgICAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suTmFtZUNhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawogICAgKQogICAgaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZSIsIGNvbmZpZy5tZXNzYWdlLmVuKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZVllcyIsIGNvbmZpZy5tZXNzYWdlWWVzLmVuKSwKICAgICAgICAgICAgbmV3IGZyLk5hbWVDYWxsYmFjaygibWVzc2FnZU5vIiwgY29uZmlnLm1lc3NhZ2VOby5lbiksCiAgICAgICAgICAJbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICAgICAgKS5idWlsZCgpOwogICAgfQogICAgZWxzZSB7CiAgICAgIAljb25maWdbY2FsbGJhY2tzLmdldCgwKS5nZXRQcm9tcHQoKV0uZW4gPSBjYWxsYmFja3MuZ2V0KDApLmdldE5hbWUoKTsKICAgICAgCWNvbmZpZ1tjYWxsYmFja3MuZ2V0KDEpLmdldFByb21wdCgpXS5lbiA9IGNhbGxiYWNrcy5nZXQoMSkuZ2V0TmFtZSgpOwogICAgICAJY29uZmlnW2NhbGxiYWNrcy5nZXQoMikuZ2V0UHJvbXB0KCldLmVuID0gY2FsbGJhY2tzLmdldCgyKS5nZXROYW1lKCk7CiAgICAgIAlub2RlU3RhdGUucHV0U2hhcmVkKCJub2RlQ29uZmlnIiwgY29uZmlnKTsKICAgIAlhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQp9KCkpOw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3331"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.361Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "e4bae345254e0df9bfa0f0633bad19e0",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 580,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"VKontakte Profile Normalization\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22VKontakte%20Profile%20Normalization%22"
        },
        "response": {
          "bodySize": 1593,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1593,
            "text": "{\"result\":[{\"_id\":\"403cf226-6051-4368-8b72-9ba14f9a5140\",\"name\":\"VKontakte Profile Normalization\",\"description\":\"Normalizes raw profile data from VKontakte\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjAgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmZpZWxkCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5qc29uCmltcG9ydCBzdGF0aWMgb3JnLmZvcmdlcm9jay5qc29uLkpzb25WYWx1ZS5vYmplY3QKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLmlkKSwKICAgICAgICBmaWVsZCgiZGlzcGxheU5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJnaXZlbk5hbWUiLCByYXdQcm9maWxlLmZpcnN0X25hbWUpLAogICAgICAgIGZpZWxkKCJmYW1pbHlOYW1lIiwgcmF3UHJvZmlsZS5sYXN0X25hbWUpLAogICAgICAgIGZpZWxkKCJwaG90b1VybCIsIHJhd1Byb2ZpbGUucGhvdG9fNTApLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpKSk=\",\"default\":true,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"creationDate\":1433147666269,\"lastModifiedBy\":\"id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org\",\"lastModifiedDate\":1433147666269}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1593"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.403Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "728b80a554f8af2bf4d3729cacc577ea",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Set OATH Theme\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Set%20OATH%20Theme%22"
        },
        "response": {
          "bodySize": 3591,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3591,
            "text": "{\"result\":[{\"_id\":\"f2107949-22f8-46c4-865d-ae1d1110a9cb\",\"name\":\"Set OATH Theme\",\"description\":\"Detect and preserve currently active theme before setting the new theme.\",\"script\":\"LyogU2V0IE9BVEggVGhlbWUKICogCiAqIERldGVjdCBhbmQgcHJlc2VydmUgY3VycmVudGx5IGFjdGl2ZSB0aGVtZSBiZWZvcmUgc2V0dGluZyB0aGUgbmV3IHRoZW1lLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgCQogIAl2YXIgdGhlbWUgPSAiRXhwYW5zZV9PQVRIIjsKCgkvLyBkbyBub3QgY2hhbmdlLCBtdXN0IGJlIGEgcmFuZG9tIGlkZW50aWZpZXIKCXZhciBhbmNob3IgPSBnZW5lcmF0ZU51bWVyaWNUb2tlbigneHh4Jyk7CiAgCiAgCXZhciBzY3JpcHQgPSAiIjsKICAgIHNjcmlwdCArPSAiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lLWlkJyk7IjsKICAgIHNjcmlwdCArPSAiY29uc29sZS5sb2coJ3RoZW1lLWlkPScrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aGVtZS1pZC0iK2FuY2hvcisiXCIpLnZhbHVlKTsiOwogIAlzY3JpcHQgKz0gImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5CdXR0b25fMFwiKS5jbGljaygpOyI7CgogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAJb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlBvbGxpbmdXYWl0Q2FsbGJhY2ssCiAgICAJY29tLnN1bi5pZGVudGl0eS5hdXRoZW50aWNhdGlvbi5jYWxsYmFja3MuSGlkZGVuVmFsdWVDYWxsYmFjaywKICAgICAgICBjb20uc3VuLmlkZW50aXR5LmF1dGhlbnRpY2F0aW9uLmNhbGxiYWNrcy5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2sKICAgICkKICAgIC8vIGRpc2NvdmVyIGFjdGl2ZSB0aGVtZSBmcm9tIFVJCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgIAluZXcgZnIuSGlkZGVuVmFsdWVDYWxsYmFjaygidGhlbWUtaWQtIithbmNob3IsICJmYWxzZSIpLAogICAgICAgICAgICBuZXcgZnIuU2NyaXB0VGV4dE91dHB1dENhbGxiYWNrKHNjcmlwdCkKICAgICAgICApLmJ1aWxkKCk7CiAgICB9CiAgCS8vIGdldCBhY3RpdmUgdGhlbWUgZnJvbSBjYWxsYmFjayBhbmQgc2V0IG5ldyB0aGVtZQogIAllbHNlIGlmIChjYWxsYmFja3Muc2l6ZSgpID09PSAyKSB7CiAgICAgICAgLy8gZGlkIHdlIGdldCB0aGUgaWQgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGhlbWU/CiAgICAgICAgaWYgKGNhbGxiYWNrcy5nZXQoMCkuZ2V0VmFsdWUoKSAhPT0gInRoZW1lLWlkLSIrYW5jaG9yKSB7CiAgICAgICAgICAJc2hhcmVkU3RhdGUucHV0KCJ0aGVtZUlkIiwgY2FsbGJhY2tzLmdldCgwKS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gc2V0IG5ldyB0aGVtZQogICAgCXZhciBzdGFnZSA9ICJ0aGVtZUlkPSIrdGhlbWU7CiAgICAgICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgICAJbmV3IGZyLlBvbGxpbmdXYWl0Q2FsbGJhY2soIjAiLCAiUGxlYXNlIHdhaXQgLi4uIikKICAgICAgICApLndpdGhTdGFnZShzdGFnZSkuYnVpbGQoKTsKICAgIH0KICAJZWxzZSB7CiAgICAgICAgLy8gY29udGludWUKICAgICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3591"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:34 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.443Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "bd725795c9e1602f26ba572e2fc89ff8",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 575,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Store Profile In Session\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Store%20Profile%20In%20Session%22"
        },
        "response": {
          "bodySize": 3481,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3481,
            "text": "{\"result\":[{\"_id\":\"3981c0d3-0e3a-4c1d-be6b-5442e8acd3a1\",\"name\":\"Store Profile In Session\",\"description\":\"Store the profile information in objectAttributes in session properties.\",\"script\":\"LyogU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uCiAqIAogKiBTdG9yZSB0aGUgcHJvZmlsZSBpbmZvcm1hdGlvbiBpbiBvYmplY3RBdHRyaWJ1dGVzIGluIHNlc3Npb24gcHJvcGVydGllcy4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKgogKiBBdXRob3I6IGpha2UuZmVhc2VsQGZvcmdlcm9jay5jb20sIHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAlsb2dnZXIubWVzc2FnZSgiU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uOiBzdGFydCIpOwogIAlvdXRjb21lID0gInRydWUiOwogICAgdmFyIGdvVG8gPSBvcmcuZm9yZ2Vyb2NrLm9wZW5hbS5hdXRoLm5vZGUuYXBpLkFjdGlvbi5nb1RvOwogICAgbXlHb3RvID0gZ29UbyhvdXRjb21lKTsKICAJCiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCWlmIChyb3V0ZWRJRFAuZ2V0KCJfaWQiKSkgewogICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoIm9yZyIsIHJvdXRlZElEUC5nZXQoIm5hbWUiKSk7CiAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgiaWRwIiwgcm91dGVkSURQLmdldCgiaWRwTmFtZSIpKTsKICAgICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoInNhYXMiLCAidHJ1ZSIpOwogICAgfQogIAllbHNlIHsKICAgICAgCW15R290by5wdXRTZXNzaW9uUHJvcGVydHkoImlkcCIsICJsb2NhbCIpOwogICAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgic2FhcyIsICJmYWxzZSIpOwogICAgfQogIAlteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJ1c2VyTmFtZSIsIHNoYXJlZFN0YXRlLmdldCgidXNlcm5hbWUiKSk7CiAgCiAgCXZhciBwcm9maWxlQXR0cnMgPSBbImdpdmVuTmFtZSIsInNuIiwibWFpbCJdOwogIAkKICAJdmFyIHVzZXJpZCA9IHNoYXJlZFN0YXRlLmdldCgiX2lkIikKICAJaWYgKHVzZXJpZCkgewogICAgICAJbXlHb3RvLnB1dFNlc3Npb25Qcm9wZXJ0eSgicHJvZmlsZVR5cGUiLCAicGVyc2lzdGVudCIpOwogICAgICAJcHJvZmlsZUF0dHJzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICBteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KGtleSwgaWRSZXBvc2l0b3J5LmdldEF0dHJpYnV0ZSh1c2VyaWQsIGtleSkuaXRlcmF0b3IoKS5uZXh0KCkpOwogICAgICAgIH0pOwogICAgfQogICAgZWxzZSB7CiAgICAgIAlteUdvdG8ucHV0U2Vzc2lvblByb3BlcnR5KCJwcm9maWxlVHlwZSIsICJ0cmFuc2llbnQiKTsKICAgIH0KCiAgCXZhciBpbmNsdWRlID0gWyJnaXZlbk5hbWUiLCJzbiIsIm1haWwiLCJyb2xlcyJdOwogIAogICAgdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgCXZhciBlbnRyaWVzID0gbnVsbDsKICAJaWYgKGF0dHJzKSB7CiAgICAgIAllbnRyaWVzID0gYXR0cnMuZW50cnlTZXQoKS50b0FycmF5KCk7CiAgICAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICAgICAgCWlmIChpbmNsdWRlLmluZGV4T2YoIiIrZW50cnkuZ2V0S2V5KCkpID4gLTEpIHsKICAgICAgICAgICAgICAgIG15R290by5wdXRTZXNzaW9uUHJvcGVydHkoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgYXR0cnMgPSB0cmFuc2llbnRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAJaWYgKGF0dHJzKSB7CiAgICAgIAllbnRyaWVzID0gYXR0cnMuZW50cnlTZXQoKS50b0FycmF5KCk7CiAgICAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICAgICAgCWlmIChpbmNsdWRlLmluZGV4T2YoIiIrZW50cnkuZ2V0S2V5KCkpID4gLTEpIHsKICAgICAgICAgICAgICAgIG15R290by5wdXRTZXNzaW9uUHJvcGVydHkoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogIAlsb2dnZXIubWVzc2FnZSgiU3RvcmUgUHJvZmlsZSBJbiBTZXNzaW9uOiBkb25lIFtvdXRjb21lPXt9XSIsIG91dGNvbWUpOwogICAgYWN0aW9uID0gbXlHb3RvLmJ1aWxkKCk7Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3481"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.483Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "867775d4871975c9aa77d6c437838559",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 574,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Display States\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Display%20States%22"
        },
        "response": {
          "bodySize": 3360,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3360,
            "text": "{\"result\":[{\"_id\":\"164fe425-01e7-4b0b-9f60-fb41f6bf362b\",\"name\":\"FRAAS-7955 Display States\",\"description\":\"FRAAS-7955 Display sharedState and transientState.\",\"script\":\"LyogZGVidWcKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogRGlzcGxheSBzaGFyZWRTdGF0ZSBhbmQgdHJhbnNpZW50U3RhdGUuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCnZhciBvdXRwdXQgPSB0cnVlOwoKdmFyIGFuY2hvciA9ICJhbmNob3ItIi5jb25jYXQoZ2VuZXJhdGVOdW1lcmljVG9rZW4oJ3h4eCcpKTsKdmFyIGhhbGlnbiA9ICJsZWZ0IjsKdmFyIG1lc3NhZ2UgPSAiPGg0PkN1cnJlbnQgU3RhdGUgVmFsdWVzPC9oND4iLmNvbmNhdCgKICAgICI8cD48Yj5TaGFyZWQgU3RhdGU8L2I+Ojxici8+IikuY29uY2F0KAogIAlzaGFyZWRTdGF0ZS50b1N0cmluZygpKS5jb25jYXQoIjwvcD4iKS5jb25jYXQoCiAgICAiPHA+PGI+VHJhbnNpZW50IFN0YXRlPC9iPjo8YnIvPiIpLmNvbmNhdCgKICAJdHJhbnNpZW50U3RhdGUudG9TdHJpbmcoKSkuY29uY2F0KCI8L3A+IikKdmFyIHNjcmlwdCA9ICJBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChcbiIuY29uY2F0KAogICJkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYWxsYmFjay1jb21wb25lbnQnKSkuZm9yRWFjaChcbiIpLmNvbmNhdCgKICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAiICB2YXIgbWVzc2FnZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4iKS5jb25jYXQoCiAgIiAgaWYgKG1lc3NhZ2UuZmlyc3RDaGlsZCAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZU5hbWUgPT0gJyN0ZXh0JyAmJiBtZXNzYWdlLmZpcnN0Q2hpbGQubm9kZVZhbHVlLnRyaW0oKSA9PSAnIikuY29uY2F0KGFuY2hvcikuY29uY2F0KCInKSB7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLnN0eWxlID0gXCJ0ZXh0LWFsaWduOiBsZWZ0OyBpbmxpbmUtc2l6ZTogNDMwcHg7IG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7XCI7XG4iKS5jb25jYXQoCiAgIiAgICBtZXNzYWdlLmFsaWduID0gXCIiKS5jb25jYXQoaGFsaWduKS5jb25jYXQoIlwiO1xuIikuY29uY2F0KAogICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAiICB9XG4iKS5jb25jYXQoCiAgIn0pIikKdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaS5BY3Rpb24sCiAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLlRleHRPdXRwdXRDYWxsYmFjaywKICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjawopCmlmIChtZXNzYWdlLmxlbmd0aCAmJiBjYWxsYmFja3MuaXNFbXB0eSgpKSB7CiAgICBhY3Rpb24gPSBmci5BY3Rpb24uc2VuZCgKICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICBmci5UZXh0T3V0cHV0Q2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgIGFuY2hvcgogICAgICAgICksCiAgICAgICAgbmV3IGZyLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjayhzY3JpcHQpCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbygidHJ1ZSIpLmJ1aWxkKCk7Cn0KCiAvKgogICogR2VuZXJhdGUgYSB0b2tlbiBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuIEFsbCAneCcgY2hhcmFjdGVycyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSByYW5kb20gbnVtYmVyIDAtOS4KICAqIAogICogRXhhbXBsZToKICAqICd4eHh4eCcgcHJvZHVjZXMgJzI4NTM1JwogICogJ3h4eC14eHgnIHByb2R1Y2VzICc0MzItNTIxJwogICovCmZ1bmN0aW9uIGdlbmVyYXRlTnVtZXJpY1Rva2VuKGZvcm1hdCkgewogICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC9beF0vZywgZnVuY3Rpb24oYykgewogICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgIHZhciB2ID0gcjsKICAgICAgICByZXR1cm4gdi50b1N0cmluZygxMCk7CiAgICB9KTsKfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3360"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.523Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "ca4e63d7b15ff40d57d9bc870b12cced",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 573,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IPv4 CIDR Rules Engine\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IPv4%20CIDR%20Rules%20Engine%22"
        },
        "response": {
          "bodySize": 2611,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2611,
            "text": "{\"result\":[{\"_id\":\"7fb962a5-9f20-41d3-a077-b424a29c1198\",\"name\":\"IPv4 CIDR Rules Engine\",\"description\":\"Evaluate IPv4 CIDR access rules from \\\"esv-ipv4-cidr-access-rules\\\".\",\"script\":\"LyogSVB2NCBDSURSIFJ1bGVzIEVuZ2luZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tLCBqdXN0aW4uY2hpbkBmb3JnZXJvY2suY29tCiAqIAogKiBFdmFsdWF0ZSBJUHY0IENJRFIgYWNjZXNzIHJ1bGVzIGZyb20gImVzdi1pcHY0LWNpZHItYWNjZXNzLXJ1bGVzIi4gCiAqIEFjY2VzcyBydWxlcyBtdXN0IGhhdmUgdGhlIGZvbGxvd2luZyBmb3JtYXQ6CiAqIHsKICogICAiYWxsb3ciOiBbCiAqICAgICAiMTQwLjExOC4wLjAvMTYiLAogKiAgICAgIjExMC4zNS4wLjAvMTYiLAogKiAgICAgIjEzMS4yNi4wLjAvMTYiLAogKiAgICAgIjkyLjYxLjIxLjE1My8zMiIKICogICBdCiAqIH0KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gYWxsb3cKICogLSBkZW55CiAqLwooZnVuY3Rpb24gKCkgewogIG91dGNvbWUgPSAiZGVueSI7CiAgCiAgdmFyIHJ1bGVzID0gSlNPTi5wYXJzZShzeXN0ZW1FbnYuZ2V0UHJvcGVydHkoImVzdi5pcHY0LmNpZHIuYWNjZXNzLnJ1bGVzIikpOwogIHZhciBhbGxvdyA9IHJ1bGVzWydhbGxvdyddOwoKICAvKgogICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKGhlYWRlck5hbWUpIHsKICAgIHJldHVybiByZXF1ZXN0SGVhZGVycy5nZXQoaGVhZGVyTmFtZSkuZ2V0KDApOwogIH0KCiAgLyoKICAgKiBSZXR1cm5zIHRoZSBjbGllbnQncyBJUCBhZGRyZXNzCiAgICovCiAgZnVuY3Rpb24gZ2V0Q2xpZW50SVBBZGRyZXNzKCkgewogICAgcmV0dXJuIGdldEhlYWRlcigieC1mb3J3YXJkZWQtZm9yIikuc3BsaXQoJywnKVswXTsKICB9CgogIGZ1bmN0aW9uIElQbnVtYmVyKElQYWRkcmVzcykgewogICAgdmFyIGlwID0gSVBhZGRyZXNzLm1hdGNoKC9eKFxkKylcLihcZCspXC4oXGQrKVwuKFxkKykkLyk7CiAgICBpZiAoaXApIHsKICAgICAgcmV0dXJuICgraXBbMV0gPDwgMjQpICsgKCtpcFsyXSA8PCAxNikgKyAoK2lwWzNdIDw8IDgpICsgK2lwWzRdOwogICAgfQogICAgLy8gZWxzZSAuLi4gPwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBJUG1hc2sobWFza1NpemUpIHsKICAgIHJldHVybiAtMSA8PCAoMzIgLSBtYXNrU2l6ZSk7CiAgfQoKICBmdW5jdGlvbiBpc0FsbG93ZWQoaXApIHsKICAgIHZhciBhbGxvd2VkID0gZmFsc2U7CiAgICBhbGxvdy5mb3JFYWNoKChjaWRyKSA9PiB7CiAgICAgIGlmICgKICAgICAgICAoSVBudW1iZXIoaXApICYgSVBtYXNrKGNpZHIuc3BsaXQoJy8nKVsxXSkpID09CiAgICAgICAgSVBudW1iZXIoY2lkci5zcGxpdCgnLycpWzBdKQogICAgICApIHsKICAgICAgICBhbGxvd2VkID0gdHJ1ZTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gYWxsb3dlZDsKICB9CiAgCiAgaWYgKGlzQWxsb3dlZChnZXRDbGllbnRJUEFkZHJlc3MoKSkpIHsKICAgIG91dGNvbWUgPSAiYWxsb3ciOwogIH0KfSgpKTs=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2611"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.565Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "bc46a12852a377e0b2084fbdb10e155f",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 569,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Display Session Info\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Display%20Session%20Info%22"
        },
        "response": {
          "bodySize": 6826,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6826,
            "text": "{\"result\":[{\"_id\":\"37bf200a-158f-4a45-8ee5-81516e4593f8\",\"name\":\"Display Session Info\",\"description\":\"Display session info.\",\"script\":\"LyogRGlzcGxheSBTZXNzaW9uIEluZm8KICogCiAqIERpc3BsYXkgU2Vzc2lvbiBJbmZvLgogKiAKICogVGhpcyBzY3JpcHQgZG9lcyBub3QgbmVlZCB0byBiZSBwYXJhbWV0cml6ZWQuIEl0IHdpbGwgd29yayBwcm9wZXJseSBhcyBpcy4KICogCiAqIFRoZSBTY3JpcHRlZCBEZWNpc2lvbiBOb2RlIG5lZWRzIHRoZSBmb2xsb3dpbmcgb3V0Y29tZXMgZGVmaW5lZDoKICogLSB0cnVlCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICovCihmdW5jdGlvbiAoKSB7CiAgICBvdXRjb21lID0gInRydWUiOwoKICAgIHZhciBhbmNob3IgPSAiYW5jaG9yLSIuY29uY2F0KGdlbmVyYXRlTnVtZXJpY1Rva2VuKCd4eHgnKSk7CiAgICB2YXIgaGFsaWduID0gImxlZnQiOwoKICAgIHZhciBjaG9pY2VzID0gW107CiAgCXZhciBkZWZhdWx0Q2hvaWNlID0gMDsKICAKICAJdmFyIGluY2x1ZGUgPSBbIm9yZyIsImlkcCIsInNhYXMiLCJwcm9maWxlVHlwZSIsImdpdmVuTmFtZSIsInNuIiwibWFpbCIsInJvbGVzIiwidXNlck5hbWUiLCJVc2VySWQiLCJMb2NhbGUiLCJhdXRoSW5zdGFudCIsIkF1dGhMZXZlbCIsIkhvc3QiLCJTZXJ2aWNlIl07CiAgICB2YXIgbWVzc2FnZSA9ICIiOwogICAgaWYgKHR5cGVvZiBleGlzdGluZ1Nlc3Npb24gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIAltZXNzYWdlID0gIjxoND5TZXNzaW9uIEluZm88L2g0PjxwIHN0eWxlPVwiZm9udC1mYW1pbHk6Y291cmllcjtcIj4iOwogICAgICAJaW5jbHVkZS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIAltZXNzYWdlICs9ICI8Yj4iICsga2V5ICsgIjwvYj46ICIgKyBleGlzdGluZ1Nlc3Npb24uZ2V0KGtleSkgKyAiPGJyLz4iOwogICAgICAgIH0pOwogICAgIAltZXNzYWdlICs9ICI8L3A+PHAgc3R5bGU9XCJmb250LXNpemU6NzAlO2ZvbnQtZmFtaWx5OmNvdXJpZXI7XCI+IgogICAgICAJdmFyIGVudHJpZXMgPSBleGlzdGluZ1Nlc3Npb24ua2V5U2V0KCkudG9BcnJheSgpOwogICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAJaWYgKGluY2x1ZGUuaW5kZXhPZigiIitrZXkpPT09LTEpIHsKICAgICAgICAgICAgCW1lc3NhZ2UgKz0gIjxiPiIgKyBrZXkgKyAiPC9iPjogIiArIGV4aXN0aW5nU2Vzc2lvbi5nZXQoa2V5KSArICI8YnIvPiI7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAJbWVzc2FnZSArPSAiPC9wPiIKICAgICAgCWNob2ljZXMucHVzaCgiR290byBTQU1MIEFwcCIpOwogICAgICAJY2hvaWNlcy5wdXNoKCJHb3RvIE9JREMgQXBwIik7CiAgICAgIAlpZiAoIiIrZXhpc3RpbmdTZXNzaW9uLmdldCgicHJvZmlsZVR5cGUiKSA9PT0gInBlcnNpc3RlbnQiKSB7CiAgICAgIAkJY2hvaWNlcy5wdXNoKCJHb3RvIFByb2ZpbGUgUGFnZSIpOwogICAgICAgIH0KICAgICAgCWNob2ljZXMucHVzaCgiTG9nb3V0Iik7CiAgICB9IGVsc2UgewogICAgICAJbWVzc2FnZSA9ICI8aDQ+Tm8gU2Vzc2lvbiE8L2g0PjxwPiIKICAgICAgCWNob2ljZXMucHVzaCgiTG9naW4iKTsKICAgIH0KICAgIHZhciBzY3JpcHQgPSAiQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoXG4iLmNvbmNhdCgKICAgICAgImRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhbGxiYWNrLWNvbXBvbmVudCcpKS5mb3JFYWNoKFxuIikuY29uY2F0KAogICAgICAiZnVuY3Rpb24gKGUpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgdmFyIG1lc3NhZ2UgPSBlLmZpcnN0RWxlbWVudENoaWxkO1xuIikuY29uY2F0KAogICAgICAiICBpZiAobWVzc2FnZS5maXJzdENoaWxkICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnI3RleHQnICYmIG1lc3NhZ2UuZmlyc3RDaGlsZC5ub2RlVmFsdWUudHJpbSgpID09ICciKS5jb25jYXQoYW5jaG9yKS5jb25jYXQoIicpIHtcbiIpLmNvbmNhdCgKICAgICAgIiAgICBtZXNzYWdlLmNsYXNzTmFtZSA9IFwiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5zdHlsZSA9IFwidGV4dC1hbGlnbjogbGVmdDsgaW5saW5lLXNpemU6IDQzMHB4OyBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkO1wiO1xuIikuY29uY2F0KAogICAgICAiICAgIG1lc3NhZ2UuYWxpZ24gPSBcIiIpLmNvbmNhdChoYWxpZ24pLmNvbmNhdCgiXCI7XG4iKS5jb25jYXQoCiAgICAgICIgICAgbWVzc2FnZS5pbm5lckhUTUwgPSAnIikuY29uY2F0KG1lc3NhZ2UpLmNvbmNhdCgiJztcbiIpLmNvbmNhdCgKICAgICAgIiAgfVxuIikuY29uY2F0KAogICAgICAifSkiKQogIAogICAgdmFyIGZyID0gSmF2YUltcG9ydGVyKAogICAgICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgICAgIGphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dE91dHB1dENhbGxiYWNrLAogICAgICAgIGNvbS5zdW4uaWRlbnRpdHkuYXV0aGVudGljYXRpb24uY2FsbGJhY2tzLlNjcmlwdFRleHRPdXRwdXRDYWxsYmFjaywKICAgICAgICBqYXZheC5zZWN1cml0eS5hdXRoLmNhbGxiYWNrLkNvbmZpcm1hdGlvbkNhbGxiYWNrCiAgICApCiAgICBpZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgICAgIGFjdGlvbiA9IGZyLkFjdGlvbi5zZW5kKAogICAgICAgICAgICBuZXcgZnIuVGV4dE91dHB1dENhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAgICAgYW5jaG9yCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG5ldyBmci5TY3JpcHRUZXh0T3V0cHV0Q2FsbGJhY2soc2NyaXB0KSwKICAgICAgICAgICAgbmV3IGZyLkNvbmZpcm1hdGlvbkNhbGxiYWNrKAogICAgICAgICAgICAgICAgZnIuQ29uZmlybWF0aW9uQ2FsbGJhY2suSU5GT1JNQVRJT04sCiAgICAgICAgICAgICAgICBjaG9pY2VzLAogICAgICAgICAgICAgICAgZGVmYXVsdENob2ljZQogICAgICAgICAgICApCiAgICAgICAgKS5idWlsZCgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgb3V0Y29tZSA9IGNob2ljZXNbY2FsbGJhY2tzLmdldCgyKS5nZXRTZWxlY3RlZEluZGV4KCldOwogICAgICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwogICAgfQoKICAgICAvKgogICAgICAqIEdlbmVyYXRlIGEgdG9rZW4gaW4gdGhlIGRlc2lyZWQgZm9ybWF0LiBBbGwgJ3gnIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIG51bWJlciAwLTkuCiAgICAgICogCiAgICAgICogRXhhbXBsZToKICAgICAgKiAneHh4eHgnIHByb2R1Y2VzICcyODUzNScKICAgICAgKiAneHh4LXh4eCcgcHJvZHVjZXMgJzQzMi01MjEnCiAgICAgICovCiAgICBmdW5jdGlvbiBnZW5lcmF0ZU51bWVyaWNUb2tlbihmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1t4XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxMHwwOwogICAgICAgICAgICB2YXIgdiA9IHI7CiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDEwKTsKICAgICAgICB9KTsKICAgIH0KfSgpKTsKCi8qCkxvY2FsZTogZW5fVVMKYXV0aEluc3RhbnQ6IDIwMjEtMDktMjVUMTc6Mjg6MzhaCk9yZ2FuaXphdGlvbjogbz1hbHBoYSxvdT1zZXJ2aWNlcyxvdT1hbS1jb25maWcKbWFpbDogdm9sa2VyQHNjaGV1YmVyLm5hbWUKUHJpbmNpcGFsczogdm9sa2VyQHNjaGV1YmVyLm5hbWUKVXNlclByb2ZpbGU6IElnbm9yZQpDaGFyU2V0OiBVVEYtOApGdWxsTG9naW5VUkw6IC9hbS9VSS9Mb2dpbj9jb2RlPTQlMkYwQVg0WGZXamlFZmJyZklzdHNGVUtvYWliUENRbVRidVBvbkxmdWhwWWhqZmotTjVRRWU5dTJQNU9zOXdOYWRHYVBzUVZCQSZzY29wZT1lbWFpbCtwcm9maWxlK2h0dHBzJTNBJTJGJTJGd3d3Lmdvb2dsZWFwaXMuY29tJTJGYXV0aCUyRnVzZXJpbmZvLmVtYWlsK2h0dHBzJTNBJTJGJTJGd3d3Lmdvb2dsZWFwaXMuY29tJTJGYXV0aCUyRnVzZXJpbmZvLnByb2ZpbGUrb3BlbmlkJnJlYWxtPSUyRmFscGhhJnN0YXRlPWZ5a3BydGZtZWNscmd3c3ptb212cXhubGlycmVoY3MmaGQ9c2NoZXViZXIubmFtZSZwcm9tcHQ9bm9uZSZhdXRodXNlcj0yCmNsaWVudFR5cGU6IGdlbmVyaWNIVE1MCmdvdG86IC9hbS9YVUkvP3JlYWxtPS9hbHBoYSZhdXRoSW5kZXhUeXBlPXNlcnZpY2UmYXV0aEluZGV4VmFsdWU9U2Vzc2lvbkluZm8mRm9yY2VBdXRoPXRydWUjLwpBTUN0eElkOiBkMzE4ODkzOC1kMDdlLTQxMzQtOTVkYi1mMWNjOTdmYzZjNDAtNTAzMjc1CmxvZ2luVVJMOiAvYW0vVUkvTG9naW4Kc246IFNjaGV1YmVyCmFtbGJjb29raWU6IDAxCkhvc3ROYW1lOiA5OS43Mi4yOC4xODIKVXNlclRva2VuOiB2b2xrZXJAc2NoZXViZXIubmFtZQpnaXZlbk5hbWU6IFZvbGtlcgpzdWNjZXNzVVJMOiAvYW0vWFVJLz9yZWFsbT0vYWxwaGEmYXV0aEluZGV4VHlwZT1zZXJ2aWNlJmF1dGhJbmRleFZhbHVlPVNlc3Npb25JbmZvJkZvcmNlQXV0aD10cnVlIy8KU2VydmljZTogUm91dGVyCkhvc3Q6IDk5LjcyLjI4LjE4MgpBdXRoTGV2ZWw6IDAKaWRwOiBnb29nbGUKVXNlcklkOiB2b2xrZXJAc2NoZXViZXIubmFtZQpzdW4uYW0uVW5pdmVyc2FsSWRlbnRpZmllcjogaWQ9dm9sa2VyQHNjaGV1YmVyLm5hbWUsb3U9dXNlcixvPWFscGhhLG91PXNlcnZpY2VzLG91PWFtLWNvbmZpZwpPaWRjU2lkOiBBQ3VUUUlPYmowdGFqUFloTE9qTWxXYzJ1ck0KUHJpbmNpcGFsOiBpZD12b2xrZXJAc2NoZXViZXIubmFtZSxvdT11c2VyLG89YWxwaGEsb3U9c2VydmljZXMsb3U9YW0tY29uZmlnCiAqLw==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6826"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.607Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "c04e5ff1818c26218ea7bc195d613107",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 568,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"IDP Integrity Check\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22IDP%20Integrity%20Check%22"
        },
        "response": {
          "bodySize": 1502,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1502,
            "text": "{\"result\":[{\"_id\":\"988c10fa-98da-4bf7-8ac9-a558d2fef1fd\",\"name\":\"IDP Integrity Check\",\"description\":\"Protection from malicious IDPs. Only allow white-listed email domains (usernames are email addresses).\",\"script\":\"LyogSURQIEludGVncml0eSBDaGVjawogKiAKICogUHJvdGVjdGlvbiBmcm9tIG1hbGljaW91cyBJRFBzLiBPbmx5IGFsbG93IHdoaXRlLWxpc3RlZCBlbWFpbCBkb21haW5zICh1c2VybmFtZXMgYXJlIGVtYWlsIGFkZHJlc3NlcykuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCByZXF1aXJlIGNvZmlndXJhdGlvbi4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICogLSBmYWxzZQogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogICAgb3V0Y29tZSA9ICJmYWxzZSI7CiAgCXZhciByb3V0ZWRJRFAgPSBzaGFyZWRTdGF0ZS5nZXQoInJvdXRlZElEUHMiKS5nZXQoMCk7CiAgCXZhciB2YWxpZERvbWFpbnMgPSBbXTsKICAJaWYgKHJvdXRlZElEUCkgewogICAgICAJdmFsaWREb21haW5zID0gcm91dGVkSURQLmdldCgiaWRwRG9tYWlucyIpOwogICAgfQogIAkKICAJdmFyIHVzZXJuYW1lID0gc2hhcmVkU3RhdGUuZ2V0KCJ1c2VybmFtZSIpOwogIAl2YXIgZG9tYWluID0gdXNlcm5hbWUuc3Vic3RyKHVzZXJuYW1lLmxhc3RJbmRleE9mKCJAIikrMSk7CiAgCWlmICh2YWxpZERvbWFpbnMuaW5kZXhPZihkb21haW4pID4gLTEpIHsKICAgICAgCW91dGNvbWUgPSAidHJ1ZSI7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1502"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.647Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "de06a28c86bbb4413c0824c89cdb20c6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 558,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"OTP Invalid\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22OTP%20Invalid%22"
        },
        "response": {
          "bodySize": 1374,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1374,
            "text": "{\"result\":[{\"_id\":\"89eff37a-2e1e-47c2-8d62-5f7417fbb6b4\",\"name\":\"OTP Invalid\",\"description\":\"Return TextOutputCallback indicating the provided OTP was invalid.\",\"script\":\"LyogT1RQIEludmFsaWQKICoKICogQXV0aG9yOiB2b2xrZXIuc2NoZXViZXJAZm9yZ2Vyb2NrLmNvbQogKiAKICogUmV0dXJuIFRleHRPdXRwdXRDYWxsYmFjayBpbmRpY2F0aW5nIHRoZSBwcm92aWRlZCBPVFAgd2FzIGludmFsaWQuCiAqIAogKiBUaGlzIHNjcmlwdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBhcmFtZXRyaXplZC4gSXQgd2lsbCB3b3JrIHByb3Blcmx5IGFzIGlzLgogKiAKICogVGhlIFNjcmlwdGVkIERlY2lzaW9uIE5vZGUgbmVlZHMgdGhlIGZvbGxvd2luZyBvdXRjb21lcyBkZWZpbmVkOgogKiAtIHRydWUKICovCm91dGNvbWUgPSAidHJ1ZSI7CnZhciBmciA9IEphdmFJbXBvcnRlcigKICAgIG9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGkuQWN0aW9uLAogICAgamF2YXguc2VjdXJpdHkuYXV0aC5jYWxsYmFjay5UZXh0T3V0cHV0Q2FsbGJhY2sKKQppZiAoY2FsbGJhY2tzLmlzRW1wdHkoKSkgewogICAgYWN0aW9uID0gZnIuQWN0aW9uLnNlbmQoCiAgICAgICAgbmV3IGZyLlRleHRPdXRwdXRDYWxsYmFjaygKICAgICAgICAgICAgZnIuVGV4dE91dHB1dENhbGxiYWNrLklORk9STUFUSU9OLAogICAgICAgICAgICAiSU5WQUxJRCIKICAgICAgICApCiAgICApLmJ1aWxkKCkKfQplbHNlIHsKICBhY3Rpb24gPSBmci5BY3Rpb24uZ29UbyhvdXRjb21lKS5idWlsZCgpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1374"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.689Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "6136d2ed32f68817c982b2f0962f5cc6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 584,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"ST_healthcare-idc-social-transformation\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22ST_healthcare-idc-social-transformation%22"
        },
        "response": {
          "bodySize": 3648,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 3648,
            "text": "{\"result\":[{\"_id\":\"d2cf4f18-651a-4a3c-9b04-ee4fc896d0c3\",\"name\":\"ST_healthcare-idc-social-transformation\",\"description\":\"Social Identity Provider Profile Transformation for ForgeRock OIDC Providers\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMjIgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2suIE5vdCBmb3IgcHJvZHVjdGlvbiB1c2UuCiAqIE1vZGlmaWVkIGJ5IFN0ZXBoZW4gUGF5bmUKICovCi8qIFNvY2lhbCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdCBmb3IgSGVhbHRoY2FyZSBJRCBDbG91ZCAqLwppbXBvcnQgc3RhdGljIG9yZy5mb3JnZXJvY2suanNvbi5Kc29uVmFsdWUuZmllbGQKaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLmpzb24KaW1wb3J0IHN0YXRpYyBvcmcuZm9yZ2Vyb2NrLmpzb24uSnNvblZhbHVlLm9iamVjdAoKbG9nZ2VyLmVycm9yKCJTVF9oZWFsdGhjYXJlLWlkYy1zb2NpYWwtdHJhbnNmb3JtYXRpb24gSGVhbHRoY2FyZSBJRCBDbG91ZCBJZGVudGl0eSBQcm92aWRlciBQcm9maWxlIFRyYW5zZm9ybWF0aW9uIHNjcmlwdDogU3RhcnQiKTsKCmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uIFByb2ZpbGUgVHJhbnNmb3JtYXRpb24gc2NyaXB0OiBTdGFydCIpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbnk6IGdpdmVuTmFtZSAiICsgcmF3UHJvZmlsZS5naXZlbk5hbWUpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogc246ICIgK3Jhd1Byb2ZpbGUuZmFtaWx5TmFtZSk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBpZDogIiArcmF3UHJvZmlsZS5pZCk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBtYWlsOiAiICsgcmF3UHJvZmlsZS5lbWFpbCk7CmxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBjbjogIiArIHJhd1Byb2ZpbGUuZGlzcGxheU5hbWUpOwpsb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogdXNlck5hbWU6ICIgKyByYXdQcm9maWxlLnVzZXJuYW1lKTsKbG9nZ2VyLmVycm9yKCJTVF9oZWFsdGhjYXJlLWlkYy1zb2NpYWwtdHJhbnNmb3JtYXRpb246IGlkOiAiICsgcmF3UHJvZmlsZS5pZC5hc1N0cmluZygpKTsKLy9sb2dnZXIuZXJyb3IoIlNUX2hlYWx0aGNhcmUtaWRjLXNvY2lhbC10cmFuc2Zvcm1hdGlvbjogaXBsYW5ldC1hbS11c2VyLWFsaWFzLWxpc3Q6ICIgKyBzZWxlY3RlZElkcCArICctJyArIHJhd1Byb2ZpbGUuaWQuYXNTdHJpbmcoKSApOwovL2xvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBzZWxlY3RlZElkcDogIiArIHNlbGVjdGVkSWRwKTsKaWYgKHJhd1Byb2ZpbGUuZmhpclVzZXIuaXNOb3ROdWxsKCkpIGxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW9uOiBmaGlyVXNlcjogIiArIHJhd1Byb2ZpbGUuZmhpclVzZXIpOwppZiAocmF3UHJvZmlsZS5JQUwuaXNOb3ROdWxsKCkpIGxvZ2dlci5lcnJvcigiU1RfaGVhbHRoY2FyZS1pZGMtc29jaWFsLXRyYW5zZm9ybWF0aW86IElBTDogIiArIHJhd1Byb2ZpbGUuSUFMKTsKCgoKCnJldHVybiBqc29uKG9iamVjdCgKICAgICAgICBmaWVsZCgiaWQiLCByYXdQcm9maWxlLnN1YiksCiAgICAgICAgZmllbGQoImRpc3BsYXlOYW1lIiwgcmF3UHJvZmlsZS5uYW1lKSwKICAgICAgICBmaWVsZCgiZ2l2ZW5OYW1lIiwgcmF3UHJvZmlsZS5naXZlbl9uYW1lKSwKICAgICAgICBmaWVsZCgiZmFtaWx5TmFtZSIsIHJhd1Byb2ZpbGUuZmFtaWx5X25hbWUpLAogICAgICAgIGZpZWxkKCJlbWFpbCIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJ1c2VybmFtZSIsIHJhd1Byb2ZpbGUuZW1haWwpLAogICAgICAgIGZpZWxkKCJJQUwiLCByYXdQcm9maWxlLklBTCksICAKICAgICAgICBmaWVsZCgidGVsZXBob25lTnVtYmVyIiwgcmF3UHJvZmlsZS5waG9uZV9udW1iZXIpLAogICAgICAgIGZpZWxkKCJmaGlyVXNlciIsIHJhd1Byb2ZpbGUuZmhpclVzZXIpLAogICAgICAgIGZpZWxkKCJ1c2VyVHlwZSIsIHJhd1Byb2ZpbGUudXNlclR5cGUpLAogICAgICAgICkKKQ==\",\"default\":false,\"language\":\"GROOVY\",\"context\":\"SOCIAL_IDP_PROFILE_TRANSFORMATION\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "3648"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.729Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "0ef369f427baa872ca4ee159a6fe7dc7",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 567,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"UOP Enrich Session\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22UOP%20Enrich%20Session%22"
        },
        "response": {
          "bodySize": 1889,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1889,
            "text": "{\"result\":[{\"_id\":\"743351b3-001a-4ec8-b3ac-a674ddb8de22\",\"name\":\"UOP Enrich Session\",\"description\":\"Enrich user session with UOP class ID.\",\"script\":\"LyogVU9QIEVucmljaCBTZXNzaW9uCiAqCiAqIEF1dGhvcjogdm9sa2VyLnNjaGV1YmVyQGZvcmdlcm9jay5jb20KICogCiAqIEFkZCBjdXJyZW50IGNsYXNzIElEIHRvIHVzZXIgc2Vzc2lvbi4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuIAogKiBJdCByZXF1aXJlcyB0aGUgSWRlbnRpZnkgRXhpc3RpbmcgVXNlciBub2RlIGJlZm9yZSBpdCBpcyBiZWluZyBjYWxsZWQuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAtIGZhbHNlCiAqLwpsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBzdGFydCIpOwpvdXRjb21lID0gImZhbHNlIjsKCmlmIChzaGFyZWRTdGF0ZS5nZXQoInVvcEN1cnJlbnRDbGFzc0lEIikpIHsKICAgIG91dGNvbWUgPSAidHJ1ZSI7CiAgICBsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBnb2luZyB0byBlbnJpY2ggc2Vzc2lvbiB3aXRoIGNsYXNzIGlkOiAiLmNvbmNhdChzaGFyZWRTdGF0ZS5nZXQoInVvcEN1cnJlbnRDbGFzc0lEIikpKTsKICAKICAgIHZhciBmciA9IEphdmFJbXBvcnRlcigKICAgICAgb3JnLmZvcmdlcm9jay5vcGVuYW0uYXV0aC5ub2RlLmFwaQogICAgKTsKCiAgICB3aXRoIChmcikgewogICAgICAgIGxvZ2dlci53YXJuaW5nKCJVT1AgRW5yaWNoIFNlc3Npb246IEVuZCAob3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIikiKSk7CiAgICAgICAgYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkucHV0U2Vzc2lvblByb3BlcnR5KCJVT1BDbGFzc0lEIiwgc2hhcmVkU3RhdGUuZ2V0KCJ1b3BDdXJyZW50Q2xhc3NJRCIpKS5idWlsZCgpOwogICAgfQogIAp9IGVsc2UgewogICAgbG9nZ2VyLmVycm9yKCJVT1AgRW5yaWNoIFNlc3Npb246IG5vIGNsYXNzZXMhIik7CiAgICBsb2dnZXIud2FybmluZygiVU9QIEVucmljaCBTZXNzaW9uOiBFbmQgKG91dGNvbWU9Ii5jb25jYXQob3V0Y29tZSkuY29uY2F0KCIpIikpOwp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1889"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.769Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "9c9fdeeef80187fbf79702a3020895b6",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 579,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Shared State Only\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Shared%20State%20Only%22"
        },
        "response": {
          "bodySize": 1401,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1401,
            "text": "{\"result\":[{\"_id\":\"dedbc9f6-7fc9-4332-a330-55f7aeb95e78\",\"name\":\"FRAAS-7955 Shared State Only\",\"description\":\"FRAAS-7955 Shared State Only\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKCnNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgidXNlck5hbWUiLCAiRlJBQVMtNzk1NSIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsICJGaXJzdC1zaGFyZWQiKTsKc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsICJMYXN0LXNoYXJlZCIpOwpzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCAiZmlyc3QubGFzdC1zaGFyZWRAY29tcGFueS5jb20iKTsKCi8qCiAqIFN0b3JlIGF0dHJpYnV0ZXMgaW4gc2hhcmVkIHN0YXRlIGZvciB1c2Ugd2l0aCB0aGUgQ3JlYXRlL1BhdGNoIE9iamVjdCBub2Rlcy4KICovCmZ1bmN0aW9uIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkgewogIAkgdmFyIHN0b3JhZ2UgPSBzaGFyZWRTdGF0ZS5nZXQoIm9iamVjdEF0dHJpYnV0ZXMiKTsKICAgIGlmIChzdG9yYWdlICYmIHZhbHVlKSB7CiAgICAgIAlpZiAoc3RvcmFnZS5wdXQpIHsKCSAgICAgICAgICBzdG9yYWdlLnB1dChuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAJZWxzZSB7CiAgICAgICAgICAJc3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICAgICAgc2hhcmVkU3RhdGUucHV0KCJvYmplY3RBdHRyaWJ1dGVzIiwgSlNPTi5wYXJzZSgie1wiIituYW1lKyJcIjpcIiIrdmFsdWUrIlwifSIpKTsKICAgIH0KfQ==\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1401"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.807Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      },
      {
        "_id": "6305235cfeadffc508b8076bf5229d24",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 582,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Scripted Module - Client Side\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Scripted%20Module%20-%20Client%20Side%22"
        },
        "response": {
          "bodySize": 958,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 958,
            "text": "{\"result\":[{\"_id\":\"c827d2b4-3608-4693-868e-bbcf86bd87c7\",\"name\":\"Scripted Module - Client Side\",\"description\":\"Default global script for client side Scripted Authentication Module\",\"script\":\"LyoKICogQ29weXJpZ2h0IDIwMTYtMjAxNyBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCi8qIERlZmF1bHQgQXV0aGVudGljYXRpb24gY2xpZW50IHNpZGUgc2NyaXB0IHRvIHVzZSBhcyBhIHRlbXBsYXRlIGZvciBuZXcgc2NyaXB0cyAqLw==\",\"default\":true,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_CLIENT_SIDE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "958"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 663,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.847Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "e4a81c5bd4ad4d7746e9f9c0dc547e7e",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 568,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"FRAAS-7955 Workaround\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22FRAAS-7955%20Workaround%22"
        },
        "response": {
          "bodySize": 1615,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 1615,
            "text": "{\"result\":[{\"_id\":\"e0ba741b-c952-4062-9899-0b1c19237ee4\",\"name\":\"FRAAS-7955 Workaround\",\"description\":\"FRAAS-7955 Workaround: Copy sharedState to transientState\",\"script\":\"b3V0Y29tZSA9ICJ0cnVlIjsKdmFyIGF0dHJzID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CmlmIChhdHRycykgewogIAlzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsIGF0dHJzLmdldCgiZ2l2ZW5OYW1lIikuY29uY2F0KCItd29ya2Fyb3VuZCIpKTsKICAJc2V0VHJhbnNpZW50T2JqZWN0QXR0cmlidXRlKCJzbiIsIGF0dHJzLmdldCgic24iKS5jb25jYXQoIi13b3JrYXJvdW5kIikpOwogIAlzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUoIm1haWwiLCBhdHRycy5nZXQoIm1haWwiKS5jb25jYXQoIi13b3JrYXJvdW5kIikpOwp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHRyYW5zaWVudCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRUcmFuc2llbnRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAgIHZhciB0cmFuc2llbnRTdG9yYWdlID0gdHJhbnNpZW50U3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAodHJhbnNpZW50U3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHRyYW5zaWVudFN0b3JhZ2UucHV0KSB7CiAgICAgICAgICAgIHRyYW5zaWVudFN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgICAgdHJhbnNpZW50U3RvcmFnZVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHZhbHVlKSB7CiAgICB0cmFuc2llbnRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "1615"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.886Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "301b5256dd3461fcdf1b5df1b36fcc10",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 588,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Twilio IVR: Verify Unknown Caller\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Twilio%20IVR%3A%20Verify%20Unknown%20Caller%22"
        },
        "response": {
          "bodySize": 2749,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2749,
            "text": "{\"result\":[{\"_id\":\"1c0c73e8-2be1-41ce-b042-3c39694346b5\",\"name\":\"Twilio IVR: Verify Unknown Caller\",\"description\":\"Verify unknown caller by account number\",\"script\":\"LyogVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gdHJ1ZQogKiAKICogRGVwZW5kaW5nIG9uIHRoZSBhbW91bnQgb2YgZGF0YSBjb2xsZWN0ZWQgdGhyb3VnaCBjYWxsYmFja3MgYW5kIGhvdyBtYW55IG9mIHRoZSBjYWxsUGFyYW1zCiAqIHlvdSBhY3RpdmF0ZSBiZWxvdywgeW91IHdpbGwgbmVlZCB0byBjaGFuZ2UgeW91ciBhdXRoZW50aWNhdGlvbiBzZXNzaW9uIGZyb20gSldUIHRvIENUUyBvcgogKiBNZW1vcnkuCiAqLwpsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyOiBzdGFydCIpOwpvdXRjb21lID0gInRydWUiOwoKLyogQmVnaW4gQ29uZmlndXJhdGlvbgogKi8KCi8vIEJ1aWxkIG91dCB0aGUgdmVyaWZpY2F0aW9uIHByb21wdAp2YXIgcHJvbXB0ID0gIlRvIGxvb2t1cCB5b3VyIGFjY291bnQsIHBsZWFzZSBlbnRlciBvciBzYXkgeW91ciBhY2NvdW50IG51bWJlci4iOwoKLyogRW5kIENvbmZpZ3VyYXRpb24KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgCW9yZy5mb3JnZXJvY2sub3BlbmFtLmF1dGgubm9kZS5hcGksCiAgCWphdmF4LnNlY3VyaXR5LmF1dGguY2FsbGJhY2suVGV4dElucHV0Q2FsbGJhY2sKKTsKICAKd2l0aCAoZnIpIHsKICAJaWYgKGNhbGxiYWNrcy5pc0VtcHR5KCkpIHsKICAgIAl2YXIgaW5wdXQgPSBuZXcgVGV4dElucHV0Q2FsbGJhY2socHJvbXB0KTsKICAgIAlhY3Rpb24gPSBBY3Rpb24uc2VuZChpbnB1dCkuYnVpbGQoKTsKICAJfSAKICAJZWxzZSB7CiAgICAgIAl2YXIgYW5zd2VyID0gbmV3IFN0cmluZyhjYWxsYmFja3MuZ2V0KDApLmdldFRleHQoKSkucmVwbGFjZSgvW14wLTldL2csICIiKTsKCQlsb2dnZXIud2FybmluZygiVHdpbGlvIElWUjogVmVyaWZ5IFVua25vd24gQ2FsbGVyOiBjYWxsYmFja3MgcmVjZWl2ZWQ6IGFuc3dlcj0iLmNvbmNhdChhbnN3ZXIpKTsKICAgICAgCXNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiZnJJbmRleGVkSW50ZWdlcjUiLCBhbnN3ZXIpOwoJCWxvZ2dlci53YXJuaW5nKCJUd2lsaW8gSVZSOiBWZXJpZnkgVW5rbm93biBDYWxsZXI6IGZpbmlzaCBbb3V0Y29tZT0iLmNvbmNhdChvdXRjb21lKS5jb25jYXQoIl0iKSk7CiAgICAJYWN0aW9uID0gQWN0aW9uLmdvVG8ob3V0Y29tZSkuYnVpbGQoKTsKICAJfQp9CgovKgogKiBTdG9yZSBhdHRyaWJ1dGVzIGluIHNoYXJlZCBzdGF0ZSBmb3IgdXNlIHdpdGggdGhlIENyZWF0ZS9QYXRjaCBPYmplY3Qgbm9kZXMuCiAqLwpmdW5jdGlvbiBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUobmFtZSwgdmFsdWUpIHsKICAJIHZhciBzdG9yYWdlID0gc2hhcmVkU3RhdGUuZ2V0KCJvYmplY3RBdHRyaWJ1dGVzIik7CiAgICBpZiAoc3RvcmFnZSAmJiB2YWx1ZSkgewogICAgICAJaWYgKHN0b3JhZ2UucHV0KSB7CgkgICAgICAgICAgc3RvcmFnZS5wdXQobmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgCWVsc2UgewogICAgICAgICAgCXN0b3JhZ2VbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh2YWx1ZSkgewogICAgICAgIHNoYXJlZFN0YXRlLnB1dCgib2JqZWN0QXR0cmlidXRlcyIsIEpTT04ucGFyc2UoIntcIiIrbmFtZSsiXCI6XCIiK3ZhbHVlKyJcIn0iKSk7CiAgICB9Cn0=\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2749"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.928Z",
        "time": 34,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 34
        }
      },
      {
        "_id": "e4b6378e7612d178fab8b1a21c2cbe2a",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 563,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Onfido-CheckStatus\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Onfido-CheckStatus%22"
        },
        "response": {
          "bodySize": 6575,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 6575,
            "text": "{\"result\":[{\"_id\":\"0c189425-e5ea-4062-ae2e-53ea14320bf4\",\"name\":\"Onfido-CheckStatus\",\"description\":\"Check Status\",\"script\":\"bG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tTdGF0dXM6IFN0YXJ0Iik7CgovKgogKiAhISEgRXh0ZW5kIHlvdXIgYXV0aGVudGljYXRpb24gc2Vzc2lvbiB0aW1lIHNvIHlvdXIgaWRlbnRpdHkgcHJvb2ZpbmcgZmxvd3MgZG9uJ3QgdGltZSBvdXQgISEhCiAqCiAqIEF1dGhlbnRpY2F0aW9uID4gU2V0dGluZ3MgPiBUcmVlcyA+IE1heCBEdXJhdGlvbiAoTWludXRlcykKICoKICogU2V0IHRvIDE1IG1pbnV0ZXMuCiAqCiAqLwoKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICoKICogUkVQTEFDRSBXSVRIIFlPVVIgT1dOIE9ORklETyBBUEkgVE9LRU4KICovCi8vdmFyIE9ORklET19BUElfVE9LRU4gPSAiYXBpX2xpdmUuU3RVZGZ4ZGlDRmIuWXJ6YmFkeEJfUjItcUc1bEZVYzNsV2c2SkFjM0NucS0iCnZhciBPTkZJRE9fQVBJX1RPS0VOID0gImFwaV9saXZlLkg1eXNSdXNBb21ZLm5iYmtpbW9XYzkxY0RaQVdKWmtKdDBUa3Fkam0xUmpyIjsKLyoKICogQkVHSU4gU0NSSVBUIENPTkZJR1VSQVRJT04KICovCgp2YXIgZnIgPSBKYXZhSW1wb3J0ZXIoCiAgICBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVxdWVzdAopCgp2YXIgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCkKcmVxdWVzdC5zZXRVcmkoImh0dHBzOi8vYXBpLm9uZmlkby5jb20vdjMvY2hlY2tzP2FwcGxpY2FudF9pZD0iICsgU3RyaW5nKHNoYXJlZFN0YXRlLmdldCgib25maWRvQXBwbGljYW50SUQiKSkpOwpyZXF1ZXN0LnNldE1ldGhvZCgiR0VUIikKcmVxdWVzdC5nZXRIZWFkZXJzKCkuYWRkKCJBdXRob3JpemF0aW9uIiwgIlRva2VuIHRva2VuPSIgKyBPTkZJRE9fQVBJX1RPS0VOKQp2YXIgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQocmVxdWVzdCkuZ2V0KCkKbG9nZ2VyLmVycm9yKCJPbmZpZG8tQ2hlY2tTdGF0dXM6IHN0YXR1cyBjaGVjayByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCm91dGNvbWUgPSAicGVuZGluZyI7CgppZiAocmVzcG9uc2UuZ2V0U3RhdHVzKCkuZ2V0Q29kZSgpID09PSAyMDApIHsKICAgIHZhciBqc29uID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICBpZiAoanNvbi5jaGVja3MubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChqc29uLmNoZWNrc1swXS5zdGF0dXMgPT0gImNvbXBsZXRlIikgewogICAgICAgICAgICBvdXRjb21lID0ganNvbi5jaGVja3NbMF0ucmVzdWx0OwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGpzb24uY2hlY2tzWzBdLnJlcG9ydF9pZHMubGVuZ3RoOyBpKyspIHsKCiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBmci5SZXF1ZXN0KCkKICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0VXJpKCJodHRwczovL2FwaS5vbmZpZG8uY29tL3YzL3JlcG9ydHMvIiArIFN0cmluZyhqc29uLmNoZWNrc1swXS5yZXBvcnRfaWRzW2ldKSk7CiAgICAgICAgICAgICAgICByZXF1ZXN0LnNldE1ldGhvZCgiR0VUIikKICAgICAgICAgICAgICAgIHJlcXVlc3QuZ2V0SGVhZGVycygpLmFkZCgiQXV0aG9yaXphdGlvbiIsICJUb2tlbiB0b2tlbj0iICsgT05GSURPX0FQSV9UT0tFTikKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gaHR0cENsaWVudC5zZW5kKHJlcXVlc3QpLmdldCgpCiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIk9uZmlkby1DaGVja1N0YXR1czogZ2V0IHJlcG9ydCByZXNwb25zZTogIi5jb25jYXQocmVzcG9uc2UuZ2V0RW50aXR5KCkuZ2V0U3RyaW5nKCkpKTsKCiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5nZXRFbnRpdHkoKS5nZXRTdHJpbmcoKSk7CiAgICAgICAgICAgICAgICBpZiAocmVwb3J0Lm5hbWUgPT0gImRvY3VtZW50IikgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXBvcnQucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiZmlyc3RfbmFtZSIpKSBzZXRTaGFyZWRPYmplY3RBdHRyaWJ1dGUoImdpdmVuTmFtZSIsIHRpdGxlQ2FzZShyZXBvcnQucHJvcGVydGllcy5maXJzdF9uYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcG9ydC5wcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KCJsYXN0X25hbWUiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzbiIsIHRpdGxlQ2FzZShyZXBvcnQucHJvcGVydGllcy5sYXN0X25hbWUpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkoImRhdGVfb2ZfYmlydGgiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJmckluZGV4ZWRTdHJpbmcyIiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmRhdGVfb2ZfYmlydGgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzEiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJwb3N0YWxBZGRyZXNzIiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uYWRkcmVzc19saW5lXzEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzMiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJjaXR5IiwgdGl0bGVDYXNlKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uYWRkcmVzc19saW5lXzMpKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5oYXNPd25Qcm9wZXJ0eSgiYWRkcmVzc19saW5lXzUiKSkgc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKCJzdGF0ZVByb3ZpbmNlIiwgcmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5hZGRyZXNzX2xpbmVfNSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcG9ydC5wcm9wZXJ0aWVzLmJhcmNvZGVbMF0uaGFzT3duUHJvcGVydHkoImFkZHJlc3NfbGluZV80IikpIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgicG9zdGFsQ29kZSIsIGZvcm1hdE9uZmlkb1ppcENvZGUocmVwb3J0LnByb3BlcnRpZXMuYmFyY29kZVswXS5hZGRyZXNzX2xpbmVfNCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXBvcnQucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiaXNzdWluZ19jb3VudHJ5IikpIHNldFNoYXJlZE9iamVjdEF0dHJpYnV0ZSgiY291bnRyeSIsIHJlcG9ydC5wcm9wZXJ0aWVzLmlzc3VpbmdfY291bnRyeSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0gZWxzZSBvdXRjb21lID0gImVycm9yIjsKCnNoYXJlZFN0YXRlLnB1dCgib25GaWRvT3V0Y29tZSIsIG91dGNvbWUpOwpsb2dnZXIuZXJyb3IoIk9uZmlkby1DaGVja1N0YXR1czogRW5kIChvdXRjb21lPSIuY29uY2F0KG91dGNvbWUpLmNvbmNhdCgiKSIpKTsKCi8qCiAqIE91dHB1dCBzdHIgaW4gdGl0bGUgY2FzZQogKiAKICogZS5nLjogJ0FMTCBVUFBFUkNBU0UgQU5EIGFsbCBsb3dlcmNhc2UnID0gJ0FsbCBVcHBlcmNhc2UgQW5kIEFsbCBMb3dlcmNhc2UnCiAqLwpmdW5jdGlvbiB0aXRsZUNhc2UoaW5wdXQpIHsKICAgIHZhciBzdHIgPSBpbnB1dC50b1N0cmluZygpOwogICAgdmFyIHNwbGl0U3RyID0gc3RyLnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXRTdHIubGVuZ3RoOyBpKyspIHsKICAgICAgICBzcGxpdFN0cltpXSA9IHNwbGl0U3RyW2ldLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3BsaXRTdHJbaV0uc2xpY2UoMSkKICAgIH0KICAgIHJldHVybiBzcGxpdFN0ci5qb2luKCcgJyk7IAp9CgovKgogKiBGb3JtYXQgWklQIGNvZGUgZnJvbSBPbmZpZG8gaWRlbnRpdHkgcHJvb2Zpbmcgb3V0cHV0CiAqIAogKiBlLmcuOiA3ODYyNjAwMDAgPSA3ODYyNgogKiAgICAgICA3ODYyNjEyMzQgPSA3ODYyNi0xMjM0CiAqLwpmdW5jdGlvbiBmb3JtYXRPbmZpZG9aaXBDb2RlKHN0cikgewogIGlmIChzdHIuc3Vic3RyaW5nKDUpID09ICIwMDAwIikgewogICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCw1KQogIH0KICBlbHNlIHsKICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsNSkgKyAiLSIgKyBzdHIuc3Vic3RyaW5nKDUpOwogIH0KfQoKLyoKICogU3RvcmUgYXR0cmlidXRlcyBpbiBzaGFyZWQgc3RhdGUgZm9yIHVzZSB3aXRoIHRoZSBDcmVhdGUvUGF0Y2ggT2JqZWN0IG5vZGVzLgogKi8KZnVuY3Rpb24gc2V0U2hhcmVkT2JqZWN0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7CiAgCSB2YXIgc3RvcmFnZSA9IHNoYXJlZFN0YXRlLmdldCgib2JqZWN0QXR0cmlidXRlcyIpOwogICAgaWYgKHN0b3JhZ2UgJiYgdmFsdWUpIHsKICAgICAgCWlmIChzdG9yYWdlLnB1dCkgewoJICAgICAgICAgIHN0b3JhZ2UucHV0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIAllbHNlIHsKICAgICAgICAgIAlzdG9yYWdlW25hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodmFsdWUpIHsKICAgICAgICBzaGFyZWRTdGF0ZS5wdXQoIm9iamVjdEF0dHJpYnV0ZXMiLCBKU09OLnBhcnNlKCJ7XCIiK25hbWUrIlwiOlwiIit2YWx1ZSsiXCJ9IikpOwogICAgfQp9\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "6575"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:33.966Z",
        "time": 36,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 36
        }
      },
      {
        "_id": "0d4d7e68edda6154b6185978006cc975",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "user-agent",
              "value": "@rockcarver/frodo-lib/0.17.3"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "content-type",
              "value": "application/json"
            },
            {
              "name": "accept-api-version",
              "value": "protocol=2.0,resource=1.0"
            },
            {
              "name": "cookie",
              "value": "6ac6499e9da2071=0LNY8cxNUTv4EeN3X2jNI0fZsZk.*AAJTSQACMDIAAlNLABxoRU8vYlZhVyt2V2g0OVBYUlFhL0hFb3pyTEk9AAR0eXBlAANDVFMAAlMxAAIwMQ..*"
            },
            {
              "name": "host",
              "value": "openam-frodo-dev.forgeblocks.com"
            }
          ],
          "headersSize": 574,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "_queryFilter",
              "value": "name eq \"Browser Language Decision\""
            }
          ],
          "url": "https://openam-frodo-dev.forgeblocks.com/am/json/realms/root/realms/alpha/scripts?_queryFilter=name%20eq%20%22Browser%20Language%20Decision%22"
        },
        "response": {
          "bodySize": 2227,
          "content": {
            "mimeType": "application/json;charset=UTF-8",
            "size": 2227,
            "text": "{\"result\":[{\"_id\":\"8508a00e-ad45-4310-b3c7-c6871b6a41a9\",\"name\":\"Browser Language Decision\",\"description\":\"Browser Language Decision\",\"script\":\"LyogQnJvd3NlciBMYW5ndWFnZSBEZWNpc2lvbgogKiAKICogRGV0ZWN0IHRoZSBicm93c2VyIGxhbmd1YWdlIGluIHRoZSByZXF1ZXN0IGFuZCBicmFuY2ggb3V0IHRvIGl0cyBuYW1lZCBleGl0IChlLmcuOiAiZGUiIG9yICJlbiIgb3IgImZyIikgCiAqIGlmIGl0IGlzIHBhcnQgb2YgdGhlIHN1cHBvcnRlZExhbmd1YWdlcyBhcnJheSwgb3RoZXJ3aXNlIHRha2UgdGhlICJvdGhlciIgZXhpdC4KICogCiAqIFRoaXMgc2NyaXB0IGRvZXMgbm90IG5lZWQgdG8gYmUgcGFyYW1ldHJpemVkLiBJdCB3aWxsIHdvcmsgcHJvcGVybHkgYXMgaXMuCiAqIAogKiBUaGUgU2NyaXB0ZWQgRGVjaXNpb24gTm9kZSBuZWVkcyB0aGUgZm9sbG93aW5nIG91dGNvbWVzIGRlZmluZWQ6CiAqIC0gb3RoZXIKICogLSA8YWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgc3VwcG9ydGVkTGFuZ3VhZ2VzIGFycmF5PgogKgogKiBBdXRob3I6IHZvbGtlci5zY2hldWJlckBmb3JnZXJvY2suY29tCiAqLwooZnVuY3Rpb24gKCkgewogIAkvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogIAkvKiBCZWdpbiBTY3JpcHQgQ29uZmlndXJhdGlvbiAqLwogIAkKICAJLy8gYWRkIGFsbCB0aGUgbGFuZ3VhZ2UgY29kZXMgeW91IHdhbnQgdG8gc3VwcG9ydAogIAl2YXIgc3VwcG9ydGVkTGFuZ3VhZ2VzID0gWyJkZSIsImVuIiwiZnIiXTsKICAJCiAgCS8qIEVuZCBTY3JpcHQgQ29uZmlndXJhdGlvbiAgICovCiAgCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgCiAgCW91dGNvbWUgPSBnZXRCcm93c2VyTGFuZ3VhZ2UoKTsKICAJCiAgICAvKgogICAgICogUmV0dXJucyB0aGUgc3VwcG9ydGVkIGJyb3dzZXIgbGFuZ3VhZ2Ugb3IgIm90aGVyIgogICAgICovCiAgICBmdW5jdGlvbiBnZXRCcm93c2VyTGFuZ3VhZ2UoKSB7CiAgICAgIAl2YXIgbGFuZ3VhZ2VIZWFkZXIgPSBnZXRIZWFkZXIoImFjY2VwdC1sYW5ndWFnZSIpOwogICAgICAJdmFyIGxhbmd1YWdlID0gbGFuZ3VhZ2VIZWFkZXIuc3BsaXQoJzsnKVswXS5zcGxpdCgnLCcpWzBdLnNwbGl0KCctJylbMF07CiAgICAgIAlpZiAoc3VwcG9ydGVkTGFuZ3VhZ2VzLmluZGV4T2YobGFuZ3VhZ2UpIDwgMCkgewogICAgICAgICAgCXJldHVybiAib3RoZXIiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGFuZ3VhZ2U7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSByZXF1ZXN0ZWQgaGVhZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEhlYWRlcihoZWFkZXJOYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzLmdldChoZWFkZXJOYW1lKS5nZXQoMCkrIiI7CiAgICB9Cn0oKSk7\",\"default\":false,\"language\":\"JAVASCRIPT\",\"context\":\"AUTHENTICATION_TREE_DECISION_NODE\",\"createdBy\":\"null\",\"creationDate\":0,\"lastModifiedBy\":\"null\",\"lastModifiedDate\":0}],\"resultCount\":1,\"pagedResultsCookie\":null,\"totalPagedResultsPolicy\":\"NONE\",\"totalPagedResults\":-1,\"remainingPagedResults\":0}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "cache-control",
              "value": "private"
            },
            {
              "name": "content-api-version",
              "value": "protocol=2.0,resource=1.1, resource=1.1"
            },
            {
              "name": "content-security-policy",
              "value": "default-src 'none';frame-ancestors 'none';sandbox"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "same-origin"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "same-origin"
            },
            {
              "name": "expires",
              "value": "0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=UTF-8"
            },
            {
              "name": "content-length",
              "value": "2227"
            },
            {
              "name": "date",
              "value": "Tue, 03 Jan 2023 19:32:35 GMT"
            },
            {
              "name": "x-forgerock-transactionid",
              "value": "frodo-95a0f546-4157-462c-91dc-c9f984808fe1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains; preload;"
            },
            {
              "name": "via",
              "value": "1.1 google"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            }
          ],
          "headersSize": 664,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2023-01-03T19:32:34.006Z",
        "time": 35,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 35
        }
      }
    ],
    "pages": [],
    "version": "1.2"
  }
}
